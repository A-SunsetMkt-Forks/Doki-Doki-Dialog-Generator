(function(e){function t(t){for(var n,s,o=t[0],c=t[1],l=t[2],d=0,h=[];d<o.length;d++)s=o[d],a[s]&&h.push(a[s][0]),a[s]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);u&&u(t);while(h.length)h.shift()();return i.push.apply(i,l||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],n=!0,o=1;o<r.length;o++){var c=r[o];0!==a[c]&&(n=!1)}n&&(i.splice(t--,1),e=s(s.s=r[0]))}return e}var n={},a={app:0},i=[];function s(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=n,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/Doki-Doki-Dialog-Generator/beta/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;i.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("cd49")},"180b":function(e,t,r){},"1f82":function(e,t,r){"use strict";var n=r("23f6"),a=r.n(n);a.a},"23f6":function(e,t,r){},3085:function(e,t,r){},3580:function(e,t,r){},"39ff":function(e,t,r){"use strict";var n=r("3580"),a=r.n(n);a.a},4857:function(e,t,r){},"515d":function(e){e.exports={id:"ddlc.natsuki",name:"Natsuki",internalId:"natsuki",folder:"natsuki",heads:{straight:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","1t","scream","corrupt","crying"],sideways:["2ta","2tb","2tc","2td","2te","2tf","2tg","2th","2ti"],sidewaysCasuals:["2bta","2btb","2btc","2btd","2bte","2btf","2btg","2bth","2bti"]},poses:[{compatibleHeads:["straight","sideways"],headInForeground:!0,left:["1l","2l"],right:["1r","2r"]},{compatibleHeads:["straight"],headAnchor:[18,22],static:"3"},{compatibleHeads:["straight","sidewaysCasuals"],headInForeground:!0,left:["1bl","2bl"],right:["1br","2br"]},{compatibleHeads:["straight"],headAnchor:[18,22],static:"3b"}]}},5503:function(e,t,r){"use strict";var n=r("9dc8"),a=r.n(n);a.a},"5c0b":function(e,t,r){"use strict";var n=r("5e27"),a=r.n(n);a.a},"5d7c":function(e){e.exports={id:"ddlc.fan.amy1",name:"Amy (classic)",internalId:"classic_amy",folder:"classic_amy",heads:{straight:["aa","ab","ac","ad","ae","af","ag","ah","ai","ba","bb","bc","bd","be","bf","bg","bh","bi","ca","cb","cc","cd","ce","cf","cg","ch","ci","da","db","dc","dd","de","df","dg","dh","di","ea","eb","ec","ed","ee","ef","eg","eh","ei","fa","fb","fc","fd","fe","ff","fg","fh","fi"]},poses:[{compatibleHeads:["straight"],left:["1l","2l"],right:["1r"],headInForeground:!0},{compatibleHeads:["straight"],static:"3"}]}},"5e27":function(e,t,r){},"66a6":function(e,t,r){"use strict";var n=r("79cc"),a=r.n(n);a.a},6785:function(e){e.exports={id:"ddlc.yuri",name:"Yuri",internalId:"yuri",folder:"yuri",heads:{straight:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","y1","y2","y3","y4","y5","y6","y7","hisui"],sideways:["a2","b2","c2","d2","e2"]},poses:[{compatibleHeads:["straight"],left:["1l","2l"],right:["1r","2r"]},{compatibleHeads:["sideways"],static:"3"},{compatibleHeads:["straight"],left:["1bl","2bl"],right:["1br","2br"]},{compatibleHeads:["sideways"],static:"3b"}]}},"6b47":function(e){e.exports={id:"ddlc.monika",name:"Monika",internalId:"monika",folder:"monika",heads:{straight:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r"],sideways:["a2","b2"]},poses:[{compatibleHeads:["straight"],left:["1l","2l"],right:["1r","2r"]},{compatibleHeads:["sideways"],static:"3"}]}},"794c":function(e){e.exports={id:"ddlc.fan.amy2",name:"Amy",internalId:"amy",folder:"amy",heads:{straight:["a","b","c","d","e","f","g","h","i","h","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],straight_broken_glases:["!1","!2","!3","!4","!5"]},poses:[{compatibleHeads:["straight","straight_broken_glases"],left:["1l","2l","3l"],right:["1r","2r"],headInForeground:!0},{compatibleHeads:["straight","straight_broken_glases"],static:"5"},{compatibleHeads:["straight","straight_broken_glases"],static:"6"},{compatibleHeads:["straight"],left:["4l"],right:["1r","2r"]}]}},"79cc":function(e,t,r){},"7b43":function(e){e.exports={id:"ddlc.fan.mc_chad",name:"MC (Chad)",internalId:"chad",folder:"chad",heads:{straight:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","y","z","error","error1","shock"],straight_closed:["u","w","v","x1","x2","x3","x4"],straight_red:{folder:"red",all:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","y","z","error","error1","shock"]}},poses:[{compatibleHeads:["straight","straight_closed"],left:["1l","2l","4l"],right:["1r","2r"]},{compatibleHeads:["straight","straight_closed"],static:"3"},{compatibleHeads:["straight","straight_closed"],left:["1bl","2bl","4bl"],right:["1br","2br"]},{compatibleHeads:["straight","straight_closed"],static:"3b"},{compatibleHeads:["straight_red","straight_closed"],left:["1l","2l","4l"],right:["1r","2r"]},{compatibleHeads:["straight_red","straight_closed"],static:"3"},{compatibleHeads:["straight_red","straight_closed"],left:["1bl","2bl","4bl"],right:["1br","2br"]},{compatibleHeads:["straight_red","straight_closed"],static:"3b"}]}},"81c5":function(e){e.exports={id:"ddlc.sayori",name:"Sayori",internalId:"sayori",folder:"sayori",heads:{straight:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y"],sideways:["a2","b2","c2","d2"]},poses:[{compatibleHeads:["straight"],left:["1l","2l"],right:["1r","2r"]},{compatibleHeads:["sideways"],static:"3"},{compatibleHeads:["straight"],left:["1bl","2bl"],right:["1br","2br"]}]}},8735:function(e,t,r){"use strict";var n=r("f649"),a=r.n(n);a.a},"9dc8":function(e,t,r){},b367:function(e,t,r){"use strict";var n=r("ea81"),a=r.n(n);a.a},baa9:function(e,t,r){"use strict";var n=r("3085"),a=r.n(n);a.a},cd49:function(e,t,r){"use strict";r.r(t);r("cadf"),r("551c"),r("f751"),r("097d");var n=r("2b0e"),a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("div",{attrs:{id:"container"}},[r("canvas",{ref:"sd",style:{width:e.canvasWidth+"px",height:e.canvasHeight+"px"},attrs:{id:"scaled_display",height:"720",width:"1280",draggable:""},on:{click:e.onUiClick,touchstart:e.onTouchStart,dragstart:e.onDragStart,touchmove:e.onSpriteDragMove,mousemove:e.onSpriteDragMove,touchend:e.onSpriteDrop,mouseup:e.onSpriteDrop,dragover:e.onDragOver,drop:e.onDrop,mouseenter:e.onMouseEnter}},[e._v("HTML5 is required to use the Doki Doki Dialog Generator.")])]),r("message-console",{class:{vertical:e.vertical},attrs:{loading:e.currentlyRendering,id:"messages"}}),r("div",{class:{vertical:e.vertical},attrs:{id:"panels"}},[r("div",{attrs:{id:"toolbar"}},[r("button",{class:{active:"add"===e.panel},on:{click:function(t){e.panel="add"===e.panel?"":"add"}}},[e._v("A")]),r("button",{class:{active:"backgrounds"===e.panel},on:{click:function(t){e.panel="backgrounds"===e.panel?"":"backgrounds"}}},[e._v("B")]),r("button",{class:{active:"credits"===e.panel},on:{click:function(t){e.panel="credits"===e.panel?"":"credits"}}},[e._v("C")]),r("button",{on:{click:e.download}},[e._v("D")])]),r("keep-alive",[""===e.panel?r("general-panel",{attrs:{options:e.textbox,vertical:e.vertical,"has-prev-render":""!==e.prevRender,lqRendering:e.lqRendering},on:{"update:lqRendering":function(t){e.lqRendering=t},"update:lq-rendering":function(t){e.lqRendering=t},"show-prev-render":e.showPreviousRender}}):e._e(),"add"===e.panel?r("add-panel",{attrs:{vertical:e.vertical},on:{chosen:e.onCharacterCreate,"add-custom-asset":e.onAssetCreate}}):e._e(),"backgrounds"===e.panel?r("backgrounds-panel",{attrs:{vertical:e.vertical},on:{"invalidate-render":e.invalidateRender},model:{value:e.currentBackground,callback:function(t){e.currentBackground=t},expression:"currentBackground"}}):e._e(),"credits"===e.panel?r("credits-panel",{attrs:{vertical:e.vertical}}):e._e(),"character"===e.panel?r("character-panel",{attrs:{vertical:e.vertical,character:e.selectedCharacter},on:{shiftLayer:e.onObjectLayerShift,"invalidate-render":e.invalidateRender}}):e._e(),"sprite"===e.panel?r("sprite-panel",{attrs:{vertical:e.vertical,sprite:e.selectedSprite},on:{shiftLayer:e.onObjectLayerShift,"invalidate-render":e.invalidateRender}}):e._e()],1)],1)],1)},i=[],s=(r("4917"),r("768b")),o=(r("5df3"),r("ac4d"),r("8a81"),r("ac6a"),r("96cf"),r("3b8d")),c=r("d225"),l=r("b0b4"),u=r("308d"),d=r("6bb5"),h=r("4e2b"),p=r("9ab4"),f=r("60a3"),g=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"btn",on:{click:function(t){return e.$emit("click")}}},[e._t("default")],2)},b=[],v=function(e){function t(){return Object(c["a"])(this,t),Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments))}return Object(h["a"])(t,e),t}(f["c"]);v=p["a"]([Object(f["a"])({components:{}})],v);var m=v,y=m,_=(r("b367"),r("2877")),k=Object(_["a"])(y,g,b,!1,null,null,null),w=k.exports,x=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:{panel:!0,vertical:e.vertical}},[r("h1",[e._v("General")]),r("toggle",{attrs:{label:"Low quality preview?",title:"Reduces the quality of the preview images to speed up the user experience and consume less data. Does not effect final render.",value:e.lqRendering},on:{input:function(t){return e.$emit("update:lqRendering",t)}}}),r("button",{attrs:{disabled:!e.hasPrevRender},on:{click:function(t){return e.$emit("show-prev-render")}}},[e._v("Compare to last download")]),r("toggle",{attrs:{label:"Textbox visible?"},model:{value:e.options.display,callback:function(t){e.$set(e.options,"display",t)},expression:"options.display"}}),r("toggle",{attrs:{label:"Textbox corrupt?"},model:{value:e.options.corrupted,callback:function(t){e.$set(e.options,"corrupted",t)},expression:"options.corrupted"}}),r("div",[r("label",{attrs:{for:"current_talking"}},[e._v("Person talking:")]),r("br"),r("select",{directives:[{name:"model",rawName:"v-model",value:e.options.talking,expression:"options.talking"}],attrs:{id:"current_talking"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.options,"talking",t.target.multiple?r:r[0])}}},[r("option",{attrs:{value:""}},[e._v("No-one")]),r("option",{attrs:{value:"Sayori"}},[e._v("Sayori")]),r("option",{attrs:{value:"Yuri"}},[e._v("Yuri")]),r("option",{attrs:{value:"Natsuki"}},[e._v("Natsuki")]),r("option",{attrs:{value:"Monika"}},[e._v("Monika")]),r("option",{attrs:{value:"FeMC"}},[e._v("FeMC")]),r("option",{attrs:{value:"MC"}},[e._v("MC")]),r("option",{attrs:{value:"Amy"}},[e._v("Amy")]),r("option",{attrs:{value:"other"}},[e._v("Other")])])]),r("div",[r("label",{attrs:{for:"custom_name"}},[e._v("Other name:")]),r("br"),r("input",{directives:[{name:"model",rawName:"v-model",value:e.options.customName,expression:"options.customName"}],attrs:{id:"custom_name"},domProps:{value:e.options.customName},on:{input:function(t){t.target.composing||e.$set(e.options,"customName",t.target.value)}}})]),r("toggle",{attrs:{label:"Controls visible?"},model:{value:e.options.showControls,callback:function(t){e.$set(e.options,"showControls",t)},expression:"options.showControls"}}),r("toggle",{attrs:{label:"Able to skip?"},model:{value:e.options.allowSkipping,callback:function(t){e.$set(e.options,"allowSkipping",t)},expression:"options.allowSkipping"}}),r("toggle",{attrs:{label:"Continue arrow?"},model:{value:e.options.showContinueArrow,callback:function(t){e.$set(e.options,"showContinueArrow",t)},expression:"options.showContinueArrow"}}),r("div",{attrs:{id:"dialog_text_wrapper"}},[r("label",{attrs:{for:"dialog_text"}},[e._v("Dialog:")]),r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.options.dialog,expression:"options.dialog"}],attrs:{id:"dialog_text"},domProps:{value:e.options.dialog},on:{input:function(t){t.target.composing||e.$set(e.options,"dialog",t.target.value)}}})]),e._m(0)],1)},O=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",[e._v("\n\t\tFormatting:\n\t\t"),r("br"),e._v("[In brackets] for editied style text\n\t")])}],j=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("input",{ref:"checkbox",attrs:{id:e._uid,type:"checkbox"},domProps:{checked:e.value},on:{change:e.onChange}}),r("label",{attrs:{for:e._uid}},[e._v(e._s(e.label))])])},C=[],P=function(e){function t(){return Object(c["a"])(this,t),Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments))}return Object(h["a"])(t,e),Object(l["a"])(t,[{key:"onChange",value:function(e){this.$emit("input",!!this.$refs.checkbox.checked)}},{key:"checkbox",get:function(){return this.$refs.checkbox}}]),t}(f["c"]);p["a"]([Object(f["b"])({type:String})],P.prototype,"label",void 0),p["a"]([Object(f["b"])({type:Boolean,default:!1})],P.prototype,"value",void 0),P=p["a"]([Object(f["a"])({components:{}})],P);var S=P,R=S,$=(r("e2da"),Object(_["a"])(R,j,C,!1,null,"7e803566",null)),L=$.exports,T=function(e){function t(){return Object(c["a"])(this,t),Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments))}return Object(h["a"])(t,e),Object(l["a"])(t,[{key:"talkingChange",value:function(){this.options.talking="other"}}]),t}(f["c"]);p["a"]([Object(f["b"])({required:!0})],T.prototype,"options",void 0),p["a"]([Object(f["b"])({required:!0,type:Boolean})],T.prototype,"vertical",void 0),p["a"]([Object(f["b"])({required:!0,type:Boolean})],T.prototype,"lqRendering",void 0),p["a"]([Object(f["b"])({required:!0,type:Boolean})],T.prototype,"hasPrevRender",void 0),p["a"]([Object(f["d"])("options.customName")],T.prototype,"talkingChange",null),T=p["a"]([Object(f["a"])({components:{Toggle:L}})],T);var A=T,H=A,M=(r("1f82"),Object(_["a"])(H,x,O,!1,null,"1ad1b6c2",null)),D=M.exports,q=function(){var e=this,t=e.$createElement,r=e._self._c||t;return void 0!==e.isWebPSupported?r("div",{class:{panel:!0,vertical:e.vertical}},[r("h1",[e._v("Add character")]),e._l(e.characters,function(t){return r("div",{key:t.id,staticClass:"character",attrs:{title:t.name},on:{click:function(r){e.$emit("chosen",t.id.toLowerCase())}}},[r("img",{attrs:{src:e.assetPath(t),alt:t.name}})])}),r("div",{staticClass:"btn custom-sprite",on:{click:function(t){return e.$refs.upload.click()}}},[e._v("\n\t\tCustom sprite\n\t\t"),r("input",{ref:"upload",attrs:{type:"file"},on:{change:e.onFileUpload}})])],2):e._e()},I=[],B=(r("a481"),r("bd86")),E=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(c["a"])(this,e),this.name=r,this.custom=n,this.flip=!1,this.path=(n?"":"/backgrounds/")+t}return Object(l["a"])(e,[{key:"render",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,de(this.path,t.hq);case 3:e.t1=e.sent,e.t2=this.flip,e.t3={image:e.t1,x:0,y:0,flip:e.t2},e.t0.drawImage.call(e.t0,e.t3);case 7:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),F={name:"Static color",color:"#000000",render:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t.drawRect({x:0,y:0,w:1280,h:720,fill:{style:this.color}});case 1:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},Y={name:"Transparent",render:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},N=r("81c5"),U=r("6785"),X=r("6b47"),W=r("515d"),z=r("f721"),G=r("fdec"),K=r("7b43"),J=r("d0ca"),V=r("794c"),Q=r("5d7c"),Z=function(){function e(t,r,n){Object(c["a"])(this,e),this.name=t,this.basefolder=r,this.variants=n,this.flip=!1,this.variantI=0,this.variants=n.map(function(e){return e.map(function(e){return(r+e).replace(/\/+/g,"/")})}),this.path=this.variants[0][0]}return Object(l["a"])(e,[{key:"render",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var r,n,a,i,s,o,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.variants[this.variantI].map(function(e){return de(e,t.hq)}));case 2:for(r=e.sent,n=!0,a=!1,i=void 0,e.prev=6,s=r[Symbol.iterator]();!(n=(o=s.next()).done);n=!0)c=o.value,t.drawImage({image:c,x:0,y:0,flip:this.flip});e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](6),a=!0,i=e.t0;case 14:e.prev=14,e.prev=15,n||null==s.return||s.return();case 17:if(e.prev=17,!a){e.next=20;break}throw i;case 20:return e.finish(17);case 21:return e.finish(14);case 22:case"end":return e.stop()}},e,this,[[6,10,14,22],[15,,17,21]])}));function t(t){return e.apply(this,arguments)}return t}()},{key:"variant",get:function(){return this.variantI},set:function(e){e<0&&(e=this.variants.length+e),e>=this.variants.length&&(e=this.variants.length-e),this.variantI=e}}]),e}(),ee=new n["a"],te={fire:function(e){ee.$emit(e.kind,e)},subscribe:function(e,t){ee.$on(e.kind,t)},unsubscribe:function(e,t){ee.$off(e.kind,t)}},re=function e(t){Object(c["a"])(this,e),this.path=t,this.kind="AssetFailureEvent"};re.kind="AssetFailureEvent";var ne,ae,ie=function e(){Object(c["a"])(this,e)},se=[X,W,N,U,z,G,K,J,V,Q],oe=(ne={},Object(B["a"])(ne,N.id,N),Object(B["a"])(ne,U.id,U),Object(B["a"])(ne,W.id,W),Object(B["a"])(ne,X.id,X),Object(B["a"])(ne,z.id,z),Object(B["a"])(ne,G.id,G),Object(B["a"])(ne,K.id,K),Object(B["a"])(ne,J.id,J),Object(B["a"])(ne,V.id,V),Object(B["a"])(ne,Q.id,Q),ne);function ce(){return ae||(ae=new Promise(function(e,t){var r="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=",n=document.createElement("img");n.addEventListener("load",function(){e(2===n.width&&1===n.height)}),n.addEventListener("error",function(){e(!1)}),n.src=r})),ae}var le={},ue={};function de(e){return he.apply(this,arguments)}function he(){return he=Object(o["a"])(regeneratorRuntime.mark(function e(t){var r,n,a=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(r=!(a.length>1&&void 0!==a[1])||a[1],!ue[t]){e.next=3;break}return e.abrupt("return",ue[t]);case 3:return e.t0="".concat("/Doki-Doki-Dialog-Generator/beta/","/assets/").concat(t).concat(r?"":".lq"),e.next=6,ce();case 6:if(!e.sent){e.next=10;break}e.t1=".webp",e.next=11;break;case 10:e.t1=".png";case 11:return e.t2=e.t1,n=e.t0.concat.call(e.t0,e.t2).replace(/\/+/,"/"),le[n]||(le[n]=new Promise(function(e,t){var r=new Image;r.addEventListener("load",function(){e(r)}),r.addEventListener("error",function(){te.fire(new re(n)),le[n]=void 0,e(new ie)}),r.crossOrigin="Anonymous",r.src=n,r.style.display="none",document.body.appendChild(r)})),e.abrupt("return",le[n]);case 15:case"end":return e.stop()}},e)})),he.apply(this,arguments)}function pe(e,t){var r=URL.createObjectURL(t);return ue[e]=new Promise(function(e,t){var n=new Image;n.addEventListener("load",function(){e(n)}),n.addEventListener("error",function(){t('Failed to load "'.concat(r,'"'))}),n.crossOrigin="Anonymous",n.src=r,n.style.display="none",document.body.appendChild(n)}),r}var fe=[new Z("Clubroom","/backgrounds/",[["club"],["club-skill"]]),new E("closet","Closet"),new E("corridor","Corridor"),new E("class","Classroom"),new E("residential","Street"),new E("house","House"),new E("bedroom","Bedroom"),new E("kitchen","Kitchen"),new E("sayori_bedroom","Sayori's bedroom"),new E("bsod","Blue screen of death"),new E("unused-house","Unused house found in game files"),new Z("Natsuki reading manga","/cg/natsuki_1/",[["n_cg1_bg"],["n_cg1_bg","n_cg1_base"],["n_cg1_bg","n_cg1_base","n_cg1_exp1"],["n_cg1_bg","n_cg1_base","n_cg1_exp2"],["n_cg1_bg","n_cg1_base","n_cg1_exp3"],["n_cg1_bg","n_cg1_base","n_cg1_exp4"],["n_cg1_bg","n_cg1_base","n_cg1_exp5"]]),new Z("Natsuki in the closet","/cg/natsuki_2/",[["n_cg2_bg"],["n_cg2_bg","n_cg2_base"],["n_cg2_bg","n_cg2_base","n_cg2_exp1"],["n_cg2_bg","n_cg2_base","n_cg2_exp2"]]),new Z("Natsuki against the wall","/cg/natsuki_3/",[["n_cg3_base"],["n_cg3_base","n_cg3_exp1"],["n_cg3_base","n_cg3_exp2"],["n_cg3_base","n_cg3_cake"],["n_cg3_base","n_cg3_exp1","n_cg3_cake"],["n_cg3_base","n_cg3_exp2","n_cg3_cake"]]),new E("../cg/sayori_1/s_cg1","Sayori dressing"),new Z("Sayori bumped head","/cg/sayori_2/",[["s_cg2_base1"],["s_cg2_base1","s_cg2_exp1"],["s_cg2_base1","s_cg2_exp2"],["s_cg2_base1","s_cg2_exp3"],["s_cg2_base1","s_cg2_exp1","s_cg2_exp3"],["s_cg2_base1","s_cg2_exp2","s_cg2_exp3"],["s_cg2_base2"],["s_cg2_base2","s_cg2_exp1"],["s_cg2_base2","s_cg2_exp2"],["s_cg2_base2","s_cg2_exp3"],["s_cg2_base2","s_cg2_exp1","s_cg2_exp3"],["s_cg2_base2","s_cg2_exp2","s_cg2_exp3"]]),new E("../cg/sayori_3/s_cg3","Sayori hug"),new Z("Yuri reading","/cg/yuri_1/",[["y_cg1_base"],["y_cg1_base","y_cg1_exp2"],["y_cg1_base","y_cg1_exp1"],["y_cg1_base","y_cg1_exp1","y_cg1_exp2"],["y_cg1_base","y_cg1_exp3"]]),new Z("Yuri against the wall","/cg/yuri_2/",[["y_cg2_bg1"],["y_cg2_bg1","y_cg2_base","y_cg2_nochoc"],["y_cg2_bg1","y_cg2_base","y_cg2_exp2","y_cg2_nochoc"],["y_cg2_bg1","y_cg2_base","y_cg2_exp3","y_cg2_nochoc"],["y_cg2_bg1","y_cg2_base"],["y_cg2_bg1","y_cg2_base","y_cg2_exp2"],["y_cg2_bg1","y_cg2_base","y_cg2_exp3"],["y_cg2_bg2"],["y_cg2_bg2","y_cg2_base","y_cg2_nochoc"],["y_cg2_bg2","y_cg2_base","y_cg2_exp2","y_cg2_nochoc"],["y_cg2_bg2","y_cg2_base","y_cg2_exp3","y_cg2_nochoc"],["y_cg2_bg2","y_cg2_base"],["y_cg2_bg2","y_cg2_base","y_cg2_exp2"],["y_cg2_bg2","y_cg2_base","y_cg2_exp3"]]),new Z("Yuri with towel","/cg/yuri_3/",[["y_cg3_base"],["y_cg3_base","y_cg3_exp1"]]),new Z("Yuri's death","/cg/yuri_kill/",[["1a"],["1b"],["1c"],["2a"],["2b"],["2c"],["3a"],["3b"],["3c"]]),new Z("The spaceroom","/cg/monika/",[["monika_room"],["monika_room_highlight"],["monika_bg"],["monika_bg_highlight"],["room"],["monika_bg_glitch"],["monika_bg_glitch","monika_glitch1"],["monika_bg_glitch","monika_glitch2"],["monika_bg_glitch","monika_glitch3"],["monika_bg_glitch","monika_glitch4"],["monika_scare"]]),F,Y],ge=function(e){function t(){var e;return Object(c["a"])(this,t),e=Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.isWebPSupported=null,e.customAssetCount=0,e}return Object(h["a"])(t,e),Object(l["a"])(t,[{key:"created",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ce();case 2:this.isWebPSupported=e.sent;case 3:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"assetPath",value:function(e){return"".concat("/Doki-Doki-Dialog-Generator/beta/","/assets/chibis/").concat(e.internalId,".lq.").concat(this.isWebPSupported?"webp":"png").replace(/\/+/,"/")}},{key:"onFileUpload",value:function(e){var t=this,r=this.$refs.upload;if(r.files){var n=!0,a=!1,i=void 0;try{for(var s,o=function(){var e=s.value;(function(r){var n="customAsset"+r;pe(n,e);t.$emit("add-custom-asset",n)})(++t.customAssetCount)},c=r.files[Symbol.iterator]();!(n=(s=c.next()).done);n=!0)o()}catch(l){a=!0,i=l}finally{try{n||null==c.return||c.return()}finally{if(a)throw i}}}}},{key:"characters",get:function(){return se}}]),t}(f["c"]);p["a"]([Object(f["b"])({required:!0,type:Boolean})],ge.prototype,"vertical",void 0),ge=p["a"]([Object(f["a"])({components:{}})],ge);var be=ge,ve=be,me=(r("5503"),Object(_["a"])(ve,q,I,!1,null,"95f33d28",null)),ye=me.exports,_e=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:{panel:!0,vertical:e.vertical}},[r("h1",[e._v(e._s(e.character.label))]),e.hasMultiplePoses||e.parts.length>0?r("fieldset",[r("legend",[e._v("Pose:")]),r("table",[r("tbody",[e.hasMultiplePoses?r("tr",[r("td",[r("button",{on:{click:function(t){return e.character.posel()}}},[e._v("<")])]),r("td",[e._v("Pose")]),r("td",[r("button",{on:{click:function(t){return e.character.poser()}}},[e._v(">")])])]):e._e(),e._l(e.parts,function(t){return r("tr",{key:t},[r("td",[r("button",{on:{click:function(r){return e.character.partl(t)}}},[e._v("<")])]),r("td",[e._v(e._s(e.captialize(t)))]),r("td",[r("button",{on:{click:function(r){return e.character.partr(t)}}},[e._v(">")])])])})],2)])]):e._e(),r("fieldset",[r("legend",[e._v("Position:")]),r("toggle",{attrs:{label:"Move freely?"},on:{input:function(t){return e.$emit("invalidate-render")}},model:{value:e.character.allowFreeMove,callback:function(t){e.$set(e.character,"allowFreeMove",t)},expression:"character.allowFreeMove"}}),e.character.allowFreeMove?r("div",[r("label",{attrs:{for:"sprite_x"}},[e._v("X:")]),r("input",{directives:[{name:"model",rawName:"v-model.number",value:e.character.x,expression:"character.x",modifiers:{number:!0}}],attrs:{id:"sprite_x",type:"number"},domProps:{value:e.character.x},on:{input:[function(t){t.target.composing||e.$set(e.character,"x",e._n(t.target.value))},function(t){return e.$emit("invalidate-render")}],keydown:function(e){e.stopPropagation()},blur:function(t){return e.$forceUpdate()}}}),r("br"),r("label",{attrs:{for:"sprite_y"}},[e._v("Y:")]),r("input",{directives:[{name:"model",rawName:"v-model.number",value:e.character.y,expression:"character.y",modifiers:{number:!0}}],attrs:{id:"sprite_y",type:"number"},domProps:{value:e.character.y},on:{input:[function(t){t.target.composing||e.$set(e.character,"y",e._n(t.target.value))},function(t){return e.$emit("invalidate-render")}],keydown:function(e){e.stopPropagation()},blur:function(t){return e.$forceUpdate()}}})]):r("div",[r("button",{on:{click:function(t){--e.character.pos,e.$emit("invalidate-render")}}},[e._v("<")]),r("select",{directives:[{name:"model",rawName:"v-model.number",value:e.character.pos,expression:"character.pos",modifiers:{number:!0}}],attrs:{id:"current_talking"},on:{input:function(t){return e.$emit("invalidate-render")},change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(t){var r="_value"in t?t._value:t.value;return e._n(r)});e.$set(e.character,"pos",t.target.multiple?r:r[0])}}},e._l(e.positionNames,function(t,n){return r("option",{key:n,domProps:{value:n}},[e._v(e._s(t))])}),0),r("button",{on:{click:function(t){++e.character.pos,e.$emit("invalidate-render")}}},[e._v(">")])])],1),r("fieldset",{attrs:{id:"layerfs"}},[r("legend",[e._v("Layer:")]),r("button",{attrs:{title:"Move to back"},on:{click:function(t){return e.$emit("shiftLayer",{object:e.character,move:"Back"})}}},[e._v("⤓")]),r("button",{attrs:{title:"Move backwards"},on:{click:function(t){return e.$emit("shiftLayer",{object:e.character,move:"Backward"})}}},[e._v("↓")]),r("button",{attrs:{title:"Move forwards"},on:{click:function(t){return e.$emit("shiftLayer",{object:e.character,move:"Forward"})}}},[e._v("↑")]),r("button",{attrs:{title:"Move to front"},on:{click:function(t){return e.$emit("shiftLayer",{object:e.character,move:"Front"})}}},[e._v("⤒")])]),r("div",[r("label",{attrs:{for:"characterOpacity"}},[e._v("Opacity:")]),r("input",{directives:[{name:"model",rawName:"v-model.number",value:e.character.opacity,expression:"character.opacity",modifiers:{number:!0}}],attrs:{type:"number",max:"100",min:"0",id:"characterOpacity"},domProps:{value:e.character.opacity},on:{input:[function(t){t.target.composing||e.$set(e.character,"opacity",e._n(t.target.value))},function(t){return e.$emit("invalidate-render")}],keydown:function(e){e.stopPropagation()},blur:function(t){return e.$forceUpdate()}}})]),r("toggle",{attrs:{label:"In front of textbox?"},on:{input:function(t){return e.$emit("invalidate-render")}},model:{value:e.character.infront,callback:function(t){e.$set(e.character,"infront",t)},expression:"character.infront"}}),r("toggle",{attrs:{label:"Close up?"},on:{input:function(t){return e.$emit("invalidate-render")}},model:{value:e.character.close,callback:function(t){e.$set(e.character,"close",t)},expression:"character.close"}}),r("toggle",{attrs:{label:"Flipped?"},on:{input:function(t){return e.$emit("invalidate-render")}},model:{value:e.character.flip,callback:function(t){e.$set(e.character,"flip",t)},expression:"character.flip"}}),r("button",{on:{click:function(t){e.$emit("shiftLayer",{object:e.character,move:"Delete"}),e.$emit("close")}}},[e._v("Delete")])],1)},ke=[],we=(r("55dd"),r("6762"),r("2fdb"),r("7f7f"),r("75fc")),xe=r("01c8"),Oe=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],je=[200,240,400,493,640,786,880,1040,1080],Ce=(r("34ef"),r("28a5"),r("8e6e"),r("456d"),r("6c7b"),function e(){Object(c["a"])(this,e)});function Pe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pe(r,!0).forEach(function(t){Object(B["a"])(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pe(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var Re=function(){function e(t,r,n){Object(c["a"])(this,e),this.fsCtx=t,this.hq=r,this.preview=n,this.aborted=!1}return Object(l["a"])(e,[{key:"drawText",value:function(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"white",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"#533643",o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"20px aller";if(this.aborted)throw new Ce;this.fsCtx.fillStyle=i,s&&(this.fsCtx.strokeStyle=s),this.fsCtx.lineWidth=2*a,this.fsCtx.textAlign=n,this.fsCtx.font=o,this.fsCtx.lineJoin="round",s&&this.fsCtx.strokeText(e,t,r),this.fsCtx.fillText(e,t,r)}},{key:"drawImage",value:function(e){if(this.aborted)throw new Ce;if(!(e.image instanceof ie)){var t=Se({flip:!1,w:e.image.width,h:e.image.height,opacity:100},e),r=t.image,n=t.flip,a=t.x,i=t.y,s=t.w,o=t.h,c=t.opacity;if(this.fsCtx.save(),c<100&&(this.fsCtx.globalAlpha=c/100),e.shadow){var l=e.shadow;l.color&&(this.fsCtx.shadowColor=l.color),l.blur&&(this.fsCtx.shadowBlur=l.blur),l.offsetX&&(this.fsCtx.shadowOffsetX=l.offsetX),l.offsetY&&(this.fsCtx.shadowOffsetY=l.offsetY)}this.fsCtx.translate(a+s/2,i+o/2),this.fsCtx.scale(n?-1:1,1),r instanceof $e?r.paintOnto(this.fsCtx,-s/2,-o/2,s,o):this.fsCtx.drawImage(r,-s/2,-o/2,s,o),this.fsCtx.restore()}}},{key:"drawRect",value:function(e){var t=e.x,r=e.y,n=e.w,a=e.h,i=e.outline,s=e.fill;if(this.aborted)throw new Ce;this.fsCtx.save(),this.fsCtx.beginPath(),this.fsCtx.rect(t,r,n,a),s&&(this.fsCtx.fillStyle=s.style,this.fsCtx.fill()),i&&(this.fsCtx.strokeStyle=i.style,this.fsCtx.lineWidth=i.width,this.fsCtx.stroke()),this.fsCtx.restore()}},{key:"measureText",value:function(e){if(this.aborted)throw new Ce;return this.fsCtx.measureText(e)}},{key:"abort",value:function(){this.aborted=!0}}]),e}(),$e=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1280,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:720;Object(c["a"])(this,e),this.runningContext=null,this.previewCanvas=document.createElement("canvas"),this.previewCanvas.width=t,this.previewCanvas.height=r}return Object(l["a"])(e,[{key:"render",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var r,n,a,i=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=!(i.length>1&&void 0!==i[1])||i[1],this.runningContext&&this.runningContext.abort(),n=this.previewCanvas.getContext("2d"),n.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),a=this.runningContext=new Re(n,r,!0),e.prev=5,e.next=8,t(this.runningContext);case 8:e.next=15;break;case 10:if(e.prev=10,e.t0=e["catch"](5),!(e.t0 instanceof Ce)){e.next=14;break}return e.abrupt("return",!1);case 14:throw e.t0;case 15:return e.prev=15,a===this.runningContext&&(this.runningContext=null),e.finish(15);case 18:return e.abrupt("return",!0);case 19:case"end":return e.stop()}},e,this,[[5,10,15,18]])}));function t(t){return e.apply(this,arguments)}return t}()},{key:"paintOnto",value:function(e,t,r,n,a){n&&a?e.drawImage(this.previewCanvas,t,r,n,a):e.drawImage(this.previewCanvas,t,r)}},{key:"download",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t,r){var n,a,i,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=document.createElement("canvas"),n.width=this.previewCanvas.width,n.height=this.previewCanvas.height,a=n.getContext("2d"),a.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),e.next=7,t(new Re(a,!0,!1));case 7:return i=n.toDataURL(),void 0===window.navigator.msSaveOrOpenBlob?(s=document.createElement("a"),s.setAttribute("href",i),s.setAttribute("download",r),document.body.appendChild(s),s.click(),document.body.removeChild(s)):window.navigator.msSaveBlob(this.dataURItoBlob(i),r),e.abrupt("return",i);case 10:case"end":return e.stop()}},e,this)}));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"getDataAt",value:function(e,t){var r=this.previewCanvas.getContext("2d");return r.getImageData(e,t,1,1).data}},{key:"dataURItoBlob",value:function(e){for(var t=atob(e.split(",")[1]),r=[],n=0;n<t.length;n++)r.push(t.charCodeAt(n));return new Blob([new Uint8Array(r)],{type:"image/png"})}},{key:"width",get:function(){return this.previewCanvas.width}},{key:"height",get:function(){return this.previewCanvas.height}}]),e}(),Le=function(){function e(t,r){Object(c["a"])(this,e),this.name=t,this.invalidator=r,this.infront=!1,this.close=!1,this.flip=!1,this.opacity=100,this.lq=!0,this.selected=!1,this.poseId=0,this.posePositions={variant:0,left:0,right:0,head:0,headType:0},this.localRenderer=new $e(960,960),this.dirty=!0,this.hitDetectionFallback=!1,this.freeMove=!1,this.pPos=4,this.pX=je[4],this.pY=0}return Object(l["a"])(e,[{key:"select",value:function(){this.selected=!0}},{key:"unselect",value:function(){this.selected=!1}},{key:"getParts",value:function(){var e=this.pose,t=this.pose.compatibleHeads.length>0?["head"]:[];return"variant"in e?[].concat(t,["variant"]):"left"in e?[].concat(t,["left","right"]):t}},{key:"updateLocalCanvas",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.localRenderer.render(function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(r){var n,a,i,s,o,c,l,u,d,h,p,f,g,b,v,m,y,_,k,w,x,O,j;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.pose,a=[],i=t.getParts(),s=(t.data.folder?t.data.folder+"/":"")+(t.pose.folder?t.pose.folder+"/":""),o=(t.data.folder?t.data.folder+"/":"")+(t.currentHeads&&t.currentHeads.folder?t.currentHeads.folder+"/":""),!n.static){e.next=9;break}a.push(s+n.static),e.next=36;break;case 9:c=!0,l=!1,u=void 0,e.prev=12,d=i[Symbol.iterator]();case 14:if(c=(h=d.next()).done){e.next=22;break}if(p=h.value,"head"!==p){e.next=18;break}return e.abrupt("continue",19);case 18:a.push(s+n[p][t.posePositions[p]]);case 19:c=!0,e.next=14;break;case 22:e.next=28;break;case 24:e.prev=24,e.t0=e["catch"](12),l=!0,u=e.t0;case 28:e.prev=28,e.prev=29,c||null==d.return||d.return();case 31:if(e.prev=31,!l){e.next=34;break}throw u;case 34:return e.finish(31);case 35:return e.finish(28);case 36:return f=t.currentHeads?o+t.currentHeads.all[t.posePositions.head]:null,e.next=39,Promise.all([f?de(f,r.hq):Promise.resolve(null)].concat(Object(we["a"])(a.map(function(e){return de(e,r.hq)}))));case 39:for(g=e.sent,b=Object(xe["a"])(g),v=b[0],m=b.slice(1),y=function(){if(v){var e=t.pose.headAnchor?t.pose.headAnchor:[0,0];r.drawImage({image:v,x:e[0],y:("ddlc.monika"===t.name?1:0)+e[1]})}},t.pose.headInForeground||y(),_=!0,k=!1,w=void 0,e.prev=48,x=m[Symbol.iterator]();!(_=(O=x.next()).done);_=!0)j=O.value,r.drawImage({image:j,x:0,y:0});e.next=56;break;case 52:e.prev=52,e.t1=e["catch"](48),k=!0,w=e.t1;case 56:e.prev=56,e.prev=57,_||null==x.return||x.return();case 59:if(e.prev=59,!k){e.next=62;break}throw w;case 62:return e.finish(59);case 63:return e.finish(56);case 64:t.pose.headInForeground&&y();case 65:case"end":return e.stop()}},e,null,[[12,24,28,36],[29,,31,35],[48,52,56,64],[57,,59,63]])}));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"render",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var r,n,a,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.dirty&&this.lq===!t.hq){e.next=4;break}return e.next=3,this.updateLocalCanvas();case 3:this.dirty=!1;case 4:r=this.close?1.6:.8,n=960*r,a=this.pX-n/2,i=(this.close?-100:-26)+this.pY,t.drawImage({image:this.localRenderer,x:a,y:i,w:n,h:n,flip:this.flip,shadow:this.selected?{blur:20,color:"red"}:void 0,opacity:this.opacity});case 9:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"hitTest",value:function(e,t){var r=this.close?1.6:.8,n=960*r,a=(e-this.pX+n/2)/r,i=(t-(this.close?-100:0)-this.pY)/r;if(this.flip&&(a=960-a),!this.hitDetectionFallback)try{var s=this.localRenderer.getDataAt(a,i);return 0!==s[3]}catch(o){if(!(o instanceof DOMException&&o.message.includes("cross-origin")))throw o;this.hitDetectionFallback=!0}return!(i<50||i>680)&&Math.abs(a-480)<150}},{key:"headl",value:function(){this.currentHeads&&(--this.posePositions.head,this.posePositions.head<0&&(--this.posePositions.headType,this.posePositions.headType<0&&(this.posePositions.headType=this.pose.compatibleHeads.length-1),this.posePositions.head=this.currentHeads.all.length-1),this.dirty=!0,this.invalidator())}},{key:"headr",value:function(){this.currentHeads&&(++this.posePositions.head,this.posePositions.head>=this.currentHeads.all.length&&(++this.posePositions.headType,this.posePositions.headType>=this.pose.compatibleHeads.length&&(this.posePositions.headType=0),this.posePositions.head=0),this.dirty=!0,this.invalidator())}},{key:"partl",value:function(e){if("head"===e)return this.headl();this.pose[e]&&(--this.posePositions[e],this.posePositions[e]<0&&(this.posePositions[e]=this.pose[e].length-1),this.dirty=!0,this.invalidator())}},{key:"partr",value:function(e){if("head"===e)return this.headr();this.pose[e]&&(++this.posePositions[e],this.posePositions[e]>=this.pose[e].length&&(this.posePositions[e]=0),this.dirty=!0,this.invalidator())}},{key:"posel",value:function(){var e=this.pose.compatibleHeads[this.posePositions.headType];--this.poseId,this.poseId<0&&(this.poseId=this.data.poses.length-1);var t=this.pose.compatibleHeads.indexOf(e);t>=0?this.posePositions.headType=t:(this.posePositions.headType=0,this.posePositions.head=0),this.posePositions.left=0,this.posePositions.right=0,this.posePositions.variant=0,this.dirty=!0,this.invalidator()}},{key:"poser",value:function(){var e=this.pose.compatibleHeads[this.posePositions.headType];++this.poseId,this.poseId>=this.data.poses.length&&(this.poseId=0);var t=this.pose.compatibleHeads.indexOf(e);t>=0?this.posePositions.headType=t:(this.posePositions.headType=0,this.posePositions.head=0),this.posePositions.left=0,this.posePositions.right=0,this.posePositions.variant=0,this.dirty=!0,this.invalidator()}},{key:"closestCharacterSlot",value:function(e){var t=je.map(function(t,r){return{pos:Math.abs(e-t),idx:r}}).sort(function(e,t){return e.pos-t.pos});return t[0].idx}},{key:"label",get:function(){return this.data.name}},{key:"data",get:function(){return oe[this.name]}},{key:"pose",get:function(){return this.data.poses[this.poseId]}},{key:"currentHeads",get:function(){if(!this.pose.compatibleHeads||0===this.pose.compatibleHeads.length)return null;var e=this.data.heads[this.pose.compatibleHeads[this.posePositions.headType]];return e instanceof Array?{all:e}:e}},{key:"allowFreeMove",get:function(){return this.freeMove},set:function(e){e?this.freeMove=!0:(this.freeMove=!1,this.pos=this.closestCharacterSlot(this.pX),this.pY=0)}},{key:"x",get:function(){return this.pX},set:function(e){this.allowFreeMove?this.pX=e:this.pos=this.closestCharacterSlot(e)}},{key:"y",get:function(){return this.pY},set:function(e){this.allowFreeMove?this.pY=e:this.pY=0}},{key:"pos",get:function(){return this.pPos},set:function(e){this.allowFreeMove||(e<0&&(e=0),e>=je.length&&(e=je.length-1),this.pPos=e,this.pX=je[e])}}]),e}(),Te=function(e){function t(){var e;return Object(c["a"])(this,t),e=Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.isWebPSupported=null,e}return Object(h["a"])(t,e),Object(l["a"])(t,[{key:"created",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ce();case 2:this.isWebPSupported=e.sent;case 3:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"captialize",value:function(e){return e.charAt(0).toUpperCase()+e.substring(1)}},{key:"positionNames",get:function(){return Oe}},{key:"parts",get:function(){return this.character.getParts()}},{key:"hasMultiplePoses",get:function(){return this.character.data.poses.length>1}}]),t}(f["c"]);p["a"]([Object(f["b"])({required:!0,type:Boolean})],Te.prototype,"vertical",void 0),p["a"]([Object(f["b"])({type:Le,required:!0})],Te.prototype,"character",void 0),Te=p["a"]([Object(f["a"])({components:{Toggle:L}})],Te);var Ae=Te,He=Ae,Me=(r("66a6"),Object(_["a"])(He,_e,ke,!1,null,"7aa1806e",null)),De=Me.exports,qe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:{panel:!0,vertical:e.vertical}},[r("h1",[e._v("Custom Sprite")]),r("fieldset",[r("legend",[e._v("Position/Size:")]),r("label",{attrs:{for:"sprite_x"}},[e._v("X:")]),r("input",{directives:[{name:"model",rawName:"v-model.number",value:e.sprite.x,expression:"sprite.x",modifiers:{number:!0}}],attrs:{id:"sprite_x",type:"number"},domProps:{value:e.sprite.x},on:{input:[function(t){t.target.composing||e.$set(e.sprite,"x",e._n(t.target.value))},function(t){return e.$emit("invalidate-render")}],keydown:function(e){e.stopPropagation()},blur:function(t){return e.$forceUpdate()}}}),r("br"),r("label",{attrs:{for:"sprite_y"}},[e._v("Y:")]),r("input",{directives:[{name:"model",rawName:"v-model.number",value:e.sprite.y,expression:"sprite.y",modifiers:{number:!0}}],attrs:{id:"sprite_y",type:"number"},domProps:{value:e.sprite.y},on:{input:[function(t){t.target.composing||e.$set(e.sprite,"y",e._n(t.target.value))},function(t){return e.$emit("invalidate-render")}],keydown:function(e){e.stopPropagation()},blur:function(t){return e.$forceUpdate()}}}),r("br"),r("label",{attrs:{for:"sprite_w"}},[e._v("Width:")]),r("input",{directives:[{name:"model",rawName:"v-model.number",value:e.sprite.width,expression:"sprite.width",modifiers:{number:!0}}],attrs:{id:"sprite_w",type:"number"},domProps:{value:e.sprite.width},on:{input:[function(t){t.target.composing||e.$set(e.sprite,"width",e._n(t.target.value))},function(t){return e.$emit("invalidate-render")}],keydown:function(e){e.stopPropagation()},blur:function(t){return e.$forceUpdate()}}}),r("br"),r("label",{attrs:{for:"sprite_h"}},[e._v("Height:")]),r("input",{directives:[{name:"model",rawName:"v-model.number",value:e.sprite.height,expression:"sprite.height",modifiers:{number:!0}}],attrs:{id:"sprite_h",type:"number"},domProps:{value:e.sprite.height},on:{input:[function(t){t.target.composing||e.$set(e.sprite,"height",e._n(t.target.value))},function(t){return e.$emit("invalidate-render")}],keydown:function(e){e.stopPropagation()},blur:function(t){return e.$forceUpdate()}}})]),r("fieldset",{attrs:{id:"layerfs"}},[r("legend",[e._v("Layer:")]),r("button",{attrs:{title:"Move to back"},on:{click:function(t){return e.$emit("shiftLayer",{object:e.sprite,move:"Back"})}}},[e._v("⤓")]),r("button",{attrs:{title:"Move backwards"},on:{click:function(t){return e.$emit("shiftLayer",{object:e.sprite,move:"Backward"})}}},[e._v("↓")]),r("button",{attrs:{title:"Move forwards"},on:{click:function(t){return e.$emit("shiftLayer",{object:e.sprite,move:"Forward"})}}},[e._v("↑")]),r("button",{attrs:{title:"Move to front"},on:{click:function(t){return e.$emit("shiftLayer",{object:e.sprite,move:"Front"})}}},[e._v("⤒")])]),r("div",[r("label",{attrs:{for:"characterOpacity"}},[e._v("Opacity:")]),r("input",{directives:[{name:"model",rawName:"v-model.number",value:e.sprite.opacity,expression:"sprite.opacity",modifiers:{number:!0}}],attrs:{type:"number",max:"100",min:"0",id:"characterOpacity"},domProps:{value:e.sprite.opacity},on:{input:[function(t){t.target.composing||e.$set(e.sprite,"opacity",e._n(t.target.value))},function(t){return e.$emit("invalidate-render")}],keydown:function(e){e.stopPropagation()},blur:function(t){return e.$forceUpdate()}}})]),r("toggle",{attrs:{label:"In front of textbox?"},on:{input:function(t){return e.$emit("invalidate-render")}},model:{value:e.sprite.infront,callback:function(t){e.$set(e.sprite,"infront",t)},expression:"sprite.infront"}}),r("toggle",{attrs:{label:"Flip?"},on:{input:function(t){return e.$emit("invalidate-render")}},model:{value:e.sprite.flip,callback:function(t){e.$set(e.sprite,"flip",t)},expression:"sprite.flip"}}),r("button",{on:{click:function(t){e.$emit("shiftLayer",{object:e.sprite,move:"Delete"}),e.$emit("close")}}},[e._v("Delete")])],1)},Ie=[],Be=function(){function e(t,r){var n=this;Object(c["a"])(this,e),this.assetName=t,this.invalidator=r,this.infront=!1,this.x=0,this.y=0,this.width=0,this.height=0,this.flip=!1,this.opacity=100,this.asset=null,this.selected=!1,de(t).then(function(e){e instanceof ie||(n.asset=e,n.width=e.width,n.height=e.height,n.invalidator())}).catch(function(e){console.error("Failed to load asset: ".concat(e))})}return Object(l["a"])(e,[{key:"select",value:function(){this.selected=!0}},{key:"unselect",value:function(){this.selected=!1}},{key:"render",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.asset){e.next=2;break}return e.abrupt("return");case 2:t.drawImage({image:this.asset,x:this.x,y:this.y,w:this.width,h:this.height,shadow:this.selected?{blur:20,color:"red"}:void 0,flip:this.flip,opacity:this.opacity});case 3:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"hitTest",value:function(e,t){var r=e-this.x,n=t-this.y;return r>=0&&r<=this.width&&n>=0&&n<=this.height}}]),e}(),Ee=function(e){function t(){return Object(c["a"])(this,t),Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments))}return Object(h["a"])(t,e),t}(f["c"]);p["a"]([Object(f["b"])({required:!0,type:Boolean})],Ee.prototype,"vertical",void 0),p["a"]([Object(f["b"])({type:Be,required:!0})],Ee.prototype,"sprite",void 0),Ee=p["a"]([Object(f["a"])({components:{Toggle:L}})],Ee);var Fe=Ee,Ye=Fe,Ne=(r("39ff"),Object(_["a"])(Ye,qe,Ie,!1,null,"4c829f7c",null)),Ue=Ne.exports,Xe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:{panel:!0,vertical:e.vertical}},[r("h1",[e._v("Credits")]),r("p",[e._v("All assets used are IP of Team Salvato and created by them, unless noted otherwise.")]),e._m(0),e._m(1),e._m(2),e._m(3),e._m(4),r("p",[e._v("Classic Amy Sprite by Meddy-sin")]),r("p",[e._v("Amy Sprite by Meddy-sin and SlightlySimple")]),r("p",[e._v("Special thanks to SlightlySimple for testing and technical help")])])},We=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",[e._v("\n\t\tDoki Doki Dialog Generator developed by EDave64\n\t\t"),r("br"),e._v("Based on gemdude46's DDLC Shitpost generator\n\t")])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",[e._v("\n\t\tMC Classic Sprite by Childish-N\n\t\t"),r("br"),e._v("MC Classic Chibi by GyleToTheRescue\n\t")])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",[e._v("\n\t\tMC Sprite by Childish-N\n\t\t"),r("br"),e._v("MC Chibi by SlightlySimple\n\t")])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",[e._v("\n\t\tMC Chad Sprite by Cylent-Nite\n\t\t"),r("br"),e._v("MC Chad Poses and expressions by SlightlySimple\n\t\t"),r("br"),e._v("MC Chad Poses and chibi by Meddy-sin\n\t")])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",[e._v("\n\t\tFeMC Sprite by Meddy-sin\n\t\t"),r("br"),e._v("FeMC Casual Sprite by SlightlySimple\n\t")])}],ze=function(e){function t(){return Object(c["a"])(this,t),Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments))}return Object(h["a"])(t,e),t}(f["c"]);p["a"]([Object(f["b"])({required:!0,type:Boolean})],ze.prototype,"vertical",void 0),ze=p["a"]([Object(f["a"])({components:{}})],ze);var Ge=ze,Ke=Ge,Je=Object(_["a"])(Ke,Xe,We,!1,null,"58fed492",null),Ve=Je.exports,Qe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:{panel:!0,vertical:e.vertical}},[r("h1",[e._v("Background")]),r("background-settings",{attrs:{value:e.value},on:{"invalidate-render":function(t){return e.$emit("invalidate-render")}}}),e._l(e.backgrounds,function(t){return r("background-button",{key:t.name,attrs:{background:t,value:e.value,customPathLookup:e.customPathLookup},on:{input:function(r){return e.$emit("input",t)}}})}),r("div",{staticClass:"btn upload-background",on:{click:function(t){return e.$refs.upload.click()}}},[e._v("\n\t\tUpload\n\t\t"),r("input",{ref:"upload",attrs:{type:"file"},on:{change:e.onFileUpload}})])],2)},Ze=[],et=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:{background:!0,active:e.background===e.value},style:e.style,attrs:{title:e.background.name},on:{click:function(t){return e.$emit("input",e.background)}}},[e._v(e._s(e.background.name))])},tt=[],rt=function(e){function t(){var e;return Object(c["a"])(this,t),e=Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.isWebPSupported=null,e}return Object(h["a"])(t,e),Object(l["a"])(t,[{key:"created",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ce();case 2:this.isWebPSupported=e.sent;case 3:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"style",get:function(){return this.background===F?{backgroundColor:F.color}:this.background instanceof E?this.background.custom?{backgroundImage:"url(".concat(this.customPathLookup[this.background.path],")")}:void 0===this.isWebPSupported?{}:{backgroundImage:"url(".concat("/Doki-Doki-Dialog-Generator/beta/","/assets/").concat(this.background.path,".lq.").concat(this.isWebPSupported?"webp":"png",")").replace(/\/+/,"/")}:this.background instanceof Z?void 0===this.isWebPSupported?{}:{backgroundImage:"url(".concat("/Doki-Doki-Dialog-Generator/beta/","/assets/").concat(this.background.path,".lq.").concat(this.isWebPSupported?"webp":"png",")").replace(/\/+/,"/")}:{}}}]),t}(f["c"]);p["a"]([Object(f["b"])({required:!0})],rt.prototype,"background",void 0),p["a"]([Object(f["b"])({required:!0})],rt.prototype,"value",void 0),p["a"]([Object(f["b"])({required:!0})],rt.prototype,"customPathLookup",void 0),rt=p["a"]([Object(f["a"])({components:{}})],rt);var nt=rt,at=nt,it=(r("f222"),Object(_["a"])(at,et,tt,!1,null,"0d824e70",null)),st=it.exports,ot=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.value===e.colorBackground?r("fieldset",[r("legend",[e._v("Settings:")]),r("label",{attrs:{for:"bg_color"}},[e._v("Color:")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.value.color,expression:"value.color"}],attrs:{id:"bg_color",type:"color"},domProps:{value:e.value.color},on:{input:[function(t){t.target.composing||e.$set(e.value,"color",t.target.value)},function(t){return e.$emit("invalidate-render")}]}})]):r("fieldset",[r("legend",[e._v("Settings:")]),r("table",[r("tr",[r("td",{attrs:{colspan:"3"}},[r("toggle",{attrs:{label:"Flipped?"},on:{input:function(t){return e.$emit("invalidate-render")}},model:{value:e.value.flip,callback:function(t){e.$set(e.value,"flip",t)},expression:"value.flip"}})],1)]),e.isVariant?r("tr",[r("td",[r("button",{on:{click:function(t){--e.value.variant,e.$emit("invalidate-render")}}},[e._v("<")])]),r("td",[e._v("Variant")]),r("td",[r("button",{on:{click:function(t){++e.value.variant,e.$emit("invalidate-render")}}},[e._v(">")])])]):e._e()])])},ct=[],lt=function(e){function t(){return Object(c["a"])(this,t),Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments))}return Object(h["a"])(t,e),Object(l["a"])(t,[{key:"isVariant",get:function(){return this.value instanceof Z}},{key:"colorBackground",get:function(){return F}}]),t}(f["c"]);p["a"]([Object(f["b"])({required:!0})],lt.prototype,"value",void 0),lt=p["a"]([Object(f["a"])({components:{Toggle:L}})],lt);var ut=lt,dt=ut,ht=(r("8735"),Object(_["a"])(dt,ot,ct,!1,null,"7dd5b727",null)),pt=ht.exports,ft=function(e){function t(){var e;return Object(c["a"])(this,t),e=Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.customPathLookup={},e.customBGCount=0,e}return Object(h["a"])(t,e),Object(l["a"])(t,[{key:"onFileUpload",value:function(e){var t=this,r=this.$refs.upload;if(r.files){var n=!0,a=!1,i=void 0;try{for(var s,o=function(){var e=s.value;(function(r){var n="customBg"+r,a=pe(n,e);fe.push(new E(n,e.name,!0)),t.$set(t.customPathLookup,n,a)})(++t.customBGCount)},c=r.files[Symbol.iterator]();!(n=(s=c.next()).done);n=!0)o()}catch(l){a=!0,i=l}finally{try{n||null==c.return||c.return()}finally{if(a)throw i}}}}},{key:"backgrounds",get:function(){return this.customBGCount,fe}}]),t}(f["c"]);p["a"]([Object(f["b"])({required:!0,type:Boolean})],ft.prototype,"vertical",void 0),p["a"]([Object(f["b"])({required:!0})],ft.prototype,"value",void 0),ft=p["a"]([Object(f["a"])({components:{BackgroundButton:st,BackgroundSettings:pt}})],ft);var gt=ft,bt=gt,vt=(r("baa9"),Object(_["a"])(bt,Qe,Ze,!1,null,"3d63bba4",null)),mt=vt.exports,yt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"messageConsole"},[e.showLoading?r("p",[e._v("Loading...")]):e._e(),e._l(e.messages,function(t,n){return r("p",{key:t+"_"+n},[e._v(e._s(t))])})],2)},_t=[],kt=function(e){function t(){var e;return Object(c["a"])(this,t),e=Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.showLoading=!1,e.showLoadingTimeout=0,e.hideLoadingTimeout=0,e.messages=[],e}return Object(h["a"])(t,e),Object(l["a"])(t,[{key:"created",value:function(){var e=this;this.onLoadingChange(this.loading),te.subscribe(re,function(t){e.messages.push("Failed to load asset '".concat(t.path,"'")),setTimeout(function(){e.messages.pop()},5e3)})}},{key:"onLoadingChange",value:function(e){var t=this;console.log("onLoadingChange",e),e?(this.hideLoadingTimeout&&(clearTimeout(this.hideLoadingTimeout),this.hideLoadingTimeout=0),this.showLoading||this.showLoadingTimeout||(console.log("setting show Timeout"),this.showLoadingTimeout=setTimeout(function(){t.showLoading=!0,console.log("showingLoading"),t.showLoadingTimeout=0},100))):(this.showLoadingTimeout&&(clearTimeout(this.showLoadingTimeout),this.showLoadingTimeout=0),this.showLoading&&!this.hideLoadingTimeout&&(console.log("setting hide Timeout"),this.hideLoadingTimeout=setTimeout(function(){t.showLoading=!1,console.log("hideLoading"),t.hideLoadingTimeout=0},100)))}}]),t}(f["c"]);p["a"]([Object(f["b"])({required:!0,type:Boolean})],kt.prototype,"loading",void 0),p["a"]([Object(f["d"])("loading")],kt.prototype,"onLoadingChange",null),kt=p["a"]([Object(f["a"])({components:{}})],kt);var wt=kt,xt=wt,Ot=(r("cd7b"),Object(_["a"])(xt,yt,_t,!1,null,"e301bda2",null)),jt=Ot.exports,Ct=function(){function e(){Object(c["a"])(this,e),this.display=!0,this.corrupted=!1,this.showControls=!0,this.allowSkipping=!0,this.showContinueArrow=!0,this.talking="",this.customName="",this.dialog=""}return Object(l["a"])(e,[{key:"render",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.display){e.next=2;break}return e.abrupt("return");case 2:if(!this.corrupted){e.next=11;break}return e.t0=t,e.next=6,de("textbox_monika");case 6:e.t1=e.sent,e.t2={image:e.t1,x:190,y:565},e.t0.drawImage.call(e.t0,e.t2),e.next=17;break;case 11:return e.t3=t,e.next=14,de("textbox");case 14:e.t4=e.sent,e.t5={image:e.t4,x:232,y:565},e.t3.drawImage.call(e.t3,e.t5);case 17:if(r=this.talking,!r){e.next=27;break}return e.t6=t,e.next=22,de("namebox");case 22:e.t7=e.sent,e.t8=526,e.t9={image:e.t7,x:264,y:e.t8},e.t6.drawImage.call(e.t6,e.t9),t.drawText("other"===r?this.customName:r,348,555,"center",3,"white","#b59","24px riffic");case 27:if(this.renderText(t),this.showControls&&(t.drawText("Skip",566,700,"left",1,this.allowSkipping?"#522":"#a66",null,"13px aller"),t.drawText("History",512,700,"left",1,"#522",null,"13px aller"),t.drawText("Auto   Save   Load   Settings",600,700,"left",1,"#522",null,"13px aller")),!this.showContinueArrow){e.next=36;break}return e.t10=t,e.next=33,de("next");case 33:e.t11=e.sent,e.t12={image:e.t11,x:1020,y:685},e.t10.drawImage.call(e.t10,e.t12);case 36:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"renderText",value:function(e){var t=[],r=!1,n=!0,a=!1,i=void 0;try{for(var s,o=this.dialog.split("\n")[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var c=s.value,l=void 0;t.push(l=[]);var u=!0,d=!1,h=void 0;try{for(var p,f=c[Symbol.iterator]();!(u=(p=f.next()).done);u=!0){var g=p.value;"["===g?r=!0:"]"===g?r=!1:l.push({l:g,b:r})}}catch(j){d=!0,h=j}finally{try{u||null==f.return||f.return()}finally{if(d)throw h}}}}catch(j){a=!0,i=j}finally{try{n||null==o.return||o.return()}finally{if(a)throw i}}for(var b=620,v=0,m=t;v<m.length;v++){var y=m[v],_=!1;if(y.length){var k=270,w=0;while(w<y.length){var x="",O=y[w].b;_=_||O;while(w<y.length&&y[w].b===O)x+=y[w].l,O&&(x+=" "),w++;e.drawText(x,k,b,"left",O?8:2,"#fff",O?"#000":"#523140","24px aller"),k+=e.measureText(x).width}}b+=26}}}]),e}(),Pt=function(e){function t(){var e;return Object(c["a"])(this,t),e=Object(u["a"])(this,Object(d["a"])(t).apply(this,arguments)),e.canvasWidth=0,e.canvasHeight=0,e.currentBackground=null,e.characters=[],e.selectedCharacter=null,e.selectedSprite=null,e.characterSelectorOpen=!1,e.backgroundSelectorOpen=!1,e.editDialog=!1,e.vertical=!1,e.textbox=new Ct,e.renderer=new $e,e.showUI=!0,e.loaded=!1,e.uiSize=192,e.lqRendering=!0,e.currentlyRendering=!1,e.panel="",e.queuedRender=null,e.prevRender="",e.showingLast=!1,e.dropSpriteCount=0,e.dropPreventClick=!1,e.draggedObject=null,e.dragXOffset=0,e.dragYOffset=0,e.dragXOriginal=0,e.dragYOriginal=0,e}return Object(h["a"])(t,e),Object(l["a"])(t,[{key:"onSelectedCharacterChange",value:function(e,t){t&&t.unselect(),e&&(e.select(),this.panel="character"),this.invalidateRender()}},{key:"onSelectedSpriteChange",value:function(e,t){t&&t.unselect(),e&&(e.select(),this.panel="sprite"),this.invalidateRender()}},{key:"onPanel",value:function(e){"character"!==e&&(this.selectedCharacter=null)}},{key:"invalidateRender",value:function(){var e=this;this.queuedRender||(this.queuedRender=requestAnimationFrame(function(){return e.render_()}))}},{key:"render_",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.queuedRender&&(cancelAnimationFrame(this.queuedRender),this.queuedRender=null),e.next=3,this.renderer.render(this.renderCallback,!this.lqRendering);case 3:t=e.sent,t&&this.display();case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderCallback",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var r,n,a,i,s,o,c,l,u,d,h,p;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.currentlyRendering=!0,e.prev=1,this.loaded){e.next=6;break}t.drawText("Starting...",this.renderer.width/2,this.renderer.height/2,"center",5,"white","#b59","32px riffic"),e.next=72;break;case 6:if(!t.preview){e.next=13;break}return e.t0=t,e.next=10,de("backgrounds/transparent");case 10:e.t1=e.sent,e.t2={x:0,y:0,image:e.t1},e.t0.drawImage.call(e.t0,e.t2);case 13:if(!this.currentBackground){e.next=16;break}return e.next=16,this.currentBackground.render(t);case 16:r=!0,n=!1,a=void 0,e.prev=19,i=this.characters[Symbol.iterator]();case 21:if(r=(s=i.next()).done){e.next=29;break}if(o=s.value,o.infront){e.next=26;break}return e.next=26,o.render(t);case 26:r=!0,e.next=21;break;case 29:e.next=35;break;case 31:e.prev=31,e.t3=e["catch"](19),n=!0,a=e.t3;case 35:e.prev=35,e.prev=36,r||null==i.return||i.return();case 38:if(e.prev=38,!n){e.next=41;break}throw a;case 41:return e.finish(38);case 42:return e.finish(35);case 43:return e.next=45,this.textbox.render(t);case 45:c=!0,l=!1,u=void 0,e.prev=48,d=this.characters[Symbol.iterator]();case 50:if(c=(h=d.next()).done){e.next=58;break}if(p=h.value,!p.infront){e.next=55;break}return e.next=55,p.render(t);case 55:c=!0,e.next=50;break;case 58:e.next=64;break;case 60:e.prev=60,e.t4=e["catch"](48),l=!0,u=e.t4;case 64:e.prev=64,e.prev=65,c||null==d.return||d.return();case 67:if(e.prev=67,!l){e.next=70;break}throw u;case 70:return e.finish(67);case 71:return e.finish(64);case 72:return e.prev=72,this.currentlyRendering=!1,e.finish(72);case 75:case"end":return e.stop()}},e,this,[[1,,72,75],[19,31,35,43],[36,,38,42],[48,60,64,72],[65,,67,71]])}));function t(t){return e.apply(this,arguments)}return t}()},{key:"created",value:function(){window.cats=this,window.removeEventListener("keydown",this.onKeydown),window.addEventListener("keydown",this.onKeydown)}},{key:"destroyed",value:function(){window.removeEventListener("keydown",this.onKeydown)}},{key:"mounted",value:function(){var e=this,t=this.$refs.sd;this.sdCtx=t.getContext("2d")||void 0,this.updateArea(),window.addEventListener("resize",this.updateArea),window.addEventListener("keypress",function(t){27===t.keyCode&&(e.selectedCharacter=null,e.panel="")}),this.currentBackground=fe[0],this.invalidateRender(),Promise.all([de(this.currentBackground.path,!1),de("textbox"),de("namebox"),de("next"),de("backgrounds/transparent")]).then(function(){e.loaded=!0,e.invalidateRender()}).catch(function(){alert("Error while loading. Sorry :/")})}},{key:"optimum",value:function(e,t){var r=e/(16/9),n=t*(16/9);return r>t?r=t:n=e,[n,r]}},{key:"optimizeWithMenu",value:function(e,t){var r=this.optimum(e,t-this.uiSize),n=this.optimum(e-this.uiSize,t);return r[0]*r[1]>n[0]*n[1]?[r[0],r[1],!1]:[n[0],n[1],!0]}},{key:"updateArea",value:function(){var e=this,t=this.optimizeWithMenu(window.innerWidth,window.innerHeight),r=Object(s["a"])(t,3),n=r[0],a=r[1],i=r[2];this.canvasWidth=n,this.canvasHeight=a,this.vertical=i,this.$nextTick(function(){e.display()})}},{key:"display",value:function(){this.sdCtx&&(this.showingLast=!1,this.renderer.paintOnto(this.sdCtx,0,0,1280,720))}},{key:"download",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.selectedCharacter=null,e.next=3,this.renderer.download(this.renderCallback,"panel.png");case 3:this.prevRender=e.sent;case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"showPreviousRender",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,r=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.showingLast){e.next=3;break}return this.display(),e.abrupt("return");case 3:this.showingLast=!0,t=new Image,t.onload=function(){r.sdCtx.drawImage(t,0,0,1280,720)},t.src=this.prevRender;case 7:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"onCharacterCreate",value:function(e){this.characterSelectorOpen=!1,this.characters.push(new Le(e,this.invalidateRender)),this.invalidateRender()}},{key:"toRendererCoordinate",value:function(e,t){var r=this.$refs.sd,n=e-r.offsetLeft,a=t-r.offsetTop,i=n/r.offsetWidth*r.width,s=a/r.offsetWidth*r.width;return[i,s]}},{key:"onUiClick",value:function(e){if(this.dropPreventClick)this.dropPreventClick=!1;else{this.panel="";var t,r=this.toRendererCoordinate(e.clientX,e.clientY),n=Object(s["a"])(r,2),a=n[0],i=n[1],o=this.objectsAt(a,i),c=o.indexOf(this.selectedCharacter||this.selectedSprite);if(t=0===c?null:-1!==c?o[c-1]:o[o.length-1]||null,t)if(t instanceof Be)this.selectedCharacter=null,this.selectedSprite=t;else{if(!(t instanceof Le))throw new Error("Unknown selected object");this.selectedSprite=null,this.selectedCharacter=t}else this.selectedCharacter=null,this.selectedSprite=null}}},{key:"objectsAt",value:function(e,t){return this.characters.filter(function(r){return r.hitTest(e,t)})}},{key:"onObjectLayerShift",value:function(e){var t=this.characters.indexOf(e.object),r=t;switch(this.characters.splice(t,1),e.move){case"Forward":r+=1;break;case"Backward":r-=1;break;case"Back":r=0;break;case"Front":r=this.characters.length;break;case"Delete":return this.panel="",void this.invalidateRender()}r<=0?this.characters.unshift(e.object):r>=this.characters.length?this.characters.push(e.object):this.characters.splice(r,0,e.object),this.invalidateRender()}},{key:"onAssetCreate",value:function(e){this.characters.push(new Be(e,this.invalidateRender))}},{key:"onDragStart",value:function(e){e.preventDefault();var t=this.selectedCharacter||this.selectedSprite;if(t){this.draggedObject=t;var r=this.toRendererCoordinate(e.clientX,e.clientY),n=Object(s["a"])(r,2),a=n[0],i=n[1];this.dragXOffset=a-t.x,this.dragYOffset=i-t.y,this.dragXOriginal=t.x,this.dragYOriginal=t.y}}},{key:"onTouchStart",value:function(e){var t=this.selectedCharacter||this.selectedSprite;if(t){this.draggedObject=t;var r=this.toRendererCoordinate(e.touches[0].clientX,e.touches[0].clientY),n=Object(s["a"])(r,2),a=n[0],i=n[1];this.dragXOffset=a-t.x,this.dragYOffset=i-t.y,this.dragXOriginal=t.x,this.dragYOriginal=t.y}}},{key:"onDragOver",value:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}},{key:"onSpriteDragMove",value:function(e){if(this.draggedObject){e.preventDefault();var t=e instanceof MouseEvent?this.toRendererCoordinate(e.clientX,e.clientY):this.toRendererCoordinate(e.touches[0].clientX,e.touches[0].clientY),r=Object(s["a"])(t,2),n=r[0],a=r[1];n-=this.dragXOffset,a-=this.dragYOffset;var i=Math.abs(n-this.dragXOriginal),o=Math.abs(a-this.dragYOriginal);if(i+o>1&&(this.dropPreventClick=!0),e.shiftKey){var c=Math.abs(n-this.dragXOriginal),l=Math.abs(a-this.dragYOriginal);c>l?a=this.dragYOriginal:n=this.dragXOriginal}this.draggedObject.x=n,this.draggedObject.y=a,this.invalidateRender()}}},{key:"onDrop",value:function(e){if(e.stopPropagation(),e.preventDefault(),e.dataTransfer){var t=!0,r=!1,n=void 0;try{for(var a,i=e.dataTransfer.items[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var s=a.value;if("file"===s.kind&&s.type.match(/image.*/)){var o="dropCustomAsset"+ ++this.dropSpriteCount;pe(o,s.getAsFile());this.onAssetCreate(o)}}}catch(c){r=!0,n=c}finally{try{t||null==i.return||i.return()}finally{if(r)throw n}}}}},{key:"onSpriteDrop",value:function(e){this.draggedObject&&("TouchEvent"in window&&e instanceof TouchEvent&&(this.dropPreventClick=!1),this.draggedObject=null)}},{key:"onMouseEnter",value:function(e){1!==e.buttons&&(this.draggedObject=null)}},{key:"onKeydown",value:function(e){var t=this.selectedCharacter||this.selectedSprite;t&&"Delete"===e.key?this.onObjectLayerShift({object:t,move:"Delete"}):t&&"ArrowLeft"===e.key?(t instanceof Le&&!t.allowFreeMove?t.pos-=1:(t.x-=e.shiftKey?1:20,t.x|=0),this.invalidateRender()):t&&"ArrowRight"===e.key?(t instanceof Le&&!t.allowFreeMove?t.pos+=1:(t.x+=e.shiftKey?1:20,t.x|=0),this.invalidateRender()):t&&"ArrowUp"===e.key?(t.y-=e.shiftKey?1:20,t.y|=0,this.invalidateRender()):t&&"ArrowDown"===e.key?(t.y+=e.shiftKey?1:20,t.y|=0,this.invalidateRender()):console.log(e)}}]),t}(f["c"]);p["a"]([Object(f["d"])("selectedCharacter")],Pt.prototype,"onSelectedCharacterChange",null),p["a"]([Object(f["d"])("selectedSprite")],Pt.prototype,"onSelectedSpriteChange",null),p["a"]([Object(f["d"])("panel")],Pt.prototype,"onPanel",null),p["a"]([Object(f["d"])("textbox",{deep:!0}),Object(f["d"])("lqRendering"),Object(f["d"])("currentBackground")],Pt.prototype,"invalidateRender",null),Pt=p["a"]([Object(f["a"])({components:{DokiButton:w,GeneralPanel:D,AddPanel:ye,BackgroundsPanel:mt,CreditsPanel:Ve,CharacterPanel:De,SpritePanel:Ue,MessageConsole:jt}})],Pt);var St=Pt,Rt=St,$t=(r("5c0b"),Object(_["a"])(Rt,a,i,!1,null,null,null)),Lt=$t.exports;n["a"].config.productionTip=!1,new n["a"]({render:function(e){return e(Lt)}}).$mount("#app")},cd7b:function(e,t,r){"use strict";var n=r("180b"),a=r.n(n);a.a},d0ca:function(e){e.exports={id:"ddlc.fan.mc1",name:"MC (Classic)",internalId:"classic_mc",folder:"classic_mc",heads:{straight:["a","b","c","d","e","f","g","h","i","j"]},poses:[{compatibleHeads:["straight"],static:"1"}]}},e2da:function(e,t,r){"use strict";var n=r("4857"),a=r.n(n);a.a},ea5a:function(e,t,r){},ea81:function(e,t,r){},f222:function(e,t,r){"use strict";var n=r("ea5a"),a=r.n(n);a.a},f649:function(e,t,r){},f721:function(e){e.exports={id:"ddlc.fan.femc",internalId:"femc",name:"FeMC",heads:{straight:{folder:"femc",all:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","glitch1","glitch2","_1","_2","_3","_4","_5","_6","_7","_8","_9","_10","_10alt","_11","_12","_13","_14"]},straight_lh:{folder:"femc_lh",all:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","glitch1","glitch2","_1","_2","_3","_4","_5","_6","_7","_8","_9","_10","_10alt","_11","_12","_13","_14"]}},poses:[{compatibleHeads:["straight"],folder:"femc",left:["1l","2l","4l","5l"],right:["1r","4r"]},{compatibleHeads:["straight"],folder:"femc",static:"3"},{compatibleHeads:["straight"],folder:"femc",left:["1bl","2bl","4bl","5bl"],right:["1br","4br"]},{compatibleHeads:["straight"],folder:"femc",static:"3b"},{compatibleHeads:["straight"],folder:"femc",left:["1cl","2cl","4cl","5cl"],right:["1cr","4cr"]},{compatibleHeads:["straight"],folder:"femc",static:"3c"},{compatibleHeads:["straight_lh"],folder:"femc_lh",left:["1l","2l","4l","5l"],right:["1r","4r"]},{compatibleHeads:["straight_lh"],folder:"femc_lh",static:"3"},{compatibleHeads:["straight_lh"],folder:"femc_lh",left:["1bl","2bl","4bl","5bl"],right:["1br","4br"]},{compatibleHeads:["straight_lh"],folder:"femc_lh",static:"3b"},{compatibleHeads:["straight_lh"],folder:"femc_lh",left:["1cl","2cl","4cl","5cl"],right:["1cr","4cr"]},{compatibleHeads:["straight_lh"],folder:"femc_lh",static:"3c"}]}},fdec:function(e){e.exports={id:"ddlc.fan.mc2",name:"MC",internalId:"mc",folder:"mc",heads:{straight:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","error","error1","shock"],straight_red:{folder:"red",all:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","error","error1","shock"]}},poses:[{compatibleHeads:["straight"],left:["1l","2l"],right:["1r","2r"]},{compatibleHeads:["straight"],static:"3"},{compatibleHeads:["straight_red"],left:["1l","2l"],right:["1r","2r"]},{compatibleHeads:["straight_red"],static:"3"}]}}});
//# sourceMappingURL=app.f625149f.js.map