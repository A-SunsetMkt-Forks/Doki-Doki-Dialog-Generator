{"version":3,"sources":["webpack:///./node_modules/core-js/internals/same-value.js","webpack:///./src/components/repo/PackDisplay.vue?11fe","webpack:///./src/components/repo/layouts/SingleBox.vue?7f0d","webpack:///./src/components/repo/SearchBar.vue?87d1","webpack:///./node_modules/core-js/modules/es.string.search.js","webpack:///./src/components/repo/List.vue?5aa2","webpack:///./src/components/repo/PackDisplay.vue?6f45","webpack:///./src/components/repo/layouts/SingleBox.vue","webpack:///./src/components/repo/SearchBar.vue","webpack:///./src/components/repo/SearchBar.vue?2b2a","webpack:///./src/components/repo/SearchBar.vue?e003","webpack:///./src/components/repo/List.vue","webpack:///./node_modules/@edave64/dddg-repo-filters/dist/parse.js","webpack:///./node_modules/@edave64/dddg-repo-filters/dist/optimize.js","webpack:///./node_modules/@edave64/dddg-repo-filters/dist/compile.js","webpack:///./node_modules/@edave64/dddg-repo-filters/dist/main.js","webpack:///./src/components/repo/types.ts","webpack:///./src/components/repo/List.vue?a629","webpack:///./src/components/repo/List.vue?a951","webpack:///./src/components/repo/PackDisplay.vue","webpack:///./src/components/toolbox/tools/character-pack-sanitizer.ts","webpack:///./src/components/repo/PackDisplay.vue?333e","webpack:///./src/components/repo/PackDisplay.vue?e5d2","webpack:///./src/components/repo/layouts/SingleBox.vue?1778","webpack:///./src/components/repo/layouts/SingleBox.vue?f036"],"names":["module","exports","Object","is","x","y","fixRegExpWellKnownSymbolLogic","anObject","requireObjectCoercible","sameValue","regExpExec","SEARCH","nativeSearch","maybeCallNative","regexp","O","this","searcher","undefined","call","RegExp","String","res","done","value","rx","S","previousLastIndex","lastIndex","result","index","class","keydownHandler","selected","ref","search","disabled","focusListHandler","$emit","authors","packs","packsArgmented","onSelect","$refs","searchBar","focus","show-back","leavePackDisplay","message","onUpdate","$event","dontCloseHelp","showHelp","debounce","props","type","Boolean","default","modelValue","data","debounceTimeout","lastSend","methods","input","documentClickHandler","event","key","preventDefault","stopPropagation","updateInternalValue","clearTimeout","setTimeout","doUpdate","div","document","createElement","innerHTML","innerText","mounted","body","addEventListener","unmounted","removeEventListener","watch","render","__scopeId","header","idx","tabindex","sortBy","headerKeydownListener","sort","desc","name","tag","updateFocusedItem","list","pack","id","focusedItem","characters","join","kind","translatePackState","state","availablePrefixes","prefixLookup","Map","prefix","i","length","short","slice","set","spaceMatcher","parseSearchwords","str","matchers","word","quote","escape","finishWord","push","payload","toLowerCase","char","lowerWord","has","get","test","matchCost","optimize","sortByCost","deduplicateMatchers","a","b","splitByType","matcher","keys","quickDeprefix","localeCompare","filter","ary","startsWith","find","collision","collIdx","indexOf","specializedTypes","Array","from","typeKey","competingMatcher","values","flatMap","EngineMatcher","replace","matchingProps","Set","searchText","engines","add","matchingProp","map","searchTerm","prop","AuthorMatcher","peopleRepository","matchingAuthors","authorKey","prototype","hasOwnProperty","author","size","CharacterMatcher","_peopleRepository","packRepository","matchingCharacters","getUniqueCharacters","character","repo","unique","uniqueCharacters","TypeMatcher","matchingTypes","types","PackMatcher","triplets","getTriplets","substr","isImpossible","searchWords","tripletCache","splitTriplets","cache","AllMatcher","allMatchers","compiler","match","CompilerMatch","compile","parsed","optimized","compiled","every","PackStates","pageKeyMoveBy","required","wordCache","computed","filtered","filterList","sortFunc","oldSort","listById","tbody","$el","findIndex","console","log","source","newIdx","max","headerId","$nextTick","element","querySelector","containerHeight","offsetHeight","scrollTop","scrollBottom","itemTop","offsetTop","itemBottom","by","Unknown","Installed","Active","exhaust","style","backgroundImage","showBack","disclaimer","sanitize","href","target","rel","addable","installable","removable","remove","uninstallable","activatable","deactivatable","authorId","authorName","authorsLinks","link","title","platform","src","icon","height","width","description","allowedTags","allowedAttributes","img","schemaLimitedAttributes","allowedSchemas","enforceAttributes","html","retDoc","doc","childNodes","node","sanitizeElement","sanitizedNode","appendChild","protocolMatcher","nodeType","Node","ELEMENT_NODE","el","tagName","includes","newEl","attrs","attributes","allowedAttrs","attr","protocolMatch","setAttribute","getAttribute","enforce","attrName","children","childNode","subNodes","subNode","ret","createTextNode","concat","linkablePlatforms","require","preview","environment","isAutoLoadingSupported","isLocalRepoSupported","isAdded","toFocus","currentName","toUpperCase","credits","$store","dispatch","dddg2Path","dddg1Path","repoUrl","components","SearchBar","List","PackDisplay","localPacks","loadedPacks","content","contentPacks","repoPacks","repoLookup","loadedLookup","packId","localLookup","installedRet","repoPack","isLoaded","isInstalled","inLocalRepo","notInstalledPacks","setSearch","fetchJSON","path","fetch","req","json","moveFocus","dialog","created","localPacksPromise","localRepositoryUrl","Promise","all"],"mappings":"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","file":"js/chunk-7799a822.958c71d2.js","sourcesContent":["// `SameValue` abstract operation\n// https://tc39.github.io/ecma262/#sec-samevalue\nmodule.exports = Object.is || function is(x, y) {\n  // eslint-disable-next-line no-self-compare\n  return x === y ? x !== 0 || 1 / x === 1 / y : x != x && y != y;\n};\n","export { default } from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./PackDisplay.vue?vue&type=style&index=0&lang=scss\"; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./PackDisplay.vue?vue&type=style&index=0&lang=scss\"","export { default } from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./SingleBox.vue?vue&type=style&index=0&id=0683c134&lang=scss&scoped=true\"; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./SingleBox.vue?vue&type=style&index=0&id=0683c134&lang=scss&scoped=true\"","export { default } from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./SearchBar.vue?vue&type=style&index=0&id=62a986c7&scoped=true&lang=scss\"; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./SearchBar.vue?vue&type=style&index=0&id=62a986c7&scoped=true&lang=scss\"","'use strict';\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar anObject = require('../internals/an-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar sameValue = require('../internals/same-value');\nvar regExpExec = require('../internals/regexp-exec-abstract');\n\n// @@search logic\nfixRegExpWellKnownSymbolLogic('search', 1, function (SEARCH, nativeSearch, maybeCallNative) {\n  return [\n    // `String.prototype.search` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.search\n    function search(regexp) {\n      var O = requireObjectCoercible(this);\n      var searcher = regexp == undefined ? undefined : regexp[SEARCH];\n      return searcher !== undefined ? searcher.call(regexp, O) : new RegExp(regexp)[SEARCH](String(O));\n    },\n    // `RegExp.prototype[@@search]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@search\n    function (regexp) {\n      var res = maybeCallNative(nativeSearch, regexp, this);\n      if (res.done) return res.value;\n\n      var rx = anObject(regexp);\n      var S = String(this);\n\n      var previousLastIndex = rx.lastIndex;\n      if (!sameValue(previousLastIndex, 0)) rx.lastIndex = 0;\n      var result = regExpExec(rx, S);\n      if (!sameValue(rx.lastIndex, previousLastIndex)) rx.lastIndex = previousLastIndex;\n      return result === null ? -1 : result.index;\n    }\n  ];\n});\n","export { default } from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./List.vue?vue&type=style&index=0&id=7185b170&scoped=true&lang=scss\"; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./List.vue?vue&type=style&index=0&id=7185b170&scoped=true&lang=scss\"","export { default } from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./PackDisplay.vue?vue&type=style&index=1&id=41199fc8&scoped=true&lang=scss\"; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./PackDisplay.vue?vue&type=style&index=1&id=41199fc8&scoped=true&lang=scss\"","<template>\n\t<div class=\"pages\" @keydown=\"keydownHandler\">\n\t\t<div class=\"page fly-left\" :class=\"{ blured: selected }\" v-if=\"!selected\">\n\t\t\t<search-bar\n\t\t\t\tclass=\"search-bar\"\n\t\t\t\tref=\"searchBar\"\n\t\t\t\tv-model=\"search\"\n\t\t\t\t:disabled=\"!!selected\"\n\t\t\t\t@focus-list=\"focusListHandler\"\n\t\t\t\t@leave=\"$emit('leave')\"\n\t\t\t/>\n\t\t\t<list\n\t\t\t\tclass=\"list\"\n\t\t\t\tref=\"list\"\n\t\t\t\t:search=\"search\"\n\t\t\t\t:authors=\"authors\"\n\t\t\t\t:packs=\"packsArgmented\"\n\t\t\t\t:disabled=\"!!selected\"\n\t\t\t\t@selected=\"onSelect\"\n\t\t\t\t@select-search-bar=\"$refs.searchBar.focus()\"\n\t\t\t/>\n\t\t</div>\n\t\t<div class=\"page fly-right\" v-if=\"selected\">\n\t\t\t<pack-display\n\t\t\t\tref=\"dialog\"\n\t\t\t\tclass=\"pack-display\"\n\t\t\t\t:authors=\"authors\"\n\t\t\t\t:packs=\"packsArgmented\"\n\t\t\t\t:selected=\"selected\"\n\t\t\t\tshow-back\n\t\t\t\t@leave=\"leavePackDisplay\"\n\t\t\t/>\n\t\t</div>\n\t</div>\n</template>\n\n<script lang=\"ts\">\n/* tslint:disable:no-bitwise */\nimport { IAuthors } from '@edave64/dddg-repo-filters/dist/authors';\nimport { IPack } from '@edave64/dddg-repo-filters/dist/pack';\nimport SearchBar from '../SearchBar.vue';\nimport List from '../List.vue';\nimport { SelectedEvent, IPackWithState, PackStates } from '../types';\nimport PackDisplay from '../PackDisplay.vue';\nimport environment from '@/environments/environment';\nimport { defineComponent } from 'vue';\n\nconst repoUrl = 'https://edave64.github.io/Doki-Doki-Dialog-Generator-Packs/';\n\nexport default defineComponent({\n\tcomponents: {\n\t\tSearchBar,\n\t\tList,\n\t\tPackDisplay,\n\t},\n\tdata: () => ({\n\t\tsearch: '',\n\t\tauthors: {} as IAuthors,\n\t\tpacks: [] as IPack[],\n\t\tlocalPacks: [] as IPack[],\n\t\tselected: null as string | null,\n\t}),\n\tcomputed: {\n\t\tpacksArgmented(): IPackWithState[] {\n\t\t\tconst loadedPacks = this.$store.state.content.contentPacks;\n\t\t\tconst repoPacks = this.packs;\n\n\t\t\tconst repoLookup = new Map(repoPacks.map(pack => [pack.id, pack]));\n\t\t\tconst loadedLookup = new Map(\n\t\t\t\tloadedPacks.map(pack => [pack.packId, pack])\n\t\t\t);\n\t\t\tconst localLookup = new Map(this.localPacks.map(pack => [pack.id, pack]));\n\n\t\t\tconst installedRet: IPackWithState[] = loadedPacks.map(pack => {\n\t\t\t\tconst repoPack = repoLookup.get(pack.packId!);\n\t\t\t\tconst isLoaded = loadedLookup.has(pack.packId!)\n\t\t\t\t\t? PackStates.Active\n\t\t\t\t\t: PackStates.Unknown;\n\t\t\t\tconst isInstalled = localLookup.has(pack.packId!)\n\t\t\t\t\t? PackStates.Installed\n\t\t\t\t\t: PackStates.Unknown;\n\t\t\t\tconst state: PackStates = isLoaded | isInstalled;\n\n\t\t\t\tif (repoPack) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...repoPack,\n\t\t\t\t\t\tstate,\n\t\t\t\t\t} as IPackWithState;\n\t\t\t\t} else {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tstate,\n\t\t\t\t\t\tid: pack.packId,\n\t\t\t\t\t\tcharacters: [],\n\t\t\t\t\t\tname: pack.packId,\n\t\t\t\t\t\tinLocalRepo: false,\n\t\t\t\t\t\tpreview: [],\n\t\t\t\t\t\tkind: [],\n\t\t\t\t\t\tdescription: '',\n\t\t\t\t\t\tdddg1Path: '',\n\t\t\t\t\t\tdddg2Path: '',\n\t\t\t\t\t\tsearchWords: [],\n\t\t\t\t\t\tauthors: [],\n\t\t\t\t\t} as IPackWithState;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst notInstalledPacks = repoPacks\n\t\t\t\t.filter(pack => !loadedLookup.has(pack.id))\n\t\t\t\t.map(pack => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...pack,\n\t\t\t\t\t\tstate: PackStates.Unknown,\n\t\t\t\t\t} as IPackWithState;\n\t\t\t\t});\n\n\t\t\treturn [\n\t\t\t\t...installedRet.filter(ret => !ret.id.startsWith('dddg.buildin.')),\n\t\t\t\t...notInstalledPacks,\n\t\t\t];\n\t\t},\n\t},\n\tmethods: {\n\t\tfocus(): void {},\n\t\tsetSearch(str: string): void {\n\t\t\tthis.selected = null;\n\t\t\tthis.search = str;\n\t\t},\n\t\tasync fetchJSON<A>(path: string): Promise<A> {\n\t\t\tconst req = await fetch(path);\n\t\t\treturn await req.json();\n\t\t},\n\t\tleavePackDisplay(moveFocus: boolean) {\n\t\t\tthis.selected = null;\n\t\t\tif (moveFocus) {\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t(this.$refs.searchBar as any).focus();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tkeydownHandler(event: KeyboardEvent) {\n\t\t\tif (event.key === 'Escape') {\n\t\t\t\tthis.selected = '';\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t(this.$refs.searchBar as any).focus();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tonSelect({ id, source }: SelectedEvent) {\n\t\t\tthis.selected = id;\n\t\t\tif (source === 'keyboard') {\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tconst dialog = this.$refs.dialog as any;\n\t\t\t\t\tdialog.focus();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tfocusListHandler() {\n\t\t\t(this.$refs.list as any).focus();\n\t\t},\n\t},\n\tasync created() {\n\t\tlet localPacksPromise: Promise<IPack[]> | [] = [];\n\n\t\tif (environment.isLocalRepoSupported) {\n\t\t\tlocalPacksPromise = this.fetchJSON(environment.localRepositoryUrl);\n\t\t}\n\n\t\t[this.packs, this.authors, this.localPacks] = await Promise.all([\n\t\t\tthis.fetchJSON<IPack[]>(repoUrl + 'repo.json'),\n\t\t\tthis.fetchJSON<IAuthors>(repoUrl + 'people.json'),\n\t\t\tlocalPacksPromise,\n\t\t]);\n\t},\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.list {\n\tz-index: 0;\n}\n\n.search-bar {\n\tz-index: 1;\n}\n\n.pages,\n.page {\n\theight: 100%;\n\twidth: 100%;\n}\n\n.fly-right.fly-enter {\n\ttransform: translate(0, 0);\n}\n\n.fly-right.fly-enter-active {\n\ttransition: transform 1s;\n\ttransform: translate(-100%, 0);\n}\n\n.fly-right.fly-leave {\n\ttransform: translate(0, 0);\n}\n\n.fly-right.fly-leave-active {\n\ttransition: transform 20s;\n\ttransform: translate(-100%, 0);\n}\n\n.fly-left.fly-enter {\n\ttransform: translate(0, 0);\n}\n\n.fly-left.fly-enter-active {\n\ttransition: transform 1s;\n\ttransform: translate(100%, 0);\n}\n\n.fly-left.fly-leave {\n\ttransform: translate(0, 0);\n}\n\n.fly-left.fly-leave-active {\n\ttransition: transform 20s;\n\ttransform: translate(100%, 0);\n}\n</style>\n","<template>\n\t<div class=\"search-area\">\n\t\t<div class=\"search-bar\">\n\t\t\t<input\n\t\t\t\tclass=\"input\"\n\t\t\t\tref=\"input\"\n\t\t\t\tv-model=\"message\"\n\t\t\t\t:disabled=\"disabled\"\n\t\t\t\t@input=\"onUpdate\"\n\t\t\t\t@click=\"$event.dontCloseHelp = true\"\n\t\t\t\t@keydown=\"keydownHandler\"\n\t\t\t/>\n\t\t\t<button\n\t\t\t\t:class=\"{ help: true, toggled: showHelp }\"\n\t\t\t\t:disabled=\"disabled\"\n\t\t\t\t@click.stop=\"\n\t\t\t\t\tshowHelp = !showHelp;\n\t\t\t\t\t$event.dontCloseHelp = true;\n\t\t\t\t\"\n\t\t\t>\n\t\t\t\t<i class=\"material-icons\">info</i>\n\t\t\t</button>\n\t\t\t<button class=\"exit-button\" @click=\"$emit('leave', true)\">\n\t\t\t\t<i class=\"material-icons\">clear</i>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class=\"info-area\" v-if=\"showHelp\" @click=\"$event.dontCloseHelp = true\">\n\t\t\t<p>Enter the text you want to search for. E.g. <code>Monika</code></p>\n\t\t\t<p>\n\t\t\t\tIf multiple words are given, each word must be found. E.g.\n\t\t\t\t<code>Monika Pose</code>\n\t\t\t</p>\n\t\t\t<p>\n\t\t\t\tTo search phrases with spaces, surround them with double quotes. E.g.\n\t\t\t\t<code>\"Monika R63\" Pose</code>\n\t\t\t</p>\n\t\t\t<p>\n\t\t\t\tTo limit your search to specific attributes of a pack, you can use the\n\t\t\t\tfollowing prefixes:\n\t\t\t</p>\n\t\t\t<table>\n\t\t\t\t<tr>\n\t\t\t\t\t<th>Prefix</th>\n\t\t\t\t\t<th>Description</th>\n\t\t\t\t\t<th>Example</th>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>Character:</td>\n\t\t\t\t\t<td></td>\n\t\t\t\t\t<td><code>Character: Monika</code></td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>Artist:</td>\n\t\t\t\t\t<td></td>\n\t\t\t\t\t<td><code>Artist: edave64</code></td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>Type:</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<code>Backgrounds</code>, <code>Sprites</code>,\n\t\t\t\t\t\t<code>Expressions</code>, <code>Styles</code>, <code>Poses</code> or\n\t\t\t\t\t\t<code>Characters</code>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td><code>Type: Poses</code></td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>Engine:</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<code>Doki Doki Dialog Generator</code>, <code>DDDG</code> or\n\t\t\t\t\t\t<code>Doki Doki Comic Club</code>, <code>DDCC</code>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td><code>Engine: DDCC</code></td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>Pack:</td>\n\t\t\t\t\t<td>The pack itself must contain the text</td>\n\t\t\t\t\t<td><code>Pack: Angry</code></td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\n\t\t\t<p>\n\t\t\t\tPrefixes can be shorted, so <code>Character: Monika</code> can be\n\t\t\t\tshortend to <code>C: Monika</code>\n\t\t\t</p>\n\t\t</div>\n\t</div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue';\n\nconst debounce = 250;\n\nexport default defineComponent({\n\tprops: {\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tmodelValue: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tdata: () => ({\n\t\tshowHelp: false,\n\t\tmessage: '',\n\t\tdebounceTimeout: null as number | null,\n\t\tlastSend: '',\n\t}),\n\tmethods: {\n\t\tfocus() {\n\t\t\t(this.$refs.input as HTMLElement).focus();\n\t\t},\n\t\tdocumentClickHandler(event: MouseEvent & { dontCloseHelp?: boolean }) {\n\t\t\tif (event.dontCloseHelp) return;\n\t\t\tthis.showHelp = false;\n\t\t},\n\t\tkeydownHandler(event: KeyboardEvent) {\n\t\t\tif (event.key === 'ArrowDown') {\n\t\t\t\tthis.$emit('focus-list');\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t},\n\t\tupdateInternalValue() {\n\t\t\tif (this.lastSend === this.modelValue) {\n\t\t\t\tthis.lastSend = '';\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.message = this.modelValue;\n\t\t},\n\t\tonUpdate() {\n\t\t\tif (this.debounceTimeout) clearTimeout(this.debounceTimeout);\n\t\t\tthis.debounceTimeout = setTimeout(this.doUpdate, debounce);\n\t\t},\n\t\tdoUpdate() {\n\t\t\tif (this.debounceTimeout) clearTimeout(this.debounceTimeout);\n\t\t\tthis.debounceTimeout = null;\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.innerHTML = this.message;\n\t\t\tthis.lastSend = div.innerText;\n\t\t\tthis.$emit('update:modelValue', div.innerText);\n\t\t},\n\t},\n\tmounted() {\n\t\tdocument.body.addEventListener('click', this.documentClickHandler);\n\t\tthis.updateInternalValue();\n\t},\n\tunmounted() {\n\t\tdocument.body.removeEventListener('click', this.documentClickHandler);\n\t},\n\twatch: {\n\t\tmodelValue() {\n\t\t\tthis.updateInternalValue();\n\t\t},\n\t},\n});\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped lang=\"scss\">\nh3 {\n\tmargin: 40px 0 0;\n}\nul {\n\tlist-style-type: none;\n\tpadding: 0;\n}\nli {\n\tdisplay: inline-block;\n\tmargin: 0 10px;\n}\na {\n\tcolor: #42b983;\n}\n\n.exit-button {\n\theight: 42px;\n\twidth: 40px;\n\tborder-left: none;\n\tbackground-position: center center;\n\tbackground-repeat: no-repeat;\n\tbackground-size: contain;\n}\n\n.search-bar {\n\tmargin: 4px;\n\twidth: calc(100% - 8px);\n\tdisplay: flex;\n}\n\n.info-area {\n\tposition: absolute;\n\ttop: 48px;\n\tleft: 8px;\n\tright: 8px;\n\tz-index: 2;\n\tborder: 2px solid #ffbde1;\n\tbackground: #fff;\n\tmax-height: calc(100vh - 56px);\n\toverflow: auto;\n\tbox-shadow: 0px 2px 4px 4px rgba(255, 189, 225, 1);\n\n\tcode {\n\t\tpadding: 2px;\n\t\tbackground: #ffe6f4;\n\t\tfont-family: monospace;\n\t\twhite-space: nowrap;\n\t}\n}\n\n.help {\n\theight: 42px;\n\twidth: 40px;\n\tborder: 2px solid #ffbde1;\n\tborder-left: 0;\n\n\t&.toggled {\n\t\tbackground-color: #ffbde1;\n\t}\n}\n\n.input {\n\tdisplay: block;\n\twidth: calc(100% - 40px);\n\tborder: 2px solid #ffbde1;\n\tpadding: 8px;\n\theight: 42px;\n\toverflow: hidden;\n\twhite-space: nowrap;\n\tbackground: #ffe6f4 url(./search.svg);\n\tbackground-repeat: no-repeat;\n\tbackground-size: contain;\n\tbackground-position: right center;\n\tpadding-right: 64px;\n}\n\n.suggestions {\n\tborder: 2px black solid;\n\tborder-top: 0;\n\tbackground: white;\n\n\t.suggestion {\n\t\tborder: 0;\n\t\tline-height: 24px;\n\t\tpadding: 4px;\n\t}\n\t.suggestion {\n\t\tborder: 0;\n\t\tline-height: 24px;\n\t\tpadding: 4px;\n\t\tborder-radius: 4px;\n\n\t\t.primary {\n\t\t\tfont-weight: bolder;\n\t\t}\n\n\t\t.secondary {\n\t\t\tcolor: #222;\n\t\t}\n\n\t\t&.active {\n\t\t\tbackground: cyan;\n\t\t}\n\n\t\t&:hover {\n\t\t\tbackground: lightcyan;\n\t\t}\n\t}\n}\n</style>\n","\nimport { defineComponent } from 'vue';\n\nconst debounce = 250;\n\nexport default defineComponent({\n\tprops: {\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tmodelValue: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tdata: () => ({\n\t\tshowHelp: false,\n\t\tmessage: '',\n\t\tdebounceTimeout: null as number | null,\n\t\tlastSend: '',\n\t}),\n\tmethods: {\n\t\tfocus() {\n\t\t\t(this.$refs.input as HTMLElement).focus();\n\t\t},\n\t\tdocumentClickHandler(event: MouseEvent & { dontCloseHelp?: boolean }) {\n\t\t\tif (event.dontCloseHelp) return;\n\t\t\tthis.showHelp = false;\n\t\t},\n\t\tkeydownHandler(event: KeyboardEvent) {\n\t\t\tif (event.key === 'ArrowDown') {\n\t\t\t\tthis.$emit('focus-list');\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t},\n\t\tupdateInternalValue() {\n\t\t\tif (this.lastSend === this.modelValue) {\n\t\t\t\tthis.lastSend = '';\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.message = this.modelValue;\n\t\t},\n\t\tonUpdate() {\n\t\t\tif (this.debounceTimeout) clearTimeout(this.debounceTimeout);\n\t\t\tthis.debounceTimeout = setTimeout(this.doUpdate, debounce);\n\t\t},\n\t\tdoUpdate() {\n\t\t\tif (this.debounceTimeout) clearTimeout(this.debounceTimeout);\n\t\t\tthis.debounceTimeout = null;\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.innerHTML = this.message;\n\t\t\tthis.lastSend = div.innerText;\n\t\t\tthis.$emit('update:modelValue', div.innerText);\n\t\t},\n\t},\n\tmounted() {\n\t\tdocument.body.addEventListener('click', this.documentClickHandler);\n\t\tthis.updateInternalValue();\n\t},\n\tunmounted() {\n\t\tdocument.body.removeEventListener('click', this.documentClickHandler);\n\t},\n\twatch: {\n\t\tmodelValue() {\n\t\t\tthis.updateInternalValue();\n\t\t},\n\t},\n});\n","import { render } from \"./SearchBar.vue?vue&type=template&id=62a986c7&scoped=true&bindings={}\"\nimport script from \"./SearchBar.vue?vue&type=script&lang=ts\"\nexport * from \"./SearchBar.vue?vue&type=script&lang=ts\"\n\nimport \"./SearchBar.vue?vue&type=style&index=0&id=62a986c7&scoped=true&lang=scss\"\nscript.render = render\nscript.__scopeId = \"data-v-62a986c7\"\n\nexport default script","<template>\n\t<div class=\"list\">\n\t\t<table>\n\t\t\t<thead>\n\t\t\t\t<tr ref=\"header\">\n\t\t\t\t\t<th\n\t\t\t\t\t\tv-for=\"(header, idx) of [\n\t\t\t\t\t\t\t['name', 'Pack'],\n\t\t\t\t\t\t\t['characters', 'Character'],\n\t\t\t\t\t\t\t['kind', 'Type'],\n\t\t\t\t\t\t\t['authors', 'Authors'],\n\t\t\t\t\t\t\t['state', 'Status'],\n\t\t\t\t\t\t]\"\n\t\t\t\t\t\t:key=\"idx\"\n\t\t\t\t\t\t:tabindex=\"disabled ? -1 : 0\"\n\t\t\t\t\t\t@click=\"sortBy(header[0])\"\n\t\t\t\t\t\t@keydown=\"headerKeydownListener($event, header[0])\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<div>{{ header[1] }}</div>\n\t\t\t\t\t\t\t<div v-if=\"sort === header[0]\">{{ desc ? '▼' : '▲' }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</th>\n\t\t\t\t</tr>\n\t\t\t</thead>\n\t\t\t<transition-group\n\t\t\t\tname=\"tbody-group\"\n\t\t\t\ttag=\"tbody\"\n\t\t\t\tref=\"tbody\"\n\t\t\t\t:tabindex=\"disabled ? -1 : 0\"\n\t\t\t\t@keydown=\"keydownHandler\"\n\t\t\t\t@focus=\"updateFocusedItem\"\n\t\t\t>\n\t\t\t\t<tr\n\t\t\t\t\tv-for=\"pack of list\"\n\t\t\t\t\t:key=\"pack.id\"\n\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t'tbody-group-item': true,\n\t\t\t\t\t\tfocused: focusedItem === pack.id,\n\t\t\t\t\t}\"\n\t\t\t\t\t@mousedown=\"focusedItem = pack.id\"\n\t\t\t\t\t@click=\"$emit('selected', { id: pack.id, source: 'pointer' })\"\n\t\t\t\t>\n\t\t\t\t\t<td>{{ pack.name }}</td>\n\t\t\t\t\t<td>{{ pack.characters.join(', ') }}</td>\n\t\t\t\t\t<td>{{ pack.kind.join(', ') }}</td>\n\t\t\t\t\t<td>{{ pack.authors.join(', ') }}</td>\n\t\t\t\t\t<td>{{ translatePackState(pack.state) }}</td>\n\t\t\t\t</tr>\n\t\t\t</transition-group>\n\t\t</table>\n\t</div>\n</template>\n\n<script lang=\"ts\">\nimport { IPack } from '@edave64/dddg-repo-filters/dist/pack';\nimport { IAuthors } from '@edave64/dddg-repo-filters/dist/authors';\nimport run from '@edave64/dddg-repo-filters/dist/main';\nimport { PackStates, IPackWithState } from './types';\nimport { exhaust } from '@/util/exhaust';\nimport { defineComponent, PropType } from 'vue';\n\nconst pageKeyMoveBy = 10;\n\nexport default defineComponent({\n\tprops: {\n\t\tsearch: { type: String, required: true },\n\t\tauthors: { type: Object as PropType<IAuthors>, required: true },\n\t\tpacks: { type: Object as PropType<IPackWithState[]>, required: true },\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata: () => ({\n\t\tsort: '' as keyof IPack | '',\n\t\tdesc: false,\n\t\tfocusedItem: '',\n\t\twordCache: {} as { [id: string]: Set<string> },\n\t}),\n\tcomputed: {\n\t\tlist(): IPackWithState[] {\n\t\t\tconst filtered = this.filterList(this.packs, this.search);\n\t\t\tif (this.sort && filtered.length > 0) {\n\t\t\t\tconst sort = this.sort as keyof IPack;\n\t\t\t\tlet sortFunc: ((a: IPack, b: IPack) => number) | undefined;\n\t\t\t\tif (typeof filtered[0][sort] === 'string') {\n\t\t\t\t\tsortFunc = (a, b) => a.name.localeCompare(b.name);\n\t\t\t\t} else if (filtered[0][sort] instanceof Array) {\n\t\t\t\t\tsortFunc = (a, b) =>\n\t\t\t\t\t\t(a as any)[sort]\n\t\t\t\t\t\t\t.join(', ')\n\t\t\t\t\t\t\t.localeCompare((b as any)[sort].join(', '));\n\t\t\t\t}\n\t\t\t\tif (sortFunc) {\n\t\t\t\t\tif (this.desc) {\n\t\t\t\t\t\tconst oldSort = sortFunc;\n\t\t\t\t\t\tsortFunc = (b, a) => oldSort(a, b);\n\t\t\t\t\t}\n\t\t\t\t\tfiltered.sort(sortFunc);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn filtered;\n\t\t},\n\t\tlistById(): Map<string, IPack> {\n\t\t\treturn new Map(this.packs.map(pack => [pack.id, pack]));\n\t\t},\n\t\tuniqueCharacters(): string[] {\n\t\t\treturn Array.from(\n\t\t\t\tnew Set(\n\t\t\t\t\tthis.packs.flatMap(pack =>\n\t\t\t\t\t\tpack.characters.map(char => char.toLowerCase())\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t);\n\t\t},\n\t},\n\tmethods: {\n\t\tfocus(): void {\n\t\t\t((this.$refs.tbody as any).$el as HTMLElement).focus();\n\t\t},\n\t\tkeydownHandler(event: KeyboardEvent) {\n\t\t\tconst indexOf = this.list.findIndex(pack => pack.id === this.focusedItem);\n\t\t\tconsole.log(indexOf);\n\t\t\tswitch (event.key) {\n\t\t\t\tcase 'Enter':\n\t\t\t\t\tthis.$emit('selected', { id: this.focusedItem, source: 'keyboard' });\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ArrowUp':\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tif (indexOf === 0) {\n\t\t\t\t\t\tthis.$emit('select-search-bar');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.focusedItem = this.list[indexOf - 1].id;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ArrowDown':\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tif (indexOf < this.list.length - 1) {\n\t\t\t\t\t\tthis.focusedItem = this.list[indexOf + 1].id;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'PageUp': {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tlet newIdx = indexOf - pageKeyMoveBy;\n\t\t\t\t\tif (newIdx < 0) {\n\t\t\t\t\t\tnewIdx = 0;\n\t\t\t\t\t}\n\t\t\t\t\tthis.focusedItem = this.list[newIdx].id;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase 'PageDown': {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tlet newIdx = indexOf + pageKeyMoveBy;\n\t\t\t\t\tconst max = this.list.length - 1;\n\t\t\t\t\tif (newIdx > max) {\n\t\t\t\t\t\tnewIdx = max;\n\t\t\t\t\t}\n\t\t\t\t\tthis.focusedItem = this.list[newIdx].id;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\theaderKeydownListener(event: KeyboardEvent, headerId: keyof IPack) {\n\t\t\tswitch (event.key) {\n\t\t\t\tcase 'Enter':\n\t\t\t\tcase ' ':\n\t\t\t\t\tthis.sortBy(headerId);\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ArrowDown':\n\t\t\t\t\tthis.focus();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ArrowUp':\n\t\t\t\t\tthis.$emit('select-search-bar');\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\t\tupdateFocusedItem() {\n\t\t\tif (this.list.length === 0) {\n\t\t\t\tthis.focusedItem = '';\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this.focusedItem === '') {\n\t\t\t\tthis.focusedItem = this.list[0].id;\n\t\t\t}\n\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tconst header = this.$refs.header as HTMLElement;\n\t\t\t\tconst element = document.querySelector(\n\t\t\t\t\t'.list tbody .focused'\n\t\t\t\t) as HTMLDivElement;\n\n\t\t\t\tconst containerHeight =\n\t\t\t\t\t(this.$el as HTMLElement).offsetHeight - header.offsetHeight;\n\t\t\t\tconst scrollTop = this.$el.scrollTop;\n\t\t\t\tconst scrollBottom = scrollTop + containerHeight;\n\n\t\t\t\tif (element) {\n\t\t\t\t\tconst itemTop = element.offsetTop - header.offsetHeight;\n\t\t\t\t\tconst itemBottom = itemTop + element.offsetHeight;\n\n\t\t\t\t\tif (itemBottom > scrollBottom) {\n\t\t\t\t\t\tthis.$el.scrollTop = itemBottom - containerHeight;\n\t\t\t\t\t} else if (itemTop < scrollTop) {\n\t\t\t\t\t\tthis.$el.scrollTop = itemTop;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tsortBy(by: keyof IPack) {\n\t\t\tif (this.sort === by) {\n\t\t\t\tif (!this.desc) {\n\t\t\t\t\tthis.desc = true;\n\t\t\t\t} else {\n\t\t\t\t\tthis.sort = '';\n\t\t\t\t\tthis.desc = false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.sort = by;\n\t\t\t\tthis.desc = false;\n\t\t\t}\n\t\t},\n\t\tfilterList(list: IPackWithState[], search: string): IPackWithState[] {\n\t\t\tif (!search) return [...list];\n\t\t\treturn run(search, this.authors, list) as IPackWithState[];\n\t\t},\n\t\ttranslatePackState(state: PackStates) {\n\t\t\tswitch (state) {\n\t\t\t\tcase PackStates.Unknown:\n\t\t\t\t\treturn 'Not added';\n\t\t\t\tcase PackStates.Installed:\n\t\t\t\t\treturn 'Installed';\n\t\t\t\tcase PackStates.Active:\n\t\t\t\t\treturn 'Active';\n\t\t\t\tdefault:\n\t\t\t\t\texhaust(state);\n\t\t\t}\n\t\t},\n\t},\n\twatch: {\n\t\tfocusedItem() {\n\t\t\tthis.updateFocusedItem();\n\t\t},\n\t},\n});\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped lang=\"scss\">\n.list {\n\twidth: 100%;\n\theight: calc(100% - 64px);\n\toverflow: auto;\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.tbody-group-item {\n\topacity: 1;\n\ttransition: all 0.15s;\n}\n.tbody-group-enter, .list-leave-to /* .list-leave-active below version 2.1.8 */ {\n\topacity: 0;\n}\n\n.spacer {\n\tflex-grow: 1;\n}\ntable {\n\ttext-align: left;\n\tborder-collapse: collapse;\n\tmin-width: 100%;\n\tuser-select: none;\n\t.focused {\n\t\tbackground: #ffe6f4;\n\t}\n}\ntbody:focus {\n\toutline: 0;\n\t.focused {\n\t\tbackground: #ffbde1;\n\t}\n}\ntr:hover,\nth:hover {\n\tbackground: #ffe6f4;\n\tcursor: pointer;\n}\nth,\ntd {\n\tpadding: 0.25rem;\n\tmin-height: 42px;\n}\nth {\n\tbackground: white;\n\tposition: sticky;\n\ttop: 0;\n\tbox-shadow: 0 2px 2px -1px rgba(0, 0, 0, 1);\n\n\t> div {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t}\n}\nfooter {\n\tpadding-top: 8px;\n\tcolor: #444;\n}\n</style>\n","const availablePrefixes = ['author', 'character', 'type', 'pack', 'engine'];\nconst prefixLookup = new Map();\nfor (const prefix of availablePrefixes) {\n    for (let i = 1; i <= prefix.length; ++i) {\n        const short = prefix.slice(0, i);\n        prefixLookup.set(short, prefix);\n    }\n}\nconst spaceMatcher = /\\s/;\nexport default function parseSearchwords(str) {\n    const matchers = [];\n    let word = '';\n    let type = '';\n    let quote = false;\n    let escape = false;\n    function finishWord() {\n        matchers.push({\n            type: type || 'all',\n            payload: word.toLowerCase(),\n        });\n        word = '';\n        type = '';\n        escape = false;\n        quote = false;\n    }\n    for (const char of str) {\n        if (escape) {\n            word += char;\n            escape = false;\n            continue;\n        }\n        switch (char) {\n            case '\\\\':\n                escape = true;\n                continue;\n            case ':':\n                // eslint-disable-next-line no-case-declarations\n                const lowerWord = word.toLowerCase();\n                if (!quote && type === '' && prefixLookup.has(lowerWord)) {\n                    type = prefixLookup.get(lowerWord);\n                    word = '';\n                    continue;\n                }\n                break;\n            case '\"':\n                if (quote) {\n                    finishWord();\n                }\n                else {\n                    quote = true;\n                }\n                continue;\n        }\n        if (!quote && spaceMatcher.test(char)) {\n            if (word) {\n                finishWord();\n            }\n        }\n        else {\n            word += char;\n        }\n    }\n    if (word)\n        finishWord();\n    return matchers;\n}\n","const matchCost = new Map([\n    // static property equals\n    ['engine', 0],\n    // search on pack properties\n    ['pack', 1],\n    // find in array\n    ['type', 2],\n    ['character', 2],\n    ['author', 2],\n    // mayhem\n    ['all', 3],\n]);\nexport default function optimize(matchers) {\n    return sortByCost(deduplicateMatchers(matchers));\n}\nexport function sortByCost(matchers) {\n    return matchers.sort((a, b) => matchCost.get(a.type) - matchCost.get(b.type) ||\n        b.payload.length - a.payload.length);\n}\n/**\n * @private\n */\nexport function deduplicateMatchers(matchers) {\n    const splitByType = new Map();\n    for (const matcher of matchers) {\n        let list = splitByType.get(matcher.type);\n        if (!list) {\n            list = [];\n            splitByType.set(matcher.type, list);\n        }\n        list.push(matcher);\n    }\n    for (const key of splitByType.keys()) {\n        const value = splitByType.get(key);\n        const quickDeprefix = value\n            .sort((a, b) => a.payload.localeCompare(b.payload))\n            .filter((matcher, idx, ary) => {\n            if (!ary[idx + 1])\n                return true;\n            return !ary[idx + 1].payload.startsWith(matcher.payload);\n        });\n        splitByType.set(key, quickDeprefix.filter((matcher, idx, ary) => {\n            return !ary.find((collision, collIdx) => collIdx !== idx && collision.payload.indexOf(matcher.payload) !== -1);\n        }));\n    }\n    const specializedTypes = Array.from(splitByType.keys()).filter(type => type !== 'all');\n    splitByType.set('all', (splitByType.get('all') || []).filter(matcher => {\n        return !specializedTypes.find(typeKey => splitByType\n            .get(typeKey)\n            .find(competingMatcher => competingMatcher.payload.indexOf(matcher.payload) !== -1));\n    }));\n    return [...splitByType.values()].flatMap(x => x);\n}\n","class EngineMatcher {\n    constructor(payload) {\n        payload = payload.replace(/[\\s-]/g, '').toLowerCase();\n        const matchingProps = new Set();\n        for (const [searchText, key] of EngineMatcher.engines) {\n            if (searchText.toLowerCase().indexOf(payload) >= 0) {\n                matchingProps.add(key);\n            }\n        }\n        this.matchingProps = Array.from(matchingProps);\n    }\n    get isImpossible() {\n        return this.matchingProps.length === 0;\n    }\n    match(pack) {\n        for (const matchingProp of this.matchingProps) {\n            if (pack[matchingProp])\n                return true;\n        }\n        return false;\n    }\n}\nEngineMatcher.engines = [\n    ['Doki Doki Dialog Generator 1', 'dddg1Path'],\n    ['Doki Doki Dialouge Generator 1', 'dddg1Path'],\n    ['DDDG1', 'dddg1Path'],\n    ['Doki Doki Dialog Generator 2', 'dddg2Path'],\n    ['Doki Doki Dialouge Generator 2', 'dddg2Path'],\n    ['DDDG2', 'dddg2Path'],\n    ['Doki Doki Comic Club 2', 'ddcc2Path'],\n    ['DDCC2', 'ddcc2Path'],\n].map(([searchTerm, prop]) => [\n    searchTerm.replace(/\\s/g, '').toLowerCase(),\n    prop,\n]);\nclass AuthorMatcher {\n    constructor(payload, peopleRepository) {\n        payload = payload.toLowerCase();\n        const matchingAuthors = new Set();\n        for (const authorKey in peopleRepository) {\n            /* istanbul ignore next */\n            if (!Object.prototype.hasOwnProperty.call(peopleRepository, authorKey))\n                continue;\n            const author = peopleRepository[authorKey];\n            const props = Object.keys(author);\n            if (authorKey.toLowerCase().indexOf(payload) >= 0 ||\n                props.find(prop => author[prop].toLowerCase().indexOf(payload) >= 0)) {\n                matchingAuthors.add(authorKey);\n            }\n        }\n        this.matchingAuthors = matchingAuthors;\n    }\n    get isImpossible() {\n        return this.matchingAuthors.size === 0;\n    }\n    match(pack) {\n        return !!pack.authors.find(author => this.matchingAuthors.has(author));\n    }\n}\nclass CharacterMatcher {\n    constructor(payload, _peopleRepository, packRepository) {\n        payload = payload.toLowerCase();\n        this.matchingCharacters = new Set(CharacterMatcher.getUniqueCharacters(packRepository).filter(char => char.toLowerCase().indexOf(payload) >= 0));\n    }\n    get isImpossible() {\n        return this.matchingCharacters.size === 0;\n    }\n    match(pack) {\n        return !!pack.characters.find(character => this.matchingCharacters.has(character));\n    }\n    static getUniqueCharacters(repo) {\n        let unique = this.uniqueCharacters.get(repo);\n        if (!unique) {\n            unique = Array.from(new Set(repo.flatMap(pack => pack.characters)));\n            this.uniqueCharacters.set(repo, unique);\n        }\n        return unique;\n    }\n}\nCharacterMatcher.uniqueCharacters = new Map();\nclass TypeMatcher {\n    constructor(payload) {\n        payload = payload.toLowerCase();\n        this.matchingTypes = new Set(TypeMatcher.types.filter(type => type.toLowerCase().indexOf(payload) >= 0));\n    }\n    get isImpossible() {\n        return this.matchingTypes.size === 0;\n    }\n    match(pack) {\n        return !!pack.kind.find(character => this.matchingTypes.has(character));\n    }\n}\nTypeMatcher.types = [\n    'Styles',\n    'Characters',\n    'Expressions',\n    'Poses',\n    'Backgrounds',\n    'Sprites',\n    'Misc',\n];\nclass PackMatcher {\n    constructor(payload, _peopleRepository, packRepository) {\n        payload = payload.toLowerCase();\n        this.payload = payload;\n        const triplets = PackMatcher.getTriplets(packRepository);\n        for (let i = 0, length = payload.length - 2; i < length; ++i) {\n            if (!triplets.has(payload.substr(i, 3))) {\n                this.isImpossible = true;\n                return;\n            }\n        }\n        this.isImpossible = false;\n    }\n    match(pack) {\n        if (this.isImpossible)\n            return false;\n        const payload = this.payload;\n        return !!(pack.id.toLowerCase().indexOf(payload) >= 0 ||\n            pack.name.toLowerCase().indexOf(payload) >= 0 ||\n            pack.searchWords.find(word => word.toLowerCase().indexOf(payload) >= 0));\n    }\n    static getTriplets(repo) {\n        let triplets = this.tripletCache.get(repo);\n        if (!triplets) {\n            triplets = new Set();\n            for (const pack of repo) {\n                PackMatcher.splitTriplets(pack.id, triplets);\n                PackMatcher.splitTriplets(pack.name, triplets);\n                for (const word of pack.searchWords) {\n                    PackMatcher.splitTriplets(word, triplets);\n                }\n            }\n            this.tripletCache.set(repo, triplets);\n        }\n        return triplets;\n    }\n    static splitTriplets(str, cache) {\n        str = str.toLowerCase();\n        for (let i = 0, length = str.length - 2; i < length; ++i) {\n            cache.add(str.substr(i, 3));\n        }\n    }\n}\nPackMatcher.tripletCache = new Map();\nclass AllMatcher {\n    constructor(payload, peopleRepository, packRepository) {\n        this.matchers = AllMatcher.allMatchers\n            .map(compiler => new compiler(payload, peopleRepository, packRepository))\n            .filter(matcher => !matcher.isImpossible);\n    }\n    get isImpossible() {\n        return this.matchers.length === 0;\n    }\n    match(pack) {\n        return !!this.matchers.find(matcher => matcher.match(pack));\n    }\n}\nAllMatcher.allMatchers = [\n    EngineMatcher,\n    AuthorMatcher,\n    CharacterMatcher,\n    TypeMatcher,\n    PackMatcher,\n];\nconst CompilerMatch = new Map([\n    ['all', AllMatcher],\n    ['author', AuthorMatcher],\n    ['character', CharacterMatcher],\n    ['engine', EngineMatcher],\n    ['pack', PackMatcher],\n    ['type', TypeMatcher],\n]);\nexport default function compile(matchers, authors, packs) {\n    return matchers.map(matcher => new (CompilerMatch.get(matcher.type))(matcher.payload, authors, packs));\n}\n","import parse from './parse';\nimport optimize from './optimize';\nimport compile from './compile';\nexport default function filter(search, authors, list) {\n    const parsed = parse(search);\n    const optimized = optimize(parsed);\n    const compiled = compile(optimized, authors, list);\n    if (compiled.find(matcher => matcher.isImpossible))\n        return [];\n    return list.filter(pack => compiled.every(matcher => matcher.match(pack)));\n}\n","import { IPack } from '@edave64/dddg-repo-filters/dist/pack';\n\nexport interface SelectedEvent {\n\tid: string;\n\tsource: 'keyboard' | 'pointer';\n}\n\nexport enum PackStates {\n\tUnknown = 0b00,\n\tInstalled = 0b01,\n\tActive = 0b10,\n}\n\nexport interface IPackWithState extends IPack {\n\tstate: PackStates;\n}\n","\nimport { IPack } from '@edave64/dddg-repo-filters/dist/pack';\nimport { IAuthors } from '@edave64/dddg-repo-filters/dist/authors';\nimport run from '@edave64/dddg-repo-filters/dist/main';\nimport { PackStates, IPackWithState } from './types';\nimport { exhaust } from '@/util/exhaust';\nimport { defineComponent, PropType } from 'vue';\n\nconst pageKeyMoveBy = 10;\n\nexport default defineComponent({\n\tprops: {\n\t\tsearch: { type: String, required: true },\n\t\tauthors: { type: Object as PropType<IAuthors>, required: true },\n\t\tpacks: { type: Object as PropType<IPackWithState[]>, required: true },\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata: () => ({\n\t\tsort: '' as keyof IPack | '',\n\t\tdesc: false,\n\t\tfocusedItem: '',\n\t\twordCache: {} as { [id: string]: Set<string> },\n\t}),\n\tcomputed: {\n\t\tlist(): IPackWithState[] {\n\t\t\tconst filtered = this.filterList(this.packs, this.search);\n\t\t\tif (this.sort && filtered.length > 0) {\n\t\t\t\tconst sort = this.sort as keyof IPack;\n\t\t\t\tlet sortFunc: ((a: IPack, b: IPack) => number) | undefined;\n\t\t\t\tif (typeof filtered[0][sort] === 'string') {\n\t\t\t\t\tsortFunc = (a, b) => a.name.localeCompare(b.name);\n\t\t\t\t} else if (filtered[0][sort] instanceof Array) {\n\t\t\t\t\tsortFunc = (a, b) =>\n\t\t\t\t\t\t(a as any)[sort]\n\t\t\t\t\t\t\t.join(', ')\n\t\t\t\t\t\t\t.localeCompare((b as any)[sort].join(', '));\n\t\t\t\t}\n\t\t\t\tif (sortFunc) {\n\t\t\t\t\tif (this.desc) {\n\t\t\t\t\t\tconst oldSort = sortFunc;\n\t\t\t\t\t\tsortFunc = (b, a) => oldSort(a, b);\n\t\t\t\t\t}\n\t\t\t\t\tfiltered.sort(sortFunc);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn filtered;\n\t\t},\n\t\tlistById(): Map<string, IPack> {\n\t\t\treturn new Map(this.packs.map(pack => [pack.id, pack]));\n\t\t},\n\t\tuniqueCharacters(): string[] {\n\t\t\treturn Array.from(\n\t\t\t\tnew Set(\n\t\t\t\t\tthis.packs.flatMap(pack =>\n\t\t\t\t\t\tpack.characters.map(char => char.toLowerCase())\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t);\n\t\t},\n\t},\n\tmethods: {\n\t\tfocus(): void {\n\t\t\t((this.$refs.tbody as any).$el as HTMLElement).focus();\n\t\t},\n\t\tkeydownHandler(event: KeyboardEvent) {\n\t\t\tconst indexOf = this.list.findIndex(pack => pack.id === this.focusedItem);\n\t\t\tconsole.log(indexOf);\n\t\t\tswitch (event.key) {\n\t\t\t\tcase 'Enter':\n\t\t\t\t\tthis.$emit('selected', { id: this.focusedItem, source: 'keyboard' });\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ArrowUp':\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tif (indexOf === 0) {\n\t\t\t\t\t\tthis.$emit('select-search-bar');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.focusedItem = this.list[indexOf - 1].id;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ArrowDown':\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tif (indexOf < this.list.length - 1) {\n\t\t\t\t\t\tthis.focusedItem = this.list[indexOf + 1].id;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'PageUp': {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tlet newIdx = indexOf - pageKeyMoveBy;\n\t\t\t\t\tif (newIdx < 0) {\n\t\t\t\t\t\tnewIdx = 0;\n\t\t\t\t\t}\n\t\t\t\t\tthis.focusedItem = this.list[newIdx].id;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase 'PageDown': {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tlet newIdx = indexOf + pageKeyMoveBy;\n\t\t\t\t\tconst max = this.list.length - 1;\n\t\t\t\t\tif (newIdx > max) {\n\t\t\t\t\t\tnewIdx = max;\n\t\t\t\t\t}\n\t\t\t\t\tthis.focusedItem = this.list[newIdx].id;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\theaderKeydownListener(event: KeyboardEvent, headerId: keyof IPack) {\n\t\t\tswitch (event.key) {\n\t\t\t\tcase 'Enter':\n\t\t\t\tcase ' ':\n\t\t\t\t\tthis.sortBy(headerId);\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ArrowDown':\n\t\t\t\t\tthis.focus();\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ArrowUp':\n\t\t\t\t\tthis.$emit('select-search-bar');\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\t\tupdateFocusedItem() {\n\t\t\tif (this.list.length === 0) {\n\t\t\t\tthis.focusedItem = '';\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this.focusedItem === '') {\n\t\t\t\tthis.focusedItem = this.list[0].id;\n\t\t\t}\n\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tconst header = this.$refs.header as HTMLElement;\n\t\t\t\tconst element = document.querySelector(\n\t\t\t\t\t'.list tbody .focused'\n\t\t\t\t) as HTMLDivElement;\n\n\t\t\t\tconst containerHeight =\n\t\t\t\t\t(this.$el as HTMLElement).offsetHeight - header.offsetHeight;\n\t\t\t\tconst scrollTop = this.$el.scrollTop;\n\t\t\t\tconst scrollBottom = scrollTop + containerHeight;\n\n\t\t\t\tif (element) {\n\t\t\t\t\tconst itemTop = element.offsetTop - header.offsetHeight;\n\t\t\t\t\tconst itemBottom = itemTop + element.offsetHeight;\n\n\t\t\t\t\tif (itemBottom > scrollBottom) {\n\t\t\t\t\t\tthis.$el.scrollTop = itemBottom - containerHeight;\n\t\t\t\t\t} else if (itemTop < scrollTop) {\n\t\t\t\t\t\tthis.$el.scrollTop = itemTop;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tsortBy(by: keyof IPack) {\n\t\t\tif (this.sort === by) {\n\t\t\t\tif (!this.desc) {\n\t\t\t\t\tthis.desc = true;\n\t\t\t\t} else {\n\t\t\t\t\tthis.sort = '';\n\t\t\t\t\tthis.desc = false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.sort = by;\n\t\t\t\tthis.desc = false;\n\t\t\t}\n\t\t},\n\t\tfilterList(list: IPackWithState[], search: string): IPackWithState[] {\n\t\t\tif (!search) return [...list];\n\t\t\treturn run(search, this.authors, list) as IPackWithState[];\n\t\t},\n\t\ttranslatePackState(state: PackStates) {\n\t\t\tswitch (state) {\n\t\t\t\tcase PackStates.Unknown:\n\t\t\t\t\treturn 'Not added';\n\t\t\t\tcase PackStates.Installed:\n\t\t\t\t\treturn 'Installed';\n\t\t\t\tcase PackStates.Active:\n\t\t\t\t\treturn 'Active';\n\t\t\t\tdefault:\n\t\t\t\t\texhaust(state);\n\t\t\t}\n\t\t},\n\t},\n\twatch: {\n\t\tfocusedItem() {\n\t\t\tthis.updateFocusedItem();\n\t\t},\n\t},\n});\n","import { render } from \"./List.vue?vue&type=template&id=7185b170&scoped=true&bindings={}\"\nimport script from \"./List.vue?vue&type=script&lang=ts\"\nexport * from \"./List.vue?vue&type=script&lang=ts\"\n\nimport \"./List.vue?vue&type=style&index=0&id=7185b170&scoped=true&lang=scss\"\nscript.render = render\nscript.__scopeId = \"data-v-7185b170\"\n\nexport default script","<template>\n\t<div class=\"pack-display\" :style=\"{ backgroundImage }\" @click.stop>\n\t\t<header>\n\t\t\t<h1>\n\t\t\t\t<button\n\t\t\t\t\tv-if=\"showBack\"\n\t\t\t\t\tclass=\"exit-button\"\n\t\t\t\t\t@click=\"$emit('leave', true)\"\n\t\t\t\t>\n\t\t\t\t\t<i class=\"material-icons\">arrow_back</i>\n\t\t\t\t</button>\n\t\t\t\t{{ pack.name }}\n\t\t\t</h1>\n\t\t\t<h2>{{ pack.id }}</h2>\n\t\t</header>\n\t\t<section\n\t\t\tclass=\"disclaimer\"\n\t\t\tv-if=\"pack.disclaimer\"\n\t\t\tv-html=\"sanitize(pack.disclaimer)\"\n\t\t/>\n\t\t<section v-if=\"pack.source\">\n\t\t\t<a :href=\"pack.source\" target=\"_blank\" rel=\"noopener noreferrer\"\n\t\t\t\t>Source</a\n\t\t\t>\n\t\t</section>\n\t\t<section>\n\t\t\t<button v-if=\"addable\" @click=\"add\">\n\t\t\t\t<i class=\"material-icons\">add</i>\n\t\t\t\tAdd {{ installable ? 'Temporarily' : '' }}\n\t\t\t</button>\n\t\t\t<button v-if=\"removable\" @click=\"remove\">\n\t\t\t\t<i class=\"material-icons\">remove</i>\n\t\t\t\tRemove {{ uninstallable ? 'Temporarily' : '' }}\n\t\t\t</button>\n\t\t\t<button v-if=\"installable\" @click=\"add\">\n\t\t\t\t<i class=\"material-icons\">add</i>\n\t\t\t\tInstall\n\t\t\t</button>\n\t\t\t<button v-if=\"uninstallable\" @click=\"remove\">\n\t\t\t\t<i class=\"material-icons\">remove</i>\n\t\t\t\tUninstall\n\t\t\t</button>\n\t\t\t<button v-if=\"activatable\" @click=\"add\">\n\t\t\t\t<i class=\"material-icons\">add</i>\n\t\t\t\tActivate\n\t\t\t</button>\n\t\t\t<button v-if=\"deactivatable\" @click=\"remove\">\n\t\t\t\t<i class=\"material-icons\">remove</i>\n\t\t\t\tDeactivate\n\t\t\t</button>\n\t\t</section>\n\t\t<section>\n\t\t\t<h3>Authors</h3>\n\t\t\t<table>\n\t\t\t\t<tbody>\n\t\t\t\t\t<tr v-for=\"authorId of pack.authors\" :key=\"authorId\">\n\t\t\t\t\t\t<td>{{ authorName(authorId) }}</td>\n\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\tv-for=\"link of authorsLinks(authorId)\"\n\t\t\t\t\t\t\t\t:key=\"link.target\"\n\t\t\t\t\t\t\t\t:href=\"link.target\"\n\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t\trel=\"noopener noreferrer\"\n\t\t\t\t\t\t\t\tclass=\"platform_button\"\n\t\t\t\t\t\t\t\t><img\n\t\t\t\t\t\t\t\t\t:title=\"link.platform\"\n\t\t\t\t\t\t\t\t\t:src=\"link.icon\"\n\t\t\t\t\t\t\t\t\theight=\"32\"\n\t\t\t\t\t\t\t\t\twidth=\"32\"\n\t\t\t\t\t\t\t/></a>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t</section>\n\t\t<section v-if=\"pack.description\">\n\t\t\t<h3>Credits</h3>\n\t\t\t<p v-html=\"sanitize(pack.description)\"></p>\n\t\t</section>\n\t</div>\n</template>\n\n<script lang=\"ts\">\nimport { IAuthor, IAuthors } from '@edave64/dddg-repo-filters/dist/authors';\nimport { sanitize } from '@/components/toolbox/tools/character-pack-sanitizer';\nimport environment from '@/environments/environment';\nimport { IPackWithState, PackStates } from './types';\nimport { defineComponent, PropType } from 'vue';\nimport { IRemovePacksAction } from '@/store';\n\nconst linkablePlatforms: Array<[keyof IAuthor, string, string]> = [\n\t['reddit', 'https://reddit.com/u/%1', 'reddit.png'],\n\t['deviantart', 'https://www.deviantart.com/%1', 'deviantart.png'],\n\t['twitter', 'https://twitter.com/%1', 'twitter.svg'],\n\t['pixiv', 'https://www.pixiv.net/users/%1', 'pixiv.ico'],\n\t['patreon', 'https://www.patreon.com/%1', 'patreon.png'],\n\t['facebook', 'https://www.facebook.com/%1', 'facebook.png'],\n\t['github', 'https://github.com/%1', 'github.png'],\n\t['website', '%1', 'website.svg'],\n];\n\nexport default defineComponent({\n\tprops: {\n\t\tselected: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tauthors: {\n\t\t\ttype: Object as PropType<IAuthors>,\n\t\t\trequire: true,\n\t\t},\n\t\tpacks: {\n\t\t\ttype: Object as PropType<IPackWithState[]>,\n\t\t\trequire: true,\n\t\t},\n\t\tshowBack: {\n\t\t\ttype: Boolean,\n\t\t\trequire: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tpack(): IPackWithState {\n\t\t\treturn this.packs!.find(pack => pack.id === this.selected)!;\n\t\t},\n\t\tbackgroundImage(): string {\n\t\t\treturn this.pack.preview.map(preview => `url('${preview}')`).join(',');\n\t\t},\n\t\tactivatable(): boolean {\n\t\t\tif (!environment.isAutoLoadingSupported) return false;\n\t\t\tif (!(this.pack.state & PackStates.Installed)) return false;\n\t\t\treturn !(this.pack.state & PackStates.Active);\n\t\t},\n\t\tdeactivatable(): boolean {\n\t\t\tif (!environment.isAutoLoadingSupported) return false;\n\t\t\tif (!(this.pack.state & PackStates.Installed)) return false;\n\t\t\treturn !!(this.pack.state & PackStates.Active);\n\t\t},\n\t\tinstallable(): boolean {\n\t\t\tif (!environment.isLocalRepoSupported) return false;\n\t\t\tif (this.pack.state & PackStates.Installed) return false;\n\t\t\treturn true;\n\t\t},\n\t\tuninstallable(): boolean {\n\t\t\tif (!environment.isLocalRepoSupported) return false;\n\t\t\tif (!(this.pack.state & PackStates.Installed)) return false;\n\t\t\treturn true;\n\t\t},\n\t\tremovable(): boolean {\n\t\t\treturn !!(this.pack.state & PackStates.Active);\n\t\t},\n\t\taddable(): boolean {\n\t\t\treturn this.pack.state === PackStates.Unknown;\n\t\t},\n\t\tisAdded(): boolean {\n\t\t\treturn false;\n\t\t},\n\t},\n\tmethods: {\n\t\tfocus() {\n\t\t\t(this.$refs.toFocus as HTMLElement).focus();\n\t\t},\n\t\tauthorName(authorId: string) {\n\t\t\tconst author = this.authors![authorId];\n\t\t\tif (author && author.currentName) return author.currentName;\n\t\t\treturn authorId;\n\t\t},\n\t\tauthorsLinks(authorId: string): AuthorLink[] {\n\t\t\tconst author = this.authors![authorId];\n\t\t\tif (!author) return [];\n\t\t\treturn linkablePlatforms\n\t\t\t\t.filter(platform => author[platform[0]])\n\t\t\t\t.map(platform => {\n\t\t\t\t\tconst value = author[platform[0]]!;\n\t\t\t\t\tconst target = platform[1].replace('%1', value);\n\t\t\t\t\treturn {\n\t\t\t\t\t\ttarget,\n\t\t\t\t\t\tplatform: platform[0][0].toUpperCase() + platform[0].slice(1),\n\t\t\t\t\t\ticon: 'icons/' + platform[2],\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t},\n\t\tsanitize(credits: string) {\n\t\t\treturn sanitize(credits);\n\t\t},\n\t\t/*\n\t\tinstall(): void {\n\t\t\tif (!this.installedPack) return;\n\t\t\tenvironment.installContentPack(\n\t\t\t\tthis.pack.dddg2Path || this.pack.dddg1Path\n\t\t\t);\n\t\t\tif (this.installedPack.queuedUninstall) {\n\t\t\t\tthis.installedPack.queuedUninstall = false;\n\t\t\t} else {\n\t\t\t\tthis.installedPack.installed = true;\n\t\t\t}\n\t\t},\n\t\tuninstall(): void {\n\t\t\tif (!this.installedPack) return;\n\t\t\tenvironment.uninstallContentPack(this.installedPack.url);\n\t\t\tthis.installedPack.queuedUninstall = true;\n\t\t},\n\t\t*/\n\t\tasync remove(): Promise<void> {\n\t\t\tawait this.$store.dispatch('removePacks', {\n\t\t\t\tpacks: new Set([this.pack.id]),\n\t\t\t} as IRemovePacksAction);\n\t\t},\n\t\tasync add(): Promise<void> {\n\t\t\tawait this.$store.dispatch(\n\t\t\t\t'content/loadContentPacks',\n\t\t\t\tthis.pack.dddg2Path || this.pack.dddg1Path\n\t\t\t);\n\t\t},\n\t},\n});\n\ninterface AuthorLink {\n\treadonly target: string;\n\treadonly platform: string;\n\treadonly icon: string;\n}\n</script>\n\n<style lang=\"scss\">\n.pack-display {\n\tul {\n\t\tmargin-left: 20px;\n\t}\n}\n</style>\n<style scoped lang=\"scss\">\n.platform_button {\n\tmargin-right: 6px;\n}\n\n.exit-button {\n\theight: 32px;\n\twidth: 32px;\n\ttext-align: center;\n\tbackground-position: center center;\n\tbackground-repeat: no-repeat;\n\tbackground-size: contain;\n}\n\n.pack-display {\n\twidth: 100%;\n\theight: 100%;\n\tbackground-attachment: scroll;\n\tbackground-color: #ffffff;\n\tbackground-position: right center;\n\tbackground-repeat: no-repeat;\n\tbackground-size: contain;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-self: center;\n\toverflow: auto;\n\tpadding: 0;\n\n\th1 {\n\t\tfont-size: 24px;\n\t}\n\n\th2 {\n\t\tfont-size: 14px;\n\t}\n\n\tsection,\n\theader,\n\tfooter {\n\t\tpadding: 16px;\n\t\tbackground: linear-gradient(\n\t\t\t90deg,\n\t\t\trgba(255, 255, 255, 1) 25%,\n\t\t\trgba(255, 255, 255, 0) 75%\n\t\t);\n\t\twidth: 100%;\n\n\t\ttext-shadow: 0 0 4px #fff, -1px -1px 0 #fff, 1px -1px 0 #fff,\n\t\t\t-1px 1px 0 #fff, 1px 1px 0 #fff;\n\t}\n\n\tfooter:last-child,\n\tsection:last-child {\n\t\tflex-grow: 1;\n\t}\n\n\tsection.disclaimer {\n\t\tbackground: linear-gradient(\n\t\t\t90deg,\n\t\t\trgba(255, 51, 51, 1) 25%,\n\t\t\trgba(255, 51, 51, 0) 75%\n\t\t);\n\t}\n\n\t.copy-wrapper {\n\t\tdisplay: block;\n\t\twidth: 1px;\n\t\toverflow: hidden;\n\t\theight: 1px;\n\t\topacity: 0;\n\n\t\tinput {\n\t\t\tposition: relative;\n\t\t}\n\t}\n}\n</style>\n","const allowedTags = [\n\t'h3',\n\t'h4',\n\t'h5',\n\t'h6',\n\t'blockquote',\n\t'p',\n\t'a',\n\t'ul',\n\t'ol',\n\t'nl',\n\t'li',\n\t'b',\n\t'i',\n\t'strong',\n\t'em',\n\t'strike',\n\t'code',\n\t'hr',\n\t'br',\n\t'div',\n\t'table',\n\t'thead',\n\t'caption',\n\t'tbody',\n\t'tr',\n\t'th',\n\t'td',\n\t'pre',\n];\nconst allowedAttributes: { [tagName: string]: string[] | undefined } = {\n\ta: ['href'],\n\timg: ['src'],\n};\nconst schemaLimitedAttributes = ['href', 'src'];\nconst allowedSchemas = ['http', 'https'];\nconst enforceAttributes: {\n\t[tagName: string]: { [attr: string]: string } | undefined;\n} = {\n\ta: {\n\t\ttarget: '_blank',\n\t\trel: 'noopener noreferrer',\n\t},\n};\n\nexport function sanitize(html: string) {\n\tconst retDoc = document.createElement('div');\n\tconst doc = document.createElement('div');\n\tdoc.innerHTML = html;\n\n\tfor (const node of Array.from(doc.childNodes)) {\n\t\tfor (const sanitizedNode of sanitizeElement(node as Element)) {\n\t\t\tretDoc.appendChild(sanitizedNode);\n\t\t}\n\t}\n\n\treturn retDoc.innerHTML;\n}\n\nconst protocolMatcher = /^(\\w+):/;\n\nfunction sanitizeElement(node: Node): Node[] {\n\tif (node.nodeType !== Node.ELEMENT_NODE) return [node];\n\tconst el = node as Element;\n\tconst tagName = el.tagName.toLowerCase();\n\tif (allowedTags.includes(tagName)) {\n\t\tconst newEl = document.createElement(tagName) as HTMLElement;\n\t\tconst attrs: Attr[] = Array.prototype.slice.call(el.attributes);\n\t\tconst allowedAttrs = allowedAttributes[tagName] || [];\n\t\tfor (const attr of attrs) {\n\t\t\tif (!allowedAttrs.includes(attr.name)) continue;\n\t\t\tif (schemaLimitedAttributes.includes(attr.name)) {\n\t\t\t\tconst protocolMatch = attr.value.match(protocolMatcher);\n\t\t\t\tif (protocolMatch && !allowedSchemas.includes(protocolMatch[1])) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\tnewEl.setAttribute(attr.name, el.getAttribute(attr.name)!);\n\t\t}\n\t\tconst enforce = enforceAttributes[tagName];\n\t\tif (enforce) {\n\t\t\tfor (const attrName in enforce) {\n\t\t\t\tif (!Object.prototype.hasOwnProperty.call(enforce, attrName)) continue;\n\t\t\t\tnewEl.setAttribute(attrName, enforce[attrName]);\n\t\t\t}\n\t\t}\n\t\tconst children: Node[] = Array.prototype.slice.call(el.childNodes);\n\t\tfor (const childNode of children) {\n\t\t\tconst subNodes = sanitizeElement(childNode);\n\t\t\tfor (const subNode of subNodes) {\n\t\t\t\tnewEl.appendChild(subNode);\n\t\t\t}\n\t\t}\n\t\treturn [newEl];\n\t} else {\n\t\tlet ret: Node[] = [];\n\t\tret.push(document.createTextNode(`<${tagName}>`));\n\t\tfor (const subNode of el.childNodes) {\n\t\t\tret = ret.concat(sanitizeElement(subNode));\n\t\t}\n\t\tret.push(document.createTextNode(`</${tagName}>`));\n\t\treturn ret;\n\t}\n}\n","\nimport { IAuthor, IAuthors } from '@edave64/dddg-repo-filters/dist/authors';\nimport { sanitize } from '@/components/toolbox/tools/character-pack-sanitizer';\nimport environment from '@/environments/environment';\nimport { IPackWithState, PackStates } from './types';\nimport { defineComponent, PropType } from 'vue';\nimport { IRemovePacksAction } from '@/store';\n\nconst linkablePlatforms: Array<[keyof IAuthor, string, string]> = [\n\t['reddit', 'https://reddit.com/u/%1', 'reddit.png'],\n\t['deviantart', 'https://www.deviantart.com/%1', 'deviantart.png'],\n\t['twitter', 'https://twitter.com/%1', 'twitter.svg'],\n\t['pixiv', 'https://www.pixiv.net/users/%1', 'pixiv.ico'],\n\t['patreon', 'https://www.patreon.com/%1', 'patreon.png'],\n\t['facebook', 'https://www.facebook.com/%1', 'facebook.png'],\n\t['github', 'https://github.com/%1', 'github.png'],\n\t['website', '%1', 'website.svg'],\n];\n\nexport default defineComponent({\n\tprops: {\n\t\tselected: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tauthors: {\n\t\t\ttype: Object as PropType<IAuthors>,\n\t\t\trequire: true,\n\t\t},\n\t\tpacks: {\n\t\t\ttype: Object as PropType<IPackWithState[]>,\n\t\t\trequire: true,\n\t\t},\n\t\tshowBack: {\n\t\t\ttype: Boolean,\n\t\t\trequire: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tpack(): IPackWithState {\n\t\t\treturn this.packs!.find(pack => pack.id === this.selected)!;\n\t\t},\n\t\tbackgroundImage(): string {\n\t\t\treturn this.pack.preview.map(preview => `url('${preview}')`).join(',');\n\t\t},\n\t\tactivatable(): boolean {\n\t\t\tif (!environment.isAutoLoadingSupported) return false;\n\t\t\tif (!(this.pack.state & PackStates.Installed)) return false;\n\t\t\treturn !(this.pack.state & PackStates.Active);\n\t\t},\n\t\tdeactivatable(): boolean {\n\t\t\tif (!environment.isAutoLoadingSupported) return false;\n\t\t\tif (!(this.pack.state & PackStates.Installed)) return false;\n\t\t\treturn !!(this.pack.state & PackStates.Active);\n\t\t},\n\t\tinstallable(): boolean {\n\t\t\tif (!environment.isLocalRepoSupported) return false;\n\t\t\tif (this.pack.state & PackStates.Installed) return false;\n\t\t\treturn true;\n\t\t},\n\t\tuninstallable(): boolean {\n\t\t\tif (!environment.isLocalRepoSupported) return false;\n\t\t\tif (!(this.pack.state & PackStates.Installed)) return false;\n\t\t\treturn true;\n\t\t},\n\t\tremovable(): boolean {\n\t\t\treturn !!(this.pack.state & PackStates.Active);\n\t\t},\n\t\taddable(): boolean {\n\t\t\treturn this.pack.state === PackStates.Unknown;\n\t\t},\n\t\tisAdded(): boolean {\n\t\t\treturn false;\n\t\t},\n\t},\n\tmethods: {\n\t\tfocus() {\n\t\t\t(this.$refs.toFocus as HTMLElement).focus();\n\t\t},\n\t\tauthorName(authorId: string) {\n\t\t\tconst author = this.authors![authorId];\n\t\t\tif (author && author.currentName) return author.currentName;\n\t\t\treturn authorId;\n\t\t},\n\t\tauthorsLinks(authorId: string): AuthorLink[] {\n\t\t\tconst author = this.authors![authorId];\n\t\t\tif (!author) return [];\n\t\t\treturn linkablePlatforms\n\t\t\t\t.filter(platform => author[platform[0]])\n\t\t\t\t.map(platform => {\n\t\t\t\t\tconst value = author[platform[0]]!;\n\t\t\t\t\tconst target = platform[1].replace('%1', value);\n\t\t\t\t\treturn {\n\t\t\t\t\t\ttarget,\n\t\t\t\t\t\tplatform: platform[0][0].toUpperCase() + platform[0].slice(1),\n\t\t\t\t\t\ticon: 'icons/' + platform[2],\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t},\n\t\tsanitize(credits: string) {\n\t\t\treturn sanitize(credits);\n\t\t},\n\t\t/*\n\t\tinstall(): void {\n\t\t\tif (!this.installedPack) return;\n\t\t\tenvironment.installContentPack(\n\t\t\t\tthis.pack.dddg2Path || this.pack.dddg1Path\n\t\t\t);\n\t\t\tif (this.installedPack.queuedUninstall) {\n\t\t\t\tthis.installedPack.queuedUninstall = false;\n\t\t\t} else {\n\t\t\t\tthis.installedPack.installed = true;\n\t\t\t}\n\t\t},\n\t\tuninstall(): void {\n\t\t\tif (!this.installedPack) return;\n\t\t\tenvironment.uninstallContentPack(this.installedPack.url);\n\t\t\tthis.installedPack.queuedUninstall = true;\n\t\t},\n\t\t*/\n\t\tasync remove(): Promise<void> {\n\t\t\tawait this.$store.dispatch('removePacks', {\n\t\t\t\tpacks: new Set([this.pack.id]),\n\t\t\t} as IRemovePacksAction);\n\t\t},\n\t\tasync add(): Promise<void> {\n\t\t\tawait this.$store.dispatch(\n\t\t\t\t'content/loadContentPacks',\n\t\t\t\tthis.pack.dddg2Path || this.pack.dddg1Path\n\t\t\t);\n\t\t},\n\t},\n});\n\ninterface AuthorLink {\n\treadonly target: string;\n\treadonly platform: string;\n\treadonly icon: string;\n}\n","import { render } from \"./PackDisplay.vue?vue&type=template&id=41199fc8&scoped=true&bindings={}\"\nimport script from \"./PackDisplay.vue?vue&type=script&lang=ts\"\nexport * from \"./PackDisplay.vue?vue&type=script&lang=ts\"\n\nimport \"./PackDisplay.vue?vue&type=style&index=0&lang=scss\"\nimport \"./PackDisplay.vue?vue&type=style&index=1&id=41199fc8&scoped=true&lang=scss\"\nscript.render = render\nscript.__scopeId = \"data-v-41199fc8\"\n\nexport default script","\n/* tslint:disable:no-bitwise */\nimport { IAuthors } from '@edave64/dddg-repo-filters/dist/authors';\nimport { IPack } from '@edave64/dddg-repo-filters/dist/pack';\nimport SearchBar from '../SearchBar.vue';\nimport List from '../List.vue';\nimport { SelectedEvent, IPackWithState, PackStates } from '../types';\nimport PackDisplay from '../PackDisplay.vue';\nimport environment from '@/environments/environment';\nimport { defineComponent } from 'vue';\n\nconst repoUrl = 'https://edave64.github.io/Doki-Doki-Dialog-Generator-Packs/';\n\nexport default defineComponent({\n\tcomponents: {\n\t\tSearchBar,\n\t\tList,\n\t\tPackDisplay,\n\t},\n\tdata: () => ({\n\t\tsearch: '',\n\t\tauthors: {} as IAuthors,\n\t\tpacks: [] as IPack[],\n\t\tlocalPacks: [] as IPack[],\n\t\tselected: null as string | null,\n\t}),\n\tcomputed: {\n\t\tpacksArgmented(): IPackWithState[] {\n\t\t\tconst loadedPacks = this.$store.state.content.contentPacks;\n\t\t\tconst repoPacks = this.packs;\n\n\t\t\tconst repoLookup = new Map(repoPacks.map(pack => [pack.id, pack]));\n\t\t\tconst loadedLookup = new Map(\n\t\t\t\tloadedPacks.map(pack => [pack.packId, pack])\n\t\t\t);\n\t\t\tconst localLookup = new Map(this.localPacks.map(pack => [pack.id, pack]));\n\n\t\t\tconst installedRet: IPackWithState[] = loadedPacks.map(pack => {\n\t\t\t\tconst repoPack = repoLookup.get(pack.packId!);\n\t\t\t\tconst isLoaded = loadedLookup.has(pack.packId!)\n\t\t\t\t\t? PackStates.Active\n\t\t\t\t\t: PackStates.Unknown;\n\t\t\t\tconst isInstalled = localLookup.has(pack.packId!)\n\t\t\t\t\t? PackStates.Installed\n\t\t\t\t\t: PackStates.Unknown;\n\t\t\t\tconst state: PackStates = isLoaded | isInstalled;\n\n\t\t\t\tif (repoPack) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...repoPack,\n\t\t\t\t\t\tstate,\n\t\t\t\t\t} as IPackWithState;\n\t\t\t\t} else {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tstate,\n\t\t\t\t\t\tid: pack.packId,\n\t\t\t\t\t\tcharacters: [],\n\t\t\t\t\t\tname: pack.packId,\n\t\t\t\t\t\tinLocalRepo: false,\n\t\t\t\t\t\tpreview: [],\n\t\t\t\t\t\tkind: [],\n\t\t\t\t\t\tdescription: '',\n\t\t\t\t\t\tdddg1Path: '',\n\t\t\t\t\t\tdddg2Path: '',\n\t\t\t\t\t\tsearchWords: [],\n\t\t\t\t\t\tauthors: [],\n\t\t\t\t\t} as IPackWithState;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst notInstalledPacks = repoPacks\n\t\t\t\t.filter(pack => !loadedLookup.has(pack.id))\n\t\t\t\t.map(pack => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...pack,\n\t\t\t\t\t\tstate: PackStates.Unknown,\n\t\t\t\t\t} as IPackWithState;\n\t\t\t\t});\n\n\t\t\treturn [\n\t\t\t\t...installedRet.filter(ret => !ret.id.startsWith('dddg.buildin.')),\n\t\t\t\t...notInstalledPacks,\n\t\t\t];\n\t\t},\n\t},\n\tmethods: {\n\t\tfocus(): void {},\n\t\tsetSearch(str: string): void {\n\t\t\tthis.selected = null;\n\t\t\tthis.search = str;\n\t\t},\n\t\tasync fetchJSON<A>(path: string): Promise<A> {\n\t\t\tconst req = await fetch(path);\n\t\t\treturn await req.json();\n\t\t},\n\t\tleavePackDisplay(moveFocus: boolean) {\n\t\t\tthis.selected = null;\n\t\t\tif (moveFocus) {\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t(this.$refs.searchBar as any).focus();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tkeydownHandler(event: KeyboardEvent) {\n\t\t\tif (event.key === 'Escape') {\n\t\t\t\tthis.selected = '';\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t(this.$refs.searchBar as any).focus();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tonSelect({ id, source }: SelectedEvent) {\n\t\t\tthis.selected = id;\n\t\t\tif (source === 'keyboard') {\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tconst dialog = this.$refs.dialog as any;\n\t\t\t\t\tdialog.focus();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tfocusListHandler() {\n\t\t\t(this.$refs.list as any).focus();\n\t\t},\n\t},\n\tasync created() {\n\t\tlet localPacksPromise: Promise<IPack[]> | [] = [];\n\n\t\tif (environment.isLocalRepoSupported) {\n\t\t\tlocalPacksPromise = this.fetchJSON(environment.localRepositoryUrl);\n\t\t}\n\n\t\t[this.packs, this.authors, this.localPacks] = await Promise.all([\n\t\t\tthis.fetchJSON<IPack[]>(repoUrl + 'repo.json'),\n\t\t\tthis.fetchJSON<IAuthors>(repoUrl + 'people.json'),\n\t\t\tlocalPacksPromise,\n\t\t]);\n\t},\n});\n","import { render } from \"./SingleBox.vue?vue&type=template&id=0683c134&scoped=true&bindings={}\"\nimport script from \"./SingleBox.vue?vue&type=script&lang=ts\"\nexport * from \"./SingleBox.vue?vue&type=script&lang=ts\"\n\nimport \"./SingleBox.vue?vue&type=style&index=0&id=0683c134&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-0683c134\"\n\nexport default script"],"sourceRoot":""}