(function(t){function e(e){for(var r,i,s=e[0],c=e[1],u=e[2],l=0,d=[];l<s.length;l++)i=s[l],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);h&&h(e);while(d.length)d.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],r=!0,i=1;i<n.length;i++){var s=n[i];0!==a[s]&&(r=!1)}r&&(o.splice(e--,1),t=c(c.s=n[0]))}return t}var r={},i={app:0},a={app:0},o=[];function s(t){return c.p+"js/"+({}[t]||t)+"."+{"chunk-164650d4":"ac1ccc23","chunk-d699e572":"bab7c82b"}[t]+".js"}function c(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(t){var e=[],n={"chunk-164650d4":1,"chunk-d699e572":1};i[t]?e.push(i[t]):0!==i[t]&&n[t]&&e.push(i[t]=new Promise((function(e,n){for(var r="css/"+({}[t]||t)+"."+{"chunk-164650d4":"8b705382","chunk-d699e572":"19605c5c"}[t]+".css",a=c.p+r,o=document.getElementsByTagName("link"),s=0;s<o.length;s++){var u=o[s],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===r||l===a))return e()}var d=document.getElementsByTagName("style");for(s=0;s<d.length;s++){u=d[s],l=u.getAttribute("data-href");if(l===r||l===a)return e()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onload=e,h.onerror=function(e){var r=e&&e.target&&e.target.src||a,o=new Error("Loading CSS chunk "+t+" failed.\n("+r+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=r,delete i[t],h.parentNode.removeChild(h),n(o)},h.href=a;var p=document.getElementsByTagName("head")[0];p.appendChild(h)})).then((function(){i[t]=0})));var r=a[t];if(0!==r)if(r)e.push(r[2]);else{var o=new Promise((function(e,n){r=a[t]=[e,n]}));e.push(r[2]=o);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=s(t);var d=new Error;u=function(e){l.onerror=l.onload=null,clearTimeout(h);var n=a[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+r+": "+i+")",d.name="ChunkLoadError",d.type=r,d.request=i,n[1](d)}a[t]=void 0}};var h=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(e)},c.m=t,c.c=r,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)c.d(n,r,function(e){return t[e]}.bind(null,r));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="",c.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=e,u=u.slice();for(var d=0;d<u.length;d++)e(u[d]);var h=l;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"032b":function(t,e,n){"use strict";n("96cf");var r=n("3b8d"),i=n("d225"),a=n("b0b4"),o=n("308d"),s=n("6bb5"),c=n("4e2b"),u=(n("34ef"),n("28a5"),n("6b54"),n("9ab4")),l=n("60a3"),d=function(t){function e(){var t;return Object(i["a"])(this,e),t=Object(o["a"])(this,Object(s["a"])(e).apply(this,arguments)),t.tempInstalled=[],t.tempUninstalled=[],t.active=[],t.inactive=[],t}return Object(c["a"])(e,t),e}(l["d"]);d=Object(u["a"])([Object(l["a"])({})],d);var h=function(){function t(){Object(i["a"])(this,t),this.allowLQ=!0,this.isLocalRepoSupported=!1,this.isAutoLoadingSupported=!1,this.isBackgroundInstallingSupported=!1,this.vueState=new d,this.localRepositoryUrl=""}return Object(a["a"])(t,[{key:"saveToFile",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){var r,i,a,o,s=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=s.length>2&&void 0!==s[2]?s[2]:"image/png",i=s.length>3&&void 0!==s[3]?s[3]:1,a=document.createElement("a"),a.setAttribute("download",n),t.next=6,this.createObjectURL(e,r,i);case 6:return o=t.sent,a.setAttribute("href",o),document.body.appendChild(a),a.click(),document.body.removeChild(a),t.abrupt("return",o);case 12:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"installBackground",value:function(t){throw new Error("This environment does not support installing backgrounds")}},{key:"uninstallBackground",value:function(t){throw new Error("This environment does not support uninstalling backgrounds")}},{key:"localRepoAdd",value:function(t){throw new Error("This environment does not support a local repository")}},{key:"localRepoRemove",value:function(t){throw new Error("This environment does not support a local repository")}},{key:"autoLoadAdd",value:function(t){throw new Error("This environment does not support auto loading")}},{key:"autoLoadRemove",value:function(t){throw new Error("This environment does not support auto loading")}},{key:"prompt",value:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e){return new Promise((function(n,r){n(prompt(t,e))}))}))},{key:"onPanelChange",value:function(t){}},{key:"createObjectURL",value:function(t,e,n){var r=this;return new Promise((function(i,a){if(t.toBlob&&window.URL&&window.URL.createObjectURL)t.toBlob((function(t){t?i(URL.createObjectURL(t)):a()}),e,n);else if(window.URL&&window.URL.createObjectURL){var o=t.toDataURL(),s=r.dataURItoBlob(o,e);i(URL.createObjectURL(s))}else i(t.toDataURL())}))}},{key:"dataURItoBlob",value:function(t,e){for(var n=atob(t.split(",")[1]),r=n.length,i=new Uint8Array(r),a=0;a<r;a++)i[a]=n.charCodeAt(a);return new Blob([i],{type:e})}}]),t}(),p=function(t){function e(){return Object(i["a"])(this,e),Object(o["a"])(this,Object(s["a"])(e).apply(this,arguments))}return Object(c["a"])(e,t),Object(a["a"])(e,[{key:"saveToFile",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){var r,i,a,o,s=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=s.length>2&&void 0!==s[2]?s[2]:"image/png",i=s.length>3&&void 0!==s[3]?s[3]:1,a=e.toDataURL(r,i),o=this.dataURItoBlob(a,r),window.URL&&window.URL.createObjectURL&&(a=URL.createObjectURL(o)),window.navigator.msSaveBlob(o,n),t.abrupt("return",a);case 7:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()}]),e}(h),f=(n("f559"),n("5947")),b=n("0c0f"),v={packId:"dddg.buildin.installedBackgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},m=function(){function t(){var e=this;Object(i["a"])(this,t),this.allowLQ=!1,this.vueState=new d,this.localRepositoryUrl="/repo/repo.json",this.isBackgroundInstallingSupported=!0,this.isLocalRepoSupported=!0,this.isAutoLoadingSupported=!0,this.electron=window,this.promptCache={},this.lastPrompt=0,this.vuexHistory=null,this.$store=null,this.bgInvalidation=null,this.pendingContentPacks=[],this.electron.ipcRenderer.on("add-persistent-content-pack",function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n,i){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$store&&e.vuexHistory){t.next=3;break}return e.pendingContentPacks.push(i),t.abrupt("return");case 3:e.vuexHistory.transaction(Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("content/loadContentPacks",i);case 2:case"end":return t.stop()}}),t)}))));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),this.electron.ipcRenderer.on("add-persistent-background",function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n,r){var i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:i="persistentBg-"+r,a=r.split("/"),Object(f["f"])(i,r),v.backgrounds.push({id:i,variants:[[i]],label:a[a.length-1]}),e.invalidateInstalledBGs();case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),this.electron.ipcRenderer.on("push-message",function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:b["f"].fire(new b["d"](n));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),this.electron.ipcRenderer.on("prompt-answered",(function(t,n,r){e.promptCache[n](r)})),this.electron.ipcRenderer.on("update-ready",(function(t){})),this.electron.ipcRenderer.send("find-customs")}return Object(a["a"])(t,[{key:"localRepoAdd",value:function(t){console.log("installContentPack",t),this.electron.ipcRenderer.send("install-content-pack",t)}},{key:"localRepoRemove",value:function(t){console.log("uninstallContentPack",t),this.electron.ipcRenderer.send("uninstall-content-pack",t)}},{key:"autoLoadAdd",value:function(t){console.log("activateContentPack",t),this.electron.ipcRenderer.send("activate-content-pack",t)}},{key:"autoLoadRemove",value:function(t){console.log("deactivateContentPack",t),this.electron.ipcRenderer.send("deactivate-content-pack",t)}},{key:"saveToFile",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return new Promise((function(o,s){t.toBlob(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(r){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=3;break}return s(),t.abrupt("return");case 3:return t.next=5,r.arrayBuffer();case 5:i=t.sent,n.electron.ipcRenderer.send("save-file",e,new Uint8Array(i)),o(URL.createObjectURL(r));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),i,a)}))}},{key:"installBackground",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1===e.assets.length){t.next=2;break}return t.abrupt("return");case 2:if("dddg.buildin.uploadedBackgrounds"===e.assets[0].sourcePack){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,Object(f["b"])(e.assets[0].hq,!0);case 6:if(n=t.sent,n instanceof HTMLImageElement){t.next=9;break}return t.abrupt("return");case 9:return t.next=11,fetch(n.src);case 11:return r=t.sent,t.t0=Uint8Array,t.next=15,r.arrayBuffer();case 15:t.t1=t.sent,i=new t.t0(t.t1),this.electron.ipcRenderer.send("install-background",i);case 18:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"uninstallBackground",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r,i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1===e.assets.length){t.next=2;break}return t.abrupt("return");case 2:if("dddg.buildin.installedBackgrounds"===e.assets[0].sourcePack){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,Object(f["b"])(e.assets[0].hq,!0);case 6:if(n=t.sent,n instanceof HTMLImageElement){t.next=9;break}return t.abrupt("return");case 9:if(n.src.startsWith("blob:")){t.next=18;break}return t.next=12,fetch(n.src);case 12:return r=t.sent,t.next=15,r.blob();case 15:i=t.sent,a=URL.createObjectURL(i),Object(f["f"])(e.assets[0].hq,a);case 18:this.electron.ipcRenderer.send("uninstall-background",e.id);case 19:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"prompt",value:function(t,e){var n=this;return new Promise((function(r,i){n.promptCache[++n.lastPrompt]=r,n.electron.ipcRenderer.send("show-prompt",n.lastPrompt,t,e)}))}},{key:"onPanelChange",value:function(t){this.electron.ipcRenderer.on("open-panel",(function(e,n){t(n)}))}},{key:"connectToStore",value:function(t,e){var n=this;this.vuexHistory=t,this.$store=e,this.invalidateInstalledBGs(),this.pendingContentPacks.length>0&&this.vuexHistory.transaction(Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.$store.dispatch("content/loadContentPacks",n.pendingContentPacks);case 2:case"end":return t.stop()}}),t)}))))}},{key:"invalidateInstalledBGs",value:function(){var t=this;this.vuexHistory&&this.$store&&null===this.bgInvalidation&&(this.bgInvalidation=requestAnimationFrame((function(){t.updateInstalledBGs()})))}},{key:"updateInstalledBGs",value:function(){var t=this;this.bgInvalidation&&(cancelAnimationFrame(this.bgInvalidation),this.bgInvalidation=null),this.vuexHistory&&this.$store&&this.vuexHistory.transaction((function(){t.$store.dispatch("content/replaceContentPack",{contentPack:v})}))}}]),t}();function g(){return window.isElectron?new m:void 0!==window.navigator.msSaveOrOpenBlob?new p:new h}var y=g();window.toast=y;e["a"]=y},"0c0f":function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return c})),n.d(e,"d",(function(){return u})),n.d(e,"e",(function(){return l}));var r=n("d225"),i=n("2b0e"),a=new i["a"];e["f"]={fireCommand:function(t){a.$emit("command",t)},subscribeCommand:function(t){a.$on("command",t)},fire:function(t){a.$emit(t.kind,t)},subscribe:function(t,e){a.$on(t.kind,e)},unsubscribe:function(t,e){a.$off(t.kind,e)}};var o=function t(e){Object(r["a"])(this,t),this.path=e,this.kind="AssetFailureEvent"};o.kind="AssetFailureEvent";var s=function t(e){Object(r["a"])(this,t),this.error=e,this.kind="CustomAssetFailureEvent"};s.kind="CustomAssetFailureEvent";var c=function t(){Object(r["a"])(this,t),this.kind="InvalidateRenderEvent"};c.kind="InvalidateRenderEvent";var u=function t(e){Object(r["a"])(this,t),this.message=e,this.kind="ShowMessageEvent"};u.kind="ShowMessageEvent";var l=function t(e,n){Object(r["a"])(this,t),this.error=e,this.info=n,this.kind="VueErrorEvent"};l.kind="VueErrorEvent"},"182c":function(t,e,n){},"1a7b":function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));n("6762"),n("2fdb"),n("ac4d"),n("8a81"),n("ac6a"),n("5df3"),n("96cf");var r=n("3b8d"),i=n("d225"),a=n("b0b4"),o=n("5947"),s=n("fd0b"),c=n("ba37"),u=function(){function t(e,n){Object(i["a"])(this,t),this.obj=e,this.data=n,this.styleData={lastBase:"",components:{}},this.lq=!0,this.localRenderer=null,this.lastVersion=-1,this.hitDetectionFallback=!1}return Object(a["a"])(t,[{key:"updatedContent",value:function(t){this.data=Object(c["f"])(t,this.obj)}},{key:"updateLocalCanvas",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=Object(c["i"])(this.data,this.obj),this.localRenderer=new s["a"](e.size[0],e.size[1]),t.next=4,this.localRenderer.render(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(r){var i,a,o,s,u,d,h,p,f,b,v,m,g,y,k,x,j,w,O,C,_,P,S;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:i=Object(c["g"])(n.data,n.obj),a=[],o=!0,s=!1,u=void 0,t.prev=5,d=e.renderCommands[Symbol.iterator]();case 7:if(o=(h=d.next()).done){t.next=28;break}p=h.value,t.t0=p.type,t.next="head"===t.t0?12:"image"===t.t0?14:"pose-part"===t.t0?16:24;break;case 12:return a.push({offset:p.offset,composite:p.composite,assets:i?i.variants[n.obj.posePositions.head||0]:[]}),t.abrupt("break",24);case 14:return a.push({offset:p.offset,composite:p.composite,assets:p.images}),t.abrupt("break",24);case 16:if(f=e.positions[p.part],f&&0!==f.length){t.next=19;break}return t.abrupt("break",24);case 19:if(b=f[n.obj.posePositions[p.part]||0],b){t.next=22;break}return t.abrupt("break",24);case 22:return a.push({offset:p.offset,composite:p.composite,assets:b}),t.abrupt("break",24);case 24:console.log(p,JSON.stringify(a));case 25:o=!0,t.next=7;break;case 28:t.next=34;break;case 30:t.prev=30,t.t1=t["catch"](5),s=!0,u=t.t1;case 34:t.prev=34,t.prev=35,o||null==d.return||d.return();case 37:if(t.prev=37,!s){t.next=40;break}throw u;case 40:return t.finish(37);case 41:return t.finish(34);case 42:return t.next=44,Promise.all(a.filter((function(t){return t.assets})).map((function(t){return l(t,r.hq)})));case 44:v=t.sent,m=!0,g=!1,y=void 0,t.prev=48,k=v[Symbol.iterator]();case 50:if(m=(x=k.next()).done){t.next=74;break}for(j=x.value,w=!0,O=!1,C=void 0,t.prev=55,_=j.assets[Symbol.iterator]();!(w=(P=_.next()).done);w=!0)S=P.value,r.drawImage({image:S,composite:j.composite,x:j.offset[0],y:j.offset[1]});t.next=63;break;case 59:t.prev=59,t.t2=t["catch"](55),O=!0,C=t.t2;case 63:t.prev=63,t.prev=64,w||null==_.return||_.return();case 66:if(t.prev=66,!O){t.next=69;break}throw C;case 69:return t.finish(66);case 70:return t.finish(63);case 71:m=!0,t.next=50;break;case 74:t.next=80;break;case 76:t.prev=76,t.t3=t["catch"](48),g=!0,y=t.t3;case 80:t.prev=80,t.prev=81,m||null==k.return||k.return();case 83:if(t.prev=83,!g){t.next=86;break}throw y;case 86:return t.finish(83);case 87:return t.finish(80);case 88:n.lastVersion=n.obj.version;case 89:case"end":return t.stop()}}),t,null,[[5,30,34,42],[35,,37,41],[48,76,80,88],[55,59,63,71],[64,,66,70],[81,,83,87]])})));return function(e){return t.apply(this,arguments)}}());case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"render",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){var r,i,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(null!==this.localRenderer&&this.lastVersion===this.obj.version&&this.lq===!n.hq){t.next=3;break}return t.next=3,this.updateLocalCanvas();case 3:r=this.width,i=this.height,a=this.x-r/2,o=this.y,n.drawImage({image:this.localRenderer,x:a,y:o,w:r,h:i,flip:this.obj.flip,shadow:e&&n.preview?{blur:20,color:"red"}:void 0,opacity:this.obj.opacity});case 8:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"hitTest",value:function(t,e){if(!this.localRenderer)return!1;var n=t-(this.x-this.width/2),r=e-this.y;if(n<0||n>this.width)return!1;if(r<0||r>this.height)return!1;if(!this.hitDetectionFallback)try{var i=this.obj.flip?this.width-n:n,a=this.localRenderer.width/this.width,o=this.localRenderer.height/this.height,s=this.localRenderer.getDataAt(Math.round(i*a),Math.round(r*o));return 0!==s[3]}catch(c){if(!(c instanceof DOMException&&c.message.includes("cross-origin")))throw c;this.hitDetectionFallback=!0}return!0}},{key:"getHitbox",value:function(){return{x0:this.x-this.width/2,x1:this.x+this.width/2,y0:this.y,y1:this.y+this.height}}},{key:"id",get:function(){return this.obj.id}},{key:"width",get:function(){var t=this.obj.close?2:1;return this.obj.width*t}},{key:"height",get:function(){var t=this.obj.close?2:1;return this.obj.height*t}},{key:"x",get:function(){return this.obj.x}},{key:"y",get:function(){return(this.obj.close?c["a"]:0)+this.obj.y}}]),t}();function l(t,e){return d.apply(this,arguments)}function d(){return d=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.t0=e.offset,t.next=3,Promise.all(e.assets.map((function(t){return Object(o["a"])(t,n)})));case 3:return t.t1=t.sent,t.t2=e.composite,t.abrupt("return",{offset:t.t0,assets:t.t1,composite:t.t2});case 6:case"end":return t.stop()}}),t)}))),d.apply(this,arguments)}},"1ac6":function(t,e,n){"use strict";var r=n("7ab2"),i=n.n(r);i.a},"1eb6":function(t,e,n){"use strict";var r=n("f2ed"),i=n.n(r);i.a},"20cf":function(t,e,n){},2748:function(t,e,n){},2823:function(t,e,n){},"2bb5":function(t,e,n){},"36ee":function(t,e,n){},"456a":function(t,e,n){"use strict";var r=n("182c"),i=n.n(r);i.a},"48ab":function(t,e,n){"use strict";var r=n("db62"),i=n.n(r);i.a},"4a58":function(t,e,n){"use strict";var r=n("36ee"),i=n.n(r);i.a},5721:function(t,e,n){},5947:function(t,e,n){"use strict";n.d(e,"d",(function(){return c})),n.d(e,"a",(function(){return d})),n.d(e,"c",(function(){return p})),n.d(e,"b",(function(){return v})),n.d(e,"e",(function(){return g})),n.d(e,"f",(function(){return y}));n("a481"),n("96cf");var r,i=n("3b8d"),a=n("0c0f"),o=n("9be5"),s=n("032b");function c(){return r||(r=new Promise((function(t,e){var n="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=",r=document.createElement("img");r.addEventListener("load",(function(){t(2===r.width&&1===r.height)})),r.addEventListener("error",(function(){t(!1)})),r.src=n}))),r}var u={},l={};function d(t){return h.apply(this,arguments)}function h(){return h=Object(i["a"])(regeneratorRuntime.mark((function t(e){var n,r=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=!(r.length>1&&void 0!==r[1])||r[1],t.abrupt("return",p(s["a"].allowLQ&&!n?e.lq:e.hq));case 2:case"end":return t.stop()}}),t)}))),h.apply(this,arguments)}function p(t){return f.apply(this,arguments)}function f(){return f=Object(i["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return u[e]||(u[e]=new Promise((function(t,n){var r=new Image;r.addEventListener("load",(function(){t(r)})),r.addEventListener("error",(function(){a["f"].fire(new a["a"](e)),u[e]=void 0,t(new o["a"])})),r.crossOrigin="Anonymous",r.src=e,r.style.display="none",document.body.appendChild(r)}))),t.abrupt("return",u[e]);case 2:case"end":return t.stop()}}),t)}))),f.apply(this,arguments)}var b=".";function v(t){return m.apply(this,arguments)}function m(){return m=Object(i["a"])(regeneratorRuntime.mark((function t(e){var n,r,i=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=!(i.length>1&&void 0!==i[1])||i[1],!l[e]){t.next=3;break}return t.abrupt("return",l[e]);case 3:return t.t0="".concat(b,"/assets/").concat(e).concat(n?"":".lq"),t.next=6,c();case 6:if(!t.sent){t.next=10;break}t.t1=".webp",t.next=11;break;case 10:t.t1=".png";case 11:return t.t2=t.t1,r=t.t0.concat.call(t.t0,t.t2).replace(/\/+/,"/"),t.abrupt("return",p(r));case 14:case"end":return t.stop()}}),t)}))),m.apply(this,arguments)}function g(t,e){var n=URL.createObjectURL(e);return l[t]=new Promise((function(t,e){var r=new Image;r.addEventListener("load",(function(){t(r)})),r.addEventListener("error",(function(t){a["f"].fire(new a["b"](t)),e('Failed to load "'.concat(n,'"'))})),r.crossOrigin="Anonymous",r.src=n,r.style.display="none",document.body.appendChild(r)})),n}function y(t,e){return l[t]=new Promise((function(t,n){var r=new Image;r.addEventListener("load",(function(){t(r)})),r.addEventListener("error",(function(t){a["f"].fire(new a["b"](t)),n('Failed to load "'.concat(e,'"'))})),r.crossOrigin="Anonymous",r.src=e,r.style.display="none",document.body.appendChild(r)}))}},"5b67":function(t,e,n){"use strict";var r=n("9340"),i=n.n(r);i.a},"5c0b":function(t,e,n){"use strict";var r=n("9c0c"),i=n.n(r);i.a},6146:function(t,e,n){},"61ea":function(t,e,n){"use strict";function r(t){throw new Error('Unexpected value "'.concat(t,'"'))}n.d(e,"a",(function(){return r}))},6452:function(t,e,n){"use strict";var r=n("2748"),i=n.n(r);i.a},"65ef":function(t,e,n){"use strict";var r=n("e0c7"),i=n.n(r);i.a},"69a0":function(t,e,n){},"6ae4":function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));n("8e6e"),n("ac6a"),n("456d"),n("6c7b");var r=n("bd86"),i=n("d225"),a=n("b0b4"),o=n("73e5"),s=n("fd0b"),c=n("9be5");function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var d=100,h=function(){function t(e,n,r){Object(i["a"])(this,t),this.fsCtx=e,this.hq=n,this.preview=r,this.aborted=!1}return Object(a["a"])(t,[{key:"drawText",value:function(t){if(this.aborted)throw new o["a"];this.fsCtx.save();var e=l({},{font:"20px aller",align:"left"},{},t),n=e.font,r=e.align,i=e.x,a=void 0===i?0:i,s=e.y,c=void 0===s?0:s,u=e.text,d=void 0===u?"":u;this.fsCtx.lineJoin="round",this.fsCtx.textAlign=r,this.fsCtx.font=n,t.outline&&(this.fsCtx.strokeStyle=t.outline.style,this.fsCtx.lineWidth=t.outline.width,this.fsCtx.strokeText(d,a,c)),t.fill&&(this.fsCtx.fillStyle=t.fill.style,this.fsCtx.fillText(d,a,c)),this.fsCtx.restore()}},{key:"measureText",value:function(t){if(this.aborted)throw new o["a"];this.fsCtx.save();var e=l({},{font:"20px aller",align:"left"},{},t),n=e.font,r=e.align,i=e.text,a=void 0===i?"":i;this.fsCtx.lineJoin="round",this.fsCtx.textAlign=r,this.fsCtx.font=n,t.outline&&(this.fsCtx.strokeStyle=t.outline.style,this.fsCtx.lineWidth=t.outline.width),t.fill&&(this.fsCtx.fillStyle=t.fill.style);var s=this.fsCtx.measureText(a);return this.fsCtx.restore(),s}},{key:"drawImage",value:function(t){if(this.aborted)throw new o["a"];if(!(t.image instanceof c["a"])){var e=l({flip:!1,w:t.image.width,h:t.image.height,opacity:100},t),n=e.image,r=e.flip,i=e.x,a=e.y,u=e.w,h=e.h,p=e.opacity;if(this.fsCtx.save(),p<d&&(this.fsCtx.globalAlpha=p/d),t.shadow){var f=t.shadow;f.color&&(this.fsCtx.shadowColor=f.color),f.blur&&(this.fsCtx.shadowBlur=f.blur),f.offsetX&&(this.fsCtx.shadowOffsetX=f.offsetX),f.offsetY&&(this.fsCtx.shadowOffsetY=f.offsetY)}this.fsCtx.translate(i+u/2,a+h/2),this.fsCtx.scale(r?-1:1,1),t.composite&&(this.fsCtx.globalCompositeOperation=t.composite),n instanceof s["a"]?n.paintOnto(this.fsCtx,-u/2,-h/2,u,h):this.fsCtx.drawImage(n,-u/2,-h/2,u,h),this.fsCtx.restore()}}},{key:"drawRect",value:function(t){var e=t.x,n=t.y,r=t.w,i=t.h,a=t.outline,s=t.fill,c=t.composition;if(this.aborted)throw new o["a"];this.fsCtx.save(),this.fsCtx.beginPath(),this.fsCtx.rect(e,n,r,i),c&&(this.fsCtx.globalCompositeOperation=c),s&&(this.fsCtx.fillStyle=s.style,this.fsCtx.fill()),a&&(this.fsCtx.strokeStyle=a.style,this.fsCtx.lineWidth=a.width,this.fsCtx.stroke()),this.fsCtx.restore()}},{key:"drawPath",value:function(t){var e=t.outline,n=t.fill,r=t.path;if(this.aborted)throw new o["a"];this.fsCtx.save(),this.fsCtx.beginPath(),r(this.fsCtx),n&&(this.fsCtx.fillStyle=n.style,this.fsCtx.fill()),e&&(this.fsCtx.strokeStyle=e.style,this.fsCtx.lineWidth=e.width,this.fsCtx.stroke()),this.fsCtx.restore()}},{key:"patternFrom",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"repeat";return t instanceof s["a"]&&(t=t.previewCanvas),this.fsCtx.createPattern(t,e)}},{key:"customTransform",value:function(t,e){this.fsCtx.save(),t(this.fsCtx),e(this),this.fsCtx.restore()}},{key:"linearGradient",value:function(t,e,n,r){return this.fsCtx.createLinearGradient(t,e,n,r)}},{key:"abort",value:function(){this.aborted=!0}}]),t}()},"6fbc":function(t,e,n){"use strict";var r=n("dd4f"),i=n.n(r);i.a},"73e5":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("d225"),i=function t(){Object(r["a"])(this,t)}},"76d0":function(t,e,n){},"7ab2":function(t,e,n){},"7ec3":function(t,e,n){"use strict";var r=n("69a0"),i=n.n(r);i.a},8343:function(t,e,n){"use strict";var r=n("fc22"),i=n.n(r);i.a},8554:function(t,e,n){"use strict";var r=n("b0ac"),i=n.n(r);i.a},"86b7":function(t,e,n){"use strict";var r=n("a956"),i=n.n(r);i.a},"8c75":function(t,e,n){},9207:function(t,e,n){"use strict";var r=n("b95e"),i=n.n(r);i.a},9340:function(t,e,n){},9716:function(t,e,n){},9765:function(t,e,n){"use strict";var r=n("6146"),i=n.n(r);i.a},"99a1":function(t,e,n){"use strict";var r=n("20cf"),i=n.n(r);i.a},"9ba6":function(t,e,n){"use strict";var r=n("9716"),i=n.n(r);i.a},"9be5":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("d225"),i=function t(){Object(r["a"])(this,t)}},"9c0c":function(t,e,n){},a505:function(t,e,n){},a5bf:function(t,e,n){"use strict";var r=n("5721"),i=n.n(r);i.a},a6a9:function(t,e,n){"use strict";var r=n("8c75"),i=n.n(r);i.a},a73b:function(t,e,n){},a838:function(t,e,n){"use strict";var r=n("a73b"),i=n.n(r);i.a},a956:function(t,e,n){},b0ac:function(t,e,n){},b43e:function(t,e,n){"use strict";var r=n("a505"),i=n.n(r);i.a},b883:function(t,e,n){"use strict";var r=n("2823"),i=n.n(r);i.a},b95e:function(t,e,n){},ba37:function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"c",(function(){return h})),n.d(e,"f",(function(){return p})),n.d(e,"i",(function(){return b})),n.d(e,"h",(function(){return v})),n.d(e,"g",(function(){return m})),n.d(e,"d",(function(){return g})),n.d(e,"b",(function(){return k})),n.d(e,"e",(function(){return x}));n("7514"),n("96cf"),n("8e6e");var r=n("3b8d"),i=(n("20d6"),n("55dd"),n("ac6a"),n("456d"),n("75fc")),a=n("bd86"),o=n("fec4"),s=n("c837");function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){Object(a["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var l=-74,d=-26,h={setPose:function(t,e){var n=t.objects[e.id];n.poseId=e.poseId,++n.version},setCharStyleGroup:function(t,e){var n=e.id,r=e.styleGroupId,i=t.objects[n];i.styleGroupId=r,++i.version},setCharStyle:function(t,e){var n=e.id,r=e.styleId,i=t.objects[n];i.styleId=r,++i.version},setPosePosition:function(t,e){var n=t.objects[e.id];n.posePositions=u({},n.posePositions,{},e.posePositions),++n.version},setClose:function(t,e){var n=t.objects[e.id];n.close=e.close,++n.version},setFreeMove:function(t,e){var n=t.objects[e.id];n.freeMove=e.freeMove,n.freeMove||(n.x=o["a"][g(n.x)],n.y=d)}};function p(t,e){var n=t.getters["content/getCharacters"];return n.get(e.characterType)}function f(t,e){var n=t["content/getCharacters"];return n.get(e.characterType)}function b(t,e){return t.styleGroups[e.styleGroupId].styles[e.styleId].poses[e.poseId]}function v(t,e){var n=b(t,e),r=Object(i["a"])(Object.keys(n.positions).filter((function(t){return n.positions[t].length>1})));return n.compatibleHeads.length>0&&r.unshift("head"),r}function m(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.posePositions.headType||0,r=b(t,e).compatibleHeads;if(!r||0===r.length)return null;var i=t.heads[r[n]];return i}function g(t){var e=o["a"].map((function(e,n){return{pos:Math.abs(t-e),idx:n}})).sort((function(t,e){return t.pos-e.pos}));return e[0].idx}var y=0,k={createCharacters:function(t,e){var n=t.rootState,r=t.commit;r("create",{object:{flip:!1,id:"characters_"+ ++y,panelId:n.panels.currentPanel,onTop:!1,opacity:100,type:"character",x:640,y:d,preserveRatio:!0,ratio:1,height:768,width:768,characterType:e.characterType,close:!1,freeMove:!1,version:0,poseId:0,styleId:0,styleGroupId:0,posePositions:{}}})},seekPart:function(t,e){var n=t.state,r=t.commit,i=t.dispatch,o=t.rootGetters,c=e.delta,u=e.id,l=e.part;if("head"!==l){var d=n.objects[u],h=b(f(o,d),d);h.positions[l]&&r("setPosePosition",{id:u,posePositions:Object(a["a"])({},l,Object(s["a"])(h.positions[l],d.posePositions[l]||0,c))})}else i("seekHead",{id:u,delta:c})},seekPose:function(t,e){var n=t.state,r=t.commit,i=t.rootGetters,a=e.id,o=e.delta,c=n.objects[a],u=f(i,c),l=u.styleGroups[c.styleGroupId].styles[c.styleId].poses;C(r,c,u,(function(t){t.poseId=Object(s["a"])(l,t.poseId,o)}))},seekStyle:function(t,e){var n=t.state,r=t.commit,i=t.rootGetters,a=e.id,o=e.delta,c=n.objects[a],u=f(i,c),l=u.styleGroups.flatMap((function(t,e){return t.styles.map((function(t,n){return{styleGroupIdx:e,styleIdx:n,styleGroupJson:JSON.stringify(t.components)}}))})).sort((function(t,e){return t.styleGroupJson.localeCompare(e.styleGroupJson)})),d=l.findIndex((function(t){return t.styleGroupIdx===c.styleGroupId&&t.styleIdx===c.styleId}));C(r,c,u,(function(t){var e=Object(s["a"])(l,d,o),n=l[e];t.styleGroupId=n.styleGroupIdx,t.styleId=n.styleIdx}))},seekHead:function(t,e){var n=t.state,r=t.commit,i=t.rootGetters,a=e.id,o=e.delta,c=n.objects[a],u=f(i,c),l=b(u,c),d=m(u,c);if(d){var h=(c.posePositions.head||0)+o,p=c.posePositions.headType||0;(h<0||h>=d.variants.length)&&(p=Object(s["a"])(l.compatibleHeads.map((function(t){return u.heads[t]})),p,o),d=m(u,c,p),h=1===o?0:d.variants.length-1),r("setPosePosition",{id:a,posePositions:{head:h,headType:p}})}},setPart:function(t,e){var n=t.state,r=t.commit,i=t.rootGetters,a=e.id,o=e.part,s=e.val,c=n.objects[a],u=f(i,c);C(r,c,u,"pose"===o?function(t){t.poseId=s}:"style"===o?function(t){t.styleId=s}:function(t){t.posePositions[o]=s})},setCharStyle:function(t,e){var n=t.state,r=t.commit,i=t.rootGetters,a=e.id,o=e.styleGroupId,s=e.styleId,c=n.objects[a],u=f(i,c);C(r,c,u,(function(t){t.styleGroupId=o,t.styleId=s}))},setCharacterPosition:function(t,e){var n=t.state,r=t.commit,i=e.id,a=e.x,s=e.y,c=n.objects[i];c.freeMove?r("setPosition",{id:i,x:a,y:s}):r("setPosition",{id:i,x:o["a"][g(a)],y:d+(c.close?l:0)})},shiftCharacterSlot:function(t,e){var n=t.state,r=t.commit,i=e.id,a=e.delta,s=n.objects[i],c=g(s.x),u=c+a;u<0&&(u=0),u>=o["a"].length&&(u=o["a"].length-1),r("setPosition",{id:i,x:o["a"][u],y:s.y})}};function x(t,e,n){return j.apply(this,arguments)}function j(){return j=Object(r["a"])(regeneratorRuntime.mark((function t(e,n,r){var i,a,o,s,c,u,l,d,h,p,f,b,v,m,g,y,k,x,j,C,_,P;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i=e.state.objects[n],a=r.characters.find((function(t){return t.id===i.characterType})),a){t.next=6;break}return console.error("Character data is missing. Dropping the character."),e.dispatch("removeObject",{id:n}),t.abrupt("return");case 6:if(o=w(i),s=a.styleGroups[i.styleGroupId],c=s.styles[o.styleId],u=c.poses[o.poseId],l=e.rootState.content.current.characters.find((function(t){return t.id===a.id})),l){t.next=15;break}return console.error("Character data is missing. Dropping the character."),e.dispatch("removeObject",{id:n}),t.abrupt("return");case 15:d=l.styleGroups.findIndex((function(t){return t.id===s.id})),o.styleGroupId=-1===d?0:d,h=l.styleGroups[o.styleGroupId],p=JSON.stringify(c.components),f=h.styles.findIndex((function(t){return JSON.stringify(t.components)===p})),o.styleId=-1===f?0:f,b=h.styles[o.styleId],v=b.poses.findIndex((function(t){return t.id===u.id})),o.poseId=-1===v?0:v,m=b.poses[o.poseId],g={},t.t0=regeneratorRuntime.keys(m.positions);case 27:if((t.t1=t.t0()).done){t.next=35;break}if(y=t.t1.value,m.positions.hasOwnProperty(y)){t.next=31;break}return t.abrupt("continue",27);case 31:k=m.positions[y],u.positions[y]?(x=o.posePositions[y],x>=0&&x<k.length?g[y]=x:g[y]=0):g[y]=0,t.next=27;break;case 35:j=u.compatibleHeads[i.posePositions.headType],C=m.compatibleHeads.indexOf(j),-1===C?(o.posePositions.headType=0,o.posePositions.head=0):(C!==i.posePositions.headType&&(o.posePositions.headType=C),_=JSON.stringify(a.heads[j].variants[i.posePositions.head]),P=l.heads[j].variants.findIndex((function(t){return JSON.stringify(t)===_})),o.posePositions.head=-1===P?0:P),O(e.commit,i,o);case 39:case"end":return t.stop()}}),t)}))),j.apply(this,arguments)}function w(t){return{styleGroupId:t.styleGroupId,styleId:t.styleId,poseId:t.poseId,posePositions:u({},t.posePositions)}}function O(t,e,n){n.styleGroupId!==e.styleGroupId&&t("setCharStyleGroup",{id:e.id,styleGroupId:n.styleGroupId}),n.styleId!==e.styleId&&(console.log("Setting style of ".concat(e.id," to ").concat(n.styleId)),t("setCharStyle",{id:e.id,styleId:n.styleId})),n.poseId!==e.poseId&&t("setPose",{id:e.id,poseId:n.poseId}),JSON.stringify(n.posePositions)!==JSON.stringify(e.posePositions)&&t("setPosePosition",{id:e.id,posePositions:n.posePositions})}function C(t,e,n,r){var i=w(e);r(i),n.styleGroups[i.styleGroupId]||(i.styleGroupId=0);var a=n.styleGroups[i.styleGroupId];a.styles[i.styleId]||(i.styleId=0);var o=a.styles[i.styleId];o.poses[i.poseId]||(i.poseId=0);var s=o.poses[i.poseId];for(var c in s.positions)s.positions[c]&&(s.positions[c][i.posePositions[c]]||(i.posePositions[c]=0));var u=n.styleGroups[e.styleGroupId].styles[e.styleId].poses[e.poseId],l=u.compatibleHeads[e.posePositions.headType||0],d=s.compatibleHeads.indexOf(l);d>=0?i.posePositions.headType=d:(i.posePositions.headType=0,i.posePositions.head=0),O(t,e,i)}},bd46:function(t,e,n){},c4e5:function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("input",{ref:"checkbox",attrs:{id:t._uid,type:"checkbox"},domProps:{checked:t.value},on:{change:t.onChange}}),n("label",{staticClass:"switch",attrs:{for:t._uid}}),n("label",{attrs:{for:t._uid}},[t._v(t._s(t.label))])])},i=[],a=n("d225"),o=n("b0b4"),s=n("308d"),c=n("6bb5"),u=n("4e2b"),l=n("9ab4"),d=n("60a3"),h=function(t){function e(){return Object(a["a"])(this,e),Object(s["a"])(this,Object(c["a"])(e).apply(this,arguments))}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"onChange",value:function(t){this.$emit("input",!!this.$refs.checkbox.checked)}},{key:"checkbox",get:function(){return this.$refs.checkbox}}]),e}(d["d"]);Object(l["a"])([Object(d["c"])({type:String})],h.prototype,"label",void 0),Object(l["a"])([Object(d["c"])({type:Boolean,default:!1})],h.prototype,"value",void 0),h=Object(l["a"])([Object(d["a"])({components:{}})],h);var p=h,f=p,b=(n("65ef"),n("2877")),v=Object(b["a"])(f,r,i,!1,null,"7bd0fd86",null);e["a"]=v.exports},c769:function(t,e,n){},c837:function(t,e,n){"use strict";function r(t,e,n){var r=e+n,i=t.length;return r<0&&(r+=i),r>=i&&(r-=i),r}n.d(e,"a",(function(){return r}))},cd49:function(t,e,n){"use strict";n.r(e);n("8e6e"),n("ac6a"),n("456d");var r=n("bd86"),i=(n("cadf"),n("551c"),n("f751"),n("097d"),n("2b0e")),a=n("2f62"),o=(n("ac4d"),n("8a81"),n("7f7f"),n("28a5"),n("7618")),s=(n("96cf"),n("3b8d")),c=(n("7514"),{install:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t._installedPlugins.find((function(t){return t.Store})))throw new Error("VuexUndoRedo plugin must be installed after the Vuex plugin.");e.resetStateMutation||(e.resetStateMutation="emptyState"),e.mutations||(e.mutations={});var n=new t({data:function(){return{done:[],undone:[],newMutation:!0,ignoreMutations:e.ignoreMutations||[],currentTransaction:null,transactionQueue:[],initialized:!1}},created:function(){window.historyStuff=this},methods:{initialize:function(t){var n=this;this.$store||(this.$store=t),this.$store&&(this.initialized||(this.initialized=!0,this.$store.subscribe((function(t){var r=function(){t.type===e.resetStateMutation||d(t.type).ignore(t)||(n.currentTransaction.push(t),n.newMutation&&(n.undone=[]))};n.currentTransaction?r():n.transaction((function(){r()}))}))))},redo:function(){if(!(this.undone.length<=0)){var t=this.undone.pop();this.newMutation=!1,a(this,t),this.newMutation=!0}},undo:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(this.done.length<=0)){t.next=2;break}return t.abrupt("return");case 2:return this.undone.push(this.done.pop()),this.newMutation=!1,t.next=6,r(this);case 6:this.newMutation=!0;case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),transaction:function(t){var e=this;return new Promise((function(n,r){var i=function(){var r=Object(s["a"])(regeneratorRuntime.mark((function r(){var i,a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.currentTransaction=[],r.prev=1,r.next=4,t();case 4:r.next=9;break;case 6:r.prev=6,r.t0=r["catch"](1),console.log("Error during transaction!: ",r.t0);case 9:i=e.done[e.done.length-1],1===e.currentTransaction.length&&i&&1===i.length&&(a=d(e.currentTransaction[0].type),a.combinable(i[0],e.currentTransaction[0])&&(o=a.combinator(i[0],e.currentTransaction[0]),e.done.pop(),e.currentTransaction=o?[o]:[])),e.currentTransaction.length>0&&e.done.push(e.currentTransaction),e.currentTransaction=null,e.transactionQueue.length>0&&e.transactionQueue.pop()(),n();case 15:case"end":return r.stop()}}),r,null,[[1,6]])})));return function(){return r.apply(this,arguments)}}();e.currentTransaction?e.transactionQueue.push(i):i()}))}}});function r(t){return i.apply(this,arguments)}function i(){return i=Object(s["a"])(regeneratorRuntime.mark((function t(n){var r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=n.done.slice(0),n.done=[],n.$store.commit(e.resetStateMutation),i=0;case 4:if(!(i<r.length)){t.next=10;break}return t.next=7,a(n,r[i]);case 7:++i,t.next=4;break;case 10:case"end":return t.stop()}}),t)}))),i.apply(this,arguments)}function a(t,e){return c.apply(this,arguments)}function c(){return c=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.transaction((function(){n.forEach((function(t){u(e,t)}))}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),c.apply(this,arguments)}function u(t,e){switch(Object(o["a"])(e.payload)){case"object":var n={};e.payload instanceof Array&&(n=[]),t.$store.commit("".concat(e.type),Object.assign(n,e.payload));break;default:t.$store.commit("".concat(e.type),e.payload)}}t.mixin({computed:{vuexHistory:function(){return n}},created:function(){n.initialize(this.$store)}});var l={};function d(t){if(!l[t]){var n=t.split("/"),r={ignore:function(t){return!1},combinable:function(t,e){return!1},combinator:function(t,e){return e}},i="",a=!0,o=!1,s=void 0;try{for(var c,u=n[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var d=c.value;e.mutations[i+"*"]&&Object.assign(r,e.mutations[i+"*"]),i+=d+"/"}}catch(h){o=!0,s=h}finally{try{a||null==u.return||u.return()}finally{if(o)throw s}}e.mutations[t]&&Object.assign(r,e.mutations[t]),l[t]=r}return l[t]}}}),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("div",{attrs:{id:"container"}},[n("render",{ref:"render",attrs:{canvasWidth:t.canvasWidth,canvasHeight:t.canvasHeight}})],1),n("message-console"),n("tool-box",{on:{"show-prev-render":t.drawLastDownload,download:function(e){return t.$refs.render.download()},"show-dialog":t.showDialog,"show-expression-dialog":t.showExpressionDialog}}),n("keep-alive",[t.dialogVisable?n("modal-dialog",{ref:"dialog",on:{leave:function(e){t.dialogVisable=!1}}},[n("single-box",{ref:"packDialog",on:{leave:function(e){t.dialogVisable=!1}}})],1):t._e()],1),t.expressionBuilderVisible?n("modal-dialog",{ref:"dialog",on:{leave:function(e){t.expressionBuilderVisible=!1}}},[n("expression-builder",{attrs:{character:t.expressionBuilderCharacter,initHeadGroup:t.expressionBuilderHeadGroup},on:{leave:function(e){t.expressionBuilderVisible=!1}}})],1):t._e()],1)},l=[],d=n("768b"),h=n("d225"),p=n("b0b4"),f=n("308d"),b=n("6bb5"),v=n("4e2b"),m=n("9ab4"),g=n("60a3"),y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{vertical:t.vertical},attrs:{id:"panels"}},[n("div",{attrs:{id:"toolbar"}},[n("button",{class:{active:"add"===t.panel},attrs:{title:"Add new objects to the scene"},on:{click:function(e){return t.setPanel("add")}}},[n("i",{staticClass:"material-icons"},[t._v("add_box")])]),n("button",{class:{active:"backgrounds"===t.panel},attrs:{title:"Change the current background"},on:{click:function(e){return t.setPanel("backgrounds")}}},[n("i",{staticClass:"material-icons"},[t._v("panorama")])]),n("button",{class:{active:"panels"===t.panel},attrs:{title:"Panels"},on:{click:function(e){return t.setPanel("panels")}}},[n("i",{staticClass:"material-icons"},[t._v("view_module")])]),n("button",{class:{active:"settings"===t.panel},attrs:{title:"Settings"},on:{click:function(e){return t.setPanel("settings")}}},[n("i",{staticClass:"material-icons"},[t._v("settings_applications")])])]),"settings"===t.panel?n("settings-panel"):"packs"===t.panel?n("content-packs-panel"):"backgrounds"===t.panel?n("backgrounds-panel",{on:{"show-dialog":function(e){return t.$emit("show-dialog",e)}}}):"help_credits"===t.panel?n("credits-panel"):"character"===t.panel?n("character-panel",{on:{"show-dialog":function(e){return t.$emit("show-dialog",e)},"show-expression-dialog":function(e){return t.$emit("show-expression-dialog",e)}}}):"sprite"===t.panel?n("sprite-panel"):"textBox"===t.panel?n("text-box-panel"):"choice"===t.panel?n("choice-panel"):"panels"===t.panel?n("panels-panel"):"notification"===t.panel?n("notification-panel"):"poem"===t.panel?n("poem-panel"):n("add-panel",{on:{"show-dialog":function(e){return t.$emit("show-dialog",e)}}}),n("div",{attrs:{id:"toolbar-end"}},[n("button",{class:{active:"help_credits"===t.panel},attrs:{title:"Help & Credits"},on:{click:function(e){return t.setPanel("help_credits")}}},[n("i",{staticClass:"material-icons"},[t._v("help")])]),n("button",{class:{active:"packs"===t.panel},attrs:{title:"Content packs"},on:{click:function(e){return t.$emit("show-dialog")}}},[n("i",{staticClass:"material-icons"},[t._v("extension")])]),n("button",{attrs:{title:"Show last downloaded panel",disabled:!t.hasPrevRender},on:{click:function(e){return t.$emit("show-prev-render")}}},[n("i",{staticClass:"material-icons"},[t._v("flip_to_back")])]),n("button",{attrs:{title:"Take a screenshot of the current scene"},on:{click:function(e){return t.$emit("download")}}},[n("i",{staticClass:"material-icons"},[t._v("photo_camera")])])])],1)},k=[],x=n("2298"),j=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"panel"},[n("h1",[t._v("Settings")]),t.lqAllowed?n("toggle",{attrs:{label:"Low quality preview?",title:"Reduces the quality of the preview images to speed up the user experience and consume less data. Does not effect final render."},model:{value:t.lqRendering,callback:function(e){t.lqRendering=e},expression:"lqRendering"}}):t._e(),n("toggle",{attrs:{label:"NSFW Mode?"},model:{value:t.nsfw,callback:function(e){t.nsfw=e},expression:"nsfw"}})],1)},w=[],O=(n("8615"),n("5df3"),n("4f7f"),n("c4e5")),C=25,_=function(t){function e(){return Object(h["a"])(this,e),Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"mounted",value:function(){this.updateVertical(),this.$el.addEventListener("wheel",(function(t){if("wheel"===t.type&&t.currentTarget){var e=t.currentTarget;if(!e.classList.contains("vertical")){var n=t;0!==n.deltaY&&(n.mozInputSource?e.scrollLeft+=n.deltaY*C:e.scrollLeft+=n.deltaY)}}}),{passive:!0})}},{key:"updateVertical",value:function(){this.$el&&(this.vertical?this.$el.classList.add("vertical"):this.$el.classList.remove("vertical"))}}]),e}(g["d"]);Object(m["a"])([Object(x["a"])("vertical",{namespace:"ui"})],_.prototype,"vertical",void 0),Object(m["a"])([Object(g["e"])("vertical")],_.prototype,"updateVertical",null),_=Object(m["a"])([Object(g["a"])({})],_);var P=n("032b"),S={"dddg.buildin.backgrounds.nsfw":"".concat("","packs/buildin.base.backgrounds.nsfw.json"),"dddg.buildin.sayori.nsfw":"".concat("","packs/buildin.base.sayori.nsfw.json"),"dddg.buildin.base.natsuki.nsfw":"".concat("","packs/buildin.base.natsuki.nsfw.json"),"dddg.buildin.yuri.nsfw":"".concat("","packs/buildin.base.yuri.nsfw.json")},R=new Set(Object.keys(S)),T=Object.values(S),I=function(t){function e(){return Object(h["a"])(this,e),Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"lqRendering",get:function(){return this.$store.state.ui.lqRendering},set:function(t){var e=this;this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$store.commit("ui/setLqRendering",t);case 2:case"end":return n.stop()}}),n)}))))}},{key:"lqAllowed",get:function(){return P["a"].allowLQ}},{key:"nsfw",get:function(){return!!this.$store.state.content.contentPacks.map((function(t){return t.packId})).filter((function(t){return!!t})).find((function(t){return R.has(t)}))},set:function(t){var e=this;this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t){n.next=5;break}return n.next=3,e.$store.dispatch("content/loadContentPacks",T);case 3:n.next=7;break;case 5:return n.next=7,e.$store.dispatch("removePacks",{packs:R});case 7:case"end":return n.stop()}}),n)}))))}}]),e}(Object(g["b"])(_));I=Object(m["a"])([Object(g["a"])({components:{Toggle:O["a"]}})],I);var $=I,E=$,D=(n("8343"),n("2877")),H=Object(D["a"])(E,j,w,!1,null,"500b662e",null),B=H.exports,L=function(){var t=this,e=t.$createElement,n=t._self._c||e;return void 0!==t.isWebPSupported?n("div",{staticClass:"panel",on:{dragenter:t.showDropTarget,mouseleave:t.hideDropTarget}},[n("drop-target",{ref:"spriteDt",staticClass:"drop-target",on:{drop:t.addCustomSpriteFile}},[t._v("Drop here to add as a new sprite")]),n("h1",[t._v("Add")]),n("div",{class:{"group-selector":!0,vertical:t.vertical}},[n("button",{class:{active:"characters"===t.group},on:{click:function(e){t.group="characters"}}},[n("i",{staticClass:"material-icons"},[t._v("emoji_people")]),t._v(" Characters ")]),n("button",{class:{active:"sprites"===t.group},on:{click:function(e){t.group="sprites"}}},[n("i",{staticClass:"material-icons"},[t._v("change_history")]),t._v(" Sprites ")]),n("button",{class:{active:"ui"===t.group},on:{click:function(e){t.group="ui"}}},[n("i",{staticClass:"material-icons"},[t._v("view_quilt")]),t._v(" UI ")])]),n("div",{class:{"item-grid":!0,vertical:t.vertical}},["characters"===t.group?[t._l(t.characters,(function(e){return n("div",{key:e.id,staticClass:"character",attrs:{title:e.label},on:{click:function(n){t.onChosen(e.id.toLowerCase())}}},[n("img",{attrs:{src:t.assetPath(e),alt:e.label}})])})),n("div",{staticClass:"btn custom-sprite",on:{click:function(e){return t.$emit("show-dialog","type: Characters")}}},[n("i",{staticClass:"material-icons"},[t._v("extension")]),t._v(" Search in content packs ")])]:t._e(),"sprites"===t.group?[t._l(t.sprites,(function(e){return n("div",{key:e.label,staticClass:"sprite",style:{background:t.assetSpriteBackground(e)},attrs:{title:e.label},on:{click:function(n){return t.addSpriteToScene(e)}}},[t._v(" "+t._s(e.label)+" ")])})),n("button",{staticClass:"btn custom-sprite",on:{click:function(e){return t.$refs.spriteUpload.click()}}},[n("i",{staticClass:"material-icons"},[t._v("publish")]),t._v(" Upload new sprite "),n("input",{ref:"spriteUpload",attrs:{type:"file"},on:{change:t.onSpriteFileUpload}})]),n("button",{on:{click:t.uploadFromURL}},[n("i",{staticClass:"material-icons"},[t._v("insert_link")]),t._v(" New sprite from URL ")]),n("button",{on:{click:function(e){return t.$emit("show-dialog","type: Sprites")}}},[n("i",{staticClass:"material-icons"},[t._v("extension")]),t._v(" Search in content packs ")])]:t._e(),"ui"===t.group?[n("button",{on:{click:t.addTextBox}},[t._v("Textbox")]),n("button",{on:{click:t.addPoem}},[t._v("Poem")]),n("button",{on:{click:t.addDialog}},[t._v("Notification")]),n("button",{on:{click:t.addChoice}},[t._v("Choice")]),n("button",{on:{click:t.addConsole}},[t._v("Console")])]:t._e()],2)],1):t._e()},N=[],A=(n("4917"),n("1c4c"),n("5947")),M=n("dc61"),F={packId:"dddg.buildin.uploadedSprites",packCredits:[""],dependencies:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},W=function(t){function e(){var t;return Object(h["a"])(this,e),t=Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.isWebPSupported=null,t.customAssetCount=0,t.group="characters",t}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"created",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(A["d"])();case 2:this.isWebPSupported=t.sent;case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"assetSpriteBackground",value:function(t){return t.variants[0].map((function(t){return"url('".concat(t.lq,"')")})).join(",")}},{key:"assetPath",value:function(t){return t.chibi?P["a"].allowLQ?t.chibi.lq:t.chibi.hq:""}},{key:"showDropTarget",value:function(t){t.dataTransfer&&(t.dataTransfer.effectAllowed="none",Array.from(t.dataTransfer.items).find((function(t){return t.type.match(/^image.*$/)}))&&(t.dataTransfer.effectAllowed="link","sprites"===this.group&&this.$refs.spriteDt.show()))}},{key:"hideDropTarget",value:function(){"sprites"===this.group&&this.$refs.spriteDt.hide()}},{key:"onSpriteFileUpload",value:function(t){var e=this.$refs.spriteUpload;if(e.files){var n=!0,r=!1,i=void 0;try{for(var a,o=e.files[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;this.addCustomSpriteFile(s)}}catch(c){r=!0,i=c}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}}},{key:"uploadFromURL",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=prompt("Enter the URL of the image"),e){t.next=3;break}return t.abrupt("return");case 3:n=e.split("/").slice(-1)[0],this.addNewCustomSprite(n,e);case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"addSpriteToScene",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.$store.dispatch("objects/createSprite",{assets:e.variants[0]});case 2:case"end":return t.stop()}}),t)}))));case 1:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"addTextBox",value:function(){var t=this;this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createTextBox",{});case 1:case"end":return e.stop()}}),e)}))))}},{key:"addChoice",value:function(){var t=this;this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createChoice",{});case 1:case"end":return e.stop()}}),e)}))))}},{key:"addDialog",value:function(){var t=this;this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createNotification",{});case 1:case"end":return e.stop()}}),e)}))))}},{key:"addPoem",value:function(){var t=this;this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createPoem",{});case 1:case"end":return e.stop()}}),e)}))))}},{key:"addConsole",value:function(){var t=this;this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createConsole",{});case 1:case"end":return e.stop()}}),e)}))))}},{key:"onChosen",value:function(t){var e=this;this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.$store.dispatch("objects/createCharacters",{characterType:t});case 1:case"end":return n.stop()}}),n)}))))}},{key:"addCustomSpriteFile",value:function(t){var e=URL.createObjectURL(t);this.addNewCustomSprite(t.name,e)}},{key:"addNewCustomSprite",value:function(t,e){var n=this;F.sprites.push({id:e,label:t,variants:[[e]]}),this.vuexHistory.transaction((function(){n.$store.dispatch("content/replaceContentPack",{contentPack:F,processed:!1})}))}},{key:"characters",get:function(){return this.$store.state.content.current.characters}},{key:"sprites",get:function(){return this.$store.state.content.current.sprites}}]),e}(Object(g["b"])(_));W=Object(m["a"])([Object(g["a"])({components:{DropTarget:M["a"]}})],W);var U=W,z=U,G=(n("99a1"),Object(D["a"])(z,L,N,!1,null,"6fcc72ae",null)),q=G.exports,V=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"panel"},[n("h1",[t._v(t._s(t.label))]),t.panelForParts?n("parts",{attrs:{character:t.character,part:t.panelForParts},on:{leave:function(e){t.panelForParts=null},"show-dialog":function(e){return t.$emit("show-dialog",e)},"show-expression-dialog":function(e){return t.$emit("show-expression-dialog",e)}}}):[t.hasMultiplePoses||t.parts.length>0?n("fieldset",[n("legend",[t._v("Pose:")]),n("table",[n("tbody",[t.hasMultipleStyles?n("tr",[n("td",{staticClass:"arrow-col"},[n("button",{on:{click:function(e){return t.seekStyle(-1)}}},[t._v("<")])]),n("td",[n("button",{staticClass:"middle-button",on:{click:function(e){t.panelForParts="style"}}},[t._v(" Style ")])]),n("td",{staticClass:"arrow-col"},[n("button",{on:{click:function(e){return t.seekStyle(1)}}},[t._v(">")])])]):t._e(),t.hasMultiplePoses?n("tr",[n("td",{staticClass:"arrow-col"},[n("button",{on:{click:function(e){return t.seekPose(-1)}}},[t._v("<")])]),n("td",[n("button",{staticClass:"middle-button",on:{click:function(e){t.panelForParts="pose"}}},[t._v(" Pose ")])]),n("td",{staticClass:"arrow-col"},[n("button",{on:{click:function(e){return t.seekPose(1)}}},[t._v(">")])])]):t._e(),t._l(t.parts,(function(e){return n("tr",{key:e},[n("td",{staticClass:"arrow-col"},[n("button",{on:{click:function(n){return t.seekPart(e,-1)}}},[t._v("<")])]),n("td",[n("button",{staticClass:"middle-button",on:{click:function(n){t.panelForParts=e}}},[t._v(" "+t._s(t.captialize(e))+" ")])]),n("td",{staticClass:"arrow-col"},[n("button",{on:{click:function(n){return t.seekPart(e,1)}}},[t._v(">")])])])}))],2)])]):t._e(),n("position-and-size",{attrs:{obj:t.character}}),n("layers",{attrs:{obj:t.character}}),n("opacity",{attrs:{obj:t.character}}),n("toggle",{attrs:{label:"Close up?"},model:{value:t.closeUp,callback:function(e){t.closeUp=e},expression:"closeUp"}}),n("toggle",{attrs:{label:"Flip?"},model:{value:t.flip,callback:function(e){t.flip=e},expression:"flip"}}),n("delete",{attrs:{obj:t.character}})]],2)},Y=[],Q=n("ba37"),X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("fieldset",[n("legend",[t._v("Position"+t._s(t.allowSize?"/Size":"")+":")]),n("table",[n("tr",[n("td",{attrs:{colspan:"2"}},[t.allowStepMove?n("toggle",{attrs:{label:"Move freely?"},model:{value:t.freeMove,callback:function(e){t.freeMove=e},expression:"freeMove"}}):t._e()],1)]),t.allowStepMove&&!t.freeMove?n("tr",[n("td",{attrs:{colspan:"2"}},[n("table",[n("tr",[n("td",{staticClass:"arrow-col"},[n("button",{attrs:{disabled:t.isFirstPos},on:{click:function(e){--t.pos}}},[t._v("<")])]),n("td",[n("select",{directives:[{name:"model",rawName:"v-model.number",value:t.pos,expression:"pos",modifiers:{number:!0}}],attrs:{id:"current_talking"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(e){var n="_value"in e?e._value:e.value;return t._n(n)}));t.pos=e.target.multiple?n:n[0]}}},t._l(t.positionNames,(function(e,r){return n("option",{key:r,domProps:{value:r}},[t._v(t._s(e))])})),0)]),n("td",{staticClass:"arrow-col"},[n("button",{attrs:{disabled:t.isLastPos},on:{click:function(e){++t.pos}}},[t._v(">")])])])])])]):[n("tr",[t._m(0),n("td",[n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.x,expression:"x",modifiers:{number:!0}}],attrs:{id:"sprite_x",type:"number"},domProps:{value:t.x},on:{keydown:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.x=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]),n("tr",[t._m(1),n("td",[n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.y,expression:"y",modifiers:{number:!0}}],attrs:{id:"sprite_y",type:"number"},domProps:{value:t.y},on:{keydown:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.y=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])])],t.allowSize?[n("tr",[t._m(2),n("td",[n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.width,expression:"width",modifiers:{number:!0}}],attrs:{id:"sprite_w",min:"0",type:"number"},domProps:{value:t.width},on:{keydown:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.width=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]),n("tr",[t._m(3),n("td",[n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.height,expression:"height",modifiers:{number:!0}}],attrs:{id:"sprite_h",min:"0",type:"number"},domProps:{value:t.height},on:{keydown:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.height=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]),n("tr",[n("td",{attrs:{colspan:"2"}},[n("toggle",{attrs:{label:"Lock ratio?"},model:{value:t.preserveRatio,callback:function(e){t.preserveRatio=e},expression:"preserveRatio"}})],1)])]:t._e()],2)])},J=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("label",{attrs:{for:"sprite_x"}},[t._v("X:")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("label",{attrs:{for:"sprite_y"}},[t._v("Y:")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("label",{attrs:{for:"sprite_w"}},[t._v("Width:")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("label",{attrs:{for:"sprite_h"}},[t._v("Height:")])])}],K=n("fec4"),Z=function(t){function e(){return Object(h["a"])(this,e),Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"allowSize",get:function(){this.obj;return("textBox"!==this.obj.type||"custom"===this.obj.style)&&!("character"===this.obj.type&&!this.obj.freeMove)}},{key:"allowStepMove",get:function(){return"freeMove"in this.obj}},{key:"freeMove",get:function(){return this.obj.freeMove},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setFreeMove",{id:e.obj.id,freeMove:t})}))}},{key:"positionNames",get:function(){return K["b"]}},{key:"pos",get:function(){return Object(Q["d"])(this.obj.x)},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setPosition",{id:e.obj.id,x:K["a"][t],y:e.obj.y})}))}},{key:"isFirstPos",get:function(){return 0===this.pos}},{key:"isLastPos",get:function(){return this.pos===K["b"].length-1}},{key:"x",get:function(){return this.obj.x},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setPosition",{id:e.obj.id,x:t,y:e.y})}))}},{key:"y",get:function(){return this.obj.y},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setPosition",{id:e.obj.id,x:e.x,y:t})}))}},{key:"height",get:function(){return this.obj.height},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setHeight",{id:e.obj.id,height:t})}))}},{key:"width",get:function(){return this.obj.width},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setWidth",{id:e.obj.id,width:t})}))}},{key:"preserveRatio",get:function(){return this.obj.preserveRatio},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setPreserveRatio",{id:e.obj.id,preserveRatio:t})}))}}]),e}(g["d"]);Object(m["a"])([Object(g["c"])({required:!0})],Z.prototype,"obj",void 0),Z=Object(m["a"])([Object(g["a"])({components:{Toggle:O["a"]}})],Z);var tt=Z,et=tt,nt=(n("a5bf"),Object(D["a"])(et,X,J,!1,null,"734fec1a",null)),rt=nt.exports,it=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("fieldset",{attrs:{id:"layerfs"}},[n("legend",[t._v("Layer:")]),n("table",[n("tbody",[n("tr",[n("td",[n("button",{attrs:{title:"Move to back"},on:{click:function(e){return t.shiftLayer(-1/0)}}},[n("i",{staticClass:"material-icons"},[t._v("vertical_align_bottom")])])]),n("td",[n("button",{attrs:{title:"Move backwards"},on:{click:function(e){return t.shiftLayer(-1)}}},[n("i",{staticClass:"material-icons"},[t._v("arrow_downward")])])]),n("td",[n("button",{attrs:{title:"Move forwards"},on:{click:function(e){return t.shiftLayer(1)}}},[n("i",{staticClass:"material-icons"},[t._v("arrow_upward")])])]),n("td",[n("button",{attrs:{title:"Move to front"},on:{click:function(e){return t.shiftLayer(1/0)}}},[n("i",{staticClass:"material-icons"},[t._v("vertical_align_top")])])])])])]),n("toggle",{attrs:{value:t.obj.onTop,label:"In front?"},on:{input:t.setInFront}})],1)},at=[],ot=function(t){function e(){return Object(h["a"])(this,e),Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"shiftLayer",value:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/shiftLayer",{id:e.obj.id,delta:t})}))}},{key:"setInFront",value:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setOnTop",{id:e.obj.id,onTop:t})}))}}]),e}(g["d"]);Object(m["a"])([Object(g["c"])({required:!0})],ot.prototype,"obj",void 0),ot=Object(m["a"])([Object(g["a"])({components:{Toggle:O["a"]}})],ot);var st=ot,ct=st,ut=(n("86b7"),Object(D["a"])(ct,it,at,!1,null,"34f3a848",null)),lt=ut.exports,dt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("table",[n("tr",[t._m(0),n("td",[n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.opacity,expression:"opacity",modifiers:{number:!0}}],attrs:{type:"number",max:"100",min:"0",id:"characterOpacity"},domProps:{value:t.opacity},on:{keydown:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.opacity=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])])])},ht=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("label",{attrs:{for:"characterOpacity"}},[t._v("Opacity:")])])}],pt=function(t){function e(){return Object(h["a"])(this,e),Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"opacity",get:function(){return this.obj.opacity},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setOpacity",{id:e.obj.id,opacity:t})}))}}]),e}(g["d"]);Object(m["a"])([Object(g["c"])({required:!0})],pt.prototype,"obj",void 0),pt=Object(m["a"])([Object(g["a"])({})],pt);var ft=pt,bt=ft,vt=(n("daf6"),Object(D["a"])(bt,dt,ht,!1,null,"28c7d1e4",null)),mt=vt.exports,gt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("button",{on:{click:t.onClick}},[t._v("Delete")])},yt=[],kt=function(t){function e(){return Object(h["a"])(this,e),Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"onClick",value:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("objects/removeObject",{id:t.obj.id})}))}}]),e}(g["d"]);Object(m["a"])([Object(g["c"])({required:!0})],kt.prototype,"obj",void 0),kt=Object(m["a"])([Object(g["a"])({})],kt);var xt=kt,jt=xt,wt=Object(D["a"])(jt,gt,yt,!1,null,null,null),Ot=wt.exports,Ct=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{partList:!0,vertical:t.vertical}},[n("button",{on:{click:function(e){return t.$emit("leave")}}},[t._v("Back")]),t._l(t.parts,(function(e,r){return n("part-button",{key:r,attrs:{value:r,part:e},on:{click:function(e){t.choose(r),t.$emit("leave")}}})})),t._l(t.styleComponents,(function(e){return n("fieldset",{key:e.name},[n("legend",[t._v(t._s(e.label))]),t._l(e.buttons,(function(r,i){return n("part-button",{key:i,attrs:{size:130,value:i,part:r},on:{click:function(n){return t.choose_component(e.name,i)}}})}))],2)})),"head"===t.part?n("button",{on:{click:function(e){return t.$emit("show-expression-dialog",{character:t.character.characterType})}}},[n("i",{staticClass:"material-icons"},[t._v("extension")]),t._v(" Create new expressions ")]):t._e(),"head"===t.part?n("button",{on:{click:function(e){return t.$emit("show-dialog","type: Expressions character: "+t.charData.label)}}},[n("i",{staticClass:"material-icons"},[t._v("extension")]),t._v(" Search in content packs ")]):"style"===t.part?n("button",{on:{click:function(e){return t.$emit("show-dialog","type: Styles character: "+t.charData.label)}}},[n("i",{staticClass:"material-icons"},[t._v("extension")]),t._v(" Search in content packs ")]):n("button",{on:{click:function(e){return t.$emit("show-dialog","type: Poses character: "+t.charData.label)}}},[n("i",{staticClass:"material-icons"},[t._v("extension")]),t._v(" Search in content packs ")])],2)},_t=[],Pt=(n("20d6"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{part:!0,active:!1},style:t.style,on:{click:function(e){return t.$emit("click")}}})}),St=[],Rt=(n("c5f6"),n("a481"),960),Tt=function(t){function e(){var t;return Object(h["a"])(this,e),t=Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.lookups=[],t.loaded=!1,t}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"created",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.part.images.map((function(t){return"string"===typeof t.asset?Object(A["b"])(t.asset,!1):Object(A["a"])(t.asset,!1)})));case 2:this.lookups=t.sent;case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"scaleX",get:function(){return this.size/this.part.size[0]}},{key:"scaleY",get:function(){return this.size/this.part.size[1]}},{key:"backgroundSize",get:function(){return"".concat(Math.floor(Rt*this.scaleX),"px ").concat(Math.floor(Rt*this.scaleY),"px")}},{key:"backgroundPosition",get:function(){return"".concat(Math.floor(this.part.offset[0]*-this.scaleX),"px ")+"".concat(Math.floor(this.part.offset[1]*-this.scaleY),"px")}},{key:"style",get:function(){var t=this.lookups.filter((function(t){return t instanceof HTMLImageElement})).map((function(t){return"url('".concat(t.src.replace("'","\\'"),"')")}));return{backgroundImage:t.join(","),height:this.size+"px",width:this.size+"px",backgroundPosition:this.backgroundPosition,backgroundSize:this.backgroundSize}}}]),e}(g["d"]);Object(m["a"])([Object(g["c"])({required:!0})],Tt.prototype,"part",void 0),Object(m["a"])([Object(g["c"])({required:!0})],Tt.prototype,"value",void 0),Object(m["a"])([Object(g["c"])({default:150,type:Number})],Tt.prototype,"size",void 0),Tt=Object(m["a"])([Object(g["a"])({components:{}})],Tt);var It=Tt,$t=It,Et=(n("6fbc"),Object(D["a"])($t,Pt,St,!1,null,"1eca283e",null)),Dt=Et.exports,Ht=function(t){function e(){var t;return Object(h["a"])(this,e),t=Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.isWebPSupported=null,t.stylePriorities=[],t}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"updateStyleData",value:function(){var t=this.charData.styleGroups[this.character.styleGroupId].styles[this.character.styleId];this.stylePriorities=Object.keys(t.components).map((function(e){return[e,t.components[e]]}))}},{key:"created",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.updateStyleData(),t.next=3,Object(A["d"])();case 3:this.isWebPSupported=t.sent;case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"generatePosePreview",value:function(t){var e=this.charData,n=e.heads[t.compatibleHeads[0]],r=n?n.variants[0]:null,i=[],a=!0,o=!1,s=void 0;try{for(var c,u=t.renderCommands[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var l=c.value;switch(l.type){case"pose-part":var d=t.positions[l.part];if(!d||0===d.length)break;i=i.concat(d[0]);break;case"head":r&&(i=i.concat(r));break;case"image":i=i.concat(l.images);break}}}catch(h){o=!0,s=h}finally{try{a||null==u.return||u.return()}finally{if(o)throw s}}return{images:i.map((function(t){return{asset:t,offset:[0,0]}})),size:t.previewSize,offset:t.previewOffset}}},{key:"updatePose",value:function(t){var e=this;void 0===t&&(t=this.character.styleGroupId);var n=this.charData,r=n.styleGroups[t],i=r.styles,a=!0,o=!1,s=void 0;try{for(var c,u=function(){var t=c.value,e=i.filter((function(e){return e.components[t[0]]===t[1]}));e.length>0&&(i=e)},l=this.stylePriorities[Symbol.iterator]();!(a=(c=l.next()).done);a=!0)u()}catch(d){o=!0,s=d}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setCharStyle",{id:e.character.id,styleGroupId:t,styleId:r.styles.indexOf(i[0])})}))}},{key:"choose",value:function(t){if("style"===this.part)this.updatePose(this.charData.styleGroups.findIndex((function(e){return e.id===t})));else if("head"===this.part){var e=t.split("_",2).map((function(t){return parseInt(t,10)})),n=Object(d["a"])(e,2),r=n[0],i=n[1];this.$store.commit("objects/setPosePosition",{id:this.character.id,posePositions:{headType:r,head:i}})}else this.setPart(this.part,parseInt(t,10))}},{key:"choose_component",value:function(t,e){var n=this.stylePriorities.findIndex((function(e){return e[0]===t}));this.stylePriorities.splice(n,1),this.stylePriorities.unshift([t,e]),this.updatePose()}},{key:"setPart",value:function(t,e){var n=this;this.vuexHistory.transaction((function(){n.$store.dispatch("objects/setPart",{id:n.character.id,part:t,val:e})}))}},{key:"charData",get:function(){return Object(Q["f"])(this.$store,this.character)}},{key:"styleComponents",get:function(){if("style"!==this.part)return[];var t=this.charData.styleGroups[this.character.styleGroupId];return t.styleComponents.map((function(e){var n={};for(var r in e.variants)if(e.variants.hasOwnProperty(r)){var i=e.variants[r];n[r]={size:t.styles[0].poses[0].size,offset:[0,0],images:[{offset:[0,0],asset:i}]}}return{label:e.label,name:e.id,buttons:n}}))}},{key:"parts",get:function(){var t,e,n,r={},i=this.charData,a=Object(Q["i"])(i,this.character);switch(this.part){case"head":for(var o=0;o<a.compatibleHeads.length;++o)for(var s=a.compatibleHeads[o],c=i.heads[s],u=0;u<c.variants.length;++u){var l=c.variants[u];r["".concat(o,"_").concat(u)]={size:c.previewSize,offset:c.previewOffset,images:l.map((function(t){return{asset:t,offset:[0,0]}}))}}return r;case"pose":for(var d=i.styleGroups[this.character.styleGroupId].styles[this.character.styleId],h=0;h<d.poses.length;++h){var p=d.poses[h];r[h]=this.generatePosePreview(p)}return r;case"style":var f=!0,b=!1,v=void 0;try{for(var m,g=i.styleGroups[Symbol.iterator]();!(f=(m=g.next()).done);f=!0){var y=m.value;r[y.id]=this.generatePosePreview(y.styles[0].poses[0])}}catch(j){b=!0,v=j}finally{try{f||null==g.return||g.return()}finally{if(b)throw v}}return r;default:t=a.positions[this.part],n=a.previewSize,e=a.previewOffset;break}for(var k=0;k<t.length;++k){var x=t[k];r[k]={images:x.map((function(t){return{offset:[0,0],asset:t}})),size:n,offset:e}}return r}}]),e}(g["d"]);Object(m["a"])([Object(x["a"])("vertical",{namespace:"ui"})],Ht.prototype,"vertical",void 0),Object(m["a"])([Object(g["c"])({required:!0})],Ht.prototype,"character",void 0),Object(m["a"])([Object(g["c"])({required:!0,type:String})],Ht.prototype,"part",void 0),Object(m["a"])([Object(g["e"])("character")],Ht.prototype,"updateStyleData",null),Ht=Object(m["a"])([Object(g["a"])({components:{PartButton:Dt}})],Ht);var Bt=Ht,Lt=Bt,Nt=(n("e277"),Object(D["a"])(Lt,Ct,_t,!1,null,"4dd22903",null)),At=Nt.exports,Mt=function(t){function e(){var t;return Object(h["a"])(this,e),t=Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.panelForParts=null,t}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"seekPose",value:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/seekPose",{id:e.character.id,delta:t})}))}},{key:"seekStyle",value:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/seekStyle",{id:e.character.id,delta:t})}))}},{key:"seekPart",value:function(t,e){var n=this;this.vuexHistory.transaction((function(){n.$store.dispatch("objects/seekPart",{id:n.character.id,delta:e,part:t})}))}},{key:"captialize",value:function(t){return t.charAt(0).toUpperCase()+t.substring(1)}},{key:"reset",value:function(){this.panelForParts=null}},{key:"selection",get:function(){return this.$store.state.ui.selection}},{key:"character",get:function(){var t=this.$store.state.objects.objects[this.selection];if("character"===t.type)return t}},{key:"charData",get:function(){return Object(Q["f"])(this.$store,this.character)}},{key:"label",get:function(){return this.charData.label||""}},{key:"parts",get:function(){return Object(Q["h"])(this.charData,this.character)}},{key:"hasMultipleStyles",get:function(){return this.charData.styleGroups[this.character.styleGroupId].styles.length>1||this.charData.styleGroups.length>1}},{key:"hasMultiplePoses",get:function(){var t=this.charData.styleGroups[this.character.styleGroupId],e=t.styles[this.character.styleId];return e.poses.length>1}},{key:"flip",get:function(){return this.character.flip},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setFlip",{id:e.character.id,flip:t})}))}},{key:"closeUp",get:function(){return this.character.close},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setClose",{id:e.character.id,close:t})}))}}]),e}(Object(g["b"])(_));Object(m["a"])([Object(g["e"])("selection")],Mt.prototype,"reset",null),Mt=Object(m["a"])([Object(g["a"])({components:{Toggle:O["a"],PositionAndSize:rt,Layers:lt,Opacity:mt,Delete:Ot,Parts:At}})],Mt);var Ft=Mt,Wt=Ft,Ut=(n("48ab"),Object(D["a"])(Wt,V,Y,!1,null,"7b2622e6",null)),zt=Ut.exports,Gt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"panel"},[n("h1",[t._v("Custom Sprite")]),n("position-and-size",{attrs:{obj:t.sprite}}),n("layers",{attrs:{obj:t.sprite}}),n("opacity",{attrs:{obj:t.sprite}}),n("toggle",{attrs:{label:"Flip?"},model:{value:t.flip,callback:function(e){t.flip=e},expression:"flip"}}),n("delete",{attrs:{obj:t.sprite}})],1)},qt=[],Vt=function(t){function e(){return Object(h["a"])(this,e),Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"sprite",get:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("sprite"===t.type)return t}},{key:"flip",get:function(){return this.sprite.flip},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setFlip",{id:e.sprite.id,flip:t})}))}}]),e}(Object(g["b"])(_));Vt=Object(m["a"])([Object(g["a"])({components:{Toggle:O["a"],PositionAndSize:rt,Layers:lt,Opacity:mt,Delete:Ot}})],Vt);var Yt=Vt,Qt=Yt,Xt=(n("7ec3"),Object(D["a"])(Qt,Gt,qt,!1,null,"0b7511a2",null)),Jt=Xt.exports,Kt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"panel"},[n("h1",[t._v("Textbox")]),""!==t.colorSelect?n("color",{attrs:{title:t.colorName},on:{leave:function(e){t.colorSelect=""}},model:{value:t.color,callback:function(e){t.color=e},expression:"color"}}):""!==t.textEditor?n("text-editor",{attrs:{title:t.textEditorName},on:{leave:function(e){t.textEditor=""}},model:{value:t.textEditorText,callback:function(e){t.textEditorText=e},expression:"textEditorText"}}):[n("table",{staticClass:"upper-combos"},[n("tr",[n("td",[n("label",{attrs:{for:"text_style"}},[t._v("Style:")])]),n("td",[n("select",{directives:[{name:"model",rawName:"v-model",value:t.textBoxStyle,expression:"textBoxStyle"}],attrs:{id:"text_style"},on:{keydown:function(t){t.stopPropagation()},change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.textBoxStyle=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"normal"}},[t._v("Normal")]),n("option",{attrs:{value:"corrupt"}},[t._v("Corrupt")]),n("option",{attrs:{value:"custom"}},[t._v("Custom")]),n("option",{attrs:{value:"none"}},[t._v("None")])])])]),n("tr",[n("td",[n("label",{attrs:{for:"current_talking"}},[t._v("Person talking:")])]),n("td",[n("select",{directives:[{name:"model",rawName:"v-model",value:t.talkingDefaults,expression:"talkingDefaults"}],attrs:{id:"current_talking"},on:{keydown:function(t){t.stopPropagation()},change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.talkingDefaults=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"No-one"}},[t._v("No-one")]),n("option",{attrs:{value:"Sayori"}},[t._v("Sayori")]),n("option",{attrs:{value:"Yuri"}},[t._v("Yuri")]),n("option",{attrs:{value:"Natsuki"}},[t._v("Natsuki")]),n("option",{attrs:{value:"Monika"}},[t._v("Monika")]),n("option",{attrs:{value:"FeMC"}},[t._v("FeMC")]),n("option",{attrs:{value:"MC"}},[t._v("MC")]),n("option",{attrs:{value:"Chad"}},[t._v("Chad")]),n("option",{attrs:{value:"Amy"}},[t._v("Amy")]),n("option",{attrs:{value:"Other"}},[t._v("Other")])])])]),n("tr",[n("td",[n("label",{attrs:{for:"custom_name"}},[t._v("Other name:")])]),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.talkingOther,expression:"talkingOther"}],attrs:{id:"custom_name"},domProps:{value:t.talkingOther},on:{keydown:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.talkingOther=e.target.value)}}}),n("button",{on:{click:function(e){t.textEditor="name"}}},[t._v("...")])])])]),n("toggle",{attrs:{label:"Auto quoting?"},model:{value:t.autoQuoting,callback:function(e){t.autoQuoting=e},expression:"autoQuoting"}}),n("toggle",{attrs:{label:"Auto line wrap?"},model:{value:t.autoWrap,callback:function(e){t.autoWrap=e},expression:"autoWrap"}}),n("div",{attrs:{id:"dialog_text_wrapper"}},[n("label",{attrs:{for:"dialog_text"}},[t._v("Dialog:")]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.dialog,expression:"dialog"}],attrs:{id:"dialog_text"},domProps:{value:t.dialog},on:{keydown:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.dialog=e.target.value)}}}),t._v(" "),n("button",{on:{click:function(e){t.textEditor="body"}}},[t._v("Formatting")])]),n("position-and-size",{attrs:{obj:t.textbox}}),n("button",{on:{click:t.resetPosition}},[t._v("Reset position")]),n("button",{on:{click:t.splitTextbox}},[t._v("Split textbox")]),n("layers",{attrs:{obj:t.textbox}}),n("opacity",{attrs:{obj:t.textbox}}),n("toggle",{attrs:{label:"Flip?"},model:{value:t.flip,callback:function(e){t.flip=e},expression:"flip"}}),n("fieldset",{on:{wheel:function(t){t.stopPropagation()}}},[n("legend",[t._v("Customization:")]),n("toggle",{attrs:{label:"Controls visible?"},model:{value:t.showControls,callback:function(e){t.showControls=e},expression:"showControls"}}),n("toggle",{attrs:{label:"Able to skip?"},model:{value:t.allowSkipping,callback:function(e){t.allowSkipping=e},expression:"allowSkipping"}}),n("toggle",{attrs:{label:"Continue arrow?"},model:{value:t.showContinueArrow,callback:function(e){t.showContinueArrow=e},expression:"showContinueArrow"}}),"custom"===t.textBoxStyle?n("table",[n("tr",[n("td",[n("label",{attrs:{for:"textbox_color"}},[t._v("Color:")])]),n("td",[n("button",{staticClass:"color-button",style:{background:t.textbox.customColor},attrs:{id:"textbox_color"},on:{click:function(e){t.colorSelect="base"}}})])]),n("tr",[n("td",[n("label",{attrs:{for:"custom_namebox_width"}},[t._v("Namebox width:")])]),n("td",[n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.customNameboxWidth,expression:"customNameboxWidth",modifiers:{number:!0}}],staticStyle:{width:"48px"},attrs:{id:"custom_namebox_width",type:"number"},domProps:{value:t.customNameboxWidth},on:{input:function(e){e.target.composing||(t.customNameboxWidth=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]),n("tr",[n("td",{attrs:{colspan:"2"}},[n("toggle",{attrs:{id:"derive_custom_colors",label:"Derive other colors"},model:{value:t.deriveCustomColors,callback:function(e){t.deriveCustomColors=e},expression:"deriveCustomColors"}})],1)]),t.deriveCustomColors?t._e():[n("tr",[n("td",[n("label",{attrs:{for:"custom_controls_color"}},[t._v("Controls Color:")])]),n("td",[n("button",{staticClass:"color-button",style:{background:t.textbox.customControlsColor},attrs:{id:"custom_controls_color"},on:{click:function(e){t.colorSelect="controls"}}})])]),n("tr",[n("td",[n("label",{attrs:{for:"custom_namebox_color"}},[t._v("Namebox Color:")])]),n("td",[n("button",{staticClass:"color-button",style:{background:t.textbox.customNameboxColor},attrs:{id:"custom_namebox_color"},on:{click:function(e){t.colorSelect="namebox"}}})])]),n("tr",[n("td",[n("label",{attrs:{for:"custom_namebox_stroke"}},[t._v("Namebox text stroke:")])]),n("td",[n("button",{staticClass:"color-button",style:{background:t.textbox.customNameboxStroke},attrs:{id:"custom_namebox_stroke"},on:{click:function(e){t.colorSelect="nameboxStroke"}}})])])]],2):t._e()],1),n("delete",{attrs:{obj:t.textbox}})]],2)},Zt=[],te=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{color:!0,vertical:t.vertical}},[n("h2",[t._v(t._s(t.title))]),n("button",{on:{click:function(e){return t.$emit("leave")}}},[t._v("OK")]),n("table",[n("tr",[n("td",[n("button",{on:{click:function(e){t.mode="hsla"}}},[t._v("HSLA")])]),n("td",[n("button",{on:{click:function(e){t.mode="rgba"}}},[t._v("RGBA")])])])]),n("div",{staticClass:"column"},[n("slider-group",{attrs:{mode:t.mode,relative:!0},model:{value:t.color,callback:function(e){t.color=e},expression:"color"}}),n("div",{staticClass:"hex-selector"},[n("label",{staticClass:"hex-label",attrs:{for:"hex_"+t._uid}},[t._v("Hex")]),n("input",{attrs:{id:"hex_"+t._uid},domProps:{value:t.color},on:{input:t.updateHex}})]),n("button",{on:{click:t.addSwatch}},[t._v("Add as swatch")])],1),n("div",{class:{vertical:t.vertical},attrs:{id:"color-swatches"}},t._l(t.swatches,(function(e){return n("button",{key:e.color,staticClass:"swatch",style:{backgroundColor:e.color},attrs:{title:e.label},on:{click:function(n){t.color=e.color,t.$emit("leave")}}})})),0)])},ee=[],ne=n("75fc"),re=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("slider",{attrs:{label:t.label1,"max-value":t.maxValue1,"gradient-stops":t.stops1},model:{value:t.v1,callback:function(e){t.v1=e},expression:"v1"}}),n("slider",{attrs:{label:t.label2,"max-value":t.maxValue2,"gradient-stops":t.stops2},model:{value:t.v2,callback:function(e){t.v2=e},expression:"v2"}}),n("slider",{attrs:{label:t.label3,"max-value":t.maxValue3,"gradient-stops":t.stops3},model:{value:t.v3,callback:function(e){t.v3=e},expression:"v3"}}),n("slider",{attrs:{label:"Alpha","max-value":255,"gradient-stops":t.stopsAlpha},model:{value:t.a,callback:function(e){t.a=e},expression:"a"}})],1)},ie=[],ae=(n("6b54"),n("f576"),function(){function t(e,n,r,i){Object(h["a"])(this,t),this.h=e,this.s=n,this.l=r,this.a=i}return Object(p["a"])(t,[{key:"toCss",value:function(){return this.a>=1?"hsl(".concat(this.h,", ").concat(this.s,", ").concat(this.l,")"):"hsla(".concat(this.h,", ").concat(this.s,", ").concat(this.l,", ").concat(this.a,")")}},{key:"shift",value:function(e){var n=this.h,r=this.s,i=this.l,a=this.a;return n+=e.h,n>=1?n-=1:n<0&&(n+=1),r+e.s>1?r-=e.s:(r+=e.s,r<0&&(r=0)),i+e.l>1||i+e.l<0?i-=e.l:i+=e.l,a+e.a>1||a+e.a<0?a-=e.a:a+=e.a,new t(n,r,i,a)}},{key:"toRgb",value:function(){var t,e,n,r=this.h,i=this.s,a=this.l,o=this.a;if(0===i)t=e=n=a;else{var s=a<.5?a*(1+i):a+i-a*i,c=2*a-s;t=this.hue2rgb(c,s,r+1/3),e=this.hue2rgb(c,s,r),n=this.hue2rgb(c,s,r-1/3)}return new oe(Math.round(255*t),Math.round(255*e),Math.round(255*n),o)}},{key:"toHSL",value:function(){return this}},{key:"hue2rgb",value:function(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}}]),t}()),oe=function(){function t(e,n,r,i){Object(h["a"])(this,t),this.r=e,this.g=n,this.b=r,this.a=i}return Object(p["a"])(t,[{key:"toCss",value:function(){return this.a>1?"rgb(".concat(this.r,",").concat(this.g,",").concat(this.b,")"):"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.a,")")}},{key:"toHex",value:function(){return"#".concat(Math.round(this.r).toString(16).padStart(2,"0")).concat(Math.round(this.g).toString(16).padStart(2,"0")).concat(Math.round(this.b).toString(16).padStart(2,"0")).concat(Math.round(255*this.a).toString(16).padStart(2,"0"))}},{key:"toRgb",value:function(){return this}},{key:"toHSL",value:function(){var t=this.r,e=this.g,n=this.b,r=this.a;t/=255,e/=255,n/=255;var i,a,o=Math.max(t,e,n),s=Math.min(t,e,n),c=(o+s)/2;if(o===s)i=a=0;else{var u=o-s;switch(a=c>.5?u/(2-o-s):u/(o+s),o){case t:i=(e-n)/u+(e<n?6:0);break;case e:i=(n-t)/u+2;break;case n:i=(t-e)/u+4;break}i/=6}return new ae(i,a,c,r)}},{key:"luminance",get:function(){return Math.sqrt(Math.pow(this.r/255*.299,2)+Math.pow(this.g/255*.587,2)+Math.pow(this.b/255*.114,2))}}],[{key:"validCss",value:function(t){return this.validCssRgb(t)||this.validHex(t)}},{key:"fromCss",value:function(t){if(this.validCssRgb(t))return this.fromCssRgb(t);if(this.validHex(t))return this.fromHex(t);throw new Error("Invalid RGB color format")}},{key:"validCssRgb",value:function(t){return this.rgbEx.test(t)||this.rgbaEx.test(t)}},{key:"fromCssRgb",value:function(e){if(!this.validCssRgb(e))throw new Error("Invalid RGB color format");var n=e.slice(0,-1),r=n.indexOf("("),i=n.slice(r+1),a=i.split(",").map((function(t){return parseFloat(t.trim())}));return new t(a[0],a[1],a[2],4===a.length?a[3]:1)}},{key:"validHex",value:function(t){return this.hexShortEx.test(t)||this.hexLongEx.test(t)}},{key:"fromHex",value:function(e){if(!this.validHex(e))throw new Error("Invalid Hex color format");var n=e.slice(1);if(3===n.length)return new t(parseInt(n[0]+n[0],16),parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),1);if(4===n.length)return new t(parseInt(n[0]+n[0],16),parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),parseInt(n[3]+n[3],16)/255);if(6===n.length)return new t(parseInt(n[0]+n[1],16),parseInt(n[2]+n[3],16),parseInt(n[4]+n[5],16),1);if(8===n.length)return new t(parseInt(n[0]+n[1],16),parseInt(n[2]+n[3],16),parseInt(n[4]+n[5],16),parseInt(n[6]+n[7],16)/255);throw new Error("Invalid Hex color format length")}}]),t}();oe.rgbEx=/^rgb\((\d*?)\,(\d*?)\,(\d*?)\)$/i,oe.rgbaEx=/^rgba\((\d{1,3})\,(\d{1,3})\,(\d{1,3})\,([\d\.]+)\)$/i,oe.hexShortEx=/^\#[0-9A-Z]{3,4}$/i,oe.hexLongEx=/^\#[0-9A-Z]{6,8}$/i;var se=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{slider:!0,vertical:t.vertical},on:{keydown:function(t){t.stopPropagation()}}},[n("label",{attrs:{for:t._uid}},[t._v(t._s(t.label))]),n("div",[n("svg",{ref:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 271 24"},on:{mousedown:t.enterSlide,touchstart:t.enterSlide,mousemove:t.moveSlide,touchmove:t.moveSlide,mouseup:t.exitSlide,touchend:t.exitSlide}},[n("defs",[n("linearGradient",{attrs:{id:"gradient"+t._uid,x1:"0%",y1:"0%",x2:"100%",y2:"0%"}},t._l(t.gradientStops,(function(e,r){return n("stop",{key:r,style:"stop-color:"+e,attrs:{offset:r/(t.gradientStops.length-1)*100+"%"}})})),1)],1),n("g",{attrs:{stroke:"#ffbde1"}},[n("path",{attrs:{d:"M7 0H262V24H7z","stroke-width":"2","paint-order":"fill stroke markers",fill:"url(#gradient"+t._uid+")"}}),n("path",{attrs:{d:t.pointerPath,"stroke-width":"2",fill:"#000000"}})])])]),n("input",{staticClass:"sliderInput",attrs:{id:t._uid,min:"0",max:t.maxValue,type:"number"},domProps:{value:t.value},on:{input:function(e){t.$emit("input",parseFloat(e.target.value))}}})])},ce=[],ue=255,le=8,de=function(t){function e(){var t;return Object(h["a"])(this,e),t=Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.slideActive=!1,t}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"enterSlide",value:function(t){this.slideActive=!0,this.moveSlide(t)}},{key:"moveSlide",value:function(t){if(this.slideActive){var e=this.$refs.svg;if(e.contains(t.target)||t.target===e)if(t instanceof MouseEvent&&1!==t.which)this.slideActive=!1;else{var n=e.getBoundingClientRect(),r=n.width/(le+ue+le),i=(t instanceof MouseEvent?t.clientX:t.touches[0].clientX)-n.x,a=i/r;t.preventDefault();var o=Math.max(Math.min(a-le,ue),0)/ue*this.maxValue;this.$emit("input",o)}}}},{key:"exitSlide",value:function(){this.slideActive=!1}},{key:"pointerPath",get:function(){var t=this.value/this.maxValue*ue;return"M".concat(t," 0L").concat(t+14," 0L").concat(t+7," 12Z")}}]),e}(g["d"]);Object(m["a"])([Object(g["c"])({type:String})],de.prototype,"label",void 0),Object(m["a"])([Object(g["c"])({})],de.prototype,"gradientStops",void 0),Object(m["a"])([Object(g["c"])({type:Number})],de.prototype,"value",void 0),Object(m["a"])([Object(g["c"])({type:Number})],de.prototype,"maxValue",void 0),Object(m["a"])([Object(x["a"])("vertical",{namespace:"ui"})],de.prototype,"vertical",void 0),de=Object(m["a"])([Object(g["a"])({components:{}})],de);var he=de,pe=he,fe=(n("a6a9"),Object(D["a"])(pe,se,ce,!1,null,"1a9b5de0",null)),be=fe.exports,ve=function(t){function e(){var t;return Object(h["a"])(this,e),t=Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.lastRGBEmit=null,t.v1=0,t.v2=0,t.v3=0,t.a=0,t}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"created",value:function(){this.initValues()}},{key:"valueChanged",value:function(){this.value!==this.lastRGBEmit&&this.initValues()}},{key:"updateValue",value:function(){var t;t="rgba"===this.mode?new oe(this.v1,this.v2,this.v3,this.a/255):new ae(this.v1/360,this.v2/100,this.v3/100,this.a/255);var e=t.toRgb().toHex();if(this.lastRGBEmit!==e){if(9!==e.length)throw new Error("Invalid color code: ".concat(e));this.lastRGBEmit=e,console.log("setting rgb",e),this.$emit("input",e)}}},{key:"initValues",value:function(){var t=oe.fromHex(this.value);if(this.lastRGBEmit=t.toHex(),this.a=255*t.a,"hsla"===this.mode){var e=t.toHSL();this.v1=360*e.h,this.v2=100*e.s,this.v3=100*e.l}else this.v1=t.r,this.v2=t.g,this.v3=t.b}},{key:"eightsStops",value:function(t){for(var e=[],n=0;n<=8;++n)e.push(t(n/8));return e}},{key:"maxValue1",get:function(){return"rgba"===this.mode?255:360}},{key:"label1",get:function(){return"rgba"===this.mode?"Red":"Hue"}},{key:"stops1",get:function(){oe.fromHex(this.value);var t=[];if("rgba"===this.mode){var e=this.relative?this.v2:0,n=this.relative?this.v3:0;t=[new oe(0,e,n,1),new oe(255,e,n,1)]}else{var r=this.relative?this.v2/100:1,i=this.relative?this.v3/100:.5;t=this.eightsStops((function(t){return new ae(t,r,i,1)}))}return t.map((function(t){return t.toRgb().toCss()}))}},{key:"maxValue2",get:function(){return"rgba"===this.mode?255:100}},{key:"label2",get:function(){return"rgba"===this.mode?"Green":"Saturation"}},{key:"stops2",get:function(){oe.fromHex(this.value);var t=[];if("rgba"===this.mode){var e=this.relative?this.v1:0,n=this.relative?this.v3:0;t=[new oe(e,0,n,1),new oe(e,255,n,1)]}else{var r=this.relative?this.v1/360:0,i=this.relative?this.v3/100:.5;t=this.eightsStops((function(t){return new ae(r,t,i,1)}))}return t.map((function(t){return t.toRgb().toCss()}))}},{key:"maxValue3",get:function(){return"rgba"===this.mode?255:100}},{key:"label3",get:function(){return"rgba"===this.mode?"Blue":"Luminosity"}},{key:"stops3",get:function(){oe.fromHex(this.value);var t=[];if("rgba"===this.mode){var e=this.relative?this.v1:0,n=this.relative?this.v2:0;t=[new oe(e,n,0,1),new oe(e,n,255,1)]}else{var r=this.relative?this.v1/360:0,i=this.relative?this.v2/100:.5;t=this.eightsStops((function(t){return new ae(r,i,t,1)}))}return t.map((function(t){return t.toRgb().toCss()}))}},{key:"stopsAlpha",get:function(){var t=oe.fromHex(this.value);return[new oe(t.r,t.g,t.b,0).toCss(),new oe(t.r,t.g,t.b,1).toCss()]}}]),e}(g["d"]);Object(m["a"])([Object(g["c"])({type:String,validator:function(t){return t.match(/^#[0-9a-f]{6,8}$/i)}})],ve.prototype,"value",void 0),Object(m["a"])([Object(g["c"])({})],ve.prototype,"mode",void 0),Object(m["a"])([Object(g["c"])({type:Boolean})],ve.prototype,"relative",void 0),Object(m["a"])([Object(x["a"])("vertical",{namespace:"ui"})],ve.prototype,"vertical",void 0),Object(m["a"])([Object(g["e"])("value")],ve.prototype,"valueChanged",null),Object(m["a"])([Object(g["e"])("v1"),Object(g["e"])("v2"),Object(g["e"])("v3"),Object(g["e"])("a")],ve.prototype,"updateValue",null),Object(m["a"])([Object(g["e"])("mode")],ve.prototype,"initValues",null),ve=Object(m["a"])([Object(g["a"])({components:{Slider:be}})],ve);var me=ve,ge=me,ye=(n("1ac6"),Object(D["a"])(ge,re,ie,!1,null,"672f504f",null)),ke=ye.exports;function xe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function je(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xe(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var we="dddg.generated.colors",Oe=function(t){function e(){var t;return Object(h["a"])(this,e),t=Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.mode="hsla",t.relative=!0,t}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"updateHex",value:function(t){var e=t.target.value;!oe.validHex(e)||7!==e.length&&9!==e.length||(console.log("setting updateHex",e),this.$emit("input",e))}},{key:"addSwatch",value:function(){var t=this;if(!this.swatches.find((function(e){return e.color===t.color}))){var e=this.$store.state.content.contentPacks.find((function(t){return"generatedPackId"===t.packId}))||{packId:we,packCredits:[""],dependencies:[],characters:[],fonts:[],backgrounds:[],sprites:[],poemStyles:[],poemBackgrounds:[],colors:[]},n=je({},e,{colors:[].concat(Object(ne["a"])(e.colors),[{label:this.color,color:this.color}])});this.vuexHistory.transaction((function(){t.$store.dispatch("content/replaceContentPack",{contentPack:n,processed:!0})}))}}},{key:"swatches",get:function(){return this.$store.state.content.current.colors}},{key:"color",get:function(){return this.value},set:function(t){this.$emit("input",t)}}]),e}(g["d"]);Object(m["a"])([Object(x["a"])("vertical",{namespace:"ui"})],Oe.prototype,"vertical",void 0),Object(m["a"])([Object(g["c"])({required:!0,type:String})],Oe.prototype,"value",void 0),Object(m["a"])([Object(g["c"])({type:String,default:""})],Oe.prototype,"title",void 0),Oe=Object(m["a"])([Object(g["a"])({components:{SliderGroup:ke}})],Oe);var Ce=Oe,_e=Ce,Pe=(n("9ba6"),Object(D["a"])(_e,te,ee,!1,null,"7798ab74",null)),Se=Pe.exports,Re=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.colorSelector?n("color",{on:{leave:t.applyColor},model:{value:t.selectedColor,callback:function(e){t.selectedColor=e},expression:"selectedColor"}}):n("div",{class:{"text-subpanel":!0,vertical:t.vertical}},[n("h2",[t._v(t._s(t.title))]),n("div",{staticClass:"column ok-col"},[n("button",{on:{click:function(e){return t.$emit("leave")}}},[t._v("OK")])]),n("div",{staticClass:"column"},[n("textarea",{ref:"textArea",domProps:{value:t.value},on:{input:t.onValueChanged,keydown:function(t){t.stopPropagation()},keypress:function(t){t.stopPropagation()}}})]),t.error?n("div",{staticClass:"column error-col"},[t._v(t._s(t.error))]):t._e(),n("div",{staticClass:"column"},[n("button",{staticClass:"style-button",on:{click:function(e){return t.insertText("\\\\")}}},[t._v("Insert \\")]),n("button",{staticClass:"style-button",on:{click:function(e){return t.insertText("\\{")}}},[t._v("Insert {")]),n("button",{staticClass:"style-button",on:{click:function(e){return t.insertText("\\}")}}},[t._v("Insert }")])]),n("p",{staticClass:"hint-col"},[t._v("Apply style to selected text:")]),n("div",{staticClass:"column"},[n("button",{staticClass:"style-button",staticStyle:{"font-weight":"bold"},on:{click:function(e){return t.insertCommand("b")}}},[t._v(" Bold ")]),n("button",{staticClass:"style-button",staticStyle:{"font-style":"italic"},on:{click:function(e){return t.insertCommand("i")}}},[t._v(" Italics ")]),n("button",{staticClass:"style-button",on:{click:function(e){return t.insertCommand("plain")}}},[t._v(" Plain ")]),n("button",{staticClass:"style-button edited-style",on:{click:function(e){return t.insertCommand("edited")}}},[t._v(" Edited ")]),n("button",{staticClass:"style-button",staticStyle:{"letter-spacing":"5px"},on:{click:function(e){return t.insertCommand("k",2)}}},[t._v(" Kerning ")])]),n("div",{staticClass:"column"},[n("button",{staticClass:"style-button",on:{click:function(e){return t.insertCommand("alpha",.5)}}},[t._v(" Alpha ")])]),n("div",{staticClass:"column"},[n("button",{staticClass:"style-button",staticStyle:{"font-size":"20px"},on:{click:function(e){return t.insertCommand("size",12)}}},[t._v(" Font size ")]),n("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedFont,expression:"selectedFont"}],staticClass:"style-button",on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selectedFont=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:""}},[t._v("Font")]),n("option",{staticStyle:{"font-family":"aller"},attrs:{value:"aller"}},[t._v("Aller (Textbox)")]),n("option",{staticStyle:{"font-family":"riffic"},attrs:{value:"riffic"}},[t._v("Riffic (Bold text)")]),n("option",{staticStyle:{"font-family":"hashtag"},attrs:{value:"hashtag"}},[t._v("Hashtag (Sayori)")]),n("option",{staticStyle:{"font-family":"ammy_handwriting"},attrs:{value:"ammy_handwriting"}},[t._v("Ammy's Handwriting (Natsuki)")]),n("option",{staticStyle:{"font-family":"journal"},attrs:{value:"journal"}},[t._v("Journal (Monika)")]),n("option",{staticStyle:{"font-family":"jp_hand_slanted"},attrs:{value:"jp_hand_slanted"}},[t._v("JP Hand Slanted (Yuri)")]),n("option",{staticStyle:{"font-family":"damagrafik_script"},attrs:{value:"damagrafik_script"}},[t._v("Damagrafik (Yuri, Act 2)")]),n("option",{staticStyle:{"font-family":"as_i_lay_dying"},attrs:{value:"as_i_lay_dying"}},[t._v("As I Lay Dying (Yuri, Act Unused)")]),n("option",{staticStyle:{"font-family":"halogen"},attrs:{value:"halogen"}},[t._v("Halogen (MC)")])]),n("button",{staticClass:"style-button",on:{click:function(e){return t.selectColor("text")}}},[t._v(" Text color ")]),n("button",{staticClass:"style-button",on:{click:function(e){return t.selectColor("outline")}}},[t._v(" Outline color ")])])])},Te=[],Ie=(n("f400"),5),$e=function(){function t(e){Object(h["a"])(this,t),this.str=e,this.i=0}return Object(p["a"])(t,[{key:"current",value:function(){return this.str[this.i]}},{key:"next",value:function(){return++this.i,this.current()}},{key:"pos",get:function(){return this.i}},{key:"around",get:function(){return this.str.slice(Math.max(0,this.i-Ie),this.i+Ie)}},{key:"ahead",get:function(){return this.str[this.i+1]}},{key:"behind",get:function(){return this.str[this.i+1]}}]),t}();function Ee(t){var e=[],n=new $e(t),r=De;while(r!==He)r=r(e,n);return e}function De(t,e){return void 0===e.current()?He:"{"===e.current()?Ne:"\n"===e.current()?Ae:Be}function He(){return He}function Be(t,e){var n,r=e.pos,i="",a=!1;while(1){if(void 0===e.current()){n=He;break}if(a)i+=e.current(),a=!1;else if("\\"===e.current())a=!0;else{if("{"===e.current()||"\n"===e.current()){n=De;break}i+=e.current()}e.next()}return t.push({type:"text",pos:r,content:i}),n}function Le(t,e){throw new Error("Error at position ".concat(t.pos,": (around: ").concat(t.around,") ").concat(e))}function Ne(t,e){var n=e.pos;if("{"!==e.current())throw new Error("Parser error: Command does not start with {");var r="/"===e.next();r&&e.next();var i="",a="",o=!1;while(1){if(void 0===e.current()&&Le(e,"Unexpected end of text inside a command"),"}"===e.current())break;o?a+=e.current():e.current().match(/[a-z]/i)?i+=e.current():"="===e.current()?(r&&Le(e,"Closing commands may not contain arguments"),o=!0):Le(e,"Unexpected character in command name."),e.next()}return e.next(),r?t.push({type:"commandClose",commandName:i,pos:n}):t.push({type:"command",pos:n,argument:a,commandName:i}),De}function Ae(t,e){return t.push({type:"newline",pos:e.pos}),e.next(),De}function Me(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Fe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Me(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Me(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var We=new Map([Ue("i",(function(t){return Fe({},t,{isItalic:!0})})),Ue("b",(function(t){return Fe({},t,{isBold:!0})})),Ue("u",(function(t){return Fe({},t,{isUnderlined:!0})})),Ue("s",(function(t){return Fe({},t,{isStrikethrough:!0})})),Ue("plain",(function(t){return Fe({},t,{isStrikethrough:!1,isUnderlined:!1,isBold:!1,isItalic:!1})})),Ue("edited",(function(t){return Fe({},t,{fontName:"verily",strokeColor:"#000000",strokeWidth:20,letterSpacing:8})})),ze("k",(function(t,e,n){return Fe({},t,{letterSpacing:e?t.letterSpacing+n:n})})),ze("size",(function(t,e,n){return Fe({},t,{fontSize:e?t.fontSize+n:n})})),ze("alpha",(function(t,e,n){return Fe({},t,{alpha:e?t.alpha+n:n})})),["font",function(t,e){return Fe({},t,{fontName:e})}],["color",function(t,e){return Fe({},t,{color:e})}],["outlinecolor",function(t,e){return Fe({},t,{strokeColor:e})}]]);function Ue(t,e){return[t,function(n,r){if(r)throw new Error("Operator '".concat(t,"' does not take any arguments."));return e(n)}]}function ze(t,e){return[t,function(n,r){if(!r)throw new Error("Operator '".concat(t,"' needs an argument."));var i="+"===r[0]||"-"===r[0],a=Number(r);if(isNaN(a))throw new Error("Operator '".concat(t,"' needs a numeric argument."));return e(n,i,a)}]}var Ge=n("61ea"),qe=function(){function t(e,n){Object(h["a"])(this,t),this.str=e,this.baseStyle=n,this.tokens=Ee(e),this.rebuildParts()}return Object(p["a"])(t,[{key:"rebuildParts",value:function(){this.renderParts=this.getRenderParts(this.tokens,this.baseStyle)}},{key:"loadFonts",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n,r,i,a,o,s,c,u,l,d,h,p,f,b,v,m,g;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("fonts"in document){t.next=2;break}return t.abrupt("return");case 2:e=new Set,n=null,r=!0,i=!1,a=void 0,t.prev=7,o=this.renderParts[Symbol.iterator]();case 9:if(r=(s=o.next()).done){t.next=17;break}if(c=s.value,"style"in c){t.next=13;break}return t.abrupt("continue",14);case 13:c.style!==n&&(n=c.style,n.fontName&&e.add(n.fontName));case 14:r=!0,t.next=9;break;case 17:t.next=23;break;case 19:t.prev=19,t.t0=t["catch"](7),i=!0,a=t.t0;case 23:t.prev=23,t.prev=24,r||null==o.return||o.return();case 26:if(t.prev=26,!i){t.next=29;break}throw a;case 29:return t.finish(26);case 30:return t.finish(23);case 31:u=!1,l=!0,d=!1,h=void 0,t.prev=35,p=e[Symbol.iterator]();case 37:if(l=(f=p.next()).done){t.next=48;break}if(b=f.value,v=document,m="8px ".concat(b),v.fonts.check(m)){t.next=45;break}return u=!0,t.next=45,v.fonts.load(m);case 45:l=!0,t.next=37;break;case 48:t.next=54;break;case 50:t.prev=50,t.t1=t["catch"](35),d=!0,h=t.t1;case 54:t.prev=54,t.prev=55,l||null==p.return||p.return();case 57:if(t.prev=57,!d){t.next=60;break}throw h;case 60:return t.finish(57);case 61:return t.finish(54);case 62:u&&(g=Ee(this.str),this.renderParts=this.getRenderParts(g,this.baseStyle));case 63:case"end":return t.stop()}}),t,this,[[7,19,23,31],[24,,26,30],[35,50,54,62],[55,,57,61]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"render",value:function(t){t.save();var e=null,n=!0,r=!1,i=void 0;try{for(var a,o=this.renderParts[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;"newline"!==s.type&&(s.style!==e&&(e=s.style,Ke(e,t)),e.strokeWidth>0&&e.strokeColor>""&&t.strokeText(s.character,s.x,s.y))}}catch(f){r=!0,i=f}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}var c=!0,u=!1,l=void 0;try{for(var d,h=this.renderParts[Symbol.iterator]();!(c=(d=h.next()).done);c=!0){var p=d.value;"newline"!==p.type&&(p.style!==e&&(e=p.style,Ke(e,t)),t.fillText(p.character,p.x,p.y))}}catch(f){u=!0,l=f}finally{try{c||null==h.return||h.return()}finally{if(u)throw l}}t.restore()}},{key:"quote",value:function(){var t;(function(t){t[t["None"]=0]="None",t[t["ExplictQuote"]=1]="ExplictQuote",t[t["ImplictQuote"]=2]="ImplictQuote",t[t["Star"]=3]="Star"})(t||(t={}));for(var e=-1,n=t.None,r=0;r<this.renderParts.length;++r){var i=this.renderParts[r];if("character"===i.type)switch(n){case t.None:if(i.character.match(/\s/))continue;'"'===i.character?(n=t.ExplictQuote,e=r):"*"===i.character?(n=t.Star,e=r):(this.renderParts.splice(r,0,{type:"character",x:0,y:0,style:i.style,character:'"',height:i.height,width:Qe(i.style,'"')}),r++,e=r,n=t.ImplictQuote);break;case t.ExplictQuote:e=r,'"'===i.character&&(n=t.None);break;case t.ImplictQuote:if(i.character.match(/\s/))continue;"*"===i.character&&(this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:i.style,character:'"',height:i.height,width:Qe(i.style,'"')}),n=t.Star,r++),e=r;break;case t.Star:"*"===i.character&&(n=t.None),e=r;break}}var a=this.renderParts[e];a&&n===t.Star&&this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:a.style,character:"*",height:a.height,width:Qe(a.style,'"')}),!a||n!==t.ExplictQuote&&n!==t.ImplictQuote||this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:a.style,character:'"',height:a.height,width:Qe(a.style,'"')})}},{key:"fixAlignment",value:function(t,e,n,r,i){var a=0,o=[];function s(){var r=e;"center"===t?r=e+(n-e)/2-a/2:"right"===t&&(r=n-a);var i=!0,s=!1,c=void 0;try{for(var u,l=o[Symbol.iterator]();!(i=(u=l.next()).done);i=!0){var d=u.value;d.x=r,r+=d.width}}catch(h){s=!0,c=h}finally{try{i||null==l.return||l.return()}finally{if(s)throw c}}}var c=this.renderParts;i>0&&(c=this.applyLineWrapping(this.renderParts.slice(0),i));var u=r,l=[],d=0,h=!0,p=!1,f=void 0;try{for(var b,v=c[Symbol.iterator]();!(h=(b=v.next()).done);h=!0){var m=b.value;d=Math.max(d,m.height),"newline"===m.type&&(l.push(d),d=0)}}catch(_){p=!0,f=_}finally{try{h||null==v.return||v.return()}finally{if(p)throw f}}l.push(d);var g=0,y=!0,k=!1,x=void 0;try{for(var j,w=c[Symbol.iterator]();!(y=(j=w.next()).done);y=!0){var O=j.value;if(d=Math.max(d,O.height),O.y=u,o.push(O),a+=O.width,"newline"===O.type)s(),u+=l[++g]||0,a=0,d=0,o=[];else if("character"===O.type){var C=o[o.length-1];"character"===C.type&&(a+=C.style.letterSpacing,C.width+=C.style.letterSpacing)}}}catch(_){k=!0,x=_}finally{try{y||null==w.return||w.return()}finally{if(k)throw x}}s()}},{key:"getHeight",value:function(t){var e=0,n=0,r=0===t?this.renderParts:this.applyLineWrapping(this.renderParts.slice(0),t),i=!0,a=!1,o=void 0;try{for(var s,c=r[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var u=s.value;e=Math.max(e,u.height),"newline"===u.type&&(n+=e,e=0)}}catch(l){a=!0,o=l}finally{try{i||null==c.return||c.return()}finally{if(a)throw o}}return n+=e,n}},{key:"getWidth",value:function(){var t=0,e=0,n=null,r=!0,i=!1,a=void 0;try{for(var o,s=this.renderParts[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var c=o.value;t+=c.width,"newline"===c.type?(e=Math.max(e,t),t=0,n=null):"character"===c.type&&(n&&"character"===n.type&&(t+=n.style.letterSpacing),n=c)}}catch(u){i=!0,a=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return e=Math.max(e,t),e}},{key:"getRenderParts",value:function(e,n){var r=[],i=[],a=[],o=Je(n),s=n,c=null,u=!0,l=!1,d=void 0;try{for(var h,p=e[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){var f=h.value;switch(f.type){case"command":if(!t.textCommands.has(f.commandName))throw new Error("There is no text command called '".concat(f.commandName,"' at position ").concat(f.pos,"."));i.push(s),a.push(c),s=t.textCommands.get(f.commandName)(s,f.argument),o=Je(s),c=f;break;case"commandClose":if(!c)throw new Error("Unmatched closing command at position ".concat(f.pos,". Closed '").concat(f.commandName,"', but no commands are currently open."));if(f.commandName!==c.commandName)throw new Error("Unmatched closing command at position ".concat(f.pos,". Closed '").concat(f.commandName,"', expected to close '").concat(c,"' first. (Opened at position ").concat(c.pos,")"));c=a.pop(),s=i.pop();break;case"newline":r.push({height:o,width:0,x:0,y:0,type:"newline"});break;case"text":var b=!0,v=!1,m=void 0;try{for(var g,y=f.content[Symbol.iterator]();!(b=(g=y.next()).done);b=!0){var k=g.value;r.push({type:"character",character:k,height:o,width:Qe(s,k),style:s,x:0,y:0})}}catch(x){v=!0,m=x}finally{try{b||null==y.return||y.return()}finally{if(v)throw m}}}}}catch(x){l=!0,d=x}finally{try{u||null==p.return||p.return()}finally{if(l)throw d}}return r}},{key:"applyLineWrapping",value:function(t,e){var n=-1,r=0,i=0,a=[],o=!0,s=!1,c=void 0;try{for(var u,l=t[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var d=u.value;if("newline"===d.type)n=-1,r=0,i=0,a.push(d);else if("character"===d.type)if(" "===d.character){if(r>e){n=-1,r=0,i=0,a.push({type:"newline",height:d.height,width:0,x:0,y:0});continue}r+=d.width,i=r,n=a.length,a.push(d)}else r+=d.width,r>e&&-1!==n?(r-=i,a.splice(n,1,{type:"newline",height:d.height,width:0,x:0,y:0}),n=-1,i=0,a.push(d)):a.push(d);else Object(Ge["a"])(d)}}catch(h){s=!0,c=h}finally{try{o||null==l.return||l.return()}finally{if(s)throw c}}return a}}]),t}();qe.textCommands=We;var Ve=document.createElement("canvas").getContext("2d"),Ye=null;function Qe(t,e){return t!==Ye&&(Ke(t,Ve),Ye=t),Ve.measureText(e).width}var Xe=new Map;function Je(t){var e=t.fontSize+" "+t.fontName;if(Xe.has(e))return Xe.get(e)*t.lineSpacing;var n=document.createElement("span");n.innerHTML="Hg",n.style.fontFamily=t.fontName,n.style.fontSize="".concat(t.fontSize,"px"),n.style.lineHeight="1";var r=document.createElement("div");r.style.opacity="0",r.style.fontFamily=t.fontName,r.style.fontSize="".concat(t.fontSize,"px"),r.style.lineHeight="1",r.style.position="absolute",r.style.top="0",r.style.left="0",r.appendChild(n),document.body.appendChild(r);try{var i=r.offsetHeight;return Xe.set(e,i),i*t.lineSpacing}finally{r.remove()}}function Ke(t,e){e.textAlign="left",e.font=(t.isItalic?"italic ":"")+(t.isBold?"bold ":"")+t.fontSize+"px "+t.fontName,e.lineJoin="round",t.strokeWidth>0&&t.strokeColor>""?(e.strokeStyle=t.strokeColor,e.lineWidth=t.strokeWidth):(e.strokeStyle="",e.lineWidth=0),e.globalAlpha=t.alpha||0,e.fillStyle=t.color}function Ze(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function tn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ze(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var en=816,nn=900,rn=146,an=568,on=38,sn=50,cn=39,un=168,ln=34,dn=29,hn=12,pn=-126,fn=-72,bn=-38,vn=30.75,mn=26,gn=426,yn=58,kn={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},xn=tn({},kn,{fontName:"riffic",fontSize:24,strokeColor:"#bb5599",strokeWidth:6,color:"white",letterSpacing:1}),jn={align:"left",font:"13px aller",fill:{style:"#522"}},wn=tn({},jn,{fill:{style:"#a66"}}),On=(K["d"],K["d"],an-cn),Cn=function(t){function e(){var t;return Object(h["a"])(this,e),t=Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.colorSelector="",t.selectedFont="",t.selectedColor="#000000",t.rememberedStart=0,t.rememberedEnd=0,t.error="",t}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"onSelectedFontChange",value:function(){""!==this.selectedFont&&(console.log(this.selectedFont),this.insertCommand("font",this.selectedFont),this.selectedFont="")}},{key:"onValueChanged",value:function(){var t=this.$refs.textArea.value;try{new qe(t,xn),this.error=""}catch(e){this.error=e.message,console.error(e)}this.$emit("input",t)}},{key:"selectColor",value:function(t){var e=this.$refs.textArea;this.colorSelector=t,this.rememberedStart=e.selectionStart,this.rememberedEnd=e.selectionEnd}},{key:"applyColor",value:function(){var t=this,e=this.selectedColor,n=this.colorSelector,r=function r(){var i=t.$refs.textArea;i?(i.selectionStart=t.rememberedStart,i.selectionEnd=t.rememberedEnd,t.insertCommand("text"===n?"color":"outlinecolor",e)):t.$nextTick(r)};this.$nextTick(r),this.selectedColor="#000000",this.colorSelector=""}},{key:"insertText",value:function(t){var e=this.$refs.textArea,n=e.value,r=e.selectionStart,i=e.selectionEnd;e.value=n.slice(0,r)+t+n.slice(i),e.selectionStart=e.selectionEnd=r+t.length,e.focus(),this.onValueChanged()}},{key:"insertCommand",value:function(t,e){var n=this.$refs.textArea,r=n.value,i=n.selectionStart,a=n.selectionEnd,o=r.slice(i,a),s=r.slice(0,i),c=r.slice(a),u=t;e&&(u+="="+e),n.value="".concat(s,"{").concat(u,"}").concat(o,"{/").concat(t,"}").concat(c),n.selectionStart=i+u.length+2,n.selectionEnd=n.selectionStart+o.length,n.focus(),this.onValueChanged()}}]),e}(g["d"]);Object(m["a"])([Object(x["a"])("vertical",{namespace:"ui"})],Cn.prototype,"vertical",void 0),Object(m["a"])([Object(g["c"])({required:!0,type:String})],Cn.prototype,"value",void 0),Object(m["a"])([Object(g["c"])({type:String,default:""})],Cn.prototype,"title",void 0),Object(m["a"])([Object(g["e"])("selectedFont")],Cn.prototype,"onSelectedFontChange",null),Cn=Object(m["a"])([Object(g["a"])({components:{Color:Se}})],Cn);var _n=Cn,Pn=_n,Sn=(n("1eb6"),Object(D["a"])(Pn,Re,Te,!1,null,"63d76104",null)),Rn=Sn.exports,Tn=function(t){function e(){var t;return Object(h["a"])(this,e),t=Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.textEditor="",t.colorSelect="",t}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"splitTextbox",value:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("objects/splitTextbox",{id:t.textbox.id})}))}},{key:"resetPosition",value:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("objects/resetTextboxBounds",{id:t.textbox.id})}))}},{key:"textbox",get:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("textBox"===t.type)return t}},{key:"textEditorName",get:function(){return"name"===this.textEditor?"Name":"body"===this.textEditor?"Dialog":""}},{key:"textEditorText",get:function(){return"name"===this.textEditor?this.textbox.talkingOther:"body"===this.textEditor?this.dialog:""},set:function(t){"name"===this.textEditor?this.talkingOther=t:"body"===this.textEditor&&(this.dialog=t)}},{key:"talkingDefaults",get:function(){return this.textbox.talkingDefault},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setTalkingDefault",{id:e.textbox.id,talkingDefault:t})}))}},{key:"talkingOther",get:function(){return this.textbox.talkingOther},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setTalkingOther",{id:e.textbox.id,talkingOther:t})}))}},{key:"showControls",get:function(){return this.textbox.controls},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setControlsVisible",{id:e.textbox.id,controls:t})}))}},{key:"allowSkipping",get:function(){return this.textbox.controls},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setSkipable",{id:e.textbox.id,skip:t})}))}},{key:"autoQuoting",get:function(){return this.textbox.autoQuoting},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setAutoQuoting",{id:e.textbox.id,autoQuoting:t})}))}},{key:"autoWrap",get:function(){return this.textbox.autoWrap},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setAutoWrapping",{id:e.textbox.id,autoWrap:t})}))}},{key:"showContinueArrow",get:function(){return this.textbox.continue},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setContinueArrow",{id:e.textbox.id,continue:t})}))}},{key:"dialog",get:function(){return this.textbox.text},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setText",{id:e.textbox.id,text:t})}))}},{key:"flip",get:function(){return this.textbox.flip},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setFlip",{id:e.textbox.id,flip:t})}))}},{key:"textBoxStyle",get:function(){return this.textbox.style},set:function(t){this.$store.dispatch("objects/setStyle",{id:this.textbox.id,style:t})}},{key:"deriveCustomColors",get:function(){return this.textbox.deriveCustomColors},set:function(t){this.$store.commit("objects/setDeriveCustomColors",{id:this.textbox.id,deriveCustomColors:t})}},{key:"customControlsColor",get:function(){return this.textbox.customControlsColor}},{key:"customNameboxWidth",get:function(){return this.textbox.customNameboxWidth},set:function(t){this.$store.commit("objects/setNameboxWidth",{id:this.textbox.id,customNameboxWidth:t})}},{key:"colorName",get:function(){switch(this.colorSelect){case"":return"";case"base":return"Base color";case"controls":return"Controls color";case"namebox":return"Namebox color";case"nameboxStroke":return"Namebox text stroke"}}},{key:"color",get:function(){switch(this.colorSelect){case"":return"#000000";case"base":return this.textbox.customColor;case"controls":return this.textbox.customControlsColor;case"namebox":return this.textbox.customNameboxColor;case"nameboxStroke":return this.textbox.customNameboxStroke}},set:function(t){switch(this.colorSelect){case"":return;case"base":this.$store.commit("objects/setCustomColor",{id:this.textbox.id,color:t});case"controls":this.$store.commit("objects/setControlsColor",{id:this.textbox.id,customControlsColor:t});case"namebox":this.$store.commit("objects/setNameboxColor",{id:this.textbox.id,customNameboxColor:t});case"nameboxStroke":this.$store.commit("objects/setNameboxStroke",{id:this.textbox.id,customNameboxStroke:t})}}}]),e}(Object(g["b"])(_));Tn=Object(m["a"])([Object(g["a"])({components:{Toggle:O["a"],PositionAndSize:rt,Layers:lt,Opacity:mt,Delete:Ot,Color:Se,TextEditor:Rn}})],Tn);var In=Tn,$n=In,En=(n("5b67"),Object(D["a"])($n,Kt,Zt,!1,null,"54858f2a",null)),Dn=En.exports,Hn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"panel"},[n("h1",[t._v("Choice")]),t.textEditor?n("text-editor",{attrs:{title:"Button Text"},on:{leave:function(e){t.textEditor=!1}},model:{value:t.button_text,callback:function(e){t.button_text=e},expression:"button_text"}}):[n("fieldset",{staticClass:"buttons"},[n("legend",[t._v("Buttons:")]),n("div",{staticClass:"list"},t._l(t.buttons,(function(e,r){return n("div",{key:r,class:{active:r===t.currentIdx},on:{click:function(e){return t.select(r)}}},[t._v(" "+t._s(""===e.text.trim()?"[Empty]":e.text)+" ")])})),0)]),n("fieldset",{staticClass:"current_button"},[n("legend",[t._v("Current button:")]),n("table",[n("tr",[n("td",{attrs:{colspan:"2"}},[n("label",{attrs:{for:"choice-button-input"}},[t._v("Text")])])]),n("tr",[n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.button_text,expression:"button_text"}],attrs:{id:"choice-button-input"},domProps:{value:t.button_text},on:{keydown:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.button_text=e.target.value)}}})]),n("td",[n("button",{on:{click:function(e){t.textEditor=!0}}},[t._v("...")])])])])]),n("button",{on:{click:t.addChoice}},[t._v("Add")]),n("button",{on:{click:t.removeChoice}},[t._v("Remove")]),n("toggle",{attrs:{label:"Auto line wrap?"},model:{value:t.autoWrap,callback:function(e){t.autoWrap=e},expression:"autoWrap"}}),n("position-and-size",{attrs:{obj:t.sprite}}),n("layers",{attrs:{obj:t.sprite}}),n("opacity",{attrs:{obj:t.sprite}}),n("toggle",{attrs:{label:"Flip?"},model:{value:t.flip,callback:function(e){t.flip=e},expression:"flip"}}),n("delete",{attrs:{obj:t.sprite}})]],2)},Bn=[],Ln=function(t){function e(){var t;return Object(h["a"])(this,e),t=Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.currentIdx=0,t.textEditor=!1,t}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"select",value:function(t){this.currentIdx=t}},{key:"addChoice",value:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("objects/addChoice",{id:t.sprite.id,text:""})}))}},{key:"removeChoice",value:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("objects/removeChoise",{id:t.sprite.id,choiceIdx:t.currentIdx})}))}},{key:"sprite",get:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("choice"===t.type)return t}},{key:"flip",get:function(){return this.sprite.flip},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setFlip",{id:e.sprite.id,flip:t})}))}},{key:"autoWrap",get:function(){return this.sprite.autoWrap},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setAutoWrapping",{id:e.sprite.id,autoWrap:t})}))}},{key:"button_text",get:function(){return this.sprite.choices[this.currentIdx].text},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setChoiceText",{id:e.sprite.id,choiceIdx:e.currentIdx,text:t})}))}},{key:"buttons",get:function(){return this.sprite.choices}}]),e}(Object(g["b"])(_));Ln=Object(m["a"])([Object(g["a"])({components:{Toggle:O["a"],PositionAndSize:rt,Layers:lt,Opacity:mt,Delete:Ot,TextEditor:Rn}})],Ln);var Nn=Ln,An=Nn,Mn=(n("d3a2"),Object(D["a"])(An,Hn,Bn,!1,null,"22068303",null)),Fn=Mn.exports,Wn=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},Un=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"panel"},[n("h1",[t._v("Help and Credits")]),n("a",{staticClass:"btn",attrs:{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/edave64/Doki-Doki-Dialog-Generator/blob/v1/docs/index.md"}},[t._v("Help")]),n("a",{staticClass:"btn",attrs:{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/edave64/Doki-Doki-Dialog-Generator/"}},[t._v("Fork me on GitHub")]),n("p",[t._v(" All assets used are IP of Team Salvato and created by them, unless noted otherwise. ")]),n("p",[t._v(" Doki Doki Dialog Generator developed by EDave64 "),n("br"),t._v("Based on gemdude46's DDLC Shitpost generator ")]),n("p",[t._v(" Unused House Background by "),n("a",{attrs:{target:"_blank",rel:"noopener noreferrer",href:"https://www.deviantart.com/fatelogic/art/VN-Background-Practice-295671161"}},[t._v("Fatelogic")])]),n("p",[t._v(" Aller Font by "),n("a",{attrs:{target:"_blank",rel:"noopener noreferrer",href:"https://www.daltonmaag.com/library/aller"}},[t._v("Dalton Maag Ltd")])]),n("p",[t._v(" Riffic Bold Font by "),n("a",{attrs:{target:"_blank",rel:"noopener noreferrer",href:"https://www.fontspring.com/fonts/inky-type/riffic"}},[t._v("InkyType")])]),n("p",[t._v(" Verily Serif Mono Font by "),n("a",{attrs:{target:"_blank",rel:"noopener noreferrer",href:"https://www.dafont.com/verily-serif-mono.font"}},[t._v("Stephen G. Hartke")])]),n("p",[t._v(" F25 Bank Printer Font by "),n("a",{attrs:{target:"_blank",rel:"noopener noreferrer",href:"https://www.dafont.com/f25-bank-printer.font"}},[t._v("F25 Digital Typeface Design")])]),n("p",[t._v(" Journal Font by "),n("a",{attrs:{target:"_blank",rel:"noopener noreferrer",href:"https://www.dafont.com/journal.font"}},[t._v("Fontourist")])]),n("p",[t._v(" Hashtag Font by "),n("a",{attrs:{target:"_blank",rel:"noopener noreferrer",href:"https://www.dafont.com/hashtag.font"}},[t._v(" TitanVex")])]),n("p",[t._v(" JP Hand Slanted Font by "),n("a",{attrs:{target:"_blank",rel:"noopener noreferrer",href:"https://www.dafont.com/jp-hand-slanted.font"}},[t._v("Jonathan Paterson")])]),n("p",[t._v(" As I Lay Dying Font by "),n("a",{attrs:{target:"_blank",rel:"noopener noreferrer",href:"https://www.dafont.com/as-i-lay-dying.font"}},[t._v("Moises Esqueda")])]),n("p",[t._v(" Damagrafik Script Font by "),n("a",{attrs:{target:"_blank",rel:"noopener noreferrer",href:"https://www.dafont.com/damagrafik-script.font"}},[t._v("Davide Terenzi")])]),n("p",[t._v(" Ammy's Handwriting Font by "),n("a",{attrs:{target:"_blank",rel:"noopener noreferrer",href:"https://www.dafont.com/ammys-handwriting.font"}},[t._v("Ammy K.")])]),n("p",[t._v(" Halogen Font by "),n("a",{attrs:{target:"_blank",rel:"noopener noreferrer",href:"https://www.dafont.com/halogen.font"}},[t._v("JLH Fonts")])]),n("p",[t._v(" MC Classic Sprite by Childish-N "),n("br"),t._v("MC Classic Chibi by GyleToTheRescue ")]),n("p",[t._v(" MC Sprite by Childish-N "),n("br"),t._v("MC Casual Sprite by SlightlySimple "),n("br"),t._v("MC Chibi by SlightlySimple ")]),n("p",[t._v(" MC Chad Sprite by Cylent-Nite "),n("br"),t._v("MC Chad Poses and expressions by SlightlySimple "),n("br"),t._v("MC Chad Poses and chibi by Meddy-sin ")]),n("p",[t._v(" FeMC Sprite by Meddy-sin "),n("br"),t._v("FeMC Casual Sprite by SlightlySimple ")]),n("p",[t._v("Classic Amy Sprite by Meddy-sin")]),n("p",[t._v("Amy Sprite by Meddy-sin and SlightlySimple")]),n("p",[t._v("Special thanks to SlightlySimple for testing and technical help")]),n("p",[t._v("Atlas421 for suggestions and testing")]),n("p",[t._v("T-Rex Harris for suggestions and testing")])])}],zn=function(t){function e(){return Object(h["a"])(this,e),Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(v["a"])(e,t),e}(Object(g["b"])(_));zn=Object(m["a"])([Object(g["a"])({components:{}})],zn);var Gn=zn,qn=Gn,Vn=(n("6452"),Object(D["a"])(qn,Wn,Un,!1,null,"186d1345",null)),Yn=Vn.exports,Qn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"panel",on:{dragenter:t.dragEnter,mouseleave:function(e){return t.$refs.dt.hide()}}},[n("drop-target",{ref:"dt",staticClass:"drop-target",on:{drop:t.addImageFile}},[t._v("Drop here to add as a new background")]),n("h1",[t._v("Background")]),t.colorSelect?n("color",{on:{leave:function(e){t.colorSelect=!1}},model:{value:t.bgColor,callback:function(e){t.bgColor=e},expression:"bgColor"}}):[n("background-settings",{on:{"change-color":function(e){t.colorSelect=!0}}}),t._l(t.backgrounds,(function(e){return n("background-button",{key:e,attrs:{backgroundId:e},on:{input:function(n){return t.setBackground(e)}}})})),n("div",{staticClass:"btn upload-background",on:{click:function(e){return t.$refs.upload.click()}}},[t._v(" Upload "),n("input",{ref:"upload",attrs:{type:"file"},on:{change:t.onFileUpload}})]),n("button",{staticClass:"upload-background",on:{click:t.addByUrl}},[t._v("Add by URL")]),n("button",{staticClass:"upload-background",attrs:{title:"Not yet implemented"},on:{click:function(e){return t.$emit("show-dialog","type: Backgrounds")}}},[n("i",{staticClass:"material-icons"},[t._v("extension")]),t._v(" Search in content packs ")])]],2)},Xn=[],Jn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{background:!0,active:t.isActive},style:t.style,attrs:{title:t.title},on:{click:function(e){return t.$emit("input",t.backgroundId)}}},[t._v(t._s(t.title))])},Kn=[],Zn=function(t){function e(){var t;return Object(h["a"])(this,e),t=Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.isWebPSupported=null,t.assets=[],t}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"created",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.bgData){t.next=4;break}return t.next=3,Promise.all(this.bgData.variants[0].map((function(t){return Object(A["a"])(t,!1)})));case 3:this.assets=t.sent;case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"background",get:function(){var t=this.$store.state.panels.currentPanel;return this.$store.state.panels.panels[t].background}},{key:"bgData",get:function(){var t=this.$store.getters["content/getBackgrounds"];return t.get(this.backgroundId)||null}},{key:"isActive",get:function(){return this.backgroundId===this.background.current}},{key:"title",get:function(){switch(this.backgroundId){case"buildin.static-color":return"Static color";case"buildin.transparent":return"Transparent"}return this.bgData.label||""}},{key:"style",get:function(){switch(this.backgroundId){case"buildin.static-color":return{"background-color":this.background.color};case"buildin.transparent":return{}}this.bgData.variants[0];var t=this.assets.filter((function(t){return t instanceof HTMLImageElement})).map((function(t){return"url('".concat(t.src,"')")})).join(",");return{backgroundImage:t}}}]),e}(g["d"]);Object(m["a"])([Object(g["c"])({required:!0})],Zn.prototype,"backgroundId",void 0),Zn=Object(m["a"])([Object(g["a"])({components:{}})],Zn);var tr=Zn,er=tr,nr=(n("b883"),Object(D["a"])(er,Jn,Kn,!1,null,"2551c94f",null)),rr=nr.exports,ir=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("fieldset",[n("legend",[t._v("Settings:")]),t.isColor?[n("label",{attrs:{for:"bg_color"}},[t._v("Color:")]),n("button",{staticClass:"color-button",style:{background:t.color},attrs:{id:"bg_color"},on:{click:function(e){return t.$emit("change-color")}}})]:t._e(),t.isVariant?n("table",[n("tr",[n("td",{attrs:{colspan:"3"}},[n("toggle",{attrs:{label:"Flipped?"},model:{value:t.flipped,callback:function(e){t.flipped=e},expression:"flipped"}})],1)]),t.hasVariants?n("tr",[n("td",{staticClass:"arrow-col"},[n("button",{on:{click:function(e){return t.seekVariant(-1)}}},[t._v("<")])]),n("td",{staticStyle:{"text-align":"center"}},[t._v("Variant")]),n("td",{staticClass:"arrow-col"},[n("button",{on:{click:function(e){return t.seekVariant(1)}}},[t._v(">")])])]):t._e(),n("tr",[n("td",{attrs:{colspan:"3"}},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.scaling,expression:"scaling"}],on:{keydown:function(t){t.stopPropagation()},change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.scaling=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"0"}},[t._v("None")]),n("option",{attrs:{value:"1"}},[t._v("Stretch")]),n("option",{attrs:{value:"2"}},[t._v("Cover")])])])])]):t._e()],2)},ar=[],or=function(t){function e(){return Object(h["a"])(this,e),Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"seekVariant",value:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("panels/seekBackgroundVariant",{delta:t,panelId:e.$store.state.panels.currentPanel})}))}},{key:"currentBackgroundId",get:function(){return this.background.current}},{key:"background",get:function(){var t=this.$store.state.panels.currentPanel;return this.$store.state.panels.panels[t].background}},{key:"bgData",get:function(){var t=this;return this.$store.state.content.current.backgrounds.find((function(e){return e.id===t.currentBackgroundId}))||null}},{key:"isColor",get:function(){return"buildin.static-color"===this.currentBackgroundId}},{key:"color",get:function(){return this.background.color},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("panels/setBackgroundColor",{color:t,panelId:e.$store.state.panels.currentPanel})}))}},{key:"flipped",get:function(){return this.background.flipped},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("panels/setBackgroundFlipped",{flipped:t,panelId:e.$store.state.panels.currentPanel})}))}},{key:"scaling",get:function(){return this.background.scaling.toString()},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("panels/setBackgroundScaling",{scaling:parseInt(t,10),panelId:e.$store.state.panels.currentPanel})}))}},{key:"isVariant",get:function(){return!!this.bgData}},{key:"hasVariants",get:function(){return!!this.bgData&&this.bgData.variants.length>1}}]),e}(g["d"]);or=Object(m["a"])([Object(g["a"])({components:{Toggle:O["a"]}})],or);var sr=or,cr=sr,ur=(n("9207"),Object(D["a"])(cr,ir,ar,!1,null,"645ce448",null)),lr=ur.exports,dr={packId:"dddg.buildin.uploadedBackgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},hr=function(t){function e(){var t;return Object(h["a"])(this,e),t=Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.colorSelect=!1,t}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"setBackground",value:function(t){this.$store.commit("panels/setCurrentBackground",{current:t,panelId:this.$store.state.panels.currentPanel})}},{key:"onFileUpload",value:function(t){var e=this.$refs.upload;if(e.files){var n=!0,r=!1,i=void 0;try{for(var a,o=e.files[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;this.addImageFile(s)}}catch(c){r=!0,i=c}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}}},{key:"addImageFile",value:function(t){var e=URL.createObjectURL(t);this.addNewCustomBackground(t.name,t.name,e)}},{key:"addByUrl",value:function(){var t=prompt("Enter the URL of the image");if(t){var e=t.split("/").slice(-1)[0];this.addNewCustomBackground(e,e,t)}}},{key:"addNewCustomBackground",value:function(t,e,n){var r=this;dr.backgrounds.push({id:t,label:e,variants:[[n]]}),this.vuexHistory.transaction((function(){r.$store.dispatch("content/replaceContentPack",{contentPack:dr}),r.setBackground(t)}))}},{key:"dragEnter",value:function(t){t.dataTransfer&&(t.dataTransfer.effectAllowed="none",Array.from(t.dataTransfer.items).find((function(t){return t.type.match(/^image.*$/)}))&&(t.dataTransfer.effectAllowed="link",this.$refs.dt.show()))}},{key:"backgrounds",get:function(){return[].concat(Object(ne["a"])(this.$store.state.content.current.backgrounds.map((function(t){return t.id}))),["buildin.static-color","buildin.transparent"])}},{key:"bgColor",get:function(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel].background.color},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("panels/setBackgroundColor",{color:t})}))}}]),e}(Object(g["b"])(_));hr=Object(m["a"])([Object(g["a"])({components:{BackgroundButton:rr,BackgroundSettings:lr,DropTarget:M["a"],Color:Se}})],hr);var pr=hr,fr=pr,br=(n("9765"),Object(D["a"])(fr,Qn,Xn,!1,null,"3a443774",null)),vr=br.exports,mr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"panel"},[n("h1",[t._v("Content Packs")]),n("button",{on:{click:t.addNew}},[t._v("Add new Pack")]),n("fieldset",[n("legend",[t._v("Installed Packs:")]),n("div",{staticClass:"list"},t._l(t.packs,(function(e){return n("div",{key:e.name,class:{active:e.name===t.name},on:{click:function(n){return t.select(e.name)}}},[t._v(" "+t._s(e.name)+" ")])})),0)]),n("label",{attrs:{for:"pack_name"}},[t._v("Name:")]),n("input",{attrs:{id:"pack_name",readonly:""},domProps:{value:t.name}}),n("label",{attrs:{for:"pack_credits"}},[t._v("Credits:")]),n("div",{attrs:{id:"pack_credits"},domProps:{innerHTML:t._s(t.credits)}}),t.activatable?n("button",{on:{click:t.activate}},[t._v("Activate")]):t._e(),t.deactivatable?n("button",{on:{click:t.deactivate}},[t._v("Deactivate")]):t._e(),t.installable?n("button",{on:{click:t.install}},[t._v("Install")]):t._e(),t.uninstallable?n("button",{on:{click:t.uninstall}},[t._v("Uninstall")]):t._e(),t.needRestart?n("div",[t._v(" The tool need restart for changes to take effect. "),n("button",{on:{click:t.restart}},[t._v("Restart Now")])]):t._e()])},gr=[],yr=(n("f559"),function(t){function e(){var t;return Object(h["a"])(this,e),t=Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.selectedPack=null,t.needRestart=!1,t}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"created",value:function(){}},{key:"select",value:function(t){this.selectedPack=this.packs.find((function(e){return e.name===t}))||null}},{key:"addNew",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,P["a"].prompt("Enter the URL of the character pack:");case 2:if(e=t.sent,e){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,this.$store.dispatch("content/loadContentPacks",e);case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"restart",value:function(){location.reload(!0)}},{key:"install",value:function(){this.selectedPack&&(P["a"].localRepoAdd(this.selectedPack.url),this.selectedPack.queuedUninstall?this.selectedPack.queuedUninstall=!1:this.selectedPack.installed=!0)}},{key:"uninstall",value:function(){this.selectedPack&&(P["a"].localRepoRemove(this.selectedPack.url),this.selectedPack.queuedUninstall=!0,this.needRestart=!0)}},{key:"activate",value:function(){this.selectedPack&&(P["a"].autoLoadAdd(this.selectedPack.url),this.selectedPack.active=!0,this.needRestart=!0)}},{key:"deactivate",value:function(){this.selectedPack&&(P["a"].autoLoadRemove(this.selectedPack.url),this.selectedPack.active=!1,this.needRestart=!0)}},{key:"packs",get:function(){var t=this.$store.state.content.contentPacks;return t.filter((function(t){return t.packId&&!t.packId.startsWith("dddg.buildin.")})).map((function(t){return{name:t.packId,credits:t.packCredits,installed:!0,active:!0,queuedUninstall:!1,freshInstall:!1,url:""}}))}},{key:"name",get:function(){return this.selectedPack?this.selectedPack.name:""}},{key:"credits",get:function(){return this.selectedPack?this.selectedPack.credits:[""]}},{key:"activatable",get:function(){return!!P["a"].isAutoLoadingSupported&&(!!this.selectedPack&&(!!this.selectedPack.installed&&(!this.selectedPack.queuedUninstall&&(!this.selectedPack.freshInstall&&!this.selectedPack.active))))}},{key:"deactivatable",get:function(){return!!P["a"].isAutoLoadingSupported&&(!!this.selectedPack&&(!!this.selectedPack.installed&&(!this.selectedPack.queuedUninstall&&(!this.selectedPack.freshInstall&&this.selectedPack.active))))}},{key:"installable",get:function(){return!!P["a"].isLocalRepoSupported&&(!!this.selectedPack&&(this.selectedPack.queuedUninstall||!this.selectedPack.installed))}},{key:"uninstallable",get:function(){return!!P["a"].isLocalRepoSupported&&(!!this.selectedPack&&(!this.selectedPack.freshInstall&&!(this.selectedPack.queuedUninstall||!this.selectedPack.installed)))}}]),e}(Object(g["b"])(_)));yr=Object(m["a"])([Object(g["a"])({components:{}})],yr);var kr,xr=yr,jr=xr,wr=(n("eb8b"),Object(D["a"])(jr,mr,gr,!1,null,"73989aa2",null)),Or=wr.exports,Cr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"panel"},[n("h1",[t._v("Panels")]),n("fieldset",{staticClass:"existing_panels_fieldset"},[n("legend",[t._v("Existing Panels")]),n("div",{staticClass:"existing_panels"},t._l(t.panelButtons,(function(e,r){return n("div",{key:e.id,class:{panel_button:!0,active:e.id===t.currentPanel},style:"background-image: url('"+e.image+"')",on:{click:function(n){return t.updateCurrentPanel(e.id)}}},[n("div",{staticClass:"panel_text"},[n("p",[t._v(t._s(e.text))])]),n("div",{staticClass:"panel_nr"},[t._v(t._s(r+1))])])})),0)]),n("div",{staticClass:"column"},[n("button",{on:{click:t.addNewPanel}},[n("i",{staticClass:"material-icons"},[t._v("add_to_queue")]),t._v(" Add new ")]),n("button",{attrs:{disabled:!t.canDeletePanel},on:{click:t.deletePanel}},[n("i",{staticClass:"material-icons"},[t._v("remove_from_queue")]),t._v(" Delete panel ")]),n("button",{attrs:{disabled:!t.canMoveAhead},on:{click:t.moveAhead}},[n("i",{staticClass:"material-icons"},[t._v("arrow_upward")]),t._v(" Move ahead ")]),n("button",{attrs:{disabled:!t.canMoveBehind},on:{click:t.moveBehind}},[n("i",{staticClass:"material-icons"},[t._v("arrow_downward")]),t._v(" Move behind ")])]),n("fieldset",[n("legend",[t._v("Export")]),n("table",[n("tr",[t._m(0),n("td",[n("select",{directives:[{name:"model",rawName:"v-model",value:t.format,expression:"format"}],attrs:{id:"export_format"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.format=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"image/png"}},[t._v("PNG (lossless)")]),t.webpSupport?n("option",{attrs:{value:"image/webp"}},[t._v("WebP (lossy)")]):t._e(),t.heifSupport?n("option",{attrs:{value:"image/heif"}},[t._v("HEIF (lossy)")]):t._e(),n("option",{attrs:{value:"image/jpeg"}},[t._v("JPEG (lossy)")])])])]),t.isLossy?n("tr",[t._m(1),n("td",[n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.quality,expression:"quality",modifiers:{number:!0}}],attrs:{id:"export_quality",type:"number",min:"0",max:"100"},domProps:{value:t.quality},on:{input:function(e){e.target.composing||(t.quality=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]):t._e(),n("tr",[t._m(2),n("td",[n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.ppi,expression:"ppi",modifiers:{number:!0}}],attrs:{id:"export_ppi",type:"number",min:"0"},domProps:{value:t.ppi},on:{input:function(e){e.target.composing||(t.ppi=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]),n("tr",[n("td",{attrs:{colspan:"2"}},[n("button",{on:{click:t.download}},[n("i",{staticClass:"material-icons"},[t._v("photo_camera")]),t._v(" Download ")])])]),n("tr",[n("td",{attrs:{colspan:"2"}},[n("button",{on:{click:t.estimateExportSize}},[t._v("Estimate filesizes")])])])])])])},_r=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("label",{attrs:{for:"export_format"}},[t._v("Format")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("label",{attrs:{for:"export_quality"}},[t._v("Quality:")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("label",{attrs:{for:"export_ppi"}},[t._v(" Panels per image: "),n("br"),t._v("(0 for one single image) ")])])}],Pr=(n("6762"),n("2fdb"),n("c837"));(function(t){t[t["None"]=0]="None",t[t["Stretch"]=1]="Stretch",t[t["Cover"]=2]="Cover"})(kr||(kr={}));var Sr="buildin.transparent",Rr=0,Tr={panelToUrl:new Map,urlToPanel:new Map,register:function(t,e){if(this.panelToUrl.has(t)){if(this.panelToUrl.get(t)===e)return;this.unregister(t,this.panelToUrl.get(t))}this.panelToUrl.set(t,e),this.urlToPanel.has(e)?this.urlToPanel.get(e).push(t):this.urlToPanel.set(e,[t])},unregister:function(t,e){if(this.urlToPanel.has(e)){var n=this.urlToPanel.get(e);n.splice(n.indexOf(t),1),0===n.length&&(this.urlToPanel.delete(e),URL.revokeObjectURL(e))}this.panelToUrl.delete(t)}},Ir={namespaced:!0,state:{panels:{},panelOrder:[],currentPanel:null},mutations:{setCurrentPanel:function(t,e){var n=e.panelId;t.currentPanel=n},setPanelPreview:function(t,e){var n=e.panelId,r=e.url;t.panels[n].lastRender=r,Tr.register(n,r)},createPanel:function(t,e){var n=e.panel;i["a"].set(t.panels,n.id,n)},setPanelOrder:function(t,e){var n=e.panelOrder;t.panelOrder=Object(ne["a"])(n)},setCurrentBackground:function(t,e){var n=e.current,r=e.panelId,i=t.panels[r];i.background.current=n,i.background.variant=0},setBackgroundColor:function(t,e){var n=e.color,r=e.panelId,i=t.panels[r];i.background.color=n},setBackgroundFlipped:function(t,e){var n=e.flipped,r=e.panelId,i=t.panels[r];i.background.flipped=n},setBackgroundVariant:function(t,e){var n=e.variant,r=e.panelId,i=t.panels[r];i.background.variant=n},setBackgroundScaling:function(t,e){var n=e.scaling,r=e.panelId,i=t.panels[r];i.background.scaling=n},deletePanel:function(t,e){var n=e.panelId;Tr.unregister(n,Tr.panelToUrl.get(n)),delete t.panels[n]}},actions:{createPanel:function(t){var e=t.state,n=t.commit,r="panel"+ ++Rr;n("createPanel",{panel:{id:r,background:{color:"#000000",current:Sr,flipped:!1,scaling:kr.None,variant:0},lastRender:""}}),e.panelOrder?n("setPanelOrder",{panelOrder:[].concat(Object(ne["a"])(e.panelOrder),[r])}):n("setPanelOrder",{panelOrder:[r]}),n("setCurrentPanel",{panelId:r})},duplicatePanel:function(t,e){var n=t.state,r=t.commit,i=t.dispatch,a=e.panelId,o=n.panels[a],s="panel"+ ++Rr;Tr.register(s,o.lastRender),r("createPanel",{panel:{id:s,background:JSON.parse(JSON.stringify(o.background)),lastRender:o.lastRender}}),i("objects/copyObjects",{sourcePanelId:a,targetPanelId:s},{root:!0});var c=n.panelOrder.indexOf(a);r("setPanelOrder",{panelOrder:[].concat(Object(ne["a"])(n.panelOrder.slice(0,c+1)),[s],Object(ne["a"])(n.panelOrder.slice(c+1)))}),r("setCurrentPanel",{panelId:s})},seekBackgroundVariant:function(t,e){var n=t.state,r=t.rootGetters,i=t.commit,a=e.delta,o=n.panels[n.currentPanel],s=r["content/getBackgrounds"],c=s.get(o.background.current);c&&i("setBackgroundVariant",{panelId:n.currentPanel,variant:Object(Pr["a"])(c.variants,o.background.variant,a)})},delete:function(t,e){var n=t.state,r=t.dispatch,i=t.commit,a=e.panelId;if(!(n.panelOrder.length<=1)){var o,s=n.panelOrder.indexOf(a);o=s===n.panelOrder.length-1?s-1:s+1,i("setCurrentPanel",{panelId:n.panelOrder[o]}),i("setPanelOrder",{panelOrder:[].concat(Object(ne["a"])(n.panelOrder.slice(0,s)),Object(ne["a"])(n.panelOrder.slice(s+1)))}),r("objects/deleteAllOfPanel",{panelId:a},{root:!0}),i("deletePanel",{panelId:a})}},fixContentPackRemoval:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r,i,a,s,c,u,l,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=e.state,i=e.rootGetters,a=e.commit,s=e.rootState,c=function(){var t=l[u],e=n.backgrounds.find((function(e){return e.id===t.background.current}));if(!e)return{v:void 0};var r=i["content/getBackgrounds"].get(t.background.current);if(!r)return s.content.current.backgrounds[0]?a("setCurrentBackground",{current:s.content.current.backgrounds[0].id,panelId:t.id}):a("setCurrentBackground",{current:"buildin.transparent",panelId:t.id}),{v:void 0};var o=JSON.stringify(e.variants[t.background.variant]),c=r.variants.findIndex((function(t){return JSON.stringify(t)===o}));c!==t.background.variant&&a("setBackgroundVariant",{variant:-1===c?0:c,panelId:t.id})},u=0,l=Object.values(r.panels);case 3:if(!(u<l.length)){t.next=10;break}if(d=c(),"object"!==Object(o["a"])(d)){t.next=7;break}return t.abrupt("return",d.v);case 7:u++,t.next=3;break;case 10:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}(),move:function(t,e){var n=t.state,r=t.commit,i=e.panelId,a=e.delta,o=Object(ne["a"])(n.panelOrder),s=o.indexOf(i);o.splice(s,1);var c=Math.max(s+a,0);o.splice(c,0,i),r("setPanelOrder",{panelOrder:o})}}},$r=function(){function t(e,n,r,i){Object(h["a"])(this,t),this.id=e,this.assets=n,this.flip=r,this.scale=i}return Object(p["a"])(t,[{key:"updatedContent",value:function(){}},{key:"render",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r,i,a,o,s,c,u,l,d,h,p,f,b;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.assets.map((function(t){return Object(A["a"])(t,n.hq)})));case 2:r=t.sent,i=!0,a=!1,o=void 0,t.prev=6,s=r[Symbol.iterator]();case 8:if(i=(c=s.next()).done){t.next=34;break}if(u=c.value,u instanceof HTMLImageElement){t.next=12;break}return t.abrupt("return");case 12:l=0,d=0,h=u.width,p=u.height,t.t0=this.scale,t.next=t.t0===kr.None?19:t.t0===kr.Stretch?22:t.t0===kr.Cover?25:30;break;case 19:return l=K["d"]/2-h/2,d=K["c"]/2-p/2,t.abrupt("break",30);case 22:return h=K["d"],p=K["c"],t.abrupt("break",30);case 25:f=h/p,b=K["d"]/K["c"],f>b?(p=K["c"],h=p*f):(h=K["d"],p=h/f),l=K["d"]/2-h/2,d=K["c"]/2-p/2;case 30:n.drawImage({image:u,x:l,y:d,w:h,h:p,flip:this.flip});case 31:i=!0,t.next=8;break;case 34:t.next=40;break;case 36:t.prev=36,t.t1=t["catch"](6),a=!0,o=t.t1;case 40:t.prev=40,t.prev=41,i||null==s.return||s.return();case 43:if(t.prev=43,!a){t.next=46;break}throw o;case 46:return t.finish(43);case 47:return t.finish(40);case 48:case"end":return t.stop()}}),t,this,[[6,36,40,48],[41,,43,47]])})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"hitTest",value:function(t,e){return!0}},{key:"getHitbox",value:function(){return{x0:0,y0:0,x1:K["d"],y1:K["c"]}}}]),t}(),Er={id:"buildin.static-color",name:"Static color",color:"#000000",updatedContent:function(){},render:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n.drawRect({x:0,y:0,w:K["d"],h:K["c"],fill:{style:this.color}});case 1:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}(),hitTest:function(){return!0},getHitbox:function(){return{x0:0,y0:0,x1:K["d"],y1:K["c"]}}},Dr=(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}}(),function(){function t(e){Object(h["a"])(this,t),this.obj=e,this.ratio=0,this.lockedRatio=!0,this.asset=null}return Object(p["a"])(t,[{key:"updatedContent",value:function(){}},{key:"render",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r,i,a,o,s,c,u,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.obj.assets.map((function(t){return Object(A["a"])(t)})));case 2:for(r=t.sent,i=this.obj.x-this.obj.width/2,a=!0,o=!1,s=void 0,t.prev=7,c=r[Symbol.iterator]();!(a=(u=c.next()).done);a=!0)l=u.value,n.drawImage({image:l,x:i,y:this.obj.y,w:this.obj.width,h:this.obj.height,shadow:e&&n.preview?{blur:20,color:"red"}:void 0,flip:this.obj.flip,opacity:this.obj.opacity});t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](7),o=!0,s=t.t0;case 15:t.prev=15,t.prev=16,a||null==c.return||c.return();case 18:if(t.prev=18,!o){t.next=21;break}throw s;case 21:return t.finish(18);case 22:return t.finish(15);case 23:case"end":return t.stop()}}),t,this,[[7,11,15,23],[16,,18,22]])})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"hitTest",value:function(t,e){var n=t-this.obj.x+this.obj.width/2,r=e-this.obj.y;return n>=0&&n<=this.obj.width&&r>=0&&r<=this.obj.height}},{key:"getHitbox",value:function(){return{x0:this.obj.x-this.obj.width/2,x1:this.obj.x+this.obj.width/2,y0:this.obj.y,y1:this.obj.y+this.obj.height}}},{key:"id",get:function(){return this.obj.id}},{key:"infront",get:function(){return this.obj.onTop}}]),t}()),Hr=n("1a7b"),Br=n("fd0b");function Lr(t,e,n,r,i,a){r<0&&(r=0),i<0&&(i=0),r<2*a&&(a=r/2),i<2*a&&(a=i/2),t.moveTo(e+a,n),t.arcTo(e+r,n,e+r,n+i,a),t.arcTo(e+r,n+i,e,n+i,a),t.arcTo(e,n+i,e,n,a),t.arcTo(e,n,e+r,n,a),t.closePath()}function Nr(t,e,n,r,i,a){r<0&&(r=0),i<0&&(i=0),r<2*a&&(a=r/2),i<2*a&&(a=i/2),t.moveTo(e+a,n),t.arcTo(e+r,n,e+r,n+i,a),t.lineTo(e+r,n+i),t.lineTo(e,n+i),t.arcTo(e,n,e+r,n,a),t.closePath()}var Ar=new ae(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),Mr=new ae(.002028397565922768,0,.13725490196078438,0),Fr=.82,Wr=new ae(-.004901960784313708,-.8599999999999999,-.16274509803921566,0),Ur=12,zr=12,Gr=1.5,qr=new ae(.08045977011494243,-.5714285714285714,-.5960784313725489,0),Vr=new ae(0,-.14285714285714296,.3,0),Yr=new ae(.004269293924466178,-.01869158878504662,-.039215686274509665,0),Qr=9.5,Xr=47,Jr=new ae(.0023347701149424305,0,.10784313725490202,0);function Kr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Zr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Kr(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Kr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ti=function(){function t(e){Object(h["a"])(this,t),this.obj=e,this.display=!0,this.lastVersion=-1,this.lastX=0,this.lastY=0,this.lastH=0,this.lastW=0,this.localRenderer=new Br["a"](K["d"],K["c"])}return Object(p["a"])(t,[{key:"updatedContent",value:function(){}},{key:"hitTest",value:function(t,e){var n=this.width,r=this.height,i=n/2,a=this.obj.x-i,o=a+n,s=this.obj.y,c=s+r;return a<=t&&o>=t&&s<=e&&c>=e}},{key:"render",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.lastVersion===this.obj.version&&this.lastX===this.obj.x&&this.lastY===this.obj.y&&this.lastH===this.obj.height&&this.lastW===this.obj.width){t.next=6;break}return t.next=3,this.updateLocalCanvas();case 3:this.lastVersion=this.obj.version,this.lastX=this.obj.x,this.lastY=this.obj.y;case 6:n.drawImage({image:this.localRenderer,x:0,y:0,flip:this.obj.flip,shadow:e&&n.preview?{blur:20,color:"red"}:void 0,opacity:this.obj.opacity});case 7:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"updateLocalCanvas",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.localRenderer.render(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(n){var r,i,a,o,s,c,u,l,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.width,i=e.height,a=r/2,o=e.obj.x-a,s=e.obj.y,t.next=7,e.renderBackdrop(n,o,s+cn);case 7:if("No-one"===e.obj.talkingDefault){t.next=11;break}return c="Other"===e.obj.talkingDefault?e.obj.talkingOther:e.obj.talkingDefault,t.next=11,e.renderNamebox(n,o+ln,s,c);case 11:return t.next=13,e.renderText(n,o,s,e.obj.autoWrap?r:0);case 13:if(u=s+i,l=u-hn,d=o+r/2,e.obj.controls&&(n.drawText(Zr({text:"History",x:d+pn,y:l},e.controlsStyle)),n.drawText(Zr({text:"Skip",x:d+fn,y:l},e.obj.skip?e.controlsStyle:e.controlsDisableStyle)),n.drawText(Zr({text:"Auto   Save   Load   Settings",x:d+bn,y:l},e.controlsStyle))),!e.obj.continue){t.next=26;break}return t.t0=n,t.next=21,Object(A["b"])("next");case 21:t.t1=t.sent,t.t2=o+r-vn,t.t3=u-mn,t.t4={image:t.t1,x:t.t2,y:t.t3},t.t0.drawImage.call(t.t0,t.t4);case 26:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getHitbox",value:function(){return{x0:this.obj.x-this.obj.width/2,x1:this.obj.x+this.obj.width/2,y0:this.obj.y,y1:this.obj.y+this.obj.height}}},{key:"renderNamebox",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n,r,i){var a,o,s,c,u=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(o=cn,s=xn,"custom"!==this.obj.style){t.next=8;break}s=Zr({},s,{strokeColor:this.nameboxOutlineColor,strokeWidth:6,color:"#FFFFFF"}),a=this.obj.customNameboxWidth,e.customTransform((function(t){t.beginPath(),Nr(t,n,r,a,o,Ur),t.clip()}),(function(t){var e=t.linearGradient(n,r,n,r+cn),i=oe.fromCss(u.nameboxBackgroundColor),a=new oe(i.r,i.g,i.b,.95),s=a.toHSL().shift(Wr).toRgb();e.addColorStop(0,a.toCss()),e.addColorStop(Fr,a.toCss()),e.addColorStop(1,s.toCss()),t.drawRect({x:n,y:r,w:u.obj.width,h:o,fill:{style:e}})})),t.next=21;break;case 8:if("none"===this.obj.style){t.next=20;break}return a=un,t.t0=e,t.next=13,Object(A["b"])("namebox");case 13:t.t1=t.sent,t.t2=n,t.t3=r,t.t4={image:t.t1,x:t.t2,y:t.t3},t.t0.drawImage.call(t.t0,t.t4),t.next=21;break;case 20:a=un;case 21:return c=new qe(i,s),t.next=24,c.loadFonts();case 24:c.fixAlignment("center",n,n+a,r+dn,0),c.render(e.fsCtx);case 26:case"end":return t.stop()}}),t,this)})));function e(e,n,r,i){return t.apply(this,arguments)}return e}()},{key:"renderBackdrop",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n,r){var i,a,o,c,u=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("custom"!==this.obj.style){t.next=9;break}i=oe.fromCss(this.obj.customColor).toHSL(),a=new Br["a"](Xr,Xr),a.render(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=function(t,r){e.drawPath({path:function(e){e.ellipse(t,r,Qr,Qr,0,0,2*Math.PI)},fill:n})},n={style:i.shift(Yr).toRgb().toCss()},r(0,0),r(Xr,0),r(0,Xr),r(Xr,Xr),r(Xr/2,Xr/2);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),!0),e.customTransform((function(t){t.beginPath(),Lr(t,n+Gr,r+Gr,u.obj.width-2*Gr,u.obj.height-2*Gr,zr),t.clip()}),(function(t){var e=u.obj.height,i=u.obj.width,o=t.linearGradient(n,r,n,r+e),s=oe.fromHex(u.obj.customColor);o.addColorStop(0,s.toCss()),o.addColorStop(1,"rgba(".concat(s.r,",").concat(s.g,",").concat(s.b,",0.6667)")),t.drawRect({x:n,y:r,w:i,h:e,fill:{style:o},outline:{style:"#ffdfee",width:6}}),t.customTransform((function(t){t.translate(n,r)}),(function(n){var r=t.patternFrom(a);t.drawRect({x:0,y:0,w:i,h:e,fill:{style:r},composition:"source-atop"})}));var c=t.linearGradient(n,r+e-yn,n,r+e);c.addColorStop(0,"rgba(255,255,255,0.3137)"),c.addColorStop(.5,"rgba(255,255,255,0.0627)"),c.addColorStop(1,"rgba(255,255,255,0)"),t.drawPath({path:function(t){t.ellipse(n+i/2,r+e,gn,yn,0,0,2*Math.PI)},fill:{style:c}})})),o=i.shift(Jr).toRgb().toCss(),e.drawPath({path:function(t){Lr(t,n+Gr,r+Gr,u.obj.width-2*Gr,u.obj.height-2*Gr,zr)},outline:{style:o,width:3}}),t.next=15;break;case 9:if("none"===this.obj.style){t.next=15;break}return"corrupt"===this.obj.style&&(n+=(en-nn)/2),t.next=13,Object(A["b"])("corrupt"===this.obj.style?"textbox_monika":"textbox");case 13:c=t.sent,e.drawImage({image:c,x:n,y:r});case 15:case"end":return t.stop()}}),t,this)})));function e(e,n,r){return t.apply(this,arguments)}return e}()},{key:"renderText",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n,r,i){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=new qe(this.obj.text,{alpha:1,color:"#ffffff",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,strokeColor:"#523140",strokeWidth:4,lineSpacing:1.2}),this.obj.autoQuoting&&"No-one"!==this.obj.talkingDefault&&a.quote(),t.next=4,a.loadFonts();case 4:a.fixAlignment("left",n+on,0,r+cn+sn,i-on-on),a.render(e.fsCtx);case 6:case"end":return t.stop()}}),t,this)})));function e(e,n,r,i){return t.apply(this,arguments)}return e}()},{key:"id",get:function(){return this.obj.id}},{key:"width",get:function(){return"custom"===this.obj.style?this.obj.width:en}},{key:"height",get:function(){return("custom"===this.obj.style?this.obj.height:rn)+cn}},{key:"controlColor",get:function(){if(this.obj.deriveCustomColors){var t=oe.fromCss(this.obj.customColor).toHSL();return t.shift(qr).toRgb().toCss()}return this.obj.customControlsColor}},{key:"controlsStyle",get:function(){return"custom"!==this.obj.style?jn:Zr({},jn,{fill:{style:this.controlColor}})}},{key:"controlsDisableStyle",get:function(){if("custom"!==this.obj.style)return wn;var t=oe.fromCss(this.controlColor).toHSL(),e=t.shift(Vr).toRgb().toCss();return Zr({},jn,{fill:{style:e}})}},{key:"nameboxOutlineColor",get:function(){if(this.obj.deriveCustomColors){var t=oe.fromCss(this.obj.customColor).toHSL();return t.shift(Ar).toRgb().toCss()}return this.obj.customNameboxStroke}},{key:"nameboxBackgroundColor",get:function(){if(this.obj.deriveCustomColors){var t=oe.fromCss(this.obj.customColor).toHSL();return t.shift(Mr).toRgb().toCss()}return this.obj.customNameboxColor}}]),t}(),ei=(new ae(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),"#ffe6f4"),ni="#ffbde1",ri=420,ii=22,ai=270,oi=7,si=(K["c"]-ai)/2,ci={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},ui=function(){function t(e){Object(h["a"])(this,t),this.obj=e,this.display=!0,this.lastVersion=-1,this.lastX=0,this.lastY=0,this.lastH=0,this.lastW=0,this.localRenderer=new Br["a"](K["d"],K["c"]),this.height=0,this.choiceRenderers=[]}return Object(p["a"])(t,[{key:"updatedContent",value:function(){}},{key:"hitTest",value:function(t,e){var n=t-(this.obj.x-this.width/2),r=e-(this.obj.y-this.height/2);return!(n<0||n>this.width)&&!(r<0||r>this.height)}},{key:"getHitbox",value:function(){var t=this.width/2,e=this.height/2;return{x0:this.obj.x-t,x1:this.obj.x+t,y0:this.obj.y-e,y1:this.obj.y+e}}},{key:"render",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.lastVersion===this.obj.version&&this.lastX===this.obj.x&&this.lastY===this.obj.y&&this.lastH===this.obj.height&&this.lastW===this.obj.width){t.next=6;break}return t.next=3,this.updateLocalCanvas();case 3:this.lastVersion=this.obj.version,this.lastX=this.obj.x,this.lastY=this.obj.y;case 6:n.drawImage({image:this.localRenderer,x:0,y:0,flip:this.obj.flip,shadow:e&&n.preview?{blur:20,color:"red"}:void 0,opacity:this.obj.opacity});case 7:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"updateLocalCanvas",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.localRenderer.render(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(n){var r,i,a,o,s,c,u,l,d,h,p,f;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.updateChoiceBounds();case 2:r=e.width,i=e.height,a=r/2,o=e.obj.x-a,s=e.obj.y-i/2,c=!0,u=!1,l=void 0,t.prev=10,d=e.choiceRenderers[Symbol.iterator]();case 12:if(c=(h=d.next()).done){t.next=24;break}return p=h.value,t.next=16,p.loadFonts();case 16:f=p.getHeight(e.obj.autoWrap?e.obj.width:0),n.drawRect({x:o,y:s,w:r,h:f+2*oi,outline:{style:ni,width:3},fill:{style:ei}}),p.fixAlignment("center",o,o+r,s+1.25*ii,e.obj.autoWrap?r:0),p.render(n.fsCtx),s+=f+2*oi+ii;case 21:c=!0,t.next=12;break;case 24:t.next=30;break;case 26:t.prev=26,t.t0=t["catch"](10),u=!0,l=t.t0;case 30:t.prev=30,t.prev=31,c||null==d.return||d.return();case 33:if(t.prev=33,!u){t.next=36;break}throw l;case 36:return t.finish(33);case 37:return t.finish(30);case 38:case"end":return t.stop()}}),t,null,[[10,26,30,38],[31,,33,37]])})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"updateChoiceBounds",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.choiceRenderers=this.obj.choices.map((function(t){return new qe(t.text||" ",ci)})),this.height=this.choiceRenderers.reduce((function(t,n){return t+n.getHeight(e.obj.autoWrap?e.obj.width:0)+2*oi}),0)+this.obj.choiceDistance*(this.obj.choices.length-1);case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"id",get:function(){return this.obj.id}},{key:"width",get:function(){return this.obj.width}}]),t}(),li=n("522c"),di=n.n(li);function hi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function pi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?hi(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):hi(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var fi="rgba(255,255,255,0.6)",bi=40,vi=30,mi=pi({},kn,{fontName:"riffic",fontSize:24,strokeColor:"#bb5599",strokeWidth:8,letterSpacing:1,color:"white"}),gi={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0},yi=function(){function t(e){Object(h["a"])(this,t),this.obj=e,this.display=!0,this.lastVersion=-1,this.lastX=0,this.lastY=0,this.lastH=0,this.lastW=0,this.localRenderer=new Br["a"](K["d"],K["c"]),this.height=0,this.width=0}return Object(p["a"])(t,[{key:"updatedContent",value:function(){}},{key:"hitTest",value:function(t,e){var n=t-(this.obj.x-this.width/2),r=e-(this.obj.y-this.height/2);return!(n<0||n>this.width)&&!(r<0||r>this.height)}},{key:"getHitbox",value:function(){var t=this.width/2,e=this.height/2;return{x0:this.obj.x-t,x1:this.obj.x+t,y0:this.obj.y-e,y1:this.obj.y+e}}},{key:"render",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.lastVersion===this.obj.version&&this.lastX===this.obj.x&&this.lastY===this.obj.y&&this.lastH===this.obj.height&&this.lastW===this.obj.width){t.next=6;break}return t.next=3,this.updateLocalCanvas();case 3:this.lastVersion=this.obj.version,this.lastX=this.obj.x,this.lastY=this.obj.y;case 6:this.obj.backdrop&&n.drawRect({x:0,y:0,w:K["d"],h:K["c"],fill:{style:fi}}),n.drawImage({image:this.localRenderer,x:0,y:0,flip:this.obj.flip,shadow:e&&n.preview?{blur:20,color:"red"}:void 0,opacity:this.obj.opacity});case 8:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"updateLocalCanvas",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.localRenderer.render(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(n){var r,i,a,o,s,c,u,l,d,h,p,f;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=new qe(e.obj.text,gi),i=new qe("OK",mi),t.next=4,r.loadFonts();case 4:return t.next=6,i.loadFonts();case 6:a=e.obj.autoWrap?e.obj.width-2*bi:0,o=e.obj.autoWrap?a:r.getWidth(),s=r.getHeight(a),c=e.obj.autoWrap?a:i.getWidth(),u=i.getHeight(a),e.width=Math.max(o,c)+2*bi,e.height=s+2*bi+vi+u,l=e.width,d=e.height,h=l/2,p=e.obj.x-h,f=e.obj.y-d/2,n.drawRect({x:p,y:f,w:l,h:d,outline:{style:ni,width:3},fill:{style:ei}}),r.fixAlignment("center",p,p+l,f+1.5*bi,a),r.render(n.fsCtx),i.fixAlignment("center",p,p+l,f+d-bi,a),i.render(n.fsCtx);case 23:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"id",get:function(){return this.obj.id}}]),t}();function ki(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function xi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ki(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ki(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ji=[{name:"Normal paper",file:"poem.jpg"},{name:"Lightly soiled paper",file:"poem_y1.jpg"},{name:"Heavily soiled paper",file:"poem_y2.jpg"},{name:"Console",file:"internal:console"},{name:"Transparent",file:"internal:transparent"}],wi=0,Oi=0,Ci=K["d"]/2,_i=K["c"]/2,Pi=33,Si=30,Ri=800,Ti=720,Ii="rgba(51,51,51,0.75)",$i=480,Ei=180,Di=3,Hi=7,Bi={alpha:1,color:"black",isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0,fontName:"aller",fontSize:12},Li=[xi({},Bi,{name:"Sayori",fontName:"hashtag",fontSize:34,lineSpacing:1.05,letterSpacing:0}),xi({},Bi,{name:"Natsuki",fontName:"ammy_handwriting",fontSize:28}),xi({},Bi,{name:"Monika",fontName:"journal",fontSize:34}),xi({},Bi,{name:"Yuri",fontName:"jp_hand_slanted",lineSpacing:1.5,fontSize:32}),xi({},Bi,{name:"Yuri Act 2",fontName:"damagrafik_script",fontSize:18,letterSpacing:-8}),xi({},Bi,{name:"Yuri Unused",fontName:"as_i_lay_dying",fontSize:40}),xi({},Bi,{name:"MC",fontName:"halogen",fontSize:30,lineSpacing:1.53}),xi({},Bi,{name:"Console",fontName:"f25_bank_printer",fontSize:18,color:"white",lineSpacing:1.1})],Ni=-2,Ai=26,Mi=10,Fi=10,Wi=function(){function t(e){Object(h["a"])(this,t),this.obj=e,this.lastVersion=-1,this.lastX=0,this.lastY=0,this.lastH=0,this.lastW=0,this.localRenderer=new Br["a"](K["d"],K["c"]),this.height=0,this.width=0,this.choiceRenderers=[]}return Object(p["a"])(t,[{key:"updatedContent",value:function(){}},{key:"hitTest",value:function(t,e){var n=t-(this.obj.x-this.width/2),r=e-(this.obj.y-this.height/2);return!(n<0||n>this.width)&&!(r<0||r>this.height)}},{key:"getHitbox",value:function(){var t=this.width/2,e=this.height/2;return{x0:this.obj.x-t,x1:this.obj.x+t,y0:this.obj.y-e,y1:this.obj.y+e}}},{key:"render",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.lastVersion===this.obj.version&&this.lastX===this.obj.x&&this.lastY===this.obj.y&&this.lastH===this.obj.height&&this.lastW===this.obj.width){t.next=6;break}return t.next=3,this.updateLocalCanvas();case 3:this.lastVersion=this.obj.version,this.lastX=this.obj.x,this.lastY=this.obj.y;case 6:n.drawImage({image:this.localRenderer,x:0,y:0,flip:this.obj.flip,shadow:e&&n.preview?{blur:20,color:"red"}:void 0,opacity:this.obj.opacity});case 7:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"updateLocalCanvas",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.localRenderer.render(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(n){var r,i,a,o,s,c,u,l,d,h,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=ji[e.obj.background],i=e.obj.y,a=e.obj.x+Fi,o=Si,s=Pi,c=2*o,"internal:console"!==r.file){t.next=15;break}u=e.height=e.obj.height,l=e.width=e.obj.width,n.drawRect({x:e.obj.x-l/2,y:e.obj.y-u/2,h:u,w:l,fill:{style:Ii}}),o=Ni,s=Ai,c=Mi,t.next=24;break;case 15:if("internal:transparent"!==r.file){t.next=20;break}e.height=e.obj.height,e.width=e.obj.width,t.next=24;break;case 20:return t.next=22,Object(A["c"])("assets/poemBackgrounds/".concat(r.file));case 22:d=t.sent,d instanceof HTMLImageElement&&(n.drawImage({image:d,x:e.obj.x-d.width/2,y:e.obj.y-d.height/2}),e.height=d.height,e.width=d.width);case 24:return i-=e.height/2,a-=e.width/2,h=Li[e.obj.font],p=new qe(e.obj.text,h),t.next=30,p.loadFonts();case 30:p.fixAlignment("left",a+o,a+o,i+s+o,e.obj.autoWrap?e.width-c:0),p.render(n.fsCtx);case 32:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"id",get:function(){return this.obj.id}}]),t}(),Ui=function(){function t(e,n,r,i){Object(h["a"])(this,t),this.store=e,this.panelId=n,this.canvasWidth=r,this.canvasHeight=i,this.renderObjectCache=new Map,this.lCurrentlyRendering=!1,this.state=e.state,this.renderer=new Br["a"](r,i)}return Object(p["a"])(t,[{key:"render",value:function(t){return this.panel?this.renderer.render(this.renderCallback.bind(this),t):Promise.resolve(!1)}},{key:"download",value:function(){var t=new Date,e="panel-".concat([t.getFullYear(),di()(t.getMonth()+1,2,"0"),di()(t.getDate(),2,"0"),di()(t.getHours(),2,"0"),di()(t.getMinutes(),2,"0"),di()(t.getSeconds(),2,"0")].join("-"),".png");return this.renderer.download(this.renderCallback.bind(this),e)}},{key:"paintOnto",value:function(t,e,n,r,i){this.renderer.paintOnto(t,e,n,r,i)}},{key:"objectsAt",value:function(t,e){return this.getRenderObjects().filter((function(n){return n.hitTest(t,e)})).map((function(t){return t.id}))}},{key:"renderCallback",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,i,a,o,s,c,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.lCurrentlyRendering=!0,t.prev=1,!e.preview){t.next=9;break}return t.t0=e,t.next=6,Object(A["b"])("backgrounds/transparent");case 6:t.t1=t.sent,t.t2={x:0,y:0,image:t.t1},t.t0.drawImage.call(t.t0,t.t2);case 9:return t.next=11,null===(n=this.getBackgroundRenderer())||void 0===n?void 0:n.render(!1,e);case 11:r=this.state.ui.selection,i=!0,a=!1,o=void 0,t.prev=15,s=this.getRenderObjects()[Symbol.iterator]();case 17:if(i=(c=s.next()).done){t.next=25;break}return u=c.value,u.updatedContent(this.store),t.next=22,u.render(r===u.id,e);case 22:i=!0,t.next=17;break;case 25:t.next=31;break;case 27:t.prev=27,t.t3=t["catch"](15),a=!0,o=t.t3;case 31:t.prev=31,t.prev=32,i||null==s.return||s.return();case 34:if(t.prev=34,!a){t.next=37;break}throw o;case 37:return t.finish(34);case 38:return t.finish(31);case 39:return t.prev=39,this.lCurrentlyRendering=!1,t.finish(39);case 42:case"end":return t.stop()}}),t,this,[[1,,39,42],[15,27,31,39],[32,,34,38]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getRenderObjects",value:function(){var t=this,e=this.state.objects.panels[this.panelId],n=e?[].concat(Object(ne["a"])(e.order),Object(ne["a"])(e.onTopOrder)):[],r=this.state.objects.objects,i=Object.keys(this.renderObjectCache).filter((function(t){return!n.includes(t)})),a=!0,o=!1,s=void 0;try{for(var c,u=i[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var l=c.value;this.renderObjectCache.delete(l)}}catch(d){o=!0,s=d}finally{try{a||null==u.return||u.return()}finally{if(o)throw s}}return n.map((function(e){var n=t.renderObjectCache.get(e);if(!n){var i=r[e];switch(i.type){case"sprite":n=new Dr(i);break;case"character":var a=i;n=new Hr["a"](a,Object(Q["f"])(t.store,a));break;case"textBox":n=new ti(i);break;case"choice":n=new ui(i);break;case"notification":n=new yi(i);break;case"poem":n=new Wi(i);break}t.renderObjectCache.set(e,n)}return n}))}},{key:"getBackgroundRenderer",value:function(){var t=this.panel;switch(t.background.current){case"buildin.static-color":return Er.color=t.background.color,Er;default:var e=this.store.getters["content/getBackgrounds"],n=e.get(t.background.current);if(!n)return null;var r=n.variants[t.background.variant];return r?new $r(t.background.current,r,t.background.flipped,t.background.scaling):null}}},{key:"currentlyRendering",get:function(){return this.lCurrentlyRendering}},{key:"panel",get:function(){return this.state.panels.panels[this.panelId]}}]),t}(),zi=n("0c0f"),Gi=1.5,qi=1/4,Vi=.5,Yi=100,Qi=90,Xi=70,Ji=function(t){function e(){var t;return Object(h["a"])(this,e),t=Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.webpSupport=!1,t.heifSupport=!1,t.ppi=0,t.format="image/png",t.quality=Qi,t}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"created",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(A["d"])();case 2:this.webpSupport=t.sent;case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"mounted",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n,r=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.moveFocusToActivePanel(),e=new Ui(this.$store,this.currentPanel,K["d"],K["c"]),t.next=4,e.render(!1);case 4:return n=document.createElement("canvas"),n.width=K["d"]*qi,n.height=K["c"]*qi,e.paintOnto(n.getContext("2d"),0,0,n.width,n.height),t.t0=n,t.t1=function(t){if(t){var e=URL.createObjectURL(t);r.vuexHistory.transaction((function(){r.$store.commit("panels/setPanelPreview",{panelId:r.$store.state.panels.currentPanel,url:e})}))}},t.next=12,Object(A["d"])();case 12:if(!t.sent){t.next=16;break}t.t2="image/webp",t.next=17;break;case 16:t.t2="image/jpeg";case 17:t.t3=t.t2,t.t4=Vi,t.t0.toBlob.call(t.t0,t.t1,t.t3,t.t4);case 20:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"download",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n,r,i,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.getPanelDistibution(),n=new Date,r="cd-".concat([n.getFullYear(),di()(n.getMonth()+1,2,"0"),di()(n.getDate(),2,"0"),di()(n.getHours(),2,"0"),di()(n.getMinutes(),2,"0"),di()(n.getSeconds(),2,"0")].join("-")),i=this.format.split("/")[1],a=this.format,o=this.quality,t.next=8,this.renderObjects(e,!0,function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:P["a"].saveToFile(n,"".concat(r,"_").concat(e,".").concat(i),a,o/Yi);case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"estimateExportSize",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n,r,i,a,o,c,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.getPanelDistibution(),n=this.format||"image/png",r=this.quality||Qi,t.next=5,this.renderObjects(e,!1,function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,i){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,a){i.toBlob((function(n){n?t(n.size):a("Image ".concat(e+1," could not be rendered."))}),n,r/Yi)})));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 5:i=t.sent,a=i.map((function(t){return(t*Gi/1024/1024).toFixed(2)+"MiB"})),o=a.length>1?"files":"file",c=a.length>1?"These":"It",u=a.length>1?"sizes":"size",zi["f"].fire(new zi["d"]("This would export ".concat(a.length," ").concat(o,". ").concat(c," would have the following (aproximate) ").concat(u,": ").concat(a.join(","))));case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"warnImageQuality",value:function(t,e){t!==Yi?e>Xi&&t<=Xi&&zi["f"].fire(new zi["d"]("Note: A quality level below 70% might be very noticable and impair legibility of text.")):zi["f"].fire(new zi["d"]("Note: 100% quality on a lossy format is still not lossless! Select PNG if you want lossless compression."))}},{key:"renderObjects",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n,r){var i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(e.map(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,a){var o,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=document.createElement("canvas"),o.width=K["d"],o.height=K["c"]*e.length,c=o.getContext("2d"),t.next=6,Promise.all(e.map(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r,a){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=new Ui(i.$store,e[a],K["d"],K["c"]),t.next=3,o.render(n);case 3:o.paintOnto(c,0,K["c"]*a,K["d"],K["c"]);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()));case 6:return t.next=8,r(a,o);case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));function e(e,n,r){return t.apply(this,arguments)}return e}()},{key:"getPanelDistibution",value:function(){var t=this.$store.state.panels.panelOrder;if(0===this.ppi)return[t];for(var e=[],n=0;n<t.length/this.ppi;++n){var r=n*this.ppi,i=r+this.ppi;e.push(Object(ne["a"])(t.slice(r,i)))}return e}},{key:"moveFocusToActivePanel",value:function(){var t=this.$el.querySelector(".panel_button.active");t&&this.scrollIntoView(t)}},{key:"scrollIntoView",value:function(t){var e=t.parentElement,n=Array.from(e.children).indexOf(t);if(this.$store.state.ui.vertical){var r=n*t.clientHeight-e.clientHeight/2+t.clientHeight/2;e.scrollTop=r,e.scrollLeft=0}else{var i=n*t.clientWidth-e.clientWidth/2+t.clientWidth/2;e.scrollLeft=i,e.scrollTop=0}}},{key:"extractObjectText",value:function(t){switch(t.type){case"textBox":return t.text;case"notification":return t.text;case"poem":return t.text;case"choice":return t.choices.map((function(t){return"[".concat(t.text,"]")})).join("\n")}return""}},{key:"addNewPanel",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$store.dispatch("panels/duplicatePanel",{panelId:e.$store.state.panels.currentPanel});case 1:case"end":return t.stop()}}),t)}))));case 2:this.$nextTick((function(){e.moveFocusToActivePanel()}));case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"updateCurrentPanel",value:function(t){var e=this;this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.$store.commit("panels/setCurrentPanel",{panelId:t});case 1:case"end":return n.stop()}}),n)})))),this.$nextTick((function(){e.moveFocusToActivePanel()}))}},{key:"deletePanel",value:function(){var t=this;this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("panels/delete",{panelId:t.$store.state.panels.currentPanel});case 1:case"end":return e.stop()}}),e)})))),this.$nextTick((function(){t.moveFocusToActivePanel()}))}},{key:"moveAhead",value:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("panels/move",{panelId:t.currentPanel,delta:-1})}))}},{key:"moveBehind",value:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("panels/move",{panelId:t.currentPanel,delta:1})}))}},{key:"isLossy",get:function(){return"image/png"!==this.format}},{key:"canDeletePanel",get:function(){return this.panelButtons.length>1}},{key:"panelButtons",get:function(){var t=this,e=this.$store.state.panels.panelOrder;return e.map((function(e){var n=t.$store.state.panels.panels[e],r=t.$store.state.objects.panels[e],i=r?[].concat(r.order,r.onTopOrder).map((function(e){return t.$store.state.objects.objects[e]})).map(t.extractObjectText):[];return{id:e,image:n.lastRender,text:i.reduce((function(t,e){return t.length>e.length?t:e}),"")}}))}},{key:"canMoveAhead",get:function(){var t=this.$store.state.panels.panelOrder,e=t.indexOf(this.currentPanel);return e>0}},{key:"canMoveBehind",get:function(){var t=this.$store.state.panels.panelOrder,e=t.indexOf(this.currentPanel);return e<t.length-1}}]),e}(Object(g["b"])(_));Object(m["a"])([Object(x["a"])("currentPanel",{namespace:"panels"})],Ji.prototype,"currentPanel",void 0),Object(m["a"])([Object(g["e"])("quality")],Ji.prototype,"warnImageQuality",null),Ji=Object(m["a"])([Object(g["a"])({})],Ji);var Ki=Ji,Zi=Ki,ta=(n("b43e"),Object(D["a"])(Zi,Cr,_r,!1,null,"e26030e8",null)),ea=ta.exports,na=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"panel"},[n("h1",[t._v("Notification")]),t.textEditor?n("text-editor",{attrs:{title:"Notification Text"},on:{leave:function(e){t.textEditor=!1}},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}}):[n("div",{attrs:{id:"notification_text"}},[n("label",{attrs:{for:"notification_text"}},[t._v("Text:")]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],attrs:{id:"notification_text"},domProps:{value:t.text},on:{keydown:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.text=e.target.value)}}}),t._v(" "),n("button",{on:{click:function(e){t.textEditor=!0}}},[t._v("Formatting")])]),n("position-and-size",{attrs:{obj:t.sprite}}),n("toggle",{attrs:{label:"Auto line wrap?"},model:{value:t.autoWrap,callback:function(e){t.autoWrap=e},expression:"autoWrap"}}),n("layers",{attrs:{obj:t.sprite}}),n("opacity",{attrs:{obj:t.sprite}}),n("toggle",{attrs:{label:"Flip?"},model:{value:t.flip,callback:function(e){t.flip=e},expression:"flip"}}),n("toggle",{attrs:{label:"Show backdrop?"},model:{value:t.renderBackdrop,callback:function(e){t.renderBackdrop=e},expression:"renderBackdrop"}}),n("delete",{attrs:{obj:t.sprite}})]],2)},ra=[],ia=function(t){function e(){var t;return Object(h["a"])(this,e),t=Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.textEditor=!1,t}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"sprite",get:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("notification"===t.type)return t}},{key:"flip",get:function(){return this.sprite.flip},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setFlip",{id:e.sprite.id,flip:t})}))}},{key:"autoWrap",get:function(){return this.sprite.autoWrap},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setAutoWrapping",{id:e.sprite.id,autoWrap:t})}))}},{key:"text",get:function(){return this.sprite.text},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setNotificationText",{id:e.sprite.id,text:t})}))}},{key:"renderBackdrop",get:function(){return this.sprite.backdrop},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setNotificationBackdrop",{id:e.sprite.id,backdrop:t})}))}}]),e}(Object(g["b"])(_));ia=Object(m["a"])([Object(g["a"])({components:{Toggle:O["a"],PositionAndSize:rt,Layers:lt,Opacity:mt,Delete:Ot,TextEditor:Rn}})],ia);var aa=ia,oa=aa,sa=(n("456a"),Object(D["a"])(oa,na,ra,!1,null,"efac3e1e",null)),ca=sa.exports,ua=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"panel"},[n("h1",[t._v(t._s("poem"===t.sprite.subType?"Poem":"Console"))]),t.textEditor?n("text-editor",{attrs:{title:"Poem Text"},on:{leave:function(e){t.textEditor=!1}},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}}):[n("div",{attrs:{id:"notification_text"}},[n("label",{attrs:{for:"notification_text"}},[t._v("Text:")]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],attrs:{id:"notification_text"},domProps:{value:t.text},on:{keydown:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.text=e.target.value)}}}),t._v(" "),n("button",{on:{click:function(e){t.textEditor=!0}}},[t._v("Formatting")])]),n("toggle",{attrs:{label:"Auto line wrap?"},model:{value:t.autoWrap,callback:function(e){t.autoWrap=e},expression:"autoWrap"}}),"poem"===t.sprite.subType?[n("select",{directives:[{name:"model",rawName:"v-model",value:t.poemBackground,expression:"poemBackground"}],on:{keydown:function(t){t.stopPropagation()},change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.poemBackground=e.target.multiple?n:n[0]}}},t._l(t.backgrounds,(function(e,r){return n("option",{key:r,domProps:{value:r}},[t._v(t._s(e.name))])})),0),n("select",{directives:[{name:"model",rawName:"v-model",value:t.poemStyle,expression:"poemStyle"}],on:{keydown:function(t){t.stopPropagation()},change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.poemStyle=e.target.multiple?n:n[0]}}},t._l(t.poemTextStyles,(function(e,r){return n("option",{key:r,domProps:{value:r}},[t._v(t._s(e.name))])})),0)]:t._e(),n("position-and-size",{attrs:{obj:t.sprite}}),n("layers",{attrs:{obj:t.sprite}}),n("opacity",{attrs:{obj:t.sprite}}),n("toggle",{attrs:{label:"Flip?"},model:{value:t.flip,callback:function(e){t.flip=e},expression:"flip"}}),n("delete",{attrs:{obj:t.sprite}})]],2)},la=[],da=function(t){function e(){var t;return Object(h["a"])(this,e),t=Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.textEditor=!1,t}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"backgrounds",get:function(){return ji}},{key:"poemTextStyles",get:function(){return Li}},{key:"sprite",get:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("poem"===t.type)return t}},{key:"flip",get:function(){return this.sprite.flip},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setFlip",{id:e.sprite.id,flip:t})}))}},{key:"text",get:function(){return this.sprite.text},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setPoemText",{id:e.sprite.id,text:t})}))}},{key:"autoWrap",get:function(){return this.sprite.autoWrap},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setAutoWrapping",{id:e.sprite.id,autoWrap:t})}))}},{key:"poemStyle",get:function(){return this.sprite.font},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setPoemFont",{id:e.sprite.id,font:t})}))}},{key:"poemBackground",get:function(){return this.sprite.background},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setPoemBackground",{id:e.sprite.id,background:t})}))}}]),e}(Object(g["b"])(_));da=Object(m["a"])([Object(g["a"])({components:{Toggle:O["a"],PositionAndSize:rt,Layers:lt,Opacity:mt,Delete:Ot,TextEditor:Rn}})],da);var ha=da,pa=ha,fa=(n("8554"),Object(D["a"])(pa,ua,la,!1,null,"2ac7befd",null)),ba=fa.exports,va=function(t){function e(){var t;return Object(h["a"])(this,e),t=Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.panelSelection="add",t}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"create",value:function(){var t=this;P["a"].onPanelChange((function(e){t.panelSelection=e}))}},{key:"setPanel",value:function(t){if(t===this.panelSelection&&(t="add"),this.panelSelection=t,this.selection){if(null===this.$store.state.ui.selection)return;this.$store.commit("ui/setSelection",null)}}},{key:"onSelectionChange",value:function(t){t?this.panelSelection="selection":"selection"===this.panelSelection&&(this.panelSelection="add")}},{key:"selection",get:function(){return this.$store.state.ui.selection}},{key:"panel",get:function(){if("selection"===this.panelSelection){if(null!==this.selection){var t=this.$store.state.objects.objects[this.selection];return t.type}this.panelSelection="add"}return this.panelSelection}},{key:"hasPrevRender",get:function(){return null!==this.$store.state.ui.lastDownload}}]),e}(g["d"]);Object(m["a"])([Object(x["a"])("vertical",{namespace:"ui"})],va.prototype,"vertical",void 0),Object(m["a"])([Object(g["e"])("selection")],va.prototype,"onSelectionChange",null),va=Object(m["a"])([Object(g["a"])({components:{SettingsPanel:B,AddPanel:q,BackgroundsPanel:vr,CreditsPanel:Yn,CharacterPanel:zt,TextBoxPanel:Dn,ChoicePanel:Fn,SpritePanel:Jt,ContentPacksPanel:Or,PanelsPanel:ea,NotificationPanel:ca,PoemPanel:ba}})],va);var ma=va,ga=ma,ya=(n("4a58"),Object(D["a"])(ga,y,k,!1,null,null,null)),ka=ya.exports,xa=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{vertical:t.vertical},attrs:{id:"messageConsole"}},[t.showLoading?n("p",[t._v("Loading...")]):t._e(),t._l(t.messages,(function(e,r){return n("p",{key:e+"_"+r},[t._v(t._s(e))])}))],2)},ja=[],wa=5e3,Oa=2e4,Ca=100,_a=function(t){function e(){var t;return Object(h["a"])(this,e),t=Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.messages=[],t.showLoading=!1,t.showLoadingTimeout=0,t.hideLoadingTimeout=0,t}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"created",value:function(){var t=this;this.onLoadingChange(this.loading),zi["f"].subscribe(zi["a"],(function(e){t.messages.push("Failed to load asset '".concat(e.path,"'")),setTimeout((function(){t.messages.shift()}),wa)})),zi["f"].subscribe(zi["b"],(function(e){t.messages.push("Failed to load custom asset. Try to download it manually and then upload it."),setTimeout((function(){t.messages.shift()}),Oa)})),zi["f"].subscribe(zi["d"],(function(e){t.messages.push(e.message),setTimeout((function(){t.messages.shift()}),Oa)})),zi["f"].subscribe(zi["e"],(function(e){t.messages.push(e.error.name),t.messages.push(JSON.stringify(e.error.stack)),t.messages.push(e.info),setTimeout((function(){t.messages.shift(),t.messages.shift(),t.messages.shift()}),Oa)}))}},{key:"onLoadingChange",value:function(t){var e=this;t?(this.hideLoadingTimeout&&(clearTimeout(this.hideLoadingTimeout),this.hideLoadingTimeout=0),this.showLoading||this.showLoadingTimeout||(this.showLoadingTimeout=setTimeout((function(){e.showLoading=!0,e.showLoadingTimeout=0}),Ca))):(this.showLoadingTimeout&&(clearTimeout(this.showLoadingTimeout),this.showLoadingTimeout=0),this.showLoading&&!this.hideLoadingTimeout&&(this.hideLoadingTimeout=setTimeout((function(){e.showLoading=!1,e.hideLoadingTimeout=0}),Ca)))}}]),e}(g["d"]);Object(m["a"])([Object(g["c"])({default:!1,type:Boolean})],_a.prototype,"loading",void 0),Object(m["a"])([Object(x["a"])("vertical",{namespace:"ui"})],_a.prototype,"vertical",void 0),Object(m["a"])([Object(g["e"])("loading")],_a.prototype,"onLoadingChange",null),_a=Object(m["a"])([Object(g["a"])({components:{}})],_a);var Pa=_a,Sa=Pa,Ra=(n("f3f8"),Object(D["a"])(Sa,xa,ja,!1,null,"449eca3e",null)),Ta=Ra.exports,Ia=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("canvas",{ref:"sd",style:{width:t.canvasWidth+"px",height:t.canvasHeight+"px"},attrs:{id:"scaled_display",height:t.bitmapHeight,width:t.bitmapWidth,draggable:""},on:{click:t.onUiClick,touchstart:t.onTouchStart,dragstart:t.onDragStart,touchmove:t.onSpriteDragMove,mousemove:t.onSpriteDragMove,touchend:t.onSpriteDrop,mouseup:t.onSpriteDrop,dragover:t.onDragOver,drop:t.onDrop,mouseenter:t.onMouseEnter}},[t._v("HTML5 is required to use the Doki Doki Dialog Generator.")])},$a=[],Ea=n("6ae4"),Da=function(t){function e(){var t;return Object(h["a"])(this,e),t=Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.currentlyRendering=!1,t.queuedRender=null,t.showingLast=!1,t.dropSpriteCount=0,t.dropPreventClick=!1,t.draggedObject=null,t.dragXOffset=0,t.dragYOffset=0,t.dragXOriginal=0,t.dragYOriginal=0,t}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"blendOver",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"download",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.sceneRender.download();case 2:e=t.sent,this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=n.$store.state.ui.lastDownload,n.$store.commit("ui/setLastDownload",e),r&&URL.revokeObjectURL(r);case 3:case"end":return t.stop()}}),t)}))));case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"invalidateRender",value:function(){var t=this;this.queuedRender||(this.queuedRender=requestAnimationFrame((function(){return t.render_()})))}},{key:"render_",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.queuedRender&&(cancelAnimationFrame(this.queuedRender),this.queuedRender=null),!this.$store.state.unsafe){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,this.sceneRender.render(!this.lqRendering);case 5:this.display();case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"created",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:zi["f"].subscribe(zi["c"],(function(t){return e.invalidateRender})),this.$store.subscribe((function(t){"panels/setPanelPreview"!==t.type&&"panels/currentPanel"!==t.type&&e.invalidateRender()}));case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"mounted",value:function(){var t=this.$refs.sd;this.sdCtx=t.getContext("2d")||void 0,this.renderLoadingScreen(),this.invalidateRender()}},{key:"renderLoadingScreen",value:function(){if(this.sdCtx){var t=document.createElement("canvas");t.height=this.bitmapHeight,t.width=this.bitmapWidth;var e=new Ea["a"](t.getContext("2d"),!0,!1);e.drawText({text:"Starting...",x:t.width/2,y:t.height/2,align:"center",outline:{width:5,style:"#b59"},font:"32px riffic",fill:{style:"white"}}),this.sdCtx.drawImage(t,this.canvasWidth,this.canvasHeight)}}},{key:"display",value:function(){this.sdCtx&&(this.showingLast=!1,this.sceneRender.paintOnto(this.sdCtx,0,0,this.bitmapWidth,this.bitmapHeight))}},{key:"toRendererCoordinate",value:function(t,e){var n=this.$refs.sd,r=t-n.offsetLeft,i=e-n.offsetTop,a=r/n.offsetWidth*n.width,o=i/n.offsetWidth*n.width;return[a,o]}},{key:"onUiClick",value:function(t){var e=this;if(this.dropPreventClick)this.dropPreventClick=!1;else{var n,r=this.toRendererCoordinate(t.clientX,t.clientY),i=Object(d["a"])(r,2),a=i[0],o=i[1],s=this.sceneRender.objectsAt(a,o),c=s.findIndex((function(t){return t===e.selection}));n=0===c?null:-1!==c?s[c-1]:s[s.length-1]||null,this.$store.state.ui.selection!==n&&this.$store.commit("ui/setSelection",n)}}},{key:"onDragStart",value:function(t){if(t.preventDefault(),this.selection){this.draggedObject=this.$store.state.objects.objects[this.selection];var e=this.toRendererCoordinate(t.clientX,t.clientY),n=Object(d["a"])(e,2),r=n[0],i=n[1];this.dragXOffset=r-this.draggedObject.x,this.dragYOffset=i-this.draggedObject.y,this.dragXOriginal=this.draggedObject.x,this.dragYOriginal=this.draggedObject.y}}},{key:"onTouchStart",value:function(t){if(this.selection){this.draggedObject=this.$store.state.objects.objects[this.selection];var e=this.toRendererCoordinate(t.touches[0].clientX,t.touches[0].clientY),n=Object(d["a"])(e,2),r=n[0],i=n[1];this.dragXOffset=r-this.draggedObject.x,this.dragYOffset=i-this.draggedObject.y,this.dragXOriginal=this.draggedObject.x,this.dragYOriginal=this.draggedObject.y}}},{key:"onDragOver",value:function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"}},{key:"onSpriteDragMove",value:function(t){var e=this;if(this.draggedObject){t.preventDefault();var n=t instanceof MouseEvent?this.toRendererCoordinate(t.clientX,t.clientY):this.toRendererCoordinate(t.touches[0].clientX,t.touches[0].clientY),r=Object(d["a"])(n,2),i=r[0],a=r[1];i-=this.dragXOffset,a-=this.dragYOffset;var o=Math.abs(i-this.dragXOriginal),s=Math.abs(a-this.dragYOriginal);o+s>1&&(this.dropPreventClick=!0),t.shiftKey&&(o>s?a=this.dragYOriginal:i=this.dragXOriginal),this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setPosition",{id:e.draggedObject.id,x:i,y:a})}))}}},{key:"onDrop",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,i,a,o,c,u=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.stopPropagation(),e.preventDefault(),e.dataTransfer){t.next=4;break}return t.abrupt("return");case 4:for(n=!0,r=!1,i=void 0,t.prev=7,a=e.dataTransfer.items[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)c=o.value,"file"===c.kind&&c.type.match(/image.*/)&&function(){var t="dropCustomAsset"+ ++u.dropSpriteCount,e=Object(A["e"])(t,c.getAsFile());u.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,u.$store.dispatch("objects/createSprite",{assets:[{hq:e,lq:e,sourcePack:"dddg.generated.uploaded-sprites"}]});case 2:case"end":return t.stop()}}),t)}))))}();t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](7),r=!0,i=t.t0;case 15:t.prev=15,t.prev=16,n||null==a.return||a.return();case 18:if(t.prev=18,!r){t.next=21;break}throw i;case 21:return t.finish(18);case 22:return t.finish(15);case 23:case"end":return t.stop()}}),t,null,[[7,11,15,23],[16,,18,22]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"onSpriteDrop",value:function(t){this.draggedObject&&("TouchEvent"in window&&t instanceof TouchEvent&&(this.dropPreventClick=!1),this.draggedObject=null)}},{key:"onMouseEnter",value:function(t){1!==t.buttons&&(this.draggedObject=null)}},{key:"selection",get:function(){return this.$store.state.ui.selection}},{key:"sceneRender",get:function(){return new Ui(this.$store,this.$store.state.panels.currentPanel,this.bitmapWidth,this.bitmapHeight)}},{key:"bitmapHeight",get:function(){return K["c"]}},{key:"bitmapWidth",get:function(){return K["d"]}}]),e}(g["d"]);Object(m["a"])([Object(g["c"])({type:Number,default:0})],Da.prototype,"canvasWidth",void 0),Object(m["a"])([Object(g["c"])({type:Number,default:0})],Da.prototype,"canvasHeight",void 0),Object(m["a"])([Object(x["a"])("lqRendering",{namespace:"ui"})],Da.prototype,"lqRendering",void 0),Object(m["a"])([Object(g["e"])("canvasWidth"),Object(g["e"])("canvasHeight")],Da.prototype,"display",null),Da=Object(m["a"])([Object(g["a"])({})],Da);var Ha=Da,Ba=Ha,La=Object(D["a"])(Ba,Ia,$a,!1,null,null,null),Na=La.exports,Aa=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"dialog-wrapper",on:{click:function(e){return t.$emit("leave")}}},[n("dialog",{attrs:{open:""},on:{click:function(t){t.stopPropagation()}}},[t._t("default")],2)])},Ma=[],Fa=function(t){function e(){return Object(h["a"])(this,e),Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(v["a"])(e,t),e}(g["d"]);Fa=Object(m["a"])([Object(g["a"])({})],Fa);var Wa=Fa,Ua=Wa,za=(n("e96c"),Object(D["a"])(Ua,Aa,Ma,!1,null,"18f0bcd0",null)),Ga=za.exports,qa=16/9,Va=20,Ya=50,Qa=function(t){function e(){var t;return Object(h["a"])(this,e),t=Object(f["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.canvasWidth=0,t.canvasHeight=0,t.blendOver=null,t.uiSize=192,t.currentlyRendering=!1,t.panel="",t.dialogVisable=!1,t.expressionBuilderVisible=!1,t.expressionBuilderCharacter="",t}return Object(v["a"])(e,t),Object(p["a"])(e,[{key:"drawLastDownload",value:function(){var t=this.$store.state.ui.lastDownload;t&&this.$refs.render.blendOver(t)}},{key:"setBlendOver",value:function(){this.blendOver=this.$store.state.ui.lastDownload}},{key:"created",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.updateArea(),window.addEventListener("resize",this.updateArea),window.removeEventListener("keydown",this.onKeydown),window.addEventListener("keydown",this.onKeydown),window.store=this.$store,document.body.addEventListener("drop",(function(t){t.preventDefault()}),!0),document.body.addEventListener("dragover",(function(t){t.preventDefault()}),!0),this.vuexHistory.transaction(Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("content/loadContentPacks",["".concat("","packs/buildin.base.backgrounds.json"),"".concat("","packs/buildin.base.monika.json"),"".concat("","packs/buildin.base.sayori.json"),"".concat("","packs/buildin.base.natsuki.json"),"".concat("","packs/buildin.base.yuri.json"),"".concat("","packs/buildin.extra.mc.json"),"".concat("","packs/buildin.extra.mc_chad.json"),"".concat("","packs/buildin.extra.mc_classic.json"),"".concat("","packs/buildin.extra.femc.json"),"".concat("","packs/buildin.extra.classic_amy.json"),"".concat("","packs/buildin.extra.amy.json")]);case 2:return t.next=4,e.$store.dispatch("panels/createPanel");case 4:return 0===Object.keys(e.$store.state.objects.objects).length&&e.$store.dispatch("objects/createTextBox",{}),t.next=7,e.$store.commit("panels/setCurrentBackground",{current:"dddg.buildin.backgrounds:ddlc.clubroom",panelId:e.$store.state.panels.currentPanel});case 7:case"end":return t.stop()}}),t)}))));case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"destroyed",value:function(){window.removeEventListener("keydown",this.onKeydown)}},{key:"mounted",value:function(){var t=this;window.addEventListener("keypress",(function(e){"Escape"===e.key&&t.vuexHistory.transaction((function(){null!==t.$store.state.ui.selection&&t.$store.commit("ui/setSelection",null)}))}))}},{key:"optimum",value:function(t,e){var n=t/qa,r=e*qa;return n>e?n=e:r=t,[r,n]}},{key:"optimizeWithMenu",value:function(t,e){var n=this.optimum(t,e-this.uiSize),r=this.optimum(t-this.uiSize,e);return n[0]*n[1]>r[0]*r[1]?[n[0],n[1],!1]:[r[0],r[1],!0]}},{key:"updateArea",value:function(){var t=this.optimizeWithMenu(document.documentElement.clientWidth,document.documentElement.clientHeight),e=Object(d["a"])(t,3),n=e[0],r=e[1],i=e[2];this.canvasWidth=n,this.canvasHeight=r,this.$store.state.ui.vertical!==i&&this.$store.commit("ui/setVertical",i)}},{key:"showDialog",value:function(t){var e=this;if(this.dialogVisable=!0,t){var n=function n(){e.$refs.packDialog?e.$refs.packDialog.setSearch(t):setTimeout(n,Ya)};this.$nextTick(n)}}},{key:"showExpressionDialog",value:function(t){this.expressionBuilderVisible=!0,this.expressionBuilderCharacter=t.character,this.expressionBuilderHeadGroup=t.headGroup}},{key:"onKeydown",value:function(t){var e=this;this.vuexHistory.transaction((function(){var n=e.$store.state.objects.objects[e.$store.state.ui.selection];if(n)if("Delete"!==t.key)if("z"===t.key&&t.ctrlKey)t.preventDefault();else if("y"===t.key&&t.ctrlKey)t.preventDefault();else{if("character"===n.type){var r=n;if(r.freeMove){if("ArrowLeft"===t.key)return void e.$store.dispatch("objects/shiftCharacterSlot",{id:r.id,delta:-1});if("ArrowRight"===t.key)return void e.$store.dispatch("objects/shiftCharacterSlot",{id:r.id,delta:1})}}var i=n.x,a=n.y;if("ArrowLeft"===t.key)i-=t.shiftKey?1:Va;else if(n&&"ArrowRight"===t.key)i+=t.shiftKey?1:Va;else if(n&&"ArrowUp"===t.key)a-=t.shiftKey?1:Va;else{if(!n||"ArrowDown"!==t.key)return void console.log(t);a+=t.shiftKey?1:Va}e.$store.dispatch("objects/setPosition",{id:n.id,x:i,y:a}),console.log(t)}else e.$store.dispatch("objects/removeObject",{id:n.id})}))}}]),e}(g["d"]);Qa=Object(m["a"])([Object(g["a"])({components:{ToolBox:ka,MessageConsole:Ta,Render:Na,ModalDialog:Ga,SingleBox:function(){return n.e("chunk-d699e572").then(n.bind(null,"dcb9"))},ExpressionBuilder:function(){return n.e("chunk-164650d4").then(n.bind(null,"d785"))}}})],Qa);var Xa=Qa,Ja=Xa,Ka=(n("5c0b"),Object(D["a"])(Ja,u,l,!1,null,null,null)),Za=Ka.exports,to={},eo=0,no={createSprite:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r,i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.state,r=e.commit,i=e.rootState,t.next=3,Object(A["a"])(n.assets[0],!1);case 3:if(a=t.sent,a instanceof HTMLImageElement){t.next=6;break}return t.abrupt("return");case 6:r("create",{object:{assets:n.assets,flip:!1,height:a.height,width:a.width,id:"sprite_"+ ++eo,panelId:i.panels.currentPanel,onTop:!1,opacity:100,preserveRatio:!0,ratio:a.width/a.height,type:"sprite",version:0,x:640,y:0}});case 7:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}()},ro={setChoices:function(t,e){var n=t.objects[e.id];n.choices=e.choices,++n.version},setChoiceColor:function(t,e){var n=t.objects[e.id];n.customColor=e.customColor,++n.version},setChoiceDistance:function(t,e){var n=t.objects[e.id];n.choiceDistance=e.choiceDistance,++n.version},setAutoWrapping:function(t,e){var n=t.objects[e.id];n.autoWrap=e.autoWrap,++n.version}},io=0,ao={createChoice:function(t,e){var n=t.commit,r=t.rootState,i="choice_"+ ++io;return n("create",{object:{x:640,y:si,width:ri,height:0,panelId:r.panels.currentPanel,flip:!1,id:i,onTop:!0,autoWrap:!0,opacity:100,type:"choice",version:0,preserveRatio:!1,ratio:en/rn,choiceDistance:ii,choices:[{selected:!1,text:"Click here to edit choice"}],customColor:ei}}),i},addChoice:function(t,e){var n=t.state,r=t.commit,i=n.objects[e.id];r("setChoices",{id:e.id,choices:[].concat(Object(ne["a"])(i.choices),[{selected:!1,text:e.text}])})},removeChoise:function(t,e){var n=t.state,r=t.commit,i=n.objects[e.id],a=Object(ne["a"])(i.choices);a[e.choiceIdx]&&(a.splice(e.choiceIdx,1),r("setChoices",{id:e.id,choices:a}))},setChoiceText:function(t,e){var n=t.state,r=t.commit,i=n.objects[e.id],a=Object(ne["a"])(i.choices);a[e.choiceIdx]&&(a[e.choiceIdx].text=e.text,r("setChoices",{id:e.id,choices:a}))}};function oo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function so(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?oo(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):oo(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var co=4,uo={setText:function(t,e){var n=t.objects[e.id];n.text=e.text,++n.version},setTalkingDefault:function(t,e){var n=t.objects[e.id];n.talkingDefault=e.talkingDefault,++n.version},setTalkingOther:function(t,e){var n=t.objects[e.id];n.talkingOther=e.talkingOther,n.talkingDefault="Other",++n.version},setStyle:function(t,e){var n=t.objects[e.id];n.style=e.style,++n.version},setControlsVisible:function(t,e){var n=t.objects[e.id];n.controls=e.controls,++n.version},setControlsColor:function(t,e){var n=t.objects[e.id];n.customControlsColor=e.customControlsColor,++n.version},setDeriveCustomColors:function(t,e){var n=t.objects[e.id];n.deriveCustomColors=e.deriveCustomColors,++n.version},setNameboxColor:function(t,e){var n=t.objects[e.id];n.customNameboxColor=e.customNameboxColor,++n.version},setNameboxStroke:function(t,e){var n=t.objects[e.id];n.customNameboxStroke=e.customNameboxStroke,++n.version},setNameboxWidth:function(t,e){var n=t.objects[e.id];n.customNameboxWidth=e.customNameboxWidth,++n.version},setSkipable:function(t,e){var n=t.objects[e.id];n.skip=e.skip,++n.version},setContinueArrow:function(t,e){var n=t.objects[e.id];n.continue=e.continue,++n.version},setCustomColor:function(t,e){var n=t.objects[e.id];n.customColor=e.color,++n.version},setAutoQuoting:function(t,e){var n=t.objects[e.id];n.autoQuoting=e.autoQuoting,++n.version},setAutoWrapping:function(t,e){var n=t.objects[e.id];n.autoWrap=e.autoWrap,++n.version},setResetBounds:function(t,e){var n=t.objects[e.id];n.resetBounds=e.resetBounds,n.x=e.resetBounds.x,n.y=e.resetBounds.y,n.height=e.resetBounds.height,n.width=e.resetBounds.width,++n.version}},lo=0,ho={createTextBox:function(t,e){var n=t.commit,r=t.rootState,i="textBox_"+ ++lo,a=e.resetBounds||{x:640,y:On,width:en,height:rn};return n("create",{object:so({},a,{panelId:r.panels.currentPanel,flip:!1,id:i,onTop:!0,opacity:100,type:"textBox",version:0,preserveRatio:!1,ratio:en/rn,continue:!0,controls:!0,skip:!0,autoQuoting:!0,autoWrap:!0,style:"normal",customColor:"#ffa8d2",deriveCustomColors:!0,customControlsColor:"#552222",customNameboxColor:"#ffeef6",customNameboxWidth:168,customNameboxStroke:"#bb5599",talkingDefault:"No-one",talkingOther:"",text:"",resetBounds:a})}),i},setStyle:function(t,e){var n=t.commit;n("setStyle",{id:e.id,style:e.style})},resetTextboxBounds:function(t,e){var n=t.commit,r=t.state,i=(t.dispatch,r.objects[e.id]);n("setPosition",{id:e.id,x:i.resetBounds.x,y:i.resetBounds.y}),n("setSize",{id:e.id,height:i.resetBounds.height,width:i.resetBounds.width})},splitTextbox:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r,i,a,o,s,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,i=e.state,a=e.dispatch,o=i.objects[n.id],s=(o.width-co)/2,r("setResetBounds",{id:n.id,resetBounds:{x:o.x-s/2,y:o.y,width:s,height:o.height}}),r("setStyle",{id:n.id,style:"custom"}),t.next=7,a("createTextBox",{resetBounds:{x:o.x+s+co/2,y:o.y,width:s,height:o.height}});case 7:c=t.sent,r("setStyle",{id:c,style:"custom"}),o.flip&&r("setFlip",{id:c,flip:o.flip});case 10:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}()},po={setNotificationColor:function(t,e){var n=t.objects[e.id];n.customColor=e.customColor,++n.version},setNotificationText:function(t,e){var n=e.id,r=e.text,i=t.objects[n];i.text=r,++i.version},setNotificationBackdrop:function(t,e){var n=e.id,r=e.backdrop,i=t.objects[n];i.backdrop=r,++i.version},setAutoWrapping:function(t,e){var n=t.objects[e.id];n.autoWrap=e.autoWrap,++n.version}},fo=0,bo={createNotification:function(t,e){var n=t.commit,r=t.rootState,i="choice_"+ ++fo;return n("create",{object:{x:K["d"]/2,y:K["c"]/2,width:ri,height:0,panelId:r.panels.currentPanel,flip:!1,autoWrap:!0,id:i,onTop:!0,opacity:100,type:"notification",version:0,preserveRatio:!1,ratio:en/rn,customColor:ei,text:"Click here to edit notification",backdrop:!0}}),i}},vo={setPoemBackground:function(t,e){var n=e.id,r=e.background,i=t.objects[n];i.background=r,++i.version},setPoemFont:function(t,e){var n=e.id,r=e.font,i=t.objects[n];i.font=r,++i.version},setPoemText:function(t,e){var n=e.id,r=e.text,i=t.objects[n];i.text=r,++i.version},setAutoWrapping:function(t,e){var n=t.objects[e.id];n.autoWrap=e.autoWrap,++n.version}},mo=0,go={createPoem:function(t,e){var n=t.commit,r=t.rootState,i="poem_"+ ++mo;return n("create",{object:{subType:"poem",x:Ci,y:_i,width:Ri,height:Ti,panelId:r.panels.currentPanel,flip:!1,id:i,onTop:!0,opacity:100,type:"poem",version:0,preserveRatio:!1,autoWrap:!0,ratio:Ri/Ti,background:wi,font:Oi,text:"New poem\n\nClick here to edit poem"}}),i},createConsole:function(t,e){var n=t.commit,r=t.rootState,i="poem_"+ ++mo;return n("create",{object:{subType:"console",x:$i/2,y:Ei/2,width:$i,height:Ei,panelId:r.panels.currentPanel,flip:!1,id:i,onTop:!0,opacity:100,type:"poem",version:0,preserveRatio:!1,ratio:$i/Ei,background:Di,font:Hi,text:"> _\n  \n  Console command\n  Click here to edit"}}),i}};function yo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ko(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?yo(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yo(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var xo=0,jo={namespaced:!0,state:{objects:{},panels:{}},mutations:ko({create:function(t,e){var n=e.object;t.panels[n.panelId]||i["a"].set(t.panels,n.panelId,{id:n.panelId,onTopOrder:[],order:[]});var r=t.panels[n.panelId],a=n.onTop?r.onTopOrder:r.order;i["a"].set(t.objects,n.id,n),a.push(n.id)},removeFromList:function(t,e){var n=t.objects[e.id],r=t.panels[n.panelId],i=e.onTop?r.onTopOrder:r.order,a=i.indexOf(e.id);i.splice(a,1)},addToList:function(t,e){var n=t.objects[e.id],r=t.panels[n.panelId],i=e.onTop?r.onTopOrder:r.order;i.splice(e.position,0,e.id)},setOnTop:function(t,e){var n=t.objects[e.id];n.onTop=e.onTop},setPosition:function(t,e){var n=t.objects[e.id];n.x=e.x,n.y=e.y},setFlip:function(t,e){var n=t.objects[e.id];n.flip=e.flip},setOpacity:function(t,e){var n=t.objects[e.id];n.opacity=e.opacity},setSize:function(t,e){var n=t.objects[e.id];n.width=e.width,n.height=e.height},setRatio:function(t,e){var n=t.objects[e.id];n.preserveRatio=e.preserveRatio,n.ratio=e.ratio},removeObject:function(t,e){var n=t.objects[e.id];delete t.objects[e.id];var r=t.panels[n.panelId];0===r.onTopOrder.length&&0===r.order.length&&delete t.panels[n.panelId]}},to,{},Q["c"],{},uo,{},ro,{},po,{},vo),actions:ko({removeObject:function(t,e){var n=t.state,r=t.commit,i=t.rootState,a=n.objects[e.id];i.ui.selection===e.id&&r("ui/setSelection",null,{root:!0}),r("removeFromList",{id:e.id,onTop:a.onTop}),r("removeObject",{id:e.id})},setPosition:function(t,e){var n=t.state,r=t.commit,i=t.dispatch,a=n.objects[e.id];"character"===a.type?i("setCharacterPosition",e):r("setPosition",e)},setOnTop:function(t,e){var n=t.state,r=t.commit,i=n.objects[e.id],a=n.panels[i.panelId];i.onTop!==e.onTop&&(r("removeFromList",{id:e.id,onTop:i.onTop}),r("addToList",{id:e.id,position:(e.onTop?a.onTopOrder:a.order).length,onTop:e.onTop}),r("setOnTop",{id:e.id,onTop:e.onTop}))},shiftLayer:function(t,e){var n=t.state,r=t.commit,i=n.objects[e.id],a=n.panels[i.panelId],o=i.onTop?a.onTopOrder:a.order,s=o.indexOf(i.id),c=s+e.delta;c<0&&(c=0),c>o.length&&(c=o.length),r("removeFromList",{id:e.id,onTop:i.onTop}),r("addToList",{id:e.id,position:c,onTop:i.onTop})},setPreserveRatio:function(t,e){var n=t.commit,r=t.state,i=r.objects[e.id],a=e.preserveRatio?i.width/i.height:0;n("setRatio",{id:e.id,preserveRatio:e.preserveRatio,ratio:a})},setWidth:function(t,e){var n=t.commit,r=t.state,i=r.objects[e.id],a=i.preserveRatio?e.width/i.ratio:i.height;n("setSize",{id:e.id,height:a,width:e.width})},setHeight:function(t,e){var n=t.commit,r=t.state,i=r.objects[e.id],a=i.preserveRatio?e.height*i.ratio:i.width;n("setSize",{id:e.id,height:e.height,width:a})},fixContentPackRemoval:function(t,e){Object.values(t.state.objects).map((function(n){switch(n.type){case"character":return void Object(Q["e"])(t,n.id,e);case"sprite":return;case"textBox":return}}))},copyObjects:function(t,e){var n=t.commit,r=t.state,i=e.sourcePanelId,a=e.targetPanelId,o=r.panels[i];if(o)for(var s=0,c=[].concat(Object(ne["a"])(o.onTopOrder),Object(ne["a"])(o.order));s<c.length;s++){var u=c[s],l=r.objects[u];n("create",{object:ko({},JSON.parse(JSON.stringify(l)),{id:"copy_".concat(l.id,"_").concat(++xo),panelId:a})})}},deleteAllOfPanel:function(t,e){for(var n=t.state,r=t.dispatch,i=e.panelId,a=n.panels[i],o=0,s=[].concat(Object(ne["a"])(a.onTopOrder),Object(ne["a"])(a.order));o<s.length;o++){var c=s[o];r("removeObject",{id:c})}}},no,{},Q["b"],{},ho,{},ao,{},bo,{},go)},wo={namespaced:!0,state:{vertical:!1,lqRendering:!0,nsfw:!1,selection:null,lastDownload:null},mutations:{setVertical:function(t,e){t.vertical=e},setNsfw:function(t,e){t.nsfw=e},setLqRendering:function(t,e){t.lqRendering=e},setSelection:function(t,e){t.selection=e},setLastDownload:function(t,e){t.lastDownload=e}}},Oo=n("0a94"),Co=n("5311"),_o=n("77e3"),Po=n("b3a0");function So(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ro(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?So(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):So(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function To(t,e){return{backgrounds:Io(t.backgrounds,e.backgrounds),characters:Eo(t.characters,e.characters),dependencies:No(t.dependencies,e.dependencies),fonts:Ao(t.fonts,e.fonts,(function(t){return t.id}),(function(t,e){return Ro({},t,{files:No(t.files,e.files)})})),poemStyles:Ao(t.poemStyles,e.poemStyles,(function(t){return t.label}),(function(){throw new Error})),poemBackgrounds:[].concat(Object(ne["a"])(t.poemBackgrounds),Object(ne["a"])(e.poemBackgrounds)),sprites:Ao(t.sprites,e.sprites,(function(t){return t.id}),(function(t,e){return{id:t.id,label:t.label,variants:[].concat(Object(ne["a"])(t.variants),Object(ne["a"])(e.variants))}})),colors:Ao(t.colors,e.colors,(function(t){return t.color}),(function(t){return t}))}}function Io(t,e){return Ao(t,e,(function(t){return t.id}),$o)}function $o(t,e){return{id:t.id,label:t.label,variants:[].concat(Object(ne["a"])(t.variants),Object(ne["a"])(e.variants))}}function Eo(t,e){return Ao(t,e,(function(t){return t.id}),Do)}function Do(t,e){return{chibi:t.chibi,id:t.id,label:t.label,heads:Lo(t.heads,e.heads),styleGroups:Ao(t.styleGroups,e.styleGroups,(function(t){return t.id}),(function(t,e){return{id:t.id,styleComponents:Ao(t.styleComponents,e.styleComponents,(function(t){return t.id}),(function(t,e){return{id:t.id,label:t.label,variants:Ho(t.variants,e.variants)}})),styles:Ao(t.styles,e.styles,(function(t){return JSON.stringify(t.components)}),(function(t,e){return{components:t.components,poses:Ao(t.poses,e.poses,(function(t){return t.id}),Bo)}}))}}))}}function Ho(t,e){var n=Ro({},t);for(var r in e)e.hasOwnProperty(r)&&(n.hasOwnProperty(r)||(n[r]=e[r]));return n}function Bo(t,e){var n=Ro({},t.positions);for(var r in e.positions)n[r]?n[r]=[].concat(Object(ne["a"])(n[r]),Object(ne["a"])(e.positions[r])):n[r]=e.positions[r];return{id:t.id,compatibleHeads:No(t.compatibleHeads,e.compatibleHeads),previewOffset:t.previewOffset,previewSize:t.previewSize,scale:t.scale,size:t.size,renderCommands:t.renderCommands,positions:n}}function Lo(t,e){var n=Ro({},t);for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];if(n[r]){var a=n[r];n[r]={previewOffset:a.previewOffset,previewSize:a.previewSize,variants:[].concat(Object(ne["a"])(a.variants),Object(ne["a"])(i.variants))}}else n[r]=i}return n}function No(t,e){var n=Object(ne["a"])(t),r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var c=o.value;n.includes(c)||n.push(c)}}catch(u){i=!0,a=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}function Ao(t,e,n,r){var i=Object(ne["a"])(t),a=new Map(t.map((function(t,e){return[n(t),e]}))),o=!0,s=!1,c=void 0;try{for(var u,l=e[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var d=u.value,h=n(d);if(a.has(h)){var p=a.get(h),f=i[p];i.splice(p,1,r(f,d))}else a.set(h,i.length),i.push(d)}}catch(b){s=!0,c=b}finally{try{o||null==l.return||l.return()}finally{if(s)throw c}}return i}function Mo(t){return t.split("/").slice(0,-1).join("/")+"/"}var Fo=new Set(["png","gif","bmp","svg"]),Wo={namespaced:!0,state:{contentPacks:[],current:{dependencies:[],backgrounds:[],characters:[],fonts:[],poemStyles:[],poemBackgrounds:[],sprites:[],colors:[]}},mutations:{setContentPacks:function(t,e){t.contentPacks=e},setCurrentContent:function(t,e){t.current=e}},actions:{contentPack:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r,i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,i=e.state,t.next=3,Uo(n);case 3:a=t.sent,r("setContentPacks",[].concat(Object(ne["a"])(i.contentPacks),[a])),r("setCurrentContent",To(i.current,a));case 6:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}(),removeContentPacks:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r,i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=e.commit,i=e.state,a=i.contentPacks.filter((function(t){return!n.has(t.packId)})),r("setContentPacks",a),r("setCurrentContent",a.reduce((function(t,e){return To(t,e)})));case 4:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}(),replaceContentPack:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r,i,a,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.commit,i=e.state,!n.processed){t.next=5;break}t.t0=n.contentPack,t.next=8;break;case 5:return t.next=7,Uo(n.contentPack);case 7:t.t0=t.sent;case 8:a=t.t0,o=i.contentPacks,s=o.findIndex((function(t){return t.packId===n.contentPack.packId})),-1===s?o.push(a):o.splice(s,1,a),r("setContentPacks",o),r("setCurrentContent",o.reduce((function(t,e){return To(t,e)})));case 14:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}(),loadContentPacks:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r,i,a,o,c,u,l,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.dispatch,"string"===typeof n&&(n=[n]),t.next=4,Promise.all(n.map(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch(e);case 2:return n=t.sent,n.ok||Go("Could not load content pack. Server responded with: ".concat(n.statusText)),t.prev=4,t.next=7,n.json();case 7:r=t.sent,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](4),Go("Content pack is not valid json!");case 13:try{a={"./":Mo(e),"/":Mo(location.href)+"assets/"},i="2.0"===r.version?Object(Co["normalizeContentPack"])(r,a):Object(_o["convert"])(Object(Po["normalizeCharacter"])(r,a),a,!1)}catch(o){Go("Content pack is not in a valid format!",o)}return t.abrupt("return",i);case 15:case"end":return t.stop()}}),t,null,[[4,10]])})));return function(e){return t.apply(this,arguments)}}()));case 4:i=t.sent,a=!0,o=!1,c=void 0,t.prev=8,u=i[Symbol.iterator]();case 10:if(a=(l=u.next()).done){t.next=17;break}return d=l.value,t.next=14,r("contentPack",d);case 14:a=!0,t.next=10;break;case 17:t.next=23;break;case 19:t.prev=19,t.t0=t["catch"](8),o=!0,c=t.t0;case 23:t.prev=23,t.prev=24,a||null==u.return||u.return();case 26:if(t.prev=26,!o){t.next=29;break}throw c;case 29:return t.finish(26);case 30:return t.finish(23);case 31:return t.abrupt("return",i.map((function(t){return t.packId})));case 32:case"end":return t.stop()}}),t,null,[[8,19,23,31],[24,,26,30]])})));function e(e,n){return t.apply(this,arguments)}return e}()},getters:{getCharacters:function(t){var e=t.current,n=new Map,r=!0,i=!1,a=void 0;try{for(var o,s=e.characters[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var c=o.value;n.set(c.id,c)}}catch(u){i=!0,a=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n},getBackgrounds:function(t){var e=t.current,n=new Map,r=!0,i=!1,a=void 0;try{for(var o,s=e.backgrounds[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var c=o.value;n.set(c.id,c)}}catch(u){i=!0,a=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}}};function Uo(t){return zo.apply(this,arguments)}function zo(){return zo=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.t0=Set,t.next=3,Object(A["d"])();case 3:if(!t.sent){t.next=7;break}t.t1=["webp"].concat(Object(ne["a"])(Fo)),t.next=8;break;case 7:t.t1=Fo;case 8:return t.t2=t.t1,n=new t.t0(t.t2),r=new Map([["ext","{lq:.lq:}.{format:webp:webp:png:png}"]]),i=Object(Oo["assetWalker"])(e,(function(t,i){var a=Object(Oo["normalizePath"])(t,r,n,!1),o=Object(Oo["normalizePath"])(t,r,n,!0);return{hq:a,lq:o,sourcePack:e.packId||"buildIn"}})),t.abrupt("return",i);case 13:case"end":return t.stop()}}),t)}))),zo.apply(this,arguments)}function Go(t,e){throw console.error(t,e),new Error(t)}i["a"].use(a["a"]);var qo=new a["a"].Store({modules:{objects:jo,ui:wo,panels:Ir,content:Wo},state:{unsafe:!1},mutations:{setUnsafe:function(t,e){}},actions:{removePacks:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r,i,a,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.dispatch,i=e.commit,a=e.state,o=n.packs,s=JSON.parse(JSON.stringify(a.content.current)),i("setUnsafe",!0),t.next=6,r("content/removeContentPacks",o);case 6:return t.next=8,r("panels/fixContentPackRemoval",s);case 8:return t.next=10,r("objects/fixContentPackRemoval",s);case 10:i("setUnsafe",!1);case 11:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}()}}),Vo={mutations:{}};function Yo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Qo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Yo(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Yo(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Xo={mutations:Qo({"objects/*":{combinable:function(t,e){return t.type===e.type&&t.payload.id===e.payload.id}},"objects/create":{combinable:function(){return!1}},"objects/removeObject":{combinable:function(){return!1}}},Vo.mutations)};function Jo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ko(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Jo(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Jo(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}i["a"].config.productionTip=!1,i["a"].use(a["a"]),i["a"].use(c,{mutations:Ko({},Xo.mutations)}),new i["a"]({store:qo,render:function(t){return t(Za)}}).$mount("#app")},d3a2:function(t,e,n){"use strict";var r=n("ed68"),i=n.n(r);i.a},daf6:function(t,e,n){"use strict";var r=n("c769"),i=n.n(r);i.a},db62:function(t,e,n){},dc61:function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.visible?n("div",{class:{vertical:t.vertical},on:{dragleave:function(e){t.visible=!1},drop:t.drop}},[t._t("default")],2):t._e()},i=[],a=(n("4917"),n("ac4d"),n("8a81"),n("ac6a"),n("d225")),o=n("b0b4"),s=n("308d"),c=n("6bb5"),u=n("4e2b"),l=n("9ab4"),d=n("60a3"),h=n("2298"),p=function(t){function e(){var t;return Object(a["a"])(this,e),t=Object(s["a"])(this,Object(c["a"])(e).apply(this,arguments)),t.visible=!1,t}return Object(u["a"])(e,t),Object(o["a"])(e,[{key:"show",value:function(){this.visible=!0}},{key:"hide",value:function(){this.visible=!1}},{key:"drop",value:function(t){if(this.hide(),t.stopPropagation(),t.preventDefault(),t.dataTransfer){var e=!0,n=!1,r=void 0;try{for(var i,a=t.dataTransfer.items[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var o=i.value;"file"===o.kind&&o.type.match(/image.*/)&&this.$emit("drop",o.getAsFile())}}catch(s){n=!0,r=s}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}}}}]),e}(d["d"]);Object(l["a"])([Object(h["a"])("vertical",{namespace:"ui"})],p.prototype,"vertical",void 0),p=Object(l["a"])([Object(d["a"])({})],p);var f=p,b=f,v=(n("a838"),n("2877")),m=Object(v["a"])(b,r,i,!1,null,"2a32b954",null);e["a"]=m.exports},dd4f:function(t,e,n){},e0c7:function(t,e,n){},e277:function(t,e,n){"use strict";var r=n("2bb5"),i=n.n(r);i.a},e441:function(t,e,n){},e96c:function(t,e,n){"use strict";var r=n("e441"),i=n.n(r);i.a},eb8b:function(t,e,n){"use strict";var r=n("76d0"),i=n.n(r);i.a},ed68:function(t,e,n){},f2ed:function(t,e,n){},f3f8:function(t,e,n){"use strict";var r=n("bd46"),i=n.n(r);i.a},fc22:function(t,e,n){},fd0b:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));n("96cf");var r=n("3b8d"),i=n("d225"),a=n("b0b4"),o=n("6ae4"),s=n("73e5"),c=n("032b"),u=n("fec4"),l=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u["d"],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u["c"];Object(i["a"])(this,t),this.runningContext=null,this.previewCanvas=document.createElement("canvas"),this.previewCanvas.width=e,this.previewCanvas.height=n}return Object(a["a"])(t,[{key:"render",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r,i,a=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=!(a.length>1&&void 0!==a[1])||a[1],this.runningContext&&this.runningContext.abort(),r=this.previewCanvas.getContext("2d"),r.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),i=this.runningContext=new o["a"](r,n,!0),t.prev=5,t.next=8,e(this.runningContext);case 8:t.next=15;break;case 10:if(t.prev=10,t.t0=t["catch"](5),!(t.t0 instanceof s["a"])){t.next=14;break}return t.abrupt("return",!1);case 14:throw t.t0;case 15:return t.prev=15,i===this.runningContext&&(this.runningContext=null),t.finish(15);case 18:return t.abrupt("return",!0);case 19:case"end":return t.stop()}}),t,this,[[5,10,15,18]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"paintOnto",value:function(t,e,n,r,i){r&&i?t.drawImage(this.previewCanvas,e,n,r,i):t.drawImage(this.previewCanvas,e,n)}},{key:"download",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){var r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=document.createElement("canvas"),r.width=this.previewCanvas.width,r.height=this.previewCanvas.height,i=r.getContext("2d"),i.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),t.next=7,e(new o["a"](i,!0,!1));case 7:return t.abrupt("return",c["a"].saveToFile(r,n));case 8:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"renderToBlob",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=document.createElement("canvas"),n.width=this.previewCanvas.width,n.height=this.previewCanvas.height,r=n.getContext("2d"),r.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),t.next=7,e(new o["a"](r,!0,!1));case 7:return t.next=9,new Promise((function(t,e){n.toBlob((function(n){n?t(n):e()}))}));case 9:return t.abrupt("return",t.sent);case 10:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getDataAt",value:function(t,e){var n=this.previewCanvas.getContext("2d");return n.getImageData(t,e,1,1).data}},{key:"width",get:function(){return this.previewCanvas.width}},{key:"height",get:function(){return this.previewCanvas.height}}]),t}()},fec4:function(t,e,n){"use strict";n.d(e,"d",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return o}));var r=1280,i=720,a=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],o=[200,240,400,493,640,786,880,1040,1080]}});
//# sourceMappingURL=app.29507660.js.map