{"version":3,"sources":["webpack:///./src/components/content-pack-builder/expression-builder/selector.vue?202b","webpack:///./src/components/content-pack-builder/expression-builder/index.vue?dd68","webpack:///./src/components/content-pack-builder/expression-builder/index.vue?0902","webpack:///./src/components/content-pack-builder/expression-builder/selection.vue?b7ff","webpack:///./src/components/content-pack-builder/expression-builder/selection.vue?84b1","webpack:///./src/components/content-pack-builder/expression-builder/selection.vue?22dc","webpack:///./src/components/content-pack-builder/expression-builder/selection.vue","webpack:///./src/components/content-pack-builder/expression-builder/selector.vue?da05","webpack:///./src/components/content-pack-builder/expression-builder/selector.vue?ed73","webpack:///./src/components/content-pack-builder/expression-builder/selector.vue?434c","webpack:///./src/components/content-pack-builder/expression-builder/selector.vue","webpack:///./src/util/workBatch/internalState.ts","webpack:///./src/util/workBatch/index.ts","webpack:///./src/components/content-pack-builder/expression-builder/index.vue?4014","webpack:///./src/components/content-pack-builder/expression-builder/index.vue?953b","webpack:///./src/components/content-pack-builder/expression-builder/index.vue","webpack:///./src/components/content-pack-builder/expression-builder/selection.vue?141e"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","on","dragEnter","hideDt","_v","headGroup","method","uploadsFinished","_s","Math","round","batchRunner","percentage","normalizeName","name","attrs","downloadLink","_e","listLink","ref","addByImageFile","$event","verticalScrollRedirect","$refs","upload","click","addByUpload","addByUrl","_l","expression","idx","key","class","expression_item","active","currentUploadedExpression","style","backgroundImage","previewPoses","previewPoseIdx","width","height","directives","rawName","value","$$selectedVal","Array","prototype","filter","call","target","options","o","selected","map","val","_value","multiple","pose","domProps","modifiers","stopPropagation","composing","offsetX","_n","$forceUpdate","offsetY","imagePatching","mask","model","callback","$$v","addMask","addition","addExtras","removeUploadedExpression","finishUpload","leave","hasParts","headgroup","preview","staticRenderFns","background","$emit","icon","label","images","i","join","default","components","component","_t","busy","error","completed","fullCount","runner","disposer","parallel","state","pendingData","currentlyRunning","Set","resolveCurrentRun","rejectCurrentRun","returnData","remainingDisposers","runningDisposers","newData","reject","slice","length","Promise","resolve","restock","remainingCapacity","startOne","size","startDisposer","data","shift","undefined","add","isRunning","has","ret","delete","values","next","reset","e","message","uploadedExpressionsPack","packId","dependencies","packCredits","characters","fonts","sprites","poemStyles","poemBackgrounds","backgrounds","colors","masks","adds","baseUrl","listPaths","partFiles","everythingBroken","uploadedExpressions","processExpression","bind","asset","window","exp","initHeadGroup","availableHeadGroups","find","group","applySingleHeadGroup","uploadInput","files","file","url","URL","createObjectURL","addUrl","environment","prompt","push","renderer","renderToBlob","rx","drawImage","image","x","y","w","h","composite","blob","finalExpression","startsWith","revokeObjectURL","charDefDefaults","poseId","posePositions","head","indexOf","temporaryCharacterModel","charRenderer","$nextTick","ctx","getContext","clearRect","paintOnto","run","processedExpressions","storeCharacter","$store","content","current","char","id","character","heads","styleGroups","chibi","storeHeadGroup","previewSize","previewOffset","variants","processedExpression","vuexHistory","transaction","dispatch","contentPack","splice","parts","split","actualName","trim","toUpperCase","toLowerCase","dataTransfer","effectAllowed","from","items","item","type","match","dt","show","hide","characterData","headTypes","Object","keys","headTypeKey","headType","lq","partsFiles","hq","charName","headGroupName","poses","styleGroupIdx","styleGroup","styleIdx","styles","poseIdx","compatibleHeads","includes","styleGroupId","styleId","sourcePack","expressionModels","styleComponents","renderCommands","headIdx","findIndex","command","headRenderCommand","newHeadCommand","offset","nr","Selection","Selector","ToggleBox","DropTarget","characterType","freeMove","close","panelId","preserveRatio","ratio","opacity","version","flip","onTop"],"mappings":"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","file":"js/chunk-238a1a62.5faeae3c.js","sourcesContent":["import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./selector.vue?vue&type=style&index=0&id=47fcc628&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./selector.vue?vue&type=style&index=0&id=47fcc628&scoped=true&lang=css&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=af07ae48&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=af07ae48&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"wrapper\",on:{\"dragenter\":_vm.dragEnter,\"mouseleave\":_vm.hideDt}},[_c('h1',[_vm._v(\"Add expressions\")]),(!_vm.headGroup)?_c('selector',{attrs:{\"label\":\"What kind of expression would you like to add?\"}},_vm._l((_vm.availableHeadGroups),function(headgroup){return _c('selection',{key:headgroup.name,attrs:{\"label\":_vm.normalizeName(headgroup.name),\"images\":headgroup.preview},on:{\"selected\":function($event){_vm.headGroup = headgroup}}})}),1):(!_vm.method)?_c('selector',{attrs:{\"label\":\"How would you like to add the new expressions?\"}},[_c('selection',{attrs:{\"label\":\"Build expressions from parts\",\"icon\":\"info\",\"disabled\":_vm.hasParts},on:{\"selected\":function($event){_vm.method = 'parts'}}}),_c('selection',{attrs:{\"label\":\"Upload expression images\",\"icon\":\"info\"},on:{\"selected\":function($event){_vm.method = 'upload'}}})],1):(_vm.method === 'upload')?[(!_vm.uploadsFinished)?_c('div',{staticClass:\"page\"},[_c('h2',[_vm._v(\" Upload new '\"+_vm._s(_vm.normalizeName(_vm.headGroup.name))+\"' expressions \"),(_vm.downloadLink)?_c('a',{attrs:{\"href\":_vm.downloadLink,\"target\":\"_blank\",\"rel\":\"noopener noreferrer\"}},[_vm._v(\"(Template)\")]):_vm._e(),(_vm.listLink)?_c('a',{attrs:{\"href\":_vm.listLink,\"target\":\"_blank\",\"rel\":\"noopener noreferrer\"}},[_vm._v(\"(List)\")]):_vm._e()]),_c('drop-target',{ref:\"dt\",staticClass:\"drop-target\",on:{\"drop\":_vm.addByImageFile}},[_vm._v(\"Drop here to add as a new expression\")]),_c('div',{staticClass:\"expression_list_wrapper\"},[_c('div',{staticClass:\"expression_list\",on:{\"&wheel\":function($event){return _vm.verticalScrollRedirect($event)}}},[_c('button',{on:{\"click\":function($event){return _vm.$refs.upload.click()}}},[_vm._v(\" Upload expression \"),_c('input',{ref:\"upload\",attrs:{\"type\":\"file\",\"multiple\":\"\"},on:{\"change\":_vm.addByUpload}})]),_c('button',{on:{\"click\":_vm.addByUrl}},[_vm._v(\"Add expression from URL\")]),_vm._l((_vm.uploadedExpressions),function(expression,idx){return _c('div',{key:idx,class:{\n\t\t\t\t\t\t\texpression_item: true,\n\t\t\t\t\t\t\tactive: _vm.currentUploadedExpression === expression,\n\t\t\t\t\t\t},style:({ backgroundImage: (\"url('\" + expression + \"')\") }),on:{\"click\":function($event){_vm.currentUploadedExpression = expression}}})})],2),_c('div',{staticClass:\"options_wrapper\"},[_c('div',{staticClass:\"image\"},[_c('canvas',{ref:\"target\",attrs:{\"width\":_vm.previewPoses[_vm.previewPoseIdx].width,\"height\":_vm.previewPoses[_vm.previewPoseIdx].height}})]),_c('div',[_vm._v(\" Preview pose: \"),_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.previewPoseIdx),expression:\"previewPoseIdx\"}],on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.previewPoseIdx=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},_vm._l((_vm.previewPoses),function(pose,idx){return _c('option',{key:idx,domProps:{\"value\":idx}},[_vm._v(_vm._s(_vm.normalizeName(pose.name)))])}),0),_c('fieldset',[_c('legend',[_vm._v(\"Offset\")]),_c('table',[_c('tr',[_c('th',[_vm._v(\"X:\")]),_c('td',[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.offsetX),expression:\"offsetX\",modifiers:{\"number\":true}}],attrs:{\"type\":\"number\"},domProps:{\"value\":(_vm.offsetX)},on:{\"keydown\":function($event){$event.stopPropagation();},\"input\":function($event){if($event.target.composing){ return; }_vm.offsetX=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}})]),_c('th',[_vm._v(\"Y:\")]),_c('td',[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.offsetY),expression:\"offsetY\",modifiers:{\"number\":true}}],attrs:{\"type\":\"number\"},domProps:{\"value\":(_vm.offsetY)},on:{\"keydown\":function($event){$event.stopPropagation();},\"input\":function($event){if($event.target.composing){ return; }_vm.offsetY=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}})])])])]),(_vm.headGroup.imagePatching && _vm.headGroup.imagePatching.mask)?_c('toggle-box',{attrs:{\"label\":\"Reduce to fit DDDG standard\"},model:{value:(_vm.addMask),callback:function ($$v) {_vm.addMask=$$v},expression:\"addMask\"}}):_vm._e(),(\n\t\t\t\t\t\t\t\t_vm.headGroup.imagePatching && _vm.headGroup.imagePatching.addition\n\t\t\t\t\t\t\t)?_c('toggle-box',{attrs:{\"label\":\"Add new parts to fit DDDG standard\"},model:{value:(_vm.addExtras),callback:function ($$v) {_vm.addExtras=$$v},expression:\"addExtras\"}}):_vm._e(),_c('button',{attrs:{\"disabled\":_vm.currentUploadedExpression === null},on:{\"click\":_vm.removeUploadedExpression}},[_vm._v(\" Remove this expression \")]),_c('button',{on:{\"click\":_vm.finishUpload}},[_vm._v(\"Finish\")]),_c('button',{on:{\"click\":_vm.leave}},[_vm._v(\"Abort\")])],1)])])],1):_c('div',[_c('h2',[_vm._v(\" Finishing up images. \"+_vm._s(Math.round(_vm.batchRunner.percentage * 100))+\"% \")])])]:_vm._e()],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"selection\",style:({ background: _vm.background }),on:{\"click\":function($event){$event.stopPropagation();return _vm.$emit('selected')}}},[_c('div',{staticClass:\"icon material-icons\"},[_vm._v(_vm._s(_vm.icon))]),_c('div',{staticClass:\"label\"},[_vm._v(_vm._s(_vm.label))])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n// App.vue has currently so many responsiblities that it's best to break it into chunks\nimport { Component, Vue, Prop } from 'vue-property-decorator';\n\n@Component({\n\tcomponents: {},\n})\nexport default class Selection extends Vue {\n\t@Prop() private icon!: string;\n\t@Prop() private label!: string;\n\t@Prop({ default: [] }) private images!: string[];\n\n\tpublic get background(): string {\n\t\treturn this.images\n\t\t\t.map(i => `center / contain no-repeat url('${i}')`)\n\t\t\t.join(',');\n\t}\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./selection.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./selection.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./selection.vue?vue&type=template&id=0839ac32&scoped=true&\"\nimport script from \"./selection.vue?vue&type=script&lang=ts&\"\nexport * from \"./selection.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./selection.vue?vue&type=style&index=0&id=0839ac32&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0839ac32\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"selector\"},[_vm._t(\"default\")],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n// App.vue has currently so many responsiblities that it's best to break it into chunks\nimport { Component, Vue } from 'vue-property-decorator';\n\n@Component({\n\tcomponents: {},\n})\nexport default class Selector extends Vue {}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./selector.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./selector.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./selector.vue?vue&type=template&id=47fcc628&scoped=true&\"\nimport script from \"./selector.vue?vue&type=script&lang=ts&\"\nexport * from \"./selector.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./selector.vue?vue&type=style&index=0&id=47fcc628&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"47fcc628\",\n  null\n  \n)\n\nexport default component.exports","import { Component, Vue } from 'vue-property-decorator';\n\n@Component({})\nexport class InternalState extends Vue {\n\tpublic busy: boolean = false;\n\tpublic error: string | null = null;\n\tpublic completed = 0;\n\tpublic fullCount = 0;\n}\n","import { Vue } from 'vue-property-decorator';\nimport { InternalState } from './internalState';\n\ntype Runner<P, R> = (\n\tpayload: P,\n\tisRunning: () => boolean\n) => Promise<R | undefined>;\n\ntype Disposer<R> = (payload: R) => Promise<void>;\n\nexport class WorkBatch<P, R> {\n\tprivate state = new Vue(InternalState) as InternalState;\n\tprivate pendingData: P[] = [];\n\tprivate currentlyRunning = new Set<P>();\n\tprivate resolveCurrentRun:\n\t\t| null\n\t\t| ((data: Array<R | undefined>) => void) = null;\n\tprivate rejectCurrentRun: null | (() => void) = null;\n\tprivate returnData: Array<R | undefined> = [];\n\n\tprivate remainingDisposers: Set<R> = new Set<R>();\n\tprivate runningDisposers: Set<R> = new Set<R>();\n\n\tpublic constructor(\n\t\tprivate readonly runner: Runner<P, R>,\n\t\tprivate readonly disposer: Disposer<R>,\n\t\tprivate readonly parallel = 4\n\t) {}\n\n\tpublic run(newData: P[]): Promise<Array<R | undefined>> {\n\t\tif (this.rejectCurrentRun) {\n\t\t\tthis.reject();\n\t\t}\n\t\tnewData = newData.slice();\n\t\tthis.pendingData = newData;\n\t\tthis.returnData = [];\n\t\tthis.state.fullCount = newData.length;\n\t\tthis.state.error = null;\n\t\tthis.state.busy = true;\n\t\tthis.state.completed = 0;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.resolveCurrentRun = resolve;\n\t\t\tthis.rejectCurrentRun = reject;\n\t\t\tif (newData.length > 0) {\n\t\t\t\tthis.restock();\n\t\t\t} else {\n\t\t\t\tthis.resolve();\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate get remainingCapacity() {\n\t\treturn (\n\t\t\tthis.parallel - this.currentlyRunning.size - this.runningDisposers.size\n\t\t);\n\t}\n\n\tprivate restock() {\n\t\twhile (this.remainingCapacity > 0 && this.pendingData.length > 0) {\n\t\t\tthis.startOne();\n\t\t}\n\t\twhile (this.remainingCapacity > 0 && this.remainingDisposers.size > 0) {\n\t\t\tthis.startDisposer();\n\t\t}\n\t}\n\n\tprivate async startOne() {\n\t\tconst data = this.pendingData.shift();\n\t\tconst idx = this.returnData.length;\n\t\tthis.returnData[idx] = undefined;\n\t\tif (!data) return;\n\t\tthis.currentlyRunning.add(data);\n\t\tconst isRunning = () => this.currentlyRunning.has(data);\n\t\tlet ret: R | undefined;\n\t\ttry {\n\t\t\tret = await this.runner(data, isRunning);\n\t\t} catch (e) {\n\t\t\tthis.reject(e);\n\t\t}\n\t\tif (isRunning()) {\n\t\t\t++this.state.completed;\n\t\t\tthis.returnData[idx] = ret;\n\t\t\tthis.currentlyRunning.delete(data);\n\t\t\tif (this.currentlyRunning.size === 0 && this.pendingData.length === 0) {\n\t\t\t\tthis.resolve();\n\t\t\t}\n\t\t} else if (ret !== undefined) {\n\t\t\tthis.remainingDisposers.add(ret);\n\t\t}\n\t\tthis.restock();\n\t}\n\n\tprivate async startDisposer() {\n\t\tconst data = this.remainingDisposers.values().next().value;\n\t\tthis.remainingDisposers.delete(data);\n\t\tthis.runningDisposers.add(data);\n\t\ttry {\n\t\t\tawait this.disposer(data);\n\t\t} catch (e) {}\n\t\tthis.runningDisposers.delete(data);\n\t\tthis.restock();\n\t}\n\n\tprivate resolve() {\n\t\tthis.state.busy = false;\n\t\t// Just to be sure\n\t\tthis.state.completed = this.state.fullCount;\n\t\tconst returnData = this.returnData;\n\t\tconst resolveCurrentRun = this.resolveCurrentRun!;\n\t\tthis.reset();\n\t\tresolveCurrentRun(returnData);\n\t}\n\n\tprivate reject(e?: Error) {\n\t\tthis.state.busy = false;\n\t\tthis.state.error = e?.message || null;\n\t\tconst returnData = this.returnData;\n\t\tconst rejectCurrentRun = this.rejectCurrentRun!;\n\t\tthis.reset();\n\t\tfor (const data of returnData) {\n\t\t\tif (data !== undefined) this.remainingDisposers.add(data);\n\t\t}\n\t\trejectCurrentRun();\n\t}\n\n\tprivate reset() {\n\t\tthis.returnData = [];\n\t\tthis.currentlyRunning = new Set<P>();\n\t\tthis.resolveCurrentRun = null;\n\t\tthis.rejectCurrentRun = null;\n\t}\n\n\tpublic get busy(): boolean {\n\t\treturn this.state.busy;\n\t}\n\n\tpublic get fullCount(): number {\n\t\treturn this.state.fullCount;\n\t}\n\n\tpublic get completed(): number {\n\t\treturn this.state.completed;\n\t}\n\n\tpublic get percentage(): number {\n\t\tif (this.fullCount === 0) return 0;\n\t\treturn this.completed / this.fullCount;\n\t}\n\n\tpublic get error(): string | null {\n\t\treturn this.state.error;\n\t}\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// App.vue has currently so many responsiblities that it's best to break it into chunks\nimport { Component, Vue, Prop, Watch, Mixins } from 'vue-property-decorator';\nimport Selection from './selection.vue';\nimport Selector from './selector.vue';\nimport DropTarget from '../../toolbox/drop-target.vue';\nimport ToggleBox from '@/components/toggle.vue';\nimport { Store } from 'vuex';\nimport { IRootState } from '@/store';\nimport environment from '@/environments/environment';\nimport { VerticalScrollRedirect } from '@/components/vertical-scroll-redirect';\nimport { Character } from '../../../renderables/character';\nimport {\n\tContentPack,\n\tCharacter as CharacterModel,\n\tPose,\n\tIHeadCommand,\n} from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\nimport { IAsset, ReplaceContentPackAction } from '../../../store/content';\nimport { getAssetByUrl } from '../../../asset-manager';\nimport { Renderer } from '../../../renderer/renderer';\nimport { WorkBatch } from '../../../util/workBatch';\nimport { IHistorySupport } from '../../../plugins/vuex-history';\n\nconst uploadedExpressionsPack: ContentPack<string> = {\n\tpackId: 'dddg.buildin.uploadedExpressions',\n\tdependencies: [],\n\tpackCredits: [],\n\tcharacters: [],\n\tfonts: [],\n\tsprites: [],\n\tpoemStyles: [],\n\tpoemBackgrounds: [],\n\tbackgrounds: [],\n\tcolors: [],\n};\n\nconst masks: { [s: string]: string | undefined } = {\n\t'dddg.buildin.base.monika:straight': 'assets/mask/monika-a-mask.png',\n\t'dddg.buildin.base.monika:sideways': 'assets/mask/monika-b-mask.png',\n\t'dddg.buildin.base.natsuki:straight': 'assets/mask/natsuki-a-mask.png',\n\t'dddg.buildin.base.natsuki:sideways': 'assets/mask/natsuki-b-mask.png',\n\t'dddg.buildin.base.natsuki:turnedAway': 'assets/mask/natsuki-c-mask.png',\n\t'dddg.buildin.base.sayori:straight': 'assets/mask/sayori-a-mask.png',\n\t'dddg.buildin.base.sayori:sideways': 'assets/mask/sayori-b-mask.png',\n\t'dddg.buildin.base.yuri:straight': 'assets/mask/yuri-a-mask.png',\n\t'dddg.buildin.base.yuri:sideways': 'assets/mask/yuri-b-mask.png',\n};\n\nconst adds: { [s: string]: string | undefined } = {\n\t'dddg.buildin.base.natsuki:straight': 'assets/mask/natsuki-a-add.png',\n};\n\nconst baseUrl =\n\t'https://github.com/edave64/Doki-Doki-Dialog-Generator/tree/master/public/assets/';\n\nconst listPaths: { [s: string]: string | undefined } = {\n\t'dddg.buildin.base.monika:ddlc.monika': `${baseUrl}monika`,\n\t'dddg.buildin.base.natsuki:ddlc.natsuki': `${baseUrl}natsuki`,\n\t'dddg.buildin.base.sayori:ddlc.sayori': `${baseUrl}sayori`,\n\t'dddg.buildin.base.yuri:ddlc.yuri': `${baseUrl}yuri`,\n\t'dddg.buildin.amy1:ddlc.fan.amy1': `${baseUrl}classic_amy`,\n\t'dddg.buildin.amy2:ddlc.fan.amy2': `${baseUrl}amy`,\n\t'dddg.buildin.femc:ddlc.fan.femc': `${baseUrl}femc`,\n\t'dddg.buildin.femc:ddlc.fan.femc:straight_lh': `${baseUrl}femc_lh`,\n\t'dddg.buildin.femc:ddlc.fan.femc:straight_hetero': `${baseUrl}femc/hetero`,\n\t'dddg.buildin.femc:ddlc.fan.femc:straight_hetero_lh': `${baseUrl}femc_lh/hetero`,\n\t'dddg.buildin.mc_classic:ddlc.fan.mc1': `${baseUrl}classic_mc`,\n\t'dddg.buildin.mc:ddlc.fan.mc2': `${baseUrl}mc`,\n\t'dddg.buildin.mc:ddlc.fan.mc2:straight_red': `${baseUrl}mc/red`,\n\t'dddg.buildin.mc_chad:ddlc.fan.mc_chad': `${baseUrl}chad`,\n\t'dddg.buildin.mc_chad:ddlc.fan.mc_chad:straight_red': `${baseUrl}chad/red`,\n};\n\nconst partFiles: { [s: string]: string[] | undefined } = {};\n\n@Component({\n\tcomponents: { Selection, Selector, ToggleBox, DropTarget },\n})\nexport default class ExpressionBuilder extends Mixins(VerticalScrollRedirect) {\n\tprivate static nr = 0;\n\n\t@Prop() public readonly character!: string;\n\t@Prop() public readonly initHeadGroup!: string | undefined;\n\tpublic $store!: Store<IRootState>;\n\n\tpublic method: null | 'upload' | 'parts' = 'upload';\n\tpublic headGroup: null | IHeadGroup = null;\n\tpublic uploadsFinished = false;\n\tpublic everythingBroken = false;\n\tpublic uploadedExpressions: string[] = [];\n\tpublic currentUploadedExpression: string | null = null;\n\tpublic previewPoseIdx: number = 0;\n\tpublic offsetX: number = 0;\n\tpublic offsetY: number = 0;\n\n\tpublic addMask = false;\n\tpublic addExtras = false;\n\tprivate vuexHistory!: IHistorySupport;\n\n\tprivate batchRunner = new WorkBatch<string, string>(\n\t\tthis.processExpression.bind(this),\n\t\tasync asset => {}\n\t);\n\n\tpublic created() {\n\t\t(window as any).exp = this;\n\t\tif (this.initHeadGroup) {\n\t\t\tthis.headGroup = this.availableHeadGroups.find(\n\t\t\t\tgroup => group.name === this.initHeadGroup\n\t\t\t)!;\n\t\t}\n\t\tthis.applySingleHeadGroup();\n\t}\n\n\tpublic get characterData(): CharacterModel<IAsset> {\n\t\treturn this.$store.state.content.current.characters.find(\n\t\t\tchar => char.id === this.character\n\t\t)!;\n\t}\n\n\tpublic get availableHeadGroups(): IHeadGroup[] {\n\t\tconst characterData = this.characterData;\n\t\tconst headTypes = Object.keys(characterData.heads);\n\t\treturn headTypes.map(headTypeKey => {\n\t\t\tconst headType = characterData.heads[headTypeKey];\n\n\t\t\treturn {\n\t\t\t\tname: headTypeKey,\n\t\t\t\tpreview: headType.variants[0].map(asset => asset.lq),\n\t\t\t\tpartsFiles: partFiles[headTypeKey] || [],\n\t\t\t\timagePatching: {\n\t\t\t\t\tmask: masks[headTypeKey],\n\t\t\t\t\taddition: adds[headTypeKey],\n\t\t\t\t},\n\t\t\t} as IHeadGroup;\n\t\t});\n\t}\n\n\t@Watch('availableHeadGroups')\n\tpublic applySingleHeadGroup() {\n\t\tif (this.availableHeadGroups.length === 1) {\n\t\t\tthis.headGroup = this.availableHeadGroups[0];\n\t\t}\n\t}\n\n\tpublic get hasParts(): boolean {\n\t\treturn !!this.availableHeadGroups.find(\n\t\t\theadGroup => headGroup.partsFiles.length > 0\n\t\t);\n\t}\n\n\tpublic async addByUpload(): Promise<void> {\n\t\tconst uploadInput = this.$refs.upload as HTMLInputElement;\n\t\tif (!uploadInput.files) return;\n\t\tfor (const file of uploadInput.files) {\n\t\t\tthis.addByImageFile(file);\n\t\t}\n\t}\n\n\tpublic addByImageFile(file: File) {\n\t\tconst url = URL.createObjectURL(file);\n\t\tthis.addUrl(url);\n\t}\n\n\tpublic async addByUrl(): Promise<void> {\n\t\tconst url = await environment.prompt('Enter the url of the image.', '');\n\t\tif (!url) return;\n\t\tthis.addUrl(url);\n\t}\n\n\tpublic addUrl(url: string): void {\n\t\tthis.currentUploadedExpression = url;\n\t\tthis.uploadedExpressions.push(url);\n\t}\n\n\tpublic get downloadLink(): string | null {\n\t\tconst character = this.characterData;\n\t\tif (!character || !this.headGroup) return null;\n\t\tconst headType = character.heads[this.headGroup!.name];\n\t\tif (!headType) return null;\n\t\treturn headType.variants[0][0].hq;\n\t}\n\n\tpublic get listLink(): string | null {\n\t\tif (!this.characterData || !this.headGroup) return null;\n\t\tconst charName = this.characterData.id;\n\t\tconst headGroupName = this.headGroup.name;\n\t\tif (listPaths[charName + ':' + headGroupName]) {\n\t\t\treturn listPaths[charName + ':' + headGroupName] || null;\n\t\t}\n\t\treturn listPaths[charName] || null;\n\t}\n\n\tpublic get previewPoses(): IPose[] {\n\t\tconst character = this.characterData;\n\t\tif (!character || !this.headGroup) return [];\n\t\tconst poses: IPose[] = [];\n\n\t\tfor (\n\t\t\tlet styleGroupIdx = 0;\n\t\t\tstyleGroupIdx < character.styleGroups.length;\n\t\t\t++styleGroupIdx\n\t\t) {\n\t\t\tconst styleGroup = character.styleGroups[styleGroupIdx];\n\t\t\tfor (let styleIdx = 0; styleIdx < styleGroup.styles.length; ++styleIdx) {\n\t\t\t\tconst style = styleGroup.styles[styleIdx];\n\t\t\t\tfor (let poseIdx = 0; poseIdx < style.poses.length; ++poseIdx) {\n\t\t\t\t\tconst pose = style.poses[poseIdx];\n\t\t\t\t\tif (pose.compatibleHeads.includes(this.headGroup.name)) {\n\t\t\t\t\t\tposes.push({\n\t\t\t\t\t\t\tname: pose.id,\n\t\t\t\t\t\t\tstyleGroupId: styleGroupIdx,\n\t\t\t\t\t\t\tstyleId: styleIdx,\n\t\t\t\t\t\t\tposeId: poseIdx,\n\t\t\t\t\t\t\twidth: pose.size[0],\n\t\t\t\t\t\t\theight: pose.size[1],\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn poses;\n\t}\n\n\tpublic get expressionModels(): IAsset[][] {\n\t\treturn this.uploadedExpressions.map(expression => [\n\t\t\t{\n\t\t\t\thq: expression,\n\t\t\t\tlq: expression,\n\t\t\t\tsourcePack: 'dddg.temp1:default',\n\t\t\t} as IAsset,\n\t\t]);\n\t}\n\n\tpublic get temporaryCharacterModel(): CharacterModel<IAsset> {\n\t\tconst poses = this.previewPoses;\n\t\tconst character = this.$store.state.content.current.characters.find(\n\t\t\tchar => char.id === this.character\n\t\t)!;\n\t\tconst offsetX = this.offsetX;\n\t\tconst offsetY = this.offsetY;\n\n\t\treturn {\n\t\t\tid: this.character,\n\t\t\theads: {\n\t\t\t\t'dddg.temp1:default': {\n\t\t\t\t\tvariants: this.expressionModels,\n\t\t\t\t\tpreviewSize: [0, 0],\n\t\t\t\t\tpreviewOffset: [0, 0],\n\t\t\t\t},\n\t\t\t},\n\t\t\tstyleGroups: [\n\t\t\t\t{\n\t\t\t\t\tid: 'preview',\n\t\t\t\t\tstyleComponents: [],\n\t\t\t\t\tstyles: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcomponents: {},\n\t\t\t\t\t\t\tposes: poses.map((pose, idx) => {\n\t\t\t\t\t\t\t\tconst styleGroup = character.styleGroups[pose.styleGroupId];\n\t\t\t\t\t\t\t\tconst style = styleGroup.styles[pose.styleId];\n\t\t\t\t\t\t\t\tconst renderCommands = style.poses[\n\t\t\t\t\t\t\t\t\tpose.poseId\n\t\t\t\t\t\t\t\t].renderCommands.slice(0);\n\t\t\t\t\t\t\t\tlet headIdx = renderCommands.findIndex(\n\t\t\t\t\t\t\t\t\tcommand => command.type === 'head'\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tconst headRenderCommand = renderCommands[headIdx];\n\t\t\t\t\t\t\t\tconst newHeadCommand: IHeadCommand = {\n\t\t\t\t\t\t\t\t\ttype: 'head',\n\t\t\t\t\t\t\t\t\toffset: [\n\t\t\t\t\t\t\t\t\t\theadRenderCommand.offset[0] + offsetX,\n\t\t\t\t\t\t\t\t\t\theadRenderCommand.offset[1] + offsetY,\n\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tthis.addMask &&\n\t\t\t\t\t\t\t\t\tthis.headGroup &&\n\t\t\t\t\t\t\t\t\tthis.headGroup.imagePatching &&\n\t\t\t\t\t\t\t\t\tthis.headGroup.imagePatching.mask\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\tconst mask = this.headGroup.imagePatching.mask;\n\t\t\t\t\t\t\t\t\trenderCommands.splice(headIdx, 1);\n\t\t\t\t\t\t\t\t\theadIdx = 1;\n\t\t\t\t\t\t\t\t\trenderCommands.splice(0, 0, newHeadCommand, {\n\t\t\t\t\t\t\t\t\t\ttype: 'image',\n\t\t\t\t\t\t\t\t\t\timages: [\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\thq: mask,\n\t\t\t\t\t\t\t\t\t\t\t\tlq: mask,\n\t\t\t\t\t\t\t\t\t\t\t\tsourcePack: 'dddg.temp1',\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t\tcomposite: 'destination-in',\n\t\t\t\t\t\t\t\t\t\toffset: headRenderCommand.offset,\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\trenderCommands.splice(headIdx, 1, newHeadCommand);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tthis.addExtras &&\n\t\t\t\t\t\t\t\t\tthis.headGroup &&\n\t\t\t\t\t\t\t\t\tthis.headGroup.imagePatching &&\n\t\t\t\t\t\t\t\t\tthis.headGroup.imagePatching.addition\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\tconst add = this.headGroup.imagePatching.addition;\n\t\t\t\t\t\t\t\t\trenderCommands.splice(headIdx + 1, 0, {\n\t\t\t\t\t\t\t\t\t\ttype: 'image',\n\t\t\t\t\t\t\t\t\t\timages: [\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\thq: add,\n\t\t\t\t\t\t\t\t\t\t\t\tlq: add,\n\t\t\t\t\t\t\t\t\t\t\t\tsourcePack: 'dddg.temp1',\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t\toffset: headRenderCommand.offset,\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t...style.poses[pose.poseId],\n\t\t\t\t\t\t\t\t\trenderCommands,\n\t\t\t\t\t\t\t\t\tid: 'dddg.temp1:pose' + idx,\n\t\t\t\t\t\t\t\t\tcompatibleHeads: ['dddg.temp1:default'],\n\t\t\t\t\t\t\t\t} as Pose<IAsset>;\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t],\n\t\t\tlabel: '',\n\t\t\tchibi: null!,\n\t\t};\n\t}\n\n\tpublic async processExpression(\n\t\texpression: string,\n\t\tisRunning: () => boolean\n\t): Promise<string | undefined> {\n\t\tlet finalExpression: string;\n\t\tconst asset = (await getAssetByUrl(expression)) as HTMLImageElement;\n\t\tif (!isRunning()) return undefined;\n\t\tconst renderer = new Renderer(\n\t\t\tasset.width + this.offsetX,\n\t\t\tasset.height + this.offsetY\n\t\t);\n\t\tconst blob = await renderer.renderToBlob(async rx => {\n\t\t\trx.drawImage({\n\t\t\t\timage: asset,\n\t\t\t\tx: this.offsetX,\n\t\t\t\ty: this.offsetY,\n\t\t\t\tw: asset.width,\n\t\t\t\th: asset.height,\n\t\t\t});\n\n\t\t\tif (\n\t\t\t\tthis.addMask &&\n\t\t\t\tthis.headGroup &&\n\t\t\t\tthis.headGroup.imagePatching &&\n\t\t\t\tthis.headGroup.imagePatching.mask\n\t\t\t) {\n\t\t\t\tconst mask = (await getAssetByUrl(\n\t\t\t\t\tthis.headGroup.imagePatching.mask\n\t\t\t\t)) as HTMLImageElement;\n\t\t\t\tif (!isRunning()) return undefined;\n\t\t\t\trx.drawImage({\n\t\t\t\t\timage: mask,\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0,\n\t\t\t\t\tw: mask.width,\n\t\t\t\t\th: mask.height,\n\t\t\t\t\tcomposite: 'destination-in',\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tthis.addExtras &&\n\t\t\t\tthis.headGroup &&\n\t\t\t\tthis.headGroup.imagePatching &&\n\t\t\t\tthis.headGroup.imagePatching.addition\n\t\t\t) {\n\t\t\t\tconst addition = (await getAssetByUrl(\n\t\t\t\t\tthis.headGroup.imagePatching.addition\n\t\t\t\t)) as HTMLImageElement;\n\t\t\t\tif (!isRunning()) return undefined;\n\t\t\t\trx.drawImage({\n\t\t\t\t\timage: addition,\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0,\n\t\t\t\t\tw: addition.width,\n\t\t\t\t\th: addition.height,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tfinalExpression = URL.createObjectURL(blob);\n\n\t\tif (expression !== finalExpression && expression.startsWith('blob:')) {\n\t\t\tURL.revokeObjectURL(expression);\n\t\t}\n\n\t\treturn finalExpression;\n\t}\n\n\t@Watch('previewPoseIdx')\n\t@Watch('previewPoses')\n\t@Watch('currentUploadedExpression')\n\t@Watch('offsetX')\n\t@Watch('offsetY')\n\t@Watch('addMask')\n\t@Watch('addExtras')\n\tpublic async redraw() {\n\t\tif (this.uploadsFinished) return;\n\t\tconst pose = this.previewPoses[this.previewPoseIdx];\n\t\tif (!pose) return;\n\t\tlet charRenderer: Character;\n\t\ttry {\n\t\t\tcharRenderer = new Character(\n\t\t\t\t{\n\t\t\t\t\t...charDefDefaults,\n\t\t\t\t\twidth: pose.width,\n\t\t\t\t\theight: pose.height,\n\t\t\t\t\tposeId: this.previewPoseIdx,\n\t\t\t\t\tx: pose.width / 2,\n\t\t\t\t\tposePositions: {\n\t\t\t\t\t\theadGroup: 0,\n\t\t\t\t\t\thead: this.uploadedExpressions.indexOf(\n\t\t\t\t\t\t\tthis.currentUploadedExpression!\n\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tawait this.temporaryCharacterModel\n\t\t\t);\n\t\t} catch (e) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.$nextTick(async () => {\n\t\t\tif (this.uploadsFinished) return;\n\t\t\tconst renderer = new Renderer(pose.width, pose.height);\n\t\t\tawait renderer.render(async rx => {\n\t\t\t\tawait charRenderer.render(false, rx);\n\t\t\t});\n\n\t\t\tconst target = this.$refs.target as HTMLCanvasElement;\n\t\t\tconst ctx = target.getContext('2d')!;\n\t\t\tctx.clearRect(0, 0, target.width, target.height);\n\t\t\trenderer.paintOnto(ctx, 0, 0, target.width, target.height);\n\t\t});\n\t}\n\n\tprivate async finishUpload() {\n\t\tthis.uploadsFinished = true;\n\t\tconst processedExpressions = (\n\t\t\tawait this.batchRunner.run(this.uploadedExpressions)\n\t\t).filter(exp => exp) as string[];\n\n\t\tconst storeCharacter = this.$store.state.content.current.characters.find(\n\t\t\tchar => char.id === this.character\n\t\t)!;\n\t\tlet character = uploadedExpressionsPack.characters.find(\n\t\t\tchar => char.id === this.character\n\t\t);\n\t\tif (!character) {\n\t\t\tcharacter = {\n\t\t\t\tid: this.character,\n\t\t\t\theads: {},\n\t\t\t\tstyleGroups: [],\n\t\t\t\tlabel: '',\n\t\t\t\tchibi: '',\n\t\t\t} as CharacterModel<string>;\n\t\t\tuploadedExpressionsPack.characters.push(character);\n\t\t}\n\n\t\tlet headGroup = character.heads[this.headGroup!.name];\n\t\tconst storeHeadGroup = storeCharacter.heads[this.headGroup!.name];\n\t\tif (!headGroup) {\n\t\t\theadGroup = {\n\t\t\t\tpreviewSize: storeHeadGroup.previewSize,\n\t\t\t\tpreviewOffset: storeHeadGroup.previewOffset,\n\t\t\t\tvariants: [],\n\t\t\t};\n\t\t\tcharacter.heads[this.headGroup!.name] = headGroup;\n\t\t}\n\n\t\tfor (const processedExpression of processedExpressions) {\n\t\t\theadGroup.variants.push([processedExpression]);\n\t\t}\n\n\t\tawait this.vuexHistory.transaction(() => {\n\t\t\tthis.$store.dispatch('content/replaceContentPack', {\n\t\t\t\tcontentPack: uploadedExpressionsPack,\n\t\t\t} as ReplaceContentPackAction);\n\t\t});\n\n\t\tthis.leave();\n\t}\n\n\tprivate leave() {\n\t\tthis.$emit('leave');\n\t\tthis.method = null;\n\t\tthis.headGroup = null;\n\t\tthis.uploadedExpressions = [];\n\t}\n\n\tprivate removeUploadedExpression() {\n\t\tif (!this.currentUploadedExpression) return;\n\t\tconst expression = this.currentUploadedExpression;\n\t\tthis.currentUploadedExpression = null;\n\t\tif (expression.startsWith('blob:')) {\n\t\t\tURL.revokeObjectURL(expression);\n\t\t}\n\t\tlet idx = this.uploadedExpressions.indexOf(expression);\n\t\tthis.uploadedExpressions.splice(idx, 1);\n\t\tif (idx > this.uploadedExpressions.length - 1) {\n\t\t\tidx = this.uploadedExpressions.length - 1;\n\t\t}\n\t\tthis.currentUploadedExpression = this.uploadedExpressions[idx] || null;\n\t}\n\n\tprivate normalizeName(name: string): string {\n\t\tconst parts = name.split(':');\n\t\tlet actualName = parts[parts.length - 1];\n\t\tconst packId = parts.length > 1 ? parts[0].trim() : '';\n\n\t\tactualName = (\n\t\t\tactualName[0].toUpperCase() + actualName.slice(1).toLowerCase()\n\t\t)\n\t\t\t.split('_')\n\t\t\t.join(' ');\n\t\tif (packId.startsWith('dddg.') || packId === '') {\n\t\t\treturn actualName;\n\t\t}\n\t\treturn packId + ': ' + actualName;\n\t}\n\n\tprivate dragEnter(e: DragEvent) {\n\t\tif (!this.headGroup || this.method !== 'upload') return;\n\t\tif (!e.dataTransfer) return;\n\t\te.dataTransfer.effectAllowed = 'none';\n\t\tif (\n\t\t\t!Array.from(e.dataTransfer.items).find(item =>\n\t\t\t\titem.type.match(/^image.*$/)\n\t\t\t)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\t\te.dataTransfer.effectAllowed = 'link';\n\t\t(this.$refs.dt as DropTarget).show();\n\t}\n\n\tprivate hideDt() {\n\t\tif (this.$refs.dt) (this.$refs.dt as DropTarget).hide();\n\t}\n}\n\nconst charDefDefaults = {\n\ttype: 'character' as 'character',\n\tcharacterType: '',\n\tfreeMove: false,\n\tclose: false,\n\tstyleGroupId: 0,\n\tstyleId: 0,\n\tposeId: 0,\n\tposePositions: {},\n\tpanelId: '',\n\tid: '',\n\ty: 0,\n\tpreserveRatio: true,\n\tratio: 1,\n\topacity: 100,\n\tversion: 1,\n\tflip: false,\n\tonTop: false,\n};\n\ninterface IPose {\n\tname: string;\n\tstyleGroupId: number;\n\tstyleId: number;\n\tposeId: number;\n\twidth: number;\n\theight: number;\n}\n\ninterface IHeadGroup {\n\tname: string;\n\tpreview: string[];\n\tpartsFiles: string[];\n\timagePatching?: {\n\t\tmask?: string;\n\t\taddition?: string;\n\t};\n}\n\ninterface ICachedProcessedExpression {\n\turl: string;\n\taddMask: boolean;\n\taddExtras: boolean;\n\toffsetX: number;\n\toffsetY: number;\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=af07ae48&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=ts&\"\nexport * from \"./index.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=af07ae48&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"af07ae48\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./selection.vue?vue&type=style&index=0&id=0839ac32&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./selection.vue?vue&type=style&index=0&id=0839ac32&scoped=true&lang=css&\""],"sourceRoot":""}