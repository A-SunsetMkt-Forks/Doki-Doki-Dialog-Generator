{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/toolbox/commonsFieldsets/positionAndSize.vue?0e1f","webpack:///./src/components/toolbox/commonsFieldsets/layers.vue?613c","webpack:///./src/components/toolbox/panels/credits.vue?415b","webpack:///./src/components/toolbox/panels/sprite.vue?e14e","webpack:///./src/components/toolbox/panels/content-pack.vue?9490","webpack:///./src/components/toolbox/toolbox.vue?e2d4","webpack:///./src/components/toolbox/commonsFieldsets/opacity.vue?ca2d","webpack:///./src/components/toolbox/panels/general.vue?cdc0","webpack:///./src/App.vue?763a","webpack:///./src/components/toolbox/panels/character/parts.vue?c19b","webpack:///./src/components/toolbox/panels/background/button.vue?446a","webpack:///./src/components/toolbox/panels/character/partButton.vue?29fd","webpack:///./src/components/message-console.vue?1bf2","webpack:///./src/components/toolbox/panels/textbox.vue?83ff","webpack:///./src/components/toggle.vue?94aa","webpack:///./src/plugins/vuex-history.js","webpack:///./src/App.vue?394f","webpack:///./src/components/toolbox/toolbox.vue?3c82","webpack:///./src/components/toolbox/panels/general.vue?8651","webpack:///./src/components/toggle.vue?0504","webpack:///./src/components/toggle.vue?c831","webpack:///./src/components/toggle.vue?111d","webpack:///./src/components/toggle.vue","webpack:///./src/components/toolbox/panels/panelMixin.ts","webpack:///./src/components/toolbox/panels/general.vue?3d06","webpack:///./src/components/toolbox/panels/general.vue?3af4","webpack:///./src/components/toolbox/panels/general.vue","webpack:///./src/components/toolbox/panels/add.vue?cb4e","webpack:///./src/eventbus/event-bus.ts","webpack:///./src/models/error-asset.ts","webpack:///./src/asset-manager.ts","webpack:///./src/components/toolbox/panels/add.vue?d112","webpack:///./src/components/toolbox/panels/add.vue?6c2e","webpack:///./src/components/toolbox/panels/add.vue","webpack:///./src/components/toolbox/panels/character.vue?196a","webpack:///./src/models/constants.ts","webpack:///./src/models/seekers.ts","webpack:///./src/store/objectTypes/characters.ts","webpack:///./src/components/toolbox/commonsFieldsets/positionAndSize.vue?161c","webpack:///./src/components/toolbox/commonsFieldsets/positionAndSize.vue?8e58","webpack:///./src/components/toolbox/commonsFieldsets/positionAndSize.vue?de84","webpack:///./src/components/toolbox/commonsFieldsets/positionAndSize.vue","webpack:///./src/components/toolbox/commonsFieldsets/layers.vue?d53c","webpack:///./src/components/toolbox/commonsFieldsets/layers.vue?dcb7","webpack:///./src/components/toolbox/commonsFieldsets/layers.vue?a903","webpack:///./src/components/toolbox/commonsFieldsets/layers.vue","webpack:///./src/components/toolbox/commonsFieldsets/opacity.vue?6f61","webpack:///./src/components/toolbox/commonsFieldsets/opacity.vue?e6e1","webpack:///./src/components/toolbox/commonsFieldsets/opacity.vue?4d33","webpack:///./src/components/toolbox/commonsFieldsets/opacity.vue","webpack:///./src/components/toolbox/commonsFieldsets/delete.vue?0946","webpack:///./src/components/toolbox/commonsFieldsets/delete.vue?c3eb","webpack:///./src/components/toolbox/commonsFieldsets/delete.vue?4121","webpack:///./src/components/toolbox/commonsFieldsets/delete.vue","webpack:///./src/components/toolbox/panels/character/parts.vue?f2bf","webpack:///./src/components/toolbox/panels/character/partButton.vue?a2cb","webpack:///./src/environments/browser.ts","webpack:///./src/environments/edge.ts","webpack:///./src/environments/electron.ts","webpack:///./src/environments/environment.ts","webpack:///./src/components/toolbox/panels/character/partButton.vue?9154","webpack:///./src/components/toolbox/panels/character/partButton.vue?b061","webpack:///./src/components/toolbox/panels/character/partButton.vue","webpack:///./src/components/toolbox/panels/character/parts.vue?9c59","webpack:///./src/components/toolbox/panels/character/parts.vue?25dd","webpack:///./src/components/toolbox/panels/character/parts.vue","webpack:///./src/components/toolbox/panels/character.vue?081c","webpack:///./src/components/toolbox/panels/character.vue?283a","webpack:///./src/components/toolbox/panels/character.vue","webpack:///./src/components/toolbox/panels/sprite.vue?78b4","webpack:///./src/components/toolbox/panels/sprite.vue?dbdb","webpack:///./src/components/toolbox/panels/sprite.vue?bfdb","webpack:///./src/components/toolbox/panels/sprite.vue","webpack:///./src/components/toolbox/panels/textbox.vue?b04a","webpack:///./src/components/toolbox/panels/textbox.vue?ca5f","webpack:///./src/components/toolbox/panels/textbox.vue?500e","webpack:///./src/components/toolbox/panels/textbox.vue","webpack:///./src/components/toolbox/panels/credits.vue?ca1f","webpack:///./src/components/toolbox/panels/credits.vue?05b9","webpack:///./src/components/toolbox/panels/credits.vue?3709","webpack:///./src/components/toolbox/panels/credits.vue","webpack:///./src/components/toolbox/panels/backgrounds.vue?9c66","webpack:///./src/components/toolbox/panels/background/button.vue?78cd","webpack:///./src/components/toolbox/panels/background/button.vue?92ee","webpack:///./src/components/toolbox/panels/background/button.vue?9649","webpack:///./src/components/toolbox/panels/background/button.vue","webpack:///./src/components/toolbox/panels/background/settings.vue?5b31","webpack:///./src/components/toolbox/panels/background/settings.vue?93fe","webpack:///./src/components/toolbox/panels/background/settings.vue?50a9","webpack:///./src/components/toolbox/panels/background/settings.vue","webpack:///./src/components/toolbox/panels/backgrounds.vue?9ca2","webpack:///./src/components/toolbox/panels/backgrounds.vue?18da","webpack:///./src/components/toolbox/panels/backgrounds.vue","webpack:///./src/components/toolbox/panels/content-pack.vue?c68f","webpack:///./src/components/toolbox/panels/character-pack-sanitizer.ts","webpack:///./src/components/toolbox/panels/content-pack.vue?566c","webpack:///./src/components/toolbox/panels/content-pack.vue?7468","webpack:///./src/components/toolbox/panels/content-pack.vue","webpack:///./src/components/toolbox/toolbox.vue?5a64","webpack:///./src/components/toolbox/toolbox.vue?983b","webpack:///./src/components/toolbox/toolbox.vue","webpack:///./src/components/message-console.vue?a1e9","webpack:///./src/components/message-console.vue?092b","webpack:///./src/components/message-console.vue?1d97","webpack:///./src/components/message-console.vue","webpack:///./src/components/render.vue?eadf","webpack:///./src/models/variant-background.ts","webpack:///./src/renderer/renderAbortedException.ts","webpack:///./src/renderer/rendererContext.ts","webpack:///./src/renderer/renderer.ts","webpack:///./src/models/background.ts","webpack:///./src/models/character.ts","webpack:///./src/models/sprite.ts","webpack:///./src/models/textBoxConstants.ts","webpack:///./src/renderer/pathTools.ts","webpack:///./src/util/colors/hsl.ts","webpack:///./src/util/colors/rgb.ts","webpack:///./src/models/textbox.ts","webpack:///./src/components/render.vue?7cec","webpack:///./src/components/render.vue?4d80","webpack:///./src/components/render.vue","webpack:///./src/App.vue?ec60","webpack:///./src/App.vue?640d","webpack:///./src/App.vue","webpack:///./src/store/objectTypes/sprite.ts","webpack:///./src/store/objectTypes/textbox.ts","webpack:///./src/store/objects.ts","webpack:///./src/store/ui.ts","webpack:///./src/store/background.ts","webpack:///./src/store/content/merge.ts","webpack:///./src/store/content/index.ts","webpack:///./src/store/index.ts","webpack:///./src/store/objectTypes/sprite_history_properties.ts","webpack:///./src/store/objects_history_properties.ts","webpack:///./src/main.ts","webpack:///./src/components/toolbox/panels/add.vue?256b","webpack:///./src/components/toolbox/panels/background/settings.vue?621c","webpack:///./src/components/toolbox/panels/character.vue?819d","webpack:///./src/components/toolbox/panels/backgrounds.vue?04d7"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","install","Vue","options","_installedPlugins","find","plugin","Store","Error","replayAll","vm","oldTransactions","done","$store","commit","resetStateMutation","replayTransaction","transaction","forEach","mutation","replayMutation","payload","baseObj","Array","type","assign","mutations","mixin","undone","newMutation","ignoreMutations","currentTransaction","transactionQueue","created","historyStuff","this","subscribe","exec","getMutationProperties","ignore","computed","canRedo","canUndo","methods","redo","pop","undo","callback","Promise","resolve","reject","console","log","lastUndo","combinable","combination","combinator","mutationProperiesCache","parts","split","mutationProperties","oldMutation","currentWildcard","part","_vm","_h","$createElement","_c","_self","attrs","ref","canvasWidth","canvasHeight","on","drawLastDownload","$event","$refs","render","download","staticRenderFns","class","vertical","active","panel","setPanel","_v","$emit","_e","staticClass","model","$$v","lqRendering","expression","hasPrevRender","nsfw","_uid","domProps","onChange","_s","label","event","checkbox","checked","String","Boolean","default","components","component","updateVertical","$el","addEventListener","e","currentTarget","target","classList","contains","ev","deltaY","mozInputSource","scrollLeft","passive","add","remove","namespace","nsfwPacks","names","Set","keys","values","state","ui","history","lastDownload","$root","content","contentPacks","map","pack","packId","filter","has","dispatch","packs","Toggle","undefined","isWebPSupported","_l","character","id","onChosen","toLowerCase","assetPath","upload","click","onFileUpload","uploadFromURL","addTextBox","eventBus","fireCommand","command","subscribeCommand","handler","$on","fire","kind","eventType","unsubscribe","$off","path","error","webpSupportPromise","losslessCode","img","document","createElement","width","height","src","assetCache","customAssets","getAAsset","asset","hq","url","lq","Image","crossOrigin","style","display","body","appendChild","getAsset","replace","registerAsset","file","URL","createObjectURL","registerAssetWithURL","customAssetCount","chibi","uploadInput","files","nr","prompt","characterType","current","characters","panelForParts","hasMultiplePoses","seekStyle","seekPose","seekPart","captialize","closeUp","flip","positions","characterPositions","arraySeeker","array","pos","delta","val","CloseUpYOffset","BaseCharacterYPos","characterMutations","setPose","obj","objects","poseId","version","setCharStyle","styleId","setPosePosition","posePositions","setClose","close","setFreeMove","freeMove","x","closestCharacterSlot","y","store","getters","getDataG","rootGetters","getPose","poses","getParts","pose","compatibleHeads","variant","left","right","getHeads","headTypeId","headType","heads","sorted","idx","Math","abs","sort","a","b","lastSpriteId","characterActions","createCharacters","onTop","opacity","preserveRatio","ratio","head","mutatePoseAndPositions","change","styles","seekHead","currentHeads","variants","headKey","setPart","setCharacterPosition","shiftCharacterSlot","currentSlotNr","newSlotNr","fixContentPackRemovalFromCharacter","context","oldPack","oldCharData","char","newCharData","rootState","chr","poseAndPositionChange","buildPoseAndPositionData","oldStyle","newStyleIdx","findIndex","oldPoseInStyle","oldPoseInStyleIndex","indexOf","newPosesInStyle","newStyle","newPoseIdx","oldPose","newPose","oldPart","JSON","stringify","newPartIdx","oldVariant","newVariantIdx","oldLeft","newLeftIdx","oldRigth","newRightIdx","oldHeadGroup","newHeadGroupIdx","oldHead","newHeadIdx","commitPoseAndPositionChanges","poseAndPosition","oldHeadCollection","newHeadCollectionNr","allowSize","allowStepMove","isFirstPos","directives","rawName","modifiers","$$selectedVal","selected","_value","_n","multiple","isLastPos","stopPropagation","composing","$forceUpdate","required","shiftLayer","Infinity","setInFront","newValue","onClick","partList","index","choose","styleComponent","button","choose_component","allowLQ","downloadCanvas","filename","setAttribute","removeChild","background","message","defaultValue","canvas","toBlob","blob","toDataURL","dataURItoBlob","dataURI","binStr","atob","len","arr","Uint8Array","charCodeAt","Blob","navigator","msSaveBlob","electron","promptCache","lastPrompt","ipcRenderer","filePath","filepath","send","arrayBuffer","buffer","HTMLImageElement","fetch","installed","startsWith","newUrl","chooseEnv","isElectron","msSaveOrOpenBlob","envX","toast","lookups","loaded","all","images","size","floor","scaleX","scaleY","offset","baseStyle","backgroundPosition","backgroundSize","environment","lookup","backgroundImage","join","Number","styleData","lastBase","charData","styleGroup","updateStyleData","renderOrder","order","toUpperCase","static","concat","selection","subSelect","styleComponents","updatePose","parseInt","headTypeIdx","headIdx","buttons","collection","ret","currentPose","headKeyIdx","headImages","currentStyle","poseIdx","generatePosePreview","dedupedStyleGroups","firstStyle","firstPose","partIdx","PartButton","str","charAt","substring","PositionAndSize","Layers","Opacity","Delete","Parts","sprite","textBoxStyle","talkingDefaults","talkingOther","showControls","allowSkipping","showContinueArrow","dialog","textbox","splitTextbox","textboxColor","customNameboxWidth","deriveCustomColors","customControlsColor","customNameboxColor","customNameboxStroke","talkingDefault","controls","skip","continue","text","customColor","color","_m","setBackground","isActive","title","assets","bgData","backgrounds","urls","flipped","seekVariant","currentBackgroundId","uploadedBackgroundsPack","packCredits","fonts","sprites","poemStyles","customPathLookup","customBGCount","contentPack","$set","BackgroundButton","BackgroundSettings","addNew","select","credits","activate","deactivate","uninstall","restart","allowedTags","allowedAttributes","schemaLimitedAttributes","allowedSchemas","enforceAttributes","rel","sanitize","html","retDoc","doc","innerHTML","from","childNodes","node","sanitizeElement","sanitizedNode","protocolMatcher","nodeType","Node","ELEMENT_NODE","el","tagName","includes","attributes","allowedAttrs","attr","protocolMatch","match","removeAttribute","enforce","attrName","createTextNode","subNode","selectedPack","needRestart","installedCharacterPacks","location","reload","installContentPack","queuedUninstall","uninstallContentPack","activateContentPack","deactivateContentPack","freshInstall","isPackInstallingSupported","panelSelection","onPanelChange","newSelection","GeneralPanel","AddPanel","BackgroundsPanel","CreditsPanel","CharacterPanel","TextBoxPanel","SpritePanel","ContentPacksPanel","messages","showLoading","showLoadingTimeout","hideLoadingTimeout","onLoadingChange","loading","setTimeout","clearTimeout","onUiClick","onTouchStart","onDragStart","onSpriteDragMove","onSpriteDrop","onDragOver","onDrop","onMouseEnter","rx","drawImage","image","fsCtx","preview","aborted","params","save","font","align","lineJoin","textAlign","outline","strokeStyle","lineWidth","strokeText","fill","fillStyle","fillText","restore","measureText","w","h","globalAlpha","shadow","shadowColor","blur","shadowBlur","offsetX","shadowOffsetX","offsetY","shadowOffsetY","translate","scale","paintOnto","composition","beginPath","rect","globalCompositeOperation","stroke","repetition","previewCanvas","createPattern","transform","x0","y0","x1","y1","createLinearGradient","runningContext","renderCallback","abort","ctx","getContext","clearRect","getImageData","drawRect","localRenderer","lastVersion","hitDetectionFallback","getData","headAssets","renderPart","loadedAssets","loadedHeadAssets","loadedAsset","loadedheadAsset","headAnchor","updateLocalCanvas","hx","hy","scaledX","scaledY","flippedX","getDataAt","round","DOMException","zoom","lockedRatio","then","catch","err","hitX","hitY","TextBoxWidth","TextBoxCorruptedWidth","TextBoxHeight","TextBoxY","TextBoxKerning","TextBoxLineHeight","TextBoxCorruptedKerning","TextBoxTextXOffset","TextBoxTextYOffset","TextBoxTextCorruptedXOffset","TextBoxTextCorruptedYOffset","NameboxHeight","NameboxWidth","NameboxXOffset","NameboxTextYOffset","ControlsYBottomOffset","ControlsXHistoryOffset","ControlsXSkipOffset","ControlsXStuffOffset","ArrowXRightOffset","ArrowYBottomOffset","GlowRX","GlowRY","NameboxTextStyle","ControlsTextStyle","ControlsTextDisabledStyle","TextBoxStyle","TextBoxCorruptedStyle","NameboxY","roundedRectangle","moveTo","arcTo","closePath","roundedTopRectangle","lineTo","deltas","HSLAColor","g","q","hue2rgb","max","min","validCssRgb","validHex","fromCssRgb","fromHex","rgbEx","test","rgbaEx","rgbHead","parentesisPos","rbgTail","elements","parseFloat","trim","RGBAColor","hexShortEx","hexLongEx","hexTail","lastX","lastY","lastH","lastW","w2","x2","y2","fromCss","toHSL","renderBackdrop","renderNamebox","renderText","bottom","controlsY","controlsCenter","drawText","controlsStyle","controlsDisableStyle","hslOutline","nameboxOutlineColor","customTransform","clip","subRx","gradient","linearGradient","baseBG","nameboxBackgroundColor","targetColor","toRgb","addColorStop","toCss","hslColor","dotPattern","dotRx","fillDelta","drawPath","ellipse","PI","subSubRx","pattern","patternFrom","glowGradient","outlineDelta","outlineColor","baseX","baseY","line","cl","startX","letter","ct","cb","base","controlColor","col","disColor","renderer","currentlyRendering","queuedRender","showingLast","dropSpriteCount","dropPreventClick","draggedObject","dragXOffset","dragYOffset","dragXOriginal","dragYOriginal","renderObjectCache","imageUrl","rc","completed","oldUrl","revokeObjectURL","requestAnimationFrame","render_","cancelAnimationFrame","unsafe","currentBackground","renderObjects","invalidateRender","sd","sdCtx","renderLoadingScreen","offsetLeft","ry","offsetTop","sx","offsetWidth","sy","selectedObject","toRendererCoordinate","clientX","clientY","objectsAt","currentObjectIdx","renderObject","hitTest","preventDefault","touches","dataTransfer","dropEffect","MouseEvent","deltaX","shiftKey","items","item","getAsFile","sourcePack","TouchEvent","objectsState","onTopOrder","toUncache","$delete","blendOver","uiSize","last","updateArea","removeEventListener","onKeydown","keyCode","sw","sh","rh","rw","opth","optimum","optv","optimizeWithMenu","documentElement","clientWidth","clientHeight","cw","ch","v","ctrlKey","ToolBox","MessageConsole","Render","spriteMutations","spriteActions","createSprite","textBoxMutations","setText","setTalkingDefault","setTalkingOther","setStyle","setControlsVisible","setControlsColor","setDeriveCustomColors","setNameboxColor","setNameboxStroke","setNameboxWidth","setSkipable","setContinueArrow","setCustomColor","lastTextBoxId","textBoxActions","createTextBox","newWidth","namespaced","removeFromList","addToList","position","setOnTop","setPosition","setFlip","setOpacity","setSize","setRatio","removeObject","actions","newPosition","setPreserveRatio","setWidth","setHeight","fixContentPackRemoval","oldContent","setVertical","setNsfw","setLqRendering","setSelection","setLastDownload","setCurrent","setColor","setFlipped","setVariant","oldBackground","newBackground","oldVariantJSON","mergeContentPacks","mergeBackgrounds","mergeCharacters","mergeIdArrays","xObj","yObj","mergeArrayUnique","mergeBackground","mergeCharacter","mergeHeadCollections","mergePose","xStyle","yStyle","headGroupKey","headGroup","getId","merge","definedIds","Map","yId","existingIdx","existing","set","baseDir","baseTypes","setContentPacks","setCurrentContent","convertContentPack","convertedPack","removeContentPacks","packIds","newContentPacks","reduce","acc","replaceContentPack","packIdx","loadContentPacks","response","status","statusText","json","paths","href","convertV1","getCharacters","getBackgrounds","types","replacementMap","msg","use","setUnsafe","removePacks","oldState","parse","oldMut","newMut","config","productionTip","$mount"],"mappings":"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","file":"js/app.5d900161.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./positionAndSize.vue?vue&type=style&index=0&id=b131be44&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./positionAndSize.vue?vue&type=style&index=0&id=b131be44&lang=scss&scoped=true&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./layers.vue?vue&type=style&index=0&id=2a014322&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./layers.vue?vue&type=style&index=0&id=2a014322&lang=scss&scoped=true&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./credits.vue?vue&type=style&index=0&id=72cb4a6e&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./credits.vue?vue&type=style&index=0&id=72cb4a6e&lang=scss&scoped=true&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sprite.vue?vue&type=style&index=0&id=1ef64526&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sprite.vue?vue&type=style&index=0&id=1ef64526&lang=scss&scoped=true&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./content-pack.vue?vue&type=style&index=0&id=74799c18&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./content-pack.vue?vue&type=style&index=0&id=74799c18&lang=scss&scoped=true&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./toolbox.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./toolbox.vue?vue&type=style&index=0&lang=scss&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./opacity.vue?vue&type=style&index=0&id=472cd2fc&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./opacity.vue?vue&type=style&index=0&id=472cd2fc&lang=scss&scoped=true&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./general.vue?vue&type=style&index=0&id=58ae7b6c&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./general.vue?vue&type=style&index=0&id=58ae7b6c&lang=scss&scoped=true&\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"","import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./parts.vue?vue&type=style&index=0&id=ec1eca48&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./parts.vue?vue&type=style&index=0&id=ec1eca48&lang=scss&scoped=true&\"","import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./button.vue?vue&type=style&index=0&id=b81baf32&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./button.vue?vue&type=style&index=0&id=b81baf32&lang=scss&scoped=true&\"","import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./partButton.vue?vue&type=style&index=0&id=c08182fc&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./partButton.vue?vue&type=style&index=0&id=c08182fc&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./message-console.vue?vue&type=style&index=0&id=24b2b581&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./message-console.vue?vue&type=style&index=0&id=24b2b581&lang=scss&scoped=true&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./textbox.vue?vue&type=style&index=0&id=63f5df46&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./textbox.vue?vue&type=style&index=0&id=63f5df46&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./toggle.vue?vue&type=style&index=0&id=21f1fd74&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./toggle.vue?vue&type=style&index=0&id=21f1fd74&lang=scss&scoped=true&\"","export default {\n\t/**\n\t *\n\t * @param {Vue} Vue\n\t * @param {{}} options\n\t */\n\tinstall(Vue, options = {}) {\n\t\tif (!Vue._installedPlugins.find(plugin => plugin.Store)) {\n\t\t\tthrow new Error(\n\t\t\t\t'VuexUndoRedo plugin must be installed after the Vuex plugin.'\n\t\t\t);\n\t\t}\n\t\tif (!options.resetStateMutation) options.resetStateMutation = 'emptyState';\n\t\tif (!options.mutations) options.mutations = {};\n\t\tVue.mixin({\n\t\t\tdata() {\n\t\t\t\treturn {\n\t\t\t\t\tdone: [],\n\t\t\t\t\tundone: [],\n\t\t\t\t\tnewMutation: true,\n\t\t\t\t\tignoreMutations: options.ignoreMutations || [],\n\t\t\t\t\tcurrentTransaction: null,\n\t\t\t\t\ttransactionQueue: [],\n\t\t\t\t};\n\t\t\t},\n\t\t\tcreated() {\n\t\t\t\twindow.historyStuff = this;\n\t\t\t\tif (this.$store) {\n\t\t\t\t\tthis.$store.subscribe(mutation => {\n\t\t\t\t\t\tconst exec = () => {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tmutation.type === options.resetStateMutation ||\n\t\t\t\t\t\t\t\tgetMutationProperties(mutation.type).ignore(mutation)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.currentTransaction.push(mutation);\n\t\t\t\t\t\t\tif (this.newMutation) {\n\t\t\t\t\t\t\t\tthis.undone = [];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tif (this.currentTransaction) {\n\t\t\t\t\t\t\texec();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// If a mutation triggers outside of any transaction, it gets it's own transaction\n\t\t\t\t\t\t\tthis.transaction(() => {\n\t\t\t\t\t\t\t\texec();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tcomputed: {\n\t\t\t\tcanRedo() {\n\t\t\t\t\treturn this.undone.length;\n\t\t\t\t},\n\t\t\t\tcanUndo() {\n\t\t\t\t\treturn this.done.length;\n\t\t\t\t},\n\t\t\t},\n\t\t\tmethods: {\n\t\t\t\tredo() {\n\t\t\t\t\tif (this.undone.length <= 0) return;\n\t\t\t\t\tlet commit = this.undone.pop();\n\t\t\t\t\tthis.newMutation = false;\n\t\t\t\t\treplayTransaction(this, commit);\n\t\t\t\t\tthis.newMutation = true;\n\t\t\t\t},\n\t\t\t\tasync undo() {\n\t\t\t\t\tif (this.done.length <= 0) return;\n\t\t\t\t\tthis.undone.push(this.done.pop());\n\t\t\t\t\tthis.newMutation = false;\n\t\t\t\t\tawait replayAll(this);\n\t\t\t\t\tthis.newMutation = true;\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * @param {transactionCallback} callback\n\t\t\t\t */\n\t\t\t\ttransaction(callback) {\n\t\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\t\tconst exec = async () => {\n\t\t\t\t\t\t\tthis.currentTransaction = [];\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tawait callback();\n\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\tconsole.log('Error during transaction!: ', e);\n\t\t\t\t\t\t\t\treject(e);\n\t\t\t\t\t\t\t\tthis.currentTransaction = [];\n\t\t\t\t\t\t\t\t// The transaction that just failed is not in the undo history yet.\n\t\t\t\t\t\t\t\t// So replaying that is equivalent to undoing the transaction.\n\t\t\t\t\t\t\t\treplayAll(this);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst lastUndo = this.done[this.done.length - 1];\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tthis.currentTransaction.length === 1 &&\n\t\t\t\t\t\t\t\tlastUndo &&\n\t\t\t\t\t\t\t\tlastUndo.length === 1\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tconst options = getMutationProperties(\n\t\t\t\t\t\t\t\t\tthis.currentTransaction[0].type\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\toptions.combinable(lastUndo[0], this.currentTransaction[0])\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\tconst combination = options.combinator(\n\t\t\t\t\t\t\t\t\t\tlastUndo[0],\n\t\t\t\t\t\t\t\t\t\tthis.currentTransaction[0]\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tthis.done.pop();\n\t\t\t\t\t\t\t\t\tif (combination) {\n\t\t\t\t\t\t\t\t\t\tthis.currentTransaction = [combination];\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t// Returning a non-truthy value in the combinator simply eliminates both transactions.\n\t\t\t\t\t\t\t\t\t\t// So if the user manually undoes an action, you can just pretend it never happened.\n\t\t\t\t\t\t\t\t\t\tthis.currentTransaction = [];\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (this.currentTransaction.length > 0) {\n\t\t\t\t\t\t\t\tthis.done.push(this.currentTransaction);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tthis.currentTransaction = null;\n\t\t\t\t\t\t\tif (this.transactionQueue.length > 0) {\n\t\t\t\t\t\t\t\tthis.transactionQueue.pop()();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t};\n\t\t\t\t\t\tif (this.currentTransaction) {\n\t\t\t\t\t\t\tthis.transactionQueue.push(exec);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\texec();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\t/**\n\t\t * @param {Vue} vm\n\t\t * @param {*} mutation\n\t\t */\n\t\tasync function replayAll(vm) {\n\t\t\tconst oldTransactions = vm.done.slice(0);\n\t\t\tvm.done = [];\n\t\t\tvm.$store.commit(options.resetStateMutation);\n\t\t\tfor (let i = 0; i < oldTransactions.length; ++i) {\n\t\t\t\tawait replayTransaction(vm, oldTransactions[i]);\n\t\t\t}\n\t\t}\n\n\t\tasync function replayTransaction(vm, transaction) {\n\t\t\treturn await vm.transaction(() => {\n\t\t\t\ttransaction.forEach(mutation => {\n\t\t\t\t\treplayMutation(vm, mutation);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * @param {Vue} vm\n\t\t * @param {*} mutation\n\t\t */\n\t\tfunction replayMutation(vm, mutation) {\n\t\t\tswitch (typeof mutation.payload) {\n\t\t\t\tcase 'object':\n\t\t\t\t\tlet baseObj = {};\n\t\t\t\t\tif (mutation.payload instanceof Array) {\n\t\t\t\t\t\tbaseObj = [];\n\t\t\t\t\t}\n\t\t\t\t\tvm.$store.commit(\n\t\t\t\t\t\t`${mutation.type}`,\n\t\t\t\t\t\tObject.assign(baseObj, mutation.payload)\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tvm.$store.commit(`${mutation.type}`, mutation.payload);\n\t\t\t}\n\t\t}\n\n\t\tconst mutationProperiesCache = {};\n\n\t\t/**\n\t\t *\n\t\t * @param {IHistoryOptions} options\n\t\t * @param {*} name\n\t\t */\n\t\tfunction getMutationProperties(name) {\n\t\t\tif (!mutationProperiesCache[name]) {\n\t\t\t\tconst parts = name.split('/');\n\t\t\t\tconst mutationProperties = {\n\t\t\t\t\tignore: mutation => false,\n\t\t\t\t\tcombinable: (oldMutation, newMutation) => false,\n\t\t\t\t\tcombinator: (oldMutation, newMutation) => newMutation,\n\t\t\t\t};\n\t\t\t\tlet currentWildcard = '';\n\t\t\t\tfor (const part of parts) {\n\t\t\t\t\tif (options.mutations[currentWildcard + '*']) {\n\t\t\t\t\t\tObject.assign(\n\t\t\t\t\t\t\tmutationProperties,\n\t\t\t\t\t\t\toptions.mutations[currentWildcard + '*']\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tcurrentWildcard += part + '/';\n\t\t\t\t}\n\t\t\t\tif (options.mutations[name]) {\n\t\t\t\t\tObject.assign(mutationProperties, options.mutations[name]);\n\t\t\t\t}\n\t\t\t\tmutationProperiesCache[name] = mutationProperties;\n\t\t\t}\n\t\t\treturn mutationProperiesCache[name];\n\t\t}\n\t},\n};\n\n/**\n * @callback transactionCallback\n * @async\n */\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('div',{attrs:{\"id\":\"container\"}},[_c('render',{ref:\"render\",attrs:{\"canvasWidth\":_vm.canvasWidth,\"canvasHeight\":_vm.canvasHeight}})],1),_c('message-console'),_c('tool-box',{on:{\"show-prev-render\":_vm.drawLastDownload,\"download\":function($event){return _vm.$refs.render.download()}}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{ vertical: _vm.vertical },attrs:{\"id\":\"panels\"}},[_c('div',{attrs:{\"id\":\"toolbar\"}},[_c('button',{class:{ active: _vm.panel === 'add' },on:{\"click\":function($event){return _vm.setPanel('add')}}},[_vm._v(\"A\")]),_c('button',{class:{ active: _vm.panel === 'backgrounds' },on:{\"click\":function($event){return _vm.setPanel('backgrounds')}}},[_vm._v(\"B\")]),_c('button',{class:{ active: _vm.panel === 'credits' },on:{\"click\":function($event){return _vm.setPanel('credits')}}},[_vm._v(\"C\")]),_c('button',{on:{\"click\":function($event){return _vm.$emit('download')}}},[_vm._v(\"D\")])]),(_vm.panel === '')?_c('general-panel',{on:{\"show-prev-render\":function($event){return _vm.$emit('show-prev-render')},\"show-content-packs\":function($event){return _vm.setPanel('content-packs')}}}):_vm._e(),(_vm.panel === 'content-packs')?_c('content-packs-panel'):_vm._e(),(_vm.panel === 'add')?_c('add-panel'):_vm._e(),(_vm.panel === 'backgrounds')?_c('backgrounds-panel'):_vm._e(),(_vm.panel === 'credits')?_c('credits-panel'):_vm._e(),(_vm.panel === 'character')?_c('character-panel'):_vm._e(),(_vm.panel === 'sprite')?_c('sprite-panel'):_vm._e(),(_vm.panel === 'textBox')?_c('text-box-panel'):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"panel\"},[_c('h1',[_vm._v(\"General\")]),_c('a',{staticClass:\"btn\",attrs:{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/edave64/Doki-Doki-Dialog-Generator/blob/v1/docs/index.md\"}},[_vm._v(\"Help\")]),_c('toggle',{attrs:{\"label\":\"Low quality preview?\",\"title\":\"Reduces the quality of the preview images to speed up the user experience and consume less data. Does not effect final render.\"},model:{value:(_vm.lqRendering),callback:function ($$v) {_vm.lqRendering=$$v},expression:\"lqRendering\"}}),_c('button',{attrs:{\"disabled\":!_vm.hasPrevRender},on:{\"click\":function($event){return _vm.$emit('show-prev-render')}}},[_vm._v(\"Compare to last download\")]),_c('button',{on:{\"click\":function($event){return _vm.$emit('show-content-packs')}}},[_vm._v(\"Content Packs\")]),_c('toggle',{attrs:{\"label\":\"NSFW Mode?\"},model:{value:(_vm.nsfw),callback:function ($$v) {_vm.nsfw=$$v},expression:\"nsfw\"}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('input',{ref:\"checkbox\",attrs:{\"id\":_vm._uid,\"type\":\"checkbox\"},domProps:{\"checked\":_vm.value},on:{\"change\":_vm.onChange}}),_c('label',{attrs:{\"for\":_vm._uid}},[_vm._v(_vm._s(_vm.label))])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop } from 'vue-property-decorator';\r\n\r\n@Component({\r\n\tcomponents: {},\r\n})\r\nexport default class Toggle extends Vue {\r\n\t@Prop({ type: String }) private label!: string | undefined;\r\n\t@Prop({ type: Boolean, default: false }) private value!: boolean;\r\n\r\n\tprivate onChange(event: Event) {\r\n\t\tthis.$emit('input', !!(this.$refs.checkbox as HTMLInputElement).checked);\r\n\t}\r\n\r\n\tprivate get checkbox(): HTMLInputElement {\r\n\t\treturn this.$refs.checkbox as HTMLInputElement;\r\n\t}\r\n}\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./toggle.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./toggle.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./toggle.vue?vue&type=template&id=21f1fd74&scoped=true&\"\nimport script from \"./toggle.vue?vue&type=script&lang=ts&\"\nexport * from \"./toggle.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./toggle.vue?vue&type=style&index=0&id=21f1fd74&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"21f1fd74\",\n  null\n  \n)\n\nexport default component.exports","import { Component, Vue, Watch } from 'vue-property-decorator';\r\nimport { State } from 'vuex-class-decorator';\r\n\r\n@Component({})\r\nexport class PanelMixin extends Vue {\r\n\t@State('vertical', { namespace: 'ui' }) private readonly vertical!: boolean;\r\n\r\n\tprivate mounted() {\r\n\t\tthis.updateVertical();\r\n\t\tthis.$el.addEventListener(\r\n\t\t\t'wheel',\r\n\t\t\te => {\r\n\t\t\t\tif (e.type !== 'wheel') return;\r\n\t\t\t\tif (!e.currentTarget) return;\r\n\t\t\t\tconst target = e.currentTarget as HTMLElement;\r\n\t\t\t\tif (target.classList.contains('vertical')) return;\r\n\r\n\t\t\t\tconst ev = e as WheelEvent;\r\n\t\t\t\tif (ev.deltaY === 0) return;\r\n\t\t\t\tif ((ev as any).mozInputSource) {\r\n\t\t\t\t\t// Firefox sends wierdly low delta values :/\r\n\t\t\t\t\ttarget.scrollLeft += ev.deltaY * 25;\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttarget.scrollLeft += ev.deltaY;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{ passive: true }\r\n\t\t);\r\n\t}\r\n\r\n\t@Watch('vertical')\r\n\tprivate updateVertical() {\r\n\t\tif (!this.$el) return;\r\n\t\tif (this.vertical) {\r\n\t\t\tthis.$el.classList.add('vertical');\r\n\t\t} else {\r\n\t\t\tthis.$el.classList.remove('vertical');\r\n\t\t}\r\n\t}\r\n}\r\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop, Watch, Mixins } from 'vue-property-decorator';\nimport { TextBox } from '@/models/textbox';\nimport Toggle from '@/components/toggle.vue';\nimport { State } from 'vuex-class-decorator';\nimport { PanelMixin } from './panelMixin';\nimport { IHistorySupport } from '../../../plugins/vuex-history';\nimport { IRemovePacksAction, IRootState } from '../../../store';\nimport { Store } from 'vuex';\n\nconst nsfwPacks = {\n\t'dddg.buildin.backgrounds.nsfw': `${process.env.BASE_URL}packs/buildin.base.backgrounds.nsfw.json`,\n\t'dddg.buildin.sayori.nsfw': `${process.env.BASE_URL}packs/buildin.base.sayori.nsfw.json`,\n\t'dddg.buildin.base.natsuki.nsfw': `${process.env.BASE_URL}packs/buildin.base.natsuki.nsfw.json`,\n\t'dddg.buildin.yuri.nsfw': `${process.env.BASE_URL}packs/buildin.base.yuri.nsfw.json`,\n};\n\nconst names = new Set(Object.keys(nsfwPacks));\nconst paths = Object.values(nsfwPacks);\n\n@Component({\n\tcomponents: {\n\t\tToggle,\n\t},\n})\nexport default class GeneralPanel extends Mixins(PanelMixin) {\n\tpublic $store!: Store<IRootState>;\n\n\tprivate get lqRendering(): boolean {\n\t\treturn this.$store.state.ui.lqRendering;\n\t}\n\tprivate set lqRendering(lqRendering: boolean) {\n\t\tthis.history.transaction(async () => {\n\t\t\tawait this.$store.commit('ui/setLqRendering', lqRendering);\n\t\t});\n\t}\n\n\tprivate get hasPrevRender(): boolean {\n\t\treturn this.$store.state.ui.lastDownload !== null;\n\t}\n\n\tprivate get history(): IHistorySupport {\n\t\treturn this.$root as any;\n\t}\n\n\tprivate get nsfw(): boolean {\n\t\treturn !!this.$store.state.content.contentPacks\n\t\t\t.map(pack => pack.packId)\n\t\t\t.filter(packId => !!packId)\n\t\t\t.find(packId => names.has(packId!));\n\t}\n\n\tprivate set nsfw(value: boolean) {\n\t\tthis.history.transaction(async () => {\n\t\t\tif (value) {\n\t\t\t\tawait this.$store.dispatch('content/loadContentPacks', paths);\n\t\t\t} else {\n\t\t\t\tawait this.$store.dispatch('removePacks', {\n\t\t\t\t\tpacks: names,\n\t\t\t\t} as IRemovePacksAction);\n\t\t\t}\n\t\t});\n\t}\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./general.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./general.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./general.vue?vue&type=template&id=58ae7b6c&scoped=true&\"\nimport script from \"./general.vue?vue&type=script&lang=ts&\"\nexport * from \"./general.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./general.vue?vue&type=style&index=0&id=58ae7b6c&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"58ae7b6c\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.isWebPSupported !== undefined)?_c('div',{staticClass:\"panel\"},[_c('h1',[_vm._v(\"Add character\")]),_vm._l((_vm.characters),function(character){return _c('div',{key:character.id,staticClass:\"character\",attrs:{\"title\":character.name},on:{\"click\":function($event){_vm.onChosen(character.id.toLowerCase())}}},[_c('img',{attrs:{\"src\":_vm.assetPath(character),\"alt\":character.name}})])}),_c('div',{staticClass:\"btn custom-sprite\",on:{\"click\":function($event){return _vm.$refs.upload.click()}}},[_vm._v(\"\\n\\t\\tCustom sprite upload\\n\\t\\t\"),_c('input',{ref:\"upload\",attrs:{\"type\":\"file\"},on:{\"change\":_vm.onFileUpload}})]),_c('div',{staticClass:\"btn custom-sprite\",on:{\"click\":_vm.uploadFromURL}},[_vm._v(\"Custom sprite from URL\")]),_c('button',{on:{\"click\":_vm.addTextBox}},[_vm._v(\"Textbox\")])],2):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import Vue from 'vue';\nimport { ICommand } from './command';\n\nconst eventBus = new Vue();\n\nexport default {\n\tfireCommand(command: ICommand) {\n\t\teventBus.$emit('command', command);\n\t},\n\tsubscribeCommand(handler: (ev: ICommand) => void): void {\n\t\teventBus.$on('command', handler);\n\t},\n\n\tfire(event: IEvent) {\n\t\teventBus.$emit(event.kind, event);\n\t},\n\n\tsubscribe<T extends IEvent>(\n\t\teventType: IEventClass<T>,\n\t\thandler: (ev: T) => void\n\t) {\n\t\teventBus.$on(eventType.kind, handler);\n\t},\n\n\tunsubscribe<T extends IEvent>(\n\t\teventType: IEventClass<T>,\n\t\thandler: (ev: T) => void\n\t) {\n\t\teventBus.$off(eventType.kind, handler);\n\t},\n};\n\ninterface IEvent {\n\tkind: string;\n}\n\ninterface IEventClass<T> {\n\tkind: string;\n\tnew (...args: any[]): T;\n}\n\n// tslint:disable: max-classes-per-file\n\nexport class AssetFailureEvent implements IEvent {\n\tpublic static readonly kind = 'AssetFailureEvent';\n\tpublic readonly kind = 'AssetFailureEvent';\n\tpublic constructor(public path: string) {}\n}\n\nexport class CustomAssetFailureEvent implements IEvent {\n\tpublic static readonly kind = 'CustomAssetFailureEvent';\n\tpublic readonly kind = 'CustomAssetFailureEvent';\n\tpublic constructor(public error: ErrorEvent) {}\n}\n\nexport class InvalidateRenderEvent implements IEvent {\n\tpublic static readonly kind = 'InvalidateRenderEvent';\n\tpublic readonly kind = 'InvalidateRenderEvent';\n}\n","export class ErrorAsset {}\n","import EventBus, {\n\tAssetFailureEvent,\n\tCustomAssetFailureEvent,\n} from './eventbus/event-bus';\nimport { ErrorAsset } from './models/error-asset';\nimport { IAsset } from './store/content';\n\nlet webpSupportPromise: Promise<boolean>;\n\nexport function isWebPSupported(): Promise<boolean> {\n\tif (!webpSupportPromise) {\n\t\twebpSupportPromise = new Promise((resolve, reject) => {\n\t\t\tconst losslessCode =\n\t\t\t\t'data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=';\n\t\t\tconst img = document.createElement('img');\n\t\t\timg.addEventListener('load', () => {\n\t\t\t\tresolve(img.width === 2 && img.height === 1);\n\t\t\t});\n\t\t\timg.addEventListener('error', () => {\n\t\t\t\tresolve(false);\n\t\t\t});\n\t\t\timg.src = losslessCode;\n\t\t});\n\t}\n\treturn webpSupportPromise;\n}\n\nconst assetCache: {\n\t[url: string]: Promise<HTMLImageElement | ErrorAsset> | undefined;\n} = {};\nconst customAssets: { [id: string]: Promise<HTMLImageElement> } = {};\n\nexport async function getAAsset(\n\tasset: IAsset,\n\thq: boolean = true\n): Promise<HTMLImageElement | ErrorAsset> {\n\tconst url = hq ? asset.hq : asset.lq;\n\n\tif (!assetCache[url]) {\n\t\tassetCache[url] = new Promise((resolve, reject) => {\n\t\t\tconst img = new Image();\n\t\t\timg.addEventListener('load', () => {\n\t\t\t\tresolve(img);\n\t\t\t});\n\t\t\timg.addEventListener('error', () => {\n\t\t\t\tEventBus.fire(new AssetFailureEvent(url));\n\t\t\t\tassetCache[url] = undefined;\n\t\t\t\tresolve(new ErrorAsset());\n\t\t\t});\n\t\t\timg.crossOrigin = 'Anonymous';\n\t\t\timg.src = url;\n\t\t\timg.style.display = 'none';\n\t\t\tdocument.body.appendChild(img);\n\t\t});\n\t}\n\n\treturn assetCache[url]!;\n}\n\nexport async function getAsset(\n\tasset: string,\n\thq: boolean = true\n): Promise<HTMLImageElement | ErrorAsset> {\n\tif (customAssets[asset]) {\n\t\treturn customAssets[asset];\n\t}\n\n\tconst url = `${process.env.BASE_URL}/assets/${asset}${hq ? '' : '.lq'}${\n\t\t(await isWebPSupported()) ? '.webp' : '.png'\n\t}`.replace(/\\/+/, '/');\n\n\tif (!assetCache[url]) {\n\t\tassetCache[url] = new Promise((resolve, reject) => {\n\t\t\tconst img = new Image();\n\t\t\timg.addEventListener('load', () => {\n\t\t\t\tresolve(img);\n\t\t\t});\n\t\t\timg.addEventListener('error', () => {\n\t\t\t\tEventBus.fire(new AssetFailureEvent(url));\n\t\t\t\tassetCache[url] = undefined;\n\t\t\t\tresolve(new ErrorAsset());\n\t\t\t});\n\t\t\timg.crossOrigin = 'Anonymous';\n\t\t\timg.src = url;\n\t\t\timg.style.display = 'none';\n\t\t\tdocument.body.appendChild(img);\n\t\t});\n\t}\n\n\treturn assetCache[url]!;\n}\n\nexport function registerAsset(asset: string, file: File): string {\n\tconst url = URL.createObjectURL(file);\n\tcustomAssets[asset] = new Promise((resolve, reject) => {\n\t\tconst img = new Image();\n\t\timg.addEventListener('load', () => {\n\t\t\tresolve(img);\n\t\t});\n\t\timg.addEventListener('error', error => {\n\t\t\tEventBus.fire(new CustomAssetFailureEvent(error));\n\t\t\treject(`Failed to load \"${url}\"`);\n\t\t});\n\t\timg.crossOrigin = 'Anonymous';\n\t\timg.src = url;\n\t\timg.style.display = 'none';\n\t\tdocument.body.appendChild(img);\n\t});\n\treturn url;\n}\n\nexport function registerAssetWithURL(\n\tasset: string,\n\turl: string\n): Promise<HTMLImageElement> {\n\treturn (customAssets[asset] = new Promise((resolve, reject) => {\n\t\tconst img = new Image();\n\t\timg.addEventListener('load', () => {\n\t\t\tresolve(img);\n\t\t});\n\t\timg.addEventListener('error', error => {\n\t\t\tEventBus.fire(new CustomAssetFailureEvent(error));\n\t\t\treject(`Failed to load \"${url}\"`);\n\t\t});\n\t\timg.crossOrigin = 'Anonymous';\n\t\timg.src = url;\n\t\timg.style.display = 'none';\n\t\tdocument.body.appendChild(img);\n\t}));\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop, Mixins } from 'vue-property-decorator';\nimport {\n\tisWebPSupported,\n\tregisterAsset,\n\tregisterAssetWithURL,\n} from '@/asset-manager';\nimport { ICreateCharacterAction } from '@/store/objectTypes/characters';\nimport { ICreateTextBoxAction } from '@/store/objectTypes/textbox';\nimport { IAsset } from '../../../store/content';\nimport { Character } from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\nimport { Store } from 'vuex';\nimport { IRootState } from '../../../store';\nimport { PanelMixin } from './panelMixin';\n\n@Component({\n\tcomponents: {},\n})\nexport default class AddPanel extends Mixins(PanelMixin) {\n\tpublic $store!: Store<IRootState>;\n\tprivate isWebPSupported: boolean | null = null;\n\tprivate customAssetCount = 0;\n\n\tprivate async created() {\n\t\tthis.isWebPSupported = await isWebPSupported();\n\t}\n\n\tprivate get characters(): Array<Character<IAsset>> {\n\t\treturn this.$store.state.content.current.characters;\n\t}\n\n\tprivate assetPath(character: Character<IAsset>) {\n\t\treturn character.chibi.lq;\n\t}\n\n\tprivate onFileUpload(e: Event) {\n\t\tconst uploadInput = this.$refs.upload as HTMLInputElement;\n\t\tif (!uploadInput.files) return;\n\t\tfor (const file of uploadInput.files) {\n\t\t\t(nr => {\n\t\t\t\tconst name = 'customAsset' + nr;\n\t\t\t\tconst url = registerAsset(name, file);\n\t\t\t\tthis.$emit('add-custom-asset', name);\n\t\t\t})(++this.customAssetCount);\n\t\t}\n\t}\n\n\tprivate async uploadFromURL() {\n\t\tconst url = prompt('Enter the URL of the image');\n\t\tif (!url) return;\n\t\tconst name = 'customAsset' + ++this.customAssetCount;\n\t\tawait registerAssetWithURL(name, url);\n\t\tthis.$emit('add-custom-asset', name);\n\t}\n\n\tprivate addTextBox() {\n\t\tthis.$store.dispatch('objects/createTextBox', {} as ICreateTextBoxAction);\n\t}\n\n\tprivate onChosen(id: string) {\n\t\tthis.$store.dispatch('objects/createCharacters', {\n\t\t\tcharacterType: id,\n\t\t} as ICreateCharacterAction);\n\t}\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./add.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./add.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./add.vue?vue&type=template&id=4e30e235&scoped=true&\"\nimport script from \"./add.vue?vue&type=script&lang=ts&\"\nexport * from \"./add.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./add.vue?vue&type=style&index=0&id=4e30e235&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4e30e235\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"panel\"},[_c('h1',[_vm._v(_vm._s(_vm.label))]),(_vm.panelForParts)?_c('parts',{attrs:{\"character\":_vm.character,\"part\":_vm.panelForParts},on:{\"leave\":function($event){_vm.panelForParts = null}}}):[(_vm.hasMultiplePoses || _vm.parts.length > 0)?_c('fieldset',[_c('legend',[_vm._v(\"Pose:\")]),_c('table',[_c('tbody',[(_vm.hasMultipleStyles)?_c('tr',[_c('td',[_c('button',{on:{\"click\":function($event){return _vm.seekStyle(-1)}}},[_vm._v(\"<\")])]),_c('td',[_c('button',{staticClass:\"middle-button\",on:{\"click\":function($event){_vm.panelForParts = 'style'}}},[_vm._v(\"Style\")])]),_c('td',[_c('button',{on:{\"click\":function($event){return _vm.seekStyle(1)}}},[_vm._v(\">\")])])]):_vm._e(),(_vm.hasMultiplePoses)?_c('tr',[_c('td',[_c('button',{on:{\"click\":function($event){return _vm.seekPose(-1)}}},[_vm._v(\"<\")])]),_c('td',[_c('button',{staticClass:\"middle-button\",on:{\"click\":function($event){_vm.panelForParts = 'pose'}}},[_vm._v(\"Pose\")])]),_c('td',[_c('button',{on:{\"click\":function($event){return _vm.seekPose(1)}}},[_vm._v(\">\")])])]):_vm._e(),_vm._l((_vm.parts),function(part){return _c('tr',{key:part},[_c('td',[_c('button',{on:{\"click\":function($event){return _vm.seekPart(part, -1)}}},[_vm._v(\"<\")])]),_c('td',[_c('button',{staticClass:\"middle-button\",on:{\"click\":function($event){_vm.panelForParts = part}}},[_vm._v(_vm._s(_vm.captialize(part)))])]),_c('td',[_c('button',{on:{\"click\":function($event){return _vm.seekPart(part, 1)}}},[_vm._v(\">\")])])])})],2)])]):_vm._e(),_c('position-and-size',{attrs:{\"obj\":_vm.character}}),_c('layers',{attrs:{\"obj\":_vm.character}}),_c('opacity',{attrs:{\"obj\":_vm.character}}),_c('toggle',{attrs:{\"label\":\"Close up?\"},model:{value:(_vm.closeUp),callback:function ($$v) {_vm.closeUp=$$v},expression:\"closeUp\"}}),_c('toggle',{attrs:{\"label\":\"Flip?\"},model:{value:(_vm.flip),callback:function ($$v) {_vm.flip=$$v},expression:\"flip\"}}),_c('delete',{attrs:{\"obj\":_vm.character}})]],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { Background } from './background';\r\n\r\nexport const backgrounds = [] as Background[];\r\n\r\nexport type Part = 'variant' | 'left' | 'right' | 'head';\r\n\r\nexport const screenWidth = 1280;\r\nexport const screenHeight = 720;\r\n\r\nexport type CharacterIds =\r\n\t| 'ddlc.monika'\r\n\t| 'ddlc.natsuki'\r\n\t| 'ddlc.sayori'\r\n\t| 'ddlc.yuri'\r\n\t| 'ddlc.fan.mc_classic'\r\n\t| 'ddlc.fan.femc';\r\n\r\nexport const positions = [\r\n\t'4-1',\r\n\t'3-1',\r\n\t'2-1',\r\n\t'4-2',\r\n\t'center',\r\n\t'4-3',\r\n\t'2-2',\r\n\t'3-3',\r\n\t'4-4',\r\n];\r\n\r\nexport const characterPositions = [\r\n\t200,\r\n\t240,\r\n\t400,\r\n\t493,\r\n\t640,\r\n\t786,\r\n\t880,\r\n\t1040,\r\n\t1080,\r\n];\r\n\r\nexport const poses = {\r\n\tsayori: {\r\n\t\tleft: [] as HTMLImageElement[],\r\n\t\tright: [] as HTMLImageElement[],\r\n\t\thead: [] as HTMLImageElement[],\r\n\t},\r\n\tyuri: {\r\n\t\tleft: [] as HTMLImageElement[],\r\n\t\tright: [] as HTMLImageElement[],\r\n\t\thead: [] as HTMLImageElement[],\r\n\t},\r\n\tnatsuki: {\r\n\t\tleft: [] as HTMLImageElement[],\r\n\t\tright: [] as HTMLImageElement[],\r\n\t\thead: [] as HTMLImageElement[],\r\n\t},\r\n\tmonika: {\r\n\t\tleft: [] as HTMLImageElement[],\r\n\t\tright: [] as HTMLImageElement[],\r\n\t\thead: [] as HTMLImageElement[],\r\n\t},\r\n};\r\n","export function arraySeeker(array: any[], pos: number, delta: number) {\n\tlet val = pos + delta;\n\tconst length = array.length;\n\n\tif (val < 0) {\n\t\tval += length;\n\t}\n\tif (val >= length) {\n\t\tval -= length;\n\t}\n\treturn val;\n}\n\nexport function nsfwArraySeeker(\n\tarray: Array<{ nsfw?: boolean }>,\n\tpos: number,\n\tdelta: number,\n\tnsfw: boolean\n) {\n\tlet val = pos;\n\tconst length = array.length;\n\tdo {\n\t\tval += delta;\n\t\tif (val < 0) {\n\t\t\tval += length;\n\t\t}\n\t\tif (val >= length) {\n\t\t\tval -= length;\n\t\t}\n\t} while (array[val].nsfw && !nsfw);\n\treturn val;\n}\n","import { ICommand } from '@/eventbus/command';\nimport {\n\tIObjectsState,\n\tICreateObjectMutation,\n\tIObject,\n\tISetPositionAction,\n\tISetObjectPositionMutation,\n\tIRemoveObjectAction,\n} from '@/store/objects';\nimport { MutationTree, ActionTree, Store, Commit, ActionContext } from 'vuex';\nimport { Part, characterPositions } from '@/models/constants';\nimport { arraySeeker } from '@/models/seekers';\nimport { IHistoryOptions } from '@/plugins/vuex-history';\nimport {\n\tCharacter,\n\tPose,\n\tHeadCollection,\n\tContentPack,\n} from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\nimport { IAsset } from '../content';\nimport { IRootState } from '..';\n\nexport interface ICharacter extends IObject {\n\ttype: 'character';\n\tcharacterType: string;\n\tfreeMove: boolean;\n\tclose: boolean;\n\tstyleId: number;\n\tposeId: number;\n\tposePositions: {\n\t\tvariant: number;\n\t\tleft: number;\n\t\tright: number;\n\t\thead: number;\n\t\theadType: number;\n\t};\n}\n\nexport const CloseUpYOffset = -74;\nexport const BaseCharacterYPos = -26;\n\nexport const characterMutations: MutationTree<IObjectsState> = {\n\tsetPose(state, command: ISetPoseMutation) {\n\t\tconst obj = state.objects[command.id] as ICharacter;\n\t\tobj.poseId = command.poseId;\n\t\t++obj.version;\n\t},\n\tsetCharStyle(state, command: ISetCharStyleMutation) {\n\t\tconsole.log(`Setting style of ${command.id} to ${command.styleId}`);\n\n\t\tconst obj = state.objects[command.id] as ICharacter;\n\t\tobj.styleId = command.styleId;\n\t\t++obj.version;\n\t},\n\tsetPosePosition(state, command: ISetPosePositionMutation) {\n\t\tconst obj = state.objects[command.id] as ICharacter;\n\t\tobj.posePositions = {\n\t\t\t...obj.posePositions,\n\t\t\t...command.posePositions,\n\t\t};\n\t\t++obj.version;\n\t},\n\tsetClose(state, command: ISetCloseMutation) {\n\t\tconst obj = state.objects[command.id] as ICharacter;\n\t\tobj.close = command.close;\n\t\t++obj.version;\n\t},\n\tsetFreeMove(state, command: ISetFreeMoveMutation) {\n\t\tconst obj = state.objects[command.id] as ICharacter;\n\t\tobj.freeMove = command.freeMove;\n\t\tif (!obj.freeMove) {\n\t\t\tobj.x = characterPositions[closestCharacterSlot(obj.x)];\n\t\t\tobj.y = BaseCharacterYPos;\n\t\t}\n\t},\n};\n\nexport function getData(\n\tstore: Store<IRootState>,\n\tstate: Readonly<ICharacter>\n): Readonly<Character<IAsset>> {\n\tconst characters = store.getters['content/getCharacters'] as Map<\n\t\tCharacter<IAsset>['id'],\n\t\tCharacter<IAsset>\n\t>;\n\treturn characters.get(state.characterType)!;\n}\n\nexport function getDataG(\n\trootGetters: any,\n\tstate: Readonly<ICharacter>\n): Readonly<Character<IAsset>> {\n\tconst characters = rootGetters['content/getCharacters'] as Map<\n\t\tCharacter<IAsset>['id'],\n\t\tCharacter<IAsset>\n\t>;\n\treturn characters.get(state.characterType)!;\n}\n\nexport function getPose(\n\tdata: Character<IAsset>,\n\tstate: Readonly<ICharacter>\n): Readonly<Pose<IAsset>> {\n\treturn data.poses[state.poseId];\n}\n\nexport function getParts(\n\tdata: Character<IAsset>,\n\tstate: Readonly<ICharacter>\n): Part[] {\n\tconst pose = getPose(data, state);\n\tconst parts: Part[] = [];\n\n\tif (pose.compatibleHeads.length > 0) parts.push('head');\n\tif (pose.variant.length > 1) parts.push('variant');\n\tif (pose.left.length > 1) parts.push('left');\n\tif (pose.right.length > 1) parts.push('right');\n\treturn parts;\n}\n\nexport function getHeads(\n\tdata: Character<IAsset>,\n\tstate: Readonly<ICharacter>,\n\theadTypeId: number = state.posePositions.headType\n): HeadCollection<IAsset> | null {\n\tconst compatibleHeads = getPose(data, state).compatibleHeads;\n\tif (!compatibleHeads || compatibleHeads.length === 0) {\n\t\treturn null;\n\t}\n\tconst heads = data.heads[compatibleHeads[headTypeId]];\n\treturn heads;\n}\n\nexport function closestCharacterSlot(pos: number): number {\n\tconst sorted = characterPositions\n\t\t.map((x, idx) => ({ pos: Math.abs(pos - x), idx }))\n\t\t.sort((a, b) => a.pos - b.pos);\n\treturn sorted[0].idx;\n}\n\nlet lastSpriteId = 0;\n\nexport const characterActions: ActionTree<IObjectsState, IRootState> = {\n\tcreateCharacters({ state, commit }, command: ICreateCharacterAction) {\n\t\tcommit('create', {\n\t\t\tobject: {\n\t\t\t\tflip: false,\n\t\t\t\tid: 'characters_' + ++lastSpriteId,\n\t\t\t\tonTop: false,\n\t\t\t\topacity: 100,\n\t\t\t\ttype: 'character',\n\t\t\t\tx: 640,\n\t\t\t\ty: BaseCharacterYPos,\n\t\t\t\tpreserveRatio: true,\n\t\t\t\tratio: 1,\n\t\t\t\theight: 768,\n\t\t\t\twidth: 768,\n\t\t\t\tcharacterType: command.characterType,\n\t\t\t\tclose: false,\n\t\t\t\tfreeMove: false,\n\t\t\t\tversion: 0,\n\t\t\t\tposeId: 0,\n\t\t\t\tstyleId: 0,\n\t\t\t\tposePositions: {\n\t\t\t\t\thead: 0,\n\t\t\t\t\theadType: 0,\n\t\t\t\t\tleft: 0,\n\t\t\t\t\tright: 0,\n\t\t\t\t\tvariant: 0,\n\t\t\t\t},\n\t\t\t} as ICharacter,\n\t\t} as ICreateObjectMutation);\n\t},\n\n\tseekPart(\n\t\t{ state, commit, dispatch, rootGetters },\n\t\t{ delta, id, part }: ISeekPosePartAction\n\t) {\n\t\tif (part === 'head') {\n\t\t\tdispatch('seekHead', { id, delta } as ISeekHeadAction);\n\t\t\treturn;\n\t\t}\n\t\tconst obj = state.objects[id] as Readonly<ICharacter>;\n\t\tconst pose = getPose(getDataG(rootGetters, obj), obj);\n\t\tif (!(pose as any)[part]) return;\n\t\tcommit('setPosePosition', {\n\t\t\tid,\n\t\t\tposePositions: {\n\t\t\t\t[part]: arraySeeker(\n\t\t\t\t\t(pose as any)[part],\n\t\t\t\t\tobj.posePositions[part],\n\t\t\t\t\tdelta\n\t\t\t\t),\n\t\t\t},\n\t\t} as ISetPosePositionMutation);\n\t},\n\n\tseekPose({ state, commit, rootGetters }, { id, delta }: ISeekPoseAction) {\n\t\tconst obj = state.objects[id] as Readonly<ICharacter>;\n\t\tconst data = getDataG(rootGetters, obj);\n\t\tmutatePoseAndPositions(commit, obj, data, change => {\n\t\t\tchange.poseId = arraySeeker(data.poses, change.poseId, delta);\n\t\t});\n\t},\n\n\tseekStyle({ state, commit, rootGetters }, { id, delta }: ISeekStyleAction) {\n\t\tconst obj = state.objects[id] as Readonly<ICharacter>;\n\t\tconst data = getDataG(rootGetters, obj);\n\t\tmutatePoseAndPositions(commit, obj, data, change => {\n\t\t\tchange.styleId = arraySeeker(data.styles, change.styleId, delta);\n\t\t});\n\t},\n\n\tseekHead({ state, commit, rootGetters }, { id, delta }: ISeekHeadAction) {\n\t\tconst obj = state.objects[id] as Readonly<ICharacter>;\n\t\tconst data = getDataG(rootGetters, obj);\n\t\tconst pose = getPose(data, obj);\n\t\tlet currentHeads = getHeads(data, obj);\n\t\tif (!currentHeads) return;\n\t\tlet head = obj.posePositions.head + delta;\n\t\tlet headType = obj.posePositions.headType;\n\t\tif (head < 0 || head >= currentHeads.variants.length) {\n\t\t\theadType = arraySeeker(\n\t\t\t\tpose.compatibleHeads.map(headKey => data.heads[headKey]),\n\t\t\t\theadType,\n\t\t\t\tdelta\n\t\t\t);\n\t\t\tcurrentHeads = getHeads(data, obj, headType)!;\n\t\t\thead = delta === 1 ? 0 : currentHeads.variants.length - 1;\n\t\t}\n\t\tcommit('setPosePosition', {\n\t\t\tid,\n\t\t\tposePositions: {\n\t\t\t\thead,\n\t\t\t\theadType,\n\t\t\t},\n\t\t} as ISetPosePositionMutation);\n\t},\n\n\tsetPart(\n\t\t{ state, commit, rootGetters },\n\t\t{ id, part, val }: ISetPartAction\n\t): void {\n\t\tconst obj = state.objects[id] as Readonly<ICharacter>;\n\t\tconst data = getDataG(rootGetters, obj);\n\t\tif (part === 'pose') {\n\t\t\tmutatePoseAndPositions(commit, obj, data, change => {\n\t\t\t\tchange.poseId = val;\n\t\t\t});\n\t\t} else if (part === 'style') {\n\t\t\tmutatePoseAndPositions(commit, obj, data, change => {\n\t\t\t\tchange.styleId = val;\n\t\t\t});\n\t\t} else {\n\t\t\tmutatePoseAndPositions(commit, obj, data, change => {\n\t\t\t\tchange.posePositions[part] = val;\n\t\t\t});\n\t\t}\n\t},\n\n\tsetCharacterPosition(\n\t\t{ state, commit },\n\t\t{ id, x, y }: ISetPositionAction\n\t): void {\n\t\tconst obj = state.objects[id] as ICharacter;\n\t\tif (obj.freeMove) {\n\t\t\tcommit('setPosition', {\n\t\t\t\tid,\n\t\t\t\tx,\n\t\t\t\ty,\n\t\t\t} as ISetObjectPositionMutation);\n\t\t} else {\n\t\t\tcommit('setPosition', {\n\t\t\t\tid,\n\t\t\t\tx: characterPositions[closestCharacterSlot(x)],\n\t\t\t\ty: BaseCharacterYPos + (obj.close ? CloseUpYOffset : 0),\n\t\t\t} as ISetObjectPositionMutation);\n\t\t}\n\t},\n\n\tshiftCharacterSlot(\n\t\t{ state, commit },\n\t\t{ id, delta }: IShiftCharacterSlotAction\n\t): void {\n\t\tconst obj = state.objects[id] as ICharacter;\n\t\tconst currentSlotNr = closestCharacterSlot(obj.x);\n\t\tlet newSlotNr = currentSlotNr + delta;\n\t\tif (newSlotNr < 0) {\n\t\t\tnewSlotNr = 0;\n\t\t}\n\t\tif (newSlotNr >= characterPositions.length) {\n\t\t\tnewSlotNr = characterPositions.length - 1;\n\t\t}\n\t\tcommit('setPosition', {\n\t\t\tid,\n\t\t\tx: characterPositions[newSlotNr],\n\t\t\ty: obj.y,\n\t\t} as ISetObjectPositionMutation);\n\t},\n};\n\nexport async function fixContentPackRemovalFromCharacter(\n\tcontext: ActionContext<IObjectsState, IRootState>,\n\tid: string,\n\toldPack: ContentPack<IAsset>\n) {\n\tconst obj = context.state.objects[id] as ICharacter;\n\tconst oldCharData = oldPack.characters.find(\n\t\tchar => char.id === obj.characterType\n\t);\n\tif (!oldCharData) {\n\t\tconsole.error('Character data is missing. Dropping the character.');\n\t\tcontext.dispatch('removeObject', {\n\t\t\tid,\n\t\t} as IRemoveObjectAction);\n\t\treturn;\n\t}\n\tconst newCharData = context.rootState.content.current.characters.find(\n\t\tchr => chr.id === oldCharData.id\n\t);\n\tif (!newCharData) {\n\t\tconsole.error('Character data is missing. Dropping the character.');\n\t\tcontext.dispatch('removeObject', {\n\t\t\tid,\n\t\t} as IRemoveObjectAction);\n\t\treturn;\n\t}\n\tconst poseAndPositionChange = buildPoseAndPositionData(obj);\n\tconst oldStyle = oldCharData.styles[obj.styleId];\n\tconst newStyleIdx = newCharData.styles.findIndex(\n\t\tstyle => style.name === oldStyle.name\n\t);\n\tif (newStyleIdx === -1) {\n\t\tposeAndPositionChange.styleId = 0;\n\t\tconst oldPoseInStyle = oldCharData.poses[poseAndPositionChange.poseId];\n\t\tconst oldPoseInStyleIndex = oldCharData.poses\n\t\t\t.filter(pose => pose.style === oldStyle.name)\n\t\t\t.indexOf(oldPoseInStyle);\n\t\tconst newPosesInStyle = newCharData.poses.filter(\n\t\t\tpose => pose.style === oldStyle.name\n\t\t);\n\t\tif (newPosesInStyle.length < oldPoseInStyleIndex) {\n\t\t\t// Restore a pose of the same index within its style\n\t\t\tposeAndPositionChange.poseId = newCharData.poses.indexOf(\n\t\t\t\tnewPosesInStyle[oldPoseInStyleIndex]\n\t\t\t);\n\t\t} else {\n\t\t\tposeAndPositionChange.poseId = 0;\n\t\t}\n\t} else {\n\t\tif (newStyleIdx !== obj.styleId) {\n\t\t\tposeAndPositionChange.styleId = newStyleIdx;\n\t\t}\n\t\tconst newStyle = newCharData.styles[poseAndPositionChange.styleId];\n\t\tconst oldPoseInStyle = oldCharData.poses[obj.poseId];\n\t\tconst newPoseIdx = newCharData.poses.findIndex(\n\t\t\tpose => pose.name === oldPoseInStyle.name\n\t\t);\n\t\tif (newPoseIdx === -1) {\n\t\t\tposeAndPositionChange.poseId = newCharData.poses.findIndex(\n\t\t\t\tpose => pose.style === newStyle.name\n\t\t\t);\n\t\t} else if (newPoseIdx !== obj.poseId) {\n\t\t\tposeAndPositionChange.poseId = newPoseIdx;\n\t\t}\n\t}\n\t// Styles and poses have been restored. Proceding with pose parts\n\tconst oldPose = oldCharData.poses[obj.poseId];\n\tconst newPose = newCharData.poses[poseAndPositionChange.poseId];\n\n\tfor (const part of ['variant', 'left', 'right'] as Array<\n\t\t'variant' | 'left' | 'right'\n\t>) {\n\t\tconst oldPart = JSON.stringify(oldPose[part][obj.posePositions[part]]);\n\t\tconst newPartIdx = newPose[part].findIndex(\n\t\t\tvariant => JSON.stringify(variant) === oldPart\n\t\t);\n\t\tif (newPartIdx === -1) {\n\t\t\tposeAndPositionChange.posePositions[part] = 0;\n\t\t} else if (newPartIdx !== obj.posePositions[part]) {\n\t\t\tposeAndPositionChange.posePositions[part] = newPartIdx;\n\t\t}\n\t}\n\n\tconst oldVariant = JSON.stringify(oldPose.variant[obj.posePositions.variant]);\n\tconst newVariantIdx = newPose.variant.findIndex(\n\t\tvariant => JSON.stringify(variant) === oldVariant\n\t);\n\tif (newVariantIdx === -1) {\n\t\tposeAndPositionChange.posePositions.variant = 0;\n\t} else if (newVariantIdx !== obj.posePositions.variant) {\n\t\tposeAndPositionChange.posePositions.variant = newVariantIdx;\n\t}\n\tconst oldLeft = JSON.stringify(oldPose.variant[obj.posePositions.left]);\n\tconst newLeftIdx = newPose.variant.findIndex(\n\t\tleft => JSON.stringify(left) === oldLeft\n\t);\n\tif (newLeftIdx === -1) {\n\t\tposeAndPositionChange.posePositions.left = 0;\n\t} else if (newLeftIdx !== obj.posePositions.left) {\n\t\tposeAndPositionChange.posePositions.left = newLeftIdx;\n\t}\n\tconst oldRigth = JSON.stringify(oldPose.variant[obj.posePositions.right]);\n\tconst newRightIdx = newPose.variant.findIndex(\n\t\tright => JSON.stringify(right) === oldRigth\n\t);\n\tif (newRightIdx === -1) {\n\t\tposeAndPositionChange.posePositions.right = 0;\n\t} else if (newRightIdx !== obj.posePositions.right) {\n\t\tposeAndPositionChange.posePositions.right = newRightIdx;\n\t}\n\n\tconst oldHeadGroup = oldPose.compatibleHeads[obj.posePositions.headType];\n\tconst newHeadGroupIdx = newPose.compatibleHeads.indexOf(oldHeadGroup);\n\n\tif (newHeadGroupIdx === -1) {\n\t\tposeAndPositionChange.posePositions.headType = 0;\n\t\tposeAndPositionChange.posePositions.head = 0;\n\t} else {\n\t\tif (newHeadGroupIdx !== obj.posePositions.headType) {\n\t\t\tposeAndPositionChange.posePositions.headType = newHeadGroupIdx;\n\t\t}\n\t\tconst oldHead = JSON.stringify(\n\t\t\toldCharData.heads[oldHeadGroup].variants[obj.posePositions.head]\n\t\t);\n\t\tconst newHeadIdx = newCharData.heads[oldHeadGroup].variants.findIndex(\n\t\t\tvariant => JSON.stringify(variant) === oldHead\n\t\t);\n\t\tif (newHeadIdx === -1) {\n\t\t\tposeAndPositionChange.posePositions.head = 0;\n\t\t} else {\n\t\t\tposeAndPositionChange.posePositions.head = newHeadIdx;\n\t\t}\n\t}\n\n\tcommitPoseAndPositionChanges(context.commit, obj, poseAndPositionChange);\n}\n\nexport const propertyOptions: IHistoryOptions = {\n\tmutations: {\n\t\tsetPosePosition: {\n\t\t\tcombinable: (oldMut, newMut) => oldMut.payload.id === newMut.payload.id,\n\t\t\tcombinator: (oldMut, newMut) => ({\n\t\t\t\ttype: newMut.type,\n\t\t\t\tpayload: {\n\t\t\t\t\tid: newMut.payload.id,\n\t\t\t\t\tposePositions: {\n\t\t\t\t\t\t...oldMut.payload.posePositions,\n\t\t\t\t\t\t...newMut.payload.posePositions,\n\t\t\t\t\t},\n\t\t\t\t} as ISetPosePositionMutation,\n\t\t\t}),\n\t\t},\n\t},\n};\n\nfunction buildPoseAndPositionData(\n\tcharacter: Readonly<ICharacter>\n): PoseAndPositionChange {\n\treturn {\n\t\tstyleId: character.styleId,\n\t\tposeId: character.poseId,\n\t\tposePositions: { ...character.posePositions },\n\t};\n}\n\nfunction commitPoseAndPositionChanges(\n\tcommit: Commit,\n\tcharacter: Readonly<ICharacter>,\n\tposeAndPosition: PoseAndPositionChange\n) {\n\tif (poseAndPosition.styleId !== character.styleId) {\n\t\tconsole.log(\n\t\t\t`Setting style of ${character.id} to ${poseAndPosition.styleId}`\n\t\t);\n\t\tcommit('setCharStyle', {\n\t\t\tid: character.id,\n\t\t\tstyleId: poseAndPosition.styleId,\n\t\t} as ISetCharStyleMutation);\n\t}\n\tif (poseAndPosition.poseId !== character.poseId) {\n\t\tcommit('setPose', {\n\t\t\tid: character.id,\n\t\t\tposeId: poseAndPosition.poseId,\n\t\t} as ISetPoseMutation);\n\t}\n\tif (\n\t\tJSON.stringify(poseAndPosition.posePositions) !==\n\t\tJSON.stringify(character.posePositions)\n\t) {\n\t\tcommit('setPosePosition', {\n\t\t\tid: character.id,\n\t\t\tposePositions: poseAndPosition.posePositions,\n\t\t} as ISetPosePositionMutation);\n\t}\n}\n\nfunction mutatePoseAndPositions(\n\tcommit: Commit,\n\tcharacter: Readonly<ICharacter>,\n\tdata: Character<IAsset>,\n\tcallback: (change: PoseAndPositionChange) => void\n) {\n\tconst poseAndPosition = buildPoseAndPositionData(character);\n\tcallback(poseAndPosition);\n\n\tif (!data.styles[poseAndPosition.styleId]) {\n\t\tposeAndPosition.styleId = 0;\n\t}\n\tconst style = data.styles[poseAndPosition.styleId];\n\n\t// ensure pose integrity\n\tif (!data.poses[poseAndPosition.poseId]) {\n\t\tposeAndPosition.poseId = 0;\n\t}\n\tif (data.poses[poseAndPosition.poseId].style !== style.name) {\n\t\tposeAndPosition.poseId = data.poses.findIndex(\n\t\t\t(val, idx) => idx > poseAndPosition.poseId && val.style === style.name\n\t\t);\n\t\tposeAndPosition.poseId = data.poses.findIndex(\n\t\t\tval => val.style === style.name\n\t\t);\n\t}\n\tconst pose = data.poses[poseAndPosition.poseId];\n\tif (!pose.left[poseAndPosition.posePositions.left]) {\n\t\tposeAndPosition.posePositions.left = 0;\n\t}\n\tif (!pose.right[poseAndPosition.posePositions.right]) {\n\t\tposeAndPosition.posePositions.right = 0;\n\t}\n\tif (!pose.variant[poseAndPosition.posePositions.variant]) {\n\t\tposeAndPosition.posePositions.variant = 0;\n\t}\n\n\t// restore head group\n\tconst oldPose = data.poses[character.poseId];\n\tconst oldHeadCollection =\n\t\toldPose.compatibleHeads[character.posePositions.headType];\n\tconst newHeadCollectionNr = pose.compatibleHeads.indexOf(oldHeadCollection);\n\tif (newHeadCollectionNr >= 0) {\n\t\tposeAndPosition.posePositions.headType = newHeadCollectionNr;\n\t} else {\n\t\tposeAndPosition.posePositions.headType = 0;\n\t\tposeAndPosition.posePositions.head = 0;\n\t}\n\n\tcommitPoseAndPositionChanges(commit, character, poseAndPosition);\n}\n\ninterface PoseAndPositionChange {\n\tstyleId: ICharacter['styleId'];\n\tposeId: ICharacter['poseId'];\n\tposePositions: ICharacter['posePositions'];\n}\n\nexport interface ISetPoseMutation extends ICommand {\n\treadonly poseId: number;\n}\n\nexport interface ISetCharStyleMutation extends ICommand {\n\treadonly styleId: number;\n}\n\nexport interface ISetPosePositionMutation extends ICommand {\n\treadonly posePositions: {\n\t\tvariant: number;\n\t\tleft: number;\n\t\tright: number;\n\t\thead: number;\n\t\theadType: number;\n\t};\n}\n\nexport interface ISetFreeMoveMutation extends ICommand {\n\treadonly freeMove: boolean;\n}\n\nexport interface ISetCloseMutation extends ICommand {\n\treadonly close: boolean;\n}\n\nexport interface ICreateCharacterAction {\n\treadonly characterType: string;\n}\n\nexport interface ISeekPoseAction extends ICommand {\n\treadonly delta: -1 | 1;\n}\n\nexport interface ISeekStyleAction extends ICommand {\n\treadonly delta: -1 | 1;\n}\n\nexport interface ISeekHeadAction extends ICommand {\n\treadonly delta: -1 | 1;\n}\n\nexport interface ISetPartAction extends ICommand {\n\treadonly part: Part | 'headType' | 'pose' | 'style';\n\treadonly val: number;\n}\n\nexport interface INsfwCheckAction extends ICommand {}\n\nexport interface ISeekPosePartAction extends ICommand {\n\treadonly part: Part;\n\treadonly delta: -1 | 1;\n}\n\nexport interface ISetSpriteSizeMutation extends ICommand {\n\treadonly width: number;\n\treadonly height: number;\n}\n\nexport interface ISetSpriteRatioMutation extends ICommand {\n\treadonly preserveRatio: boolean;\n\treadonly ratio: number;\n}\n\nexport interface ISetSpriteWidthAction extends ICommand {\n\treadonly width: number;\n}\n\nexport interface ISetSpriteHeightAction extends ICommand {\n\treadonly height: number;\n}\n\nexport interface ISetSpriteRatioAction extends ICommand {\n\treadonly preserveRatio: boolean;\n}\n\nexport interface ICreateSpriteAction extends ICommand {\n\treadonly assetName: string;\n}\n\nexport interface IShiftCharacterSlotAction extends ICommand {\n\treadonly delta: -1 | 1;\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('fieldset',[_c('legend',[_vm._v(\"Position\"+_vm._s(_vm.allowSize ? \"/Size\" : \"\")+\":\")]),(_vm.allowStepMove)?_c('toggle',{attrs:{\"label\":\"Move freely?\"},model:{value:(_vm.freeMove),callback:function ($$v) {_vm.freeMove=$$v},expression:\"freeMove\"}}):_vm._e(),(_vm.allowStepMove && !_vm.freeMove)?_c('div',[_c('button',{attrs:{\"disabled\":_vm.isFirstPos},on:{\"click\":function($event){--_vm.pos}}},[_vm._v(\"<\")]),_c('select',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.pos),expression:\"pos\",modifiers:{\"number\":true}}],attrs:{\"id\":\"current_talking\"},on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return _vm._n(val)}); _vm.pos=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},_vm._l((_vm.positionNames),function(val,key){return _c('option',{key:key,domProps:{\"value\":key}},[_vm._v(_vm._s(val))])}),0),_c('button',{attrs:{\"disabled\":_vm.isLastPos},on:{\"click\":function($event){++_vm.pos}}},[_vm._v(\">\")])]):_c('div',[_c('label',{attrs:{\"for\":\"sprite_x\"}},[_vm._v(\"X:\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.x),expression:\"x\",modifiers:{\"number\":true}}],attrs:{\"id\":\"sprite_x\",\"type\":\"number\"},domProps:{\"value\":(_vm.x)},on:{\"keydown\":function($event){$event.stopPropagation();},\"input\":function($event){if($event.target.composing){ return; }_vm.x=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}}),_c('br'),_c('label',{attrs:{\"for\":\"sprite_y\"}},[_vm._v(\"Y:\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.y),expression:\"y\",modifiers:{\"number\":true}}],attrs:{\"id\":\"sprite_y\",\"type\":\"number\"},domProps:{\"value\":(_vm.y)},on:{\"keydown\":function($event){$event.stopPropagation();},\"input\":function($event){if($event.target.composing){ return; }_vm.y=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}})]),(_vm.allowSize)?_c('div',[_c('label',{attrs:{\"for\":\"sprite_w\"}},[_vm._v(\"Width:\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.width),expression:\"width\",modifiers:{\"number\":true}}],attrs:{\"id\":\"sprite_w\",\"type\":\"number\"},domProps:{\"value\":(_vm.width)},on:{\"keydown\":function($event){$event.stopPropagation();},\"input\":function($event){if($event.target.composing){ return; }_vm.width=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}}),_c('br'),_c('label',{attrs:{\"for\":\"sprite_h\"}},[_vm._v(\"Height:\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.height),expression:\"height\",modifiers:{\"number\":true}}],attrs:{\"id\":\"sprite_h\",\"type\":\"number\"},domProps:{\"value\":(_vm.height)},on:{\"keydown\":function($event){$event.stopPropagation();},\"input\":function($event){if($event.target.composing){ return; }_vm.height=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}}),_c('toggle',{attrs:{\"label\":\"Lock ratio?\"},model:{value:(_vm.preserveRatio),callback:function ($$v) {_vm.preserveRatio=$$v},expression:\"preserveRatio\"}})],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop } from 'vue-property-decorator';\nimport Toggle from '@/components/toggle.vue';\nimport { IRenderable } from '@/models/renderable';\nimport { positions, characterPositions } from '@/models/constants';\nimport {\n\tclosestCharacterSlot,\n\tISetFreeMoveMutation,\n\tICharacter,\n} from '@/store/objectTypes/characters';\nimport { State } from 'vuex-class-decorator';\nimport {\n\tISetPositionAction,\n\tISetObjectPositionMutation,\n\tIObject,\n\tISetHeightAction,\n\tISetWidthAction,\n\tISetRatioAction,\n} from '@/store/objects';\nimport { ISprite } from '@/store/objectTypes/sprite';\nimport { IHistorySupport } from '@/plugins/vuex-history';\nimport { ITextBox } from '../../../store/objectTypes/textbox';\n\n@Component({\n\tcomponents: {\n\t\tToggle,\n\t},\n})\nexport default class PositionAndSize extends Vue {\n\t@Prop({ required: true })\n\tprivate readonly obj!: IObject;\n\n\tprivate get history(): IHistorySupport {\n\t\treturn this.$root as any;\n\t}\n\n\tprivate get allowSize() {\n\t\tconst obj = this.obj;\n\t\tif (\n\t\t\tthis.obj.type === 'textBox' &&\n\t\t\t(this.obj as ITextBox).style !== 'custom'\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\t\tif (this.obj.type === 'character' && !(this.obj as ICharacter).freeMove) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tprivate get allowStepMove() {\n\t\treturn 'freeMove' in this.obj;\n\t}\n\n\tprivate get freeMove() {\n\t\treturn (this.obj as ICharacter).freeMove;\n\t}\n\n\tprivate set freeMove(val: boolean) {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.commit('objects/setFreeMove', {\n\t\t\t\tid: this.obj.id,\n\t\t\t\tfreeMove: val,\n\t\t\t} as ISetFreeMoveMutation);\n\t\t});\n\t}\n\n\tprivate get positionNames(): string[] {\n\t\treturn positions;\n\t}\n\n\tprivate get pos(): number {\n\t\treturn closestCharacterSlot(this.obj.x);\n\t}\n\n\tprivate set pos(value: number) {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/setPosition', {\n\t\t\t\tid: this.obj.id,\n\t\t\t\tx: characterPositions[value],\n\t\t\t\ty: this.obj.y,\n\t\t\t} as ISetPositionAction);\n\t\t});\n\t}\n\n\tprivate get isFirstPos(): boolean {\n\t\treturn this.pos === 0;\n\t}\n\n\tprivate get isLastPos(): boolean {\n\t\treturn this.pos === positions.length - 1;\n\t}\n\n\tprivate get x(): number {\n\t\treturn this.obj.x;\n\t}\n\n\tprivate set x(val: number) {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/setPosition', {\n\t\t\t\tid: this.obj.id,\n\t\t\t\tx: val,\n\t\t\t\ty: this.y,\n\t\t\t} as ISetObjectPositionMutation);\n\t\t});\n\t}\n\n\tprivate get y(): number {\n\t\treturn this.obj.y;\n\t}\n\n\tprivate set y(val: number) {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/setPosition', {\n\t\t\t\tid: this.obj.id,\n\t\t\t\tx: this.x,\n\t\t\t\ty: val,\n\t\t\t} as ISetObjectPositionMutation);\n\t\t});\n\t}\n\n\tprivate get height(): number {\n\t\treturn (this.obj as ISprite).height;\n\t}\n\n\tprivate set height(val: number) {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/setHeight', {\n\t\t\t\tid: this.obj.id,\n\t\t\t\theight: val,\n\t\t\t} as ISetHeightAction);\n\t\t});\n\t}\n\n\tprivate get width(): number {\n\t\treturn (this.obj as ISprite).width;\n\t}\n\n\tprivate set width(val: number) {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/setWidth', {\n\t\t\t\tid: this.obj.id,\n\t\t\t\twidth: val,\n\t\t\t} as ISetWidthAction);\n\t\t});\n\t}\n\n\tprivate get preserveRatio(): boolean {\n\t\treturn (this.obj as ISprite).preserveRatio;\n\t}\n\n\tprivate set preserveRatio(val: boolean) {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/setPreserveRatio', {\n\t\t\t\tid: this.obj.id,\n\t\t\t\tpreserveRatio: val,\n\t\t\t} as ISetRatioAction);\n\t\t});\n\t}\n}\n\nexport interface MoveObject {\n\tobject: IRenderable;\n\tmove: 'Forward' | 'Backward' | 'Back' | 'Front' | 'Delete';\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./positionAndSize.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./positionAndSize.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./positionAndSize.vue?vue&type=template&id=b131be44&scoped=true&\"\nimport script from \"./positionAndSize.vue?vue&type=script&lang=ts&\"\nexport * from \"./positionAndSize.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./positionAndSize.vue?vue&type=style&index=0&id=b131be44&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"b131be44\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('fieldset',{attrs:{\"id\":\"layerfs\"}},[_c('legend',[_vm._v(\"Layer:\")]),_c('table',[_c('tbody',[_c('tr',[_c('td',[_c('button',{attrs:{\"title\":\"Move to back\"},on:{\"click\":function($event){return _vm.shiftLayer(-Infinity)}}},[_vm._v(\"⤓\")])]),_c('td',[_c('button',{attrs:{\"title\":\"Move backwards\"},on:{\"click\":function($event){return _vm.shiftLayer(-1)}}},[_vm._v(\"↓\")])]),_c('td',[_c('button',{attrs:{\"title\":\"Move forwards\"},on:{\"click\":function($event){return _vm.shiftLayer(1)}}},[_vm._v(\"↑\")])]),_c('td',[_c('button',{attrs:{\"title\":\"Move to front\"},on:{\"click\":function($event){return _vm.shiftLayer(Infinity)}}},[_vm._v(\"⤒\")])])])])]),_c('toggle',{attrs:{\"value\":_vm.obj.onTop,\"label\":\"In front?\"},on:{\"input\":_vm.setInFront}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop } from 'vue-property-decorator';\nimport Toggle from '@/components/toggle.vue';\nimport { ICommand } from '@/eventbus/command';\nimport eventBus from '@/eventbus/event-bus';\nimport { IHistorySupport } from '@/plugins/vuex-history';\nimport {\n\tIObjectSetOnTopAction,\n\tIObjectShiftLayerAction,\n\tIObject,\n} from '@/store/objects';\n\n@Component({\n\tcomponents: {\n\t\tToggle,\n\t},\n})\nexport default class Layers extends Vue {\n\t@Prop({ required: true }) private obj!: IObject;\n\n\tprivate get history(): IHistorySupport {\n\t\treturn this.$root as any;\n\t}\n\n\tprivate shiftLayer(delta: number) {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/shiftLayer', {\n\t\t\t\tid: this.obj.id,\n\t\t\t\tdelta,\n\t\t\t} as IObjectShiftLayerAction);\n\t\t});\n\t}\n\n\tprivate setInFront(newValue: boolean) {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/setOnTop', {\n\t\t\t\tid: this.obj.id,\n\t\t\t\tonTop: newValue,\n\t\t\t} as IObjectSetOnTopAction);\n\t\t});\n\t}\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./layers.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./layers.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./layers.vue?vue&type=template&id=2a014322&scoped=true&\"\nimport script from \"./layers.vue?vue&type=script&lang=ts&\"\nexport * from \"./layers.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./layers.vue?vue&type=style&index=0&id=2a014322&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2a014322\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('label',{attrs:{\"for\":\"characterOpacity\"}},[_vm._v(\"Opacity:\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.opacity),expression:\"opacity\",modifiers:{\"number\":true}}],attrs:{\"type\":\"number\",\"max\":\"100\",\"min\":\"0\",\"id\":\"characterOpacity\"},domProps:{\"value\":(_vm.opacity)},on:{\"keydown\":function($event){$event.stopPropagation();},\"input\":function($event){if($event.target.composing){ return; }_vm.opacity=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop } from 'vue-property-decorator';\nimport { ICommand } from '@/eventbus/command';\nimport eventBus from '@/eventbus/event-bus';\nimport { IHistorySupport } from '@/plugins/vuex-history';\nimport { IObject, ISetObjectOpacityMutation } from '@/store/objects';\n\n@Component({})\nexport default class Opacity extends Vue {\n\t@Prop({ required: true }) private obj!: IObject;\n\n\tprivate get history(): IHistorySupport {\n\t\treturn this.$root as any;\n\t}\n\n\tprivate get opacity() {\n\t\treturn this.obj.opacity;\n\t}\n\n\tprivate set opacity(opacity: number) {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.commit('objects/setOpacity', {\n\t\t\t\tid: this.obj.id,\n\t\t\t\topacity,\n\t\t\t} as ISetObjectOpacityMutation);\n\t\t});\n\t}\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./opacity.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./opacity.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./opacity.vue?vue&type=template&id=472cd2fc&scoped=true&\"\nimport script from \"./opacity.vue?vue&type=script&lang=ts&\"\nexport * from \"./opacity.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./opacity.vue?vue&type=style&index=0&id=472cd2fc&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"472cd2fc\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('button',{on:{\"click\":_vm.onClick}},[_vm._v(\"Delete\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, Vue, Prop } from 'vue-property-decorator';\nimport { IHistorySupport } from '@/plugins/vuex-history';\nimport { IObject, IRemoveObjectAction } from '@/store/objects';\n\n@Component({})\nexport default class Delete extends Vue {\n\t@Prop({ required: true }) private obj!: IObject;\n\n\tprivate get history(): IHistorySupport {\n\t\treturn this.$root as any;\n\t}\n\n\tprivate onClick() {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/removeObject', {\n\t\t\t\tid: this.obj.id,\n\t\t\t} as IRemoveObjectAction);\n\t\t});\n\t}\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./delete.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./delete.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./delete.vue?vue&type=template&id=2baede2f&\"\nimport script from \"./delete.vue?vue&type=script&lang=ts&\"\nexport * from \"./delete.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{ partList: true, vertical: _vm.vertical }},[_c('button',{on:{\"click\":function($event){return _vm.$emit('leave')}}},[_vm._v(\"Back\")]),_vm._l((_vm.parts),function(part,index){return _c('part-button',{key:index,attrs:{\"value\":index,\"part\":part},on:{\"click\":function($event){_vm.choose(index);\n\t\t\t_vm.$emit('leave');}}})}),_vm._l((_vm.styleComponents),function(styleComponent){return _c('fieldset',{key:styleComponent.name},[_c('legend',[_vm._v(_vm._s(styleComponent.label))]),_vm._l((styleComponent.buttons),function(button,index){return _c('part-button',{key:index,attrs:{\"size\":130,\"value\":index,\"part\":button},on:{\"click\":function($event){return _vm.choose_component(styleComponent.name, index)}}})})],2)})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{part: true, active: false/*background === value*/},style:(_vm.style),on:{\"click\":function($event){return _vm.$emit('click')}}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { IEnvironment, IPack } from './environment';\r\nimport { IBackground } from '@/models/background';\r\n\r\nexport class Browser implements IEnvironment {\r\n\tpublic readonly allowLQ = true;\r\n\r\n\tpublic async saveToFile(\r\n\t\tdownloadCanvas: HTMLCanvasElement,\r\n\t\tfilename: string\r\n\t): Promise<string> {\r\n\t\tconst a = document.createElement('a');\r\n\t\ta.setAttribute('download', filename);\r\n\t\tconst url = await this.createObjectURL(downloadCanvas);\r\n\t\ta.setAttribute('href', url);\r\n\t\tdocument.body.appendChild(a);\r\n\t\ta.click();\r\n\t\tdocument.body.removeChild(a);\r\n\t\treturn url;\r\n\t}\r\n\r\n\tpublic get installedCharacterPacks(): Readonly<Array<Readonly<IPack>>> {\r\n\t\treturn [];\r\n\t}\r\n\r\n\tpublic get isBackgroundInstallingSupported(): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tpublic get isPackInstallingSupported(): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tpublic installBackground(background: IBackground): boolean {\r\n\t\tthrow new Error('This environment does not support installing backgrounds');\r\n\t}\r\n\r\n\tpublic installContentPack(url: string): boolean {\r\n\t\tthrow new Error(\r\n\t\t\t'This environment does not support installing content packs'\r\n\t\t);\r\n\t}\r\n\r\n\tpublic uninstallBackground(background: IBackground): boolean {\r\n\t\tthrow new Error(\r\n\t\t\t'This environment does not support uninstalling backgrounds'\r\n\t\t);\r\n\t}\r\n\r\n\tpublic uninstallContentPack(url: string): boolean {\r\n\t\tthrow new Error(\r\n\t\t\t'This environment does not support uninstalling content packs'\r\n\t\t);\r\n\t}\r\n\tpublic activateContentPack(url: string): boolean {\r\n\t\tthrow new Error(\r\n\t\t\t'This environment does not support installing content packs'\r\n\t\t);\r\n\t}\r\n\r\n\tpublic deactivateContentPack(url: string): boolean {\r\n\t\tthrow new Error(\r\n\t\t\t'This environment does not support uninstalling content packs'\r\n\t\t);\r\n\t}\r\n\r\n\tpublic prompt(\r\n\t\tmessage: string,\r\n\t\tdefaultValue?: string\r\n\t): Promise<string | null> {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tresolve(prompt(message, defaultValue));\r\n\t\t});\r\n\t}\r\n\r\n\tpublic onPanelChange(handler: (panel: string) => void): void {\r\n\t\treturn;\r\n\t}\r\n\r\n\tprotected createObjectURL(canvas: HTMLCanvasElement): Promise<string> {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tif (canvas.toBlob && window.URL && window.URL.createObjectURL) {\r\n\t\t\t\tcanvas.toBlob(blob => {\r\n\t\t\t\t\tif (!blob) {\r\n\t\t\t\t\t\treject();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tresolve(URL.createObjectURL(blob));\r\n\t\t\t\t}, 'image/png');\r\n\t\t\t} else if (window.URL && window.URL.createObjectURL) {\r\n\t\t\t\tconst url = canvas.toDataURL();\r\n\t\t\t\tconst blob = this.dataURItoBlob(url);\r\n\t\t\t\tresolve(URL.createObjectURL(blob));\r\n\t\t\t} else {\r\n\t\t\t\tresolve(canvas.toDataURL());\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprotected dataURItoBlob(dataURI: string) {\r\n\t\tconst binStr = atob(dataURI.split(',')[1]);\r\n\t\tconst len = binStr.length;\r\n\t\tconst arr = new Uint8Array(len);\r\n\r\n\t\tfor (let i = 0; i < len; i++) {\r\n\t\t\tarr[i] = binStr.charCodeAt(i);\r\n\t\t}\r\n\r\n\t\treturn new Blob([arr], { type: 'image/png' });\r\n\t}\r\n}\r\n","import { Browser } from './browser';\r\n\r\nexport class Edge extends Browser {\r\n\tpublic async saveToFile(\r\n\t\tdownloadCanvas: HTMLCanvasElement,\r\n\t\tfilename: string\r\n\t): Promise<string> {\r\n\t\tlet url = downloadCanvas.toDataURL();\r\n\t\tconst blob = this.dataURItoBlob(url);\r\n\r\n\t\tif (window.URL && window.URL.createObjectURL) {\r\n\t\t\turl = URL.createObjectURL(blob);\r\n\t\t}\r\n\r\n\t\t// IE-specific code\r\n\t\twindow.navigator.msSaveBlob(blob, filename);\r\n\t\treturn url;\r\n\t}\r\n}\r\n","import { IEnvironment, IPack } from './environment';\r\nimport { registerAssetWithURL, getAsset } from '@/asset-manager';\r\nimport { Background } from '@/models/background';\r\nimport eventBus from '@/eventbus/event-bus';\r\n\r\nconst packs: IPack[] = [];\r\n\r\nexport class Electron implements IEnvironment {\r\n\tpublic readonly allowLQ = false;\r\n\tprivate electron = (window as any) as IElectronWindow;\r\n\tprivate promptCache: {\r\n\t\t[promptId: number]: (resolved: string | null) => void;\r\n\t} = {};\r\n\tprivate lastPrompt: number = 0;\r\n\r\n\tconstructor() {\r\n\t\tthis.electron.ipcRenderer.on(\r\n\t\t\t'add-persistent-character',\r\n\t\t\tasync (e, filePath: string, active: boolean = true) => {\r\n\t\t\t\t/*\r\n\t\t\t\tconst json = await loadCharacterPack(filePath, active);\r\n\t\t\t\tif (!json) return;\r\n\t\t\t\tpacks.push({\r\n\t\t\t\t\turl: filePath,\r\n\t\t\t\t\tqueuedUninstall: false,\r\n\t\t\t\t\tid: json.packId,\r\n\t\t\t\t\tcredits: json.packCredits,\r\n\t\t\t\t\tactive,\r\n\t\t\t\t});\r\n\t\t\t\t*/\r\n\t\t\t}\r\n\t\t);\r\n\t\tthis.electron.ipcRenderer.on(\r\n\t\t\t'add-persistent-background',\r\n\t\t\tasync (e, filepath: string) => {\r\n\t\t\t\tconst name = 'persistentBg-' + filepath;\r\n\t\t\t\tconst parts = filepath.split('/');\r\n\t\t\t\tregisterAssetWithURL(name, filepath);\r\n\t\t\t\tconsole.log(filepath);\r\n\t\t\t\t/*\r\n\t\t\t\tbackgrounds.push(\r\n\t\t\t\t\tnew Background(name, parts[parts.length - 1], true, '', true)\r\n\t\t\t\t);\r\n\t\t\t\t*/\r\n\t\t\t}\r\n\t\t);\r\n\t\tthis.electron.ipcRenderer.on('push-message', async (e, message: string) => {\r\n\t\t\t/*\r\n\t\t\teventBus.fire(new ShowMessageEvent(message));\r\n\t\t\t*/\r\n\t\t});\r\n\t\tthis.electron.ipcRenderer.on(\r\n\t\t\t'prompt-answered',\r\n\t\t\t(e, id: number, value: string | null) => {\r\n\t\t\t\tthis.promptCache[id](value);\r\n\t\t\t}\r\n\t\t);\r\n\t\tthis.electron.ipcRenderer.send('find-customs');\r\n\t}\r\n\r\n\tpublic saveToFile(\r\n\t\tdownloadCanvas: HTMLCanvasElement,\r\n\t\tfilename: string\r\n\t): Promise<string> {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tdownloadCanvas.toBlob(async blob => {\r\n\t\t\t\tif (!blob) {\r\n\t\t\t\t\treject();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconst buffer = await (blob as any).arrayBuffer();\r\n\t\t\t\tthis.electron.ipcRenderer.send(\r\n\t\t\t\t\t'save-file',\r\n\t\t\t\t\tfilename,\r\n\t\t\t\t\tnew Uint8Array(buffer)\r\n\t\t\t\t);\r\n\t\t\t\tresolve(URL.createObjectURL(blob));\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tpublic get installedCharacterPacks(): Readonly<Array<Readonly<IPack>>> {\r\n\t\treturn packs;\r\n\t}\r\n\r\n\tpublic get isBackgroundInstallingSupported(): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tpublic get isPackInstallingSupported(): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tpublic async installBackground(background: Background): Promise<void> {\r\n\t\tconst asset = await getAsset(background.path, true);\r\n\t\tif (!(asset instanceof HTMLImageElement)) return;\r\n\t\tconst img = await fetch(asset.src);\r\n\t\tconst array = new Uint8Array(await img.arrayBuffer());\r\n\t\tthis.electron.ipcRenderer.send(\r\n\t\t\t'install-background',\r\n\t\t\tbackground.name,\r\n\t\t\tarray\r\n\t\t);\r\n\t\tbackground.installed = true;\r\n\t}\r\n\r\n\tpublic async uninstallBackground(background: Background): Promise<void> {\r\n\t\tconst asset = await getAsset(background.path, true);\r\n\t\tif (!(asset instanceof HTMLImageElement)) return;\r\n\t\tif (!asset.src.startsWith('blob:')) {\r\n\t\t\tconst img = await fetch(asset.src);\r\n\t\t\tconst blob = await img.blob();\r\n\t\t\tconst newUrl = URL.createObjectURL(blob);\r\n\t\t\tregisterAssetWithURL(background.path, newUrl);\r\n\t\t}\r\n\t\tthis.electron.ipcRenderer.send('uninstall-background', background.name);\r\n\t\tbackground.installed = false;\r\n\t}\r\n\r\n\tpublic installContentPack(url: string): void {\r\n\t\tconsole.log('installContentPack', url);\r\n\t\tthis.electron.ipcRenderer.send('install-content-pack', url);\r\n\t}\r\n\r\n\tpublic uninstallContentPack(url: string): void {\r\n\t\tconsole.log('uninstallContentPack', url);\r\n\t\tthis.electron.ipcRenderer.send('uninstall-content-pack', url);\r\n\t}\r\n\r\n\tpublic activateContentPack(url: string): void {\r\n\t\tconsole.log('activateContentPack', url);\r\n\t\tthis.electron.ipcRenderer.send('activate-content-pack', url);\r\n\t}\r\n\r\n\tpublic deactivateContentPack(url: string): void {\r\n\t\tconsole.log('deactivateContentPack', url);\r\n\t\tthis.electron.ipcRenderer.send('deactivate-content-pack', url);\r\n\t}\r\n\r\n\tpublic prompt(\r\n\t\tmessage: string,\r\n\t\tdefaultValue?: string\r\n\t): Promise<string | null> {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis.promptCache[++this.lastPrompt] = resolve;\r\n\t\t\tthis.electron.ipcRenderer.send(\r\n\t\t\t\t'show-prompt',\r\n\t\t\t\tthis.lastPrompt,\r\n\t\t\t\tmessage,\r\n\t\t\t\tdefaultValue\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic onPanelChange(handler: (panel: string) => void): void {\r\n\t\tthis.electron.ipcRenderer.on('open-panel', (e, panel: string) => {\r\n\t\t\thandler(panel);\r\n\t\t});\r\n\t}\r\n}\r\n\r\ninterface IElectronWindow {\r\n\tisElectron: boolean;\r\n\tipcRenderer: IpcRenderer;\r\n}\r\n\r\ninterface IpcRenderer {\r\n\ton(\r\n\t\tchannel: string,\r\n\t\tlistener: (event: IpcRendererEvent, ...args: any[]) => void\r\n\t): void;\r\n\tsend(channel: string, ...args: any[]): void;\r\n}\r\n\r\ninterface IpcRendererEvent extends Event {\r\n\tsender: IpcRenderer;\r\n\tsenderId: number;\r\n}\r\n","import { Edge } from './edge';\r\nimport { Browser } from './browser';\r\nimport { Electron } from './electron';\r\nimport { Background } from '@/models/background';\r\n\r\nexport interface IPack {\r\n\turl: string;\r\n\tid: string;\r\n\tcredits: string;\r\n\tqueuedUninstall: boolean;\r\n\tactive: boolean;\r\n}\r\n\r\nexport interface IEnvironment {\r\n\treadonly allowLQ: boolean;\r\n\treadonly isBackgroundInstallingSupported: boolean;\r\n\treadonly isPackInstallingSupported: boolean;\r\n\treadonly installedCharacterPacks: Readonly<Array<Readonly<IPack>>>;\r\n\tsaveToFile(canvas: HTMLCanvasElement, filename: string): Promise<string>;\r\n\tinstallBackground(background: Background): void;\r\n\tuninstallBackground(background: Background): void;\r\n\tactivateContentPack(url: string): void;\r\n\tdeactivateContentPack(url: string): void;\r\n\tinstallContentPack(url: string): void;\r\n\tuninstallContentPack(url: string): void;\r\n\tprompt(message: string, defaultValue?: string): Promise<string | null>;\r\n\tonPanelChange(handler: (panel: string) => void): void;\r\n}\r\n\r\nfunction chooseEnv(): IEnvironment {\r\n\tif ((window as any).isElectron) {\r\n\t\treturn new Electron();\r\n\t}\r\n\tif (window.navigator.msSaveOrOpenBlob !== undefined) {\r\n\t\treturn new Edge();\r\n\t}\r\n\treturn new Browser();\r\n}\r\n\r\nconst envX = chooseEnv();\r\n\r\n(window as any).toast = envX;\r\nexport default envX;\r\n","\n\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop, Watch } from 'vue-property-decorator';\r\nimport { IBackground, color, Background } from '../../../../models/background';\r\nimport { VariantBackground } from '../../../../models/variant-background';\r\nimport {\r\n\tisWebPSupported,\r\n\tgetAAsset,\r\n\tgetAsset,\r\n} from '../../../../asset-manager';\r\nimport environment from '../../../../environments/environment';\r\nimport { ErrorAsset } from '../../../../models/error-asset';\r\nimport { IAsset } from '../../../../store/content';\r\n\r\nexport interface IPartButtonImage {\r\n\timages: Array<IAsset | string>;\r\n\tsize: [number, number];\r\n\toffset: [number, number];\r\n}\r\n\r\n@Component({\r\n\tcomponents: {},\r\n})\r\nexport default class PartButton extends Vue {\r\n\t@Prop({ required: true }) private readonly part!: IPartButtonImage;\r\n\t@Prop({ required: true }) private readonly value!: number;\r\n\t@Prop({ default: 150, type: Number })\r\n\tprivate readonly size!: number;\r\n\r\n\tprivate lookups: Array<HTMLImageElement | ErrorAsset | null> = [];\r\n\tprivate loaded = false;\r\n\r\n\tprivate async created() {\r\n\t\tthis.lookups = await Promise.all(\r\n\t\t\tthis.part.images.map(asset => {\r\n\t\t\t\tif (typeof asset === 'string') {\r\n\t\t\t\t\treturn getAsset(asset, false);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn getAAsset(asset, false);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tprivate get scaleX(): number {\r\n\t\treturn this.size / this.part.size[0];\r\n\t}\r\n\r\n\tprivate get scaleY(): number {\r\n\t\treturn this.size / this.part.size[1];\r\n\t}\r\n\r\n\tprivate get backgroundSize(): string {\r\n\t\treturn `${Math.floor(960 * this.scaleX)}px ${Math.floor(\r\n\t\t\t960 * this.scaleY\r\n\t\t)}px`;\r\n\t}\r\n\r\n\tprivate get backgroundPosition(): string {\r\n\t\treturn (\r\n\t\t\t`${Math.floor(this.part.offset[0] * -this.scaleX)}px ` +\r\n\t\t\t`${Math.floor(this.part.offset[1] * -this.scaleY)}px`\r\n\t\t);\r\n\t}\r\n\r\n\tprivate get style(): { [id: string]: string } {\r\n\t\tconst baseStyle = {\r\n\t\t\theight: this.size + 'px',\r\n\t\t\twidth: this.size + 'px',\r\n\t\t\tbackgroundPosition: this.backgroundPosition,\r\n\t\t\tbackgroundSize: this.backgroundSize,\r\n\t\t};\r\n\t\tconst lq = environment.allowLQ ? '.lq' : '';\r\n\t\tconst images = (this.lookups.filter(\r\n\t\t\tlookup => lookup instanceof HTMLImageElement\r\n\t\t) as HTMLImageElement[]).map(\r\n\t\t\tlookup => `url('${lookup.src.replace(\"'\", \"\\\\'\")}')`\r\n\t\t);\r\n\t\treturn {\r\n\t\t\tbackgroundImage: images.join(','),\r\n\t\t\t...baseStyle,\r\n\t\t};\r\n\t}\r\n}\r\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./partButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./partButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./partButton.vue?vue&type=template&id=c08182fc&scoped=true&\"\nimport script from \"./partButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./partButton.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./partButton.vue?vue&type=style&index=0&id=c08182fc&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"c08182fc\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop, Watch } from 'vue-property-decorator';\r\nimport {\r\n\tisWebPSupported,\r\n\tregisterAsset,\r\n\tregisterAssetWithURL,\r\n} from '@/asset-manager';\r\nimport environment from '@/environments/environment';\r\nimport PartButton, { IPartButtonImage } from './partButton.vue';\r\nimport { Part } from '@/models/constants';\r\nimport {\r\n\tStyleComponent,\r\n\tPose,\r\n\tCharacter,\r\n} from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\r\nimport { IAsset } from '@/store/content';\r\nimport {\r\n\tgetPose,\r\n\tgetDataG,\r\n\tISeekPoseAction,\r\n\tISetPosePositionMutation,\r\n\tISetPartAction,\r\n\tgetData,\r\n\tICharacter,\r\n} from '@/store/objectTypes/characters';\r\nimport { IHistorySupport } from '@/plugins/vuex-history';\r\nimport { State } from 'vuex-class-decorator';\r\n\r\ninterface IPartStyleGroup {\r\n\tlabel: string;\r\n\tname: string;\r\n\tbuttons: { [id: string]: IPartButtonImage };\r\n}\r\n\r\n@Component({\r\n\tcomponents: {\r\n\t\tPartButton,\r\n\t},\r\n})\r\nexport default class PartsPanel extends Vue {\r\n\t@State('vertical', { namespace: 'ui' }) private readonly vertical!: boolean;\r\n\r\n\t@Prop({ required: true }) private character!: ICharacter;\r\n\t@Prop({ required: true, type: String }) private readonly part!:\r\n\t\t| Part\r\n\t\t| 'pose'\r\n\t\t| 'style';\r\n\r\n\tprivate isWebPSupported: boolean | null = null;\r\n\tprivate styleData: {\r\n\t\tlastBase: string;\r\n\t\tcomponents: {\r\n\t\t\t[s: string]: string;\r\n\t\t};\r\n\t} = {\r\n\t\tlastBase: '',\r\n\t\tcomponents: {},\r\n\t};\r\n\r\n\tprivate get history(): IHistorySupport {\r\n\t\treturn this.$root as any;\r\n\t}\r\n\r\n\tprivate get charData(): Character<IAsset> {\r\n\t\treturn getData(this.$store, this.character);\r\n\t}\r\n\r\n\t@Watch('character')\r\n\tprivate updateStyleData(): void {\r\n\t\tconst pose = getPose(this.charData, this.character);\r\n\t\tconst baseStyle = this.charData.styles.find(\r\n\t\t\tstyle => style.name === pose.style\r\n\t\t);\r\n\t\tif (!baseStyle) return;\r\n\t\tthis.styleData.lastBase = baseStyle.styleGroup;\r\n\t\tthis.styleData.components = baseStyle.components;\r\n\t}\r\n\r\n\tprivate async created() {\r\n\t\tthis.updateStyleData();\r\n\t\tthis.isWebPSupported = await isWebPSupported();\r\n\t}\r\n\r\n\tprivate get styleComponents(): IPartStyleGroup[] {\r\n\t\tif (this.part !== 'style') return [];\r\n\t\treturn this.charData.styleComponents.map(component => {\r\n\t\t\tconst buttons: IPartStyleGroup['buttons'] = {};\r\n\t\t\tfor (const key in component.variants) {\r\n\t\t\t\tif (!component.variants.hasOwnProperty(key)) continue;\r\n\t\t\t\tconst variant = component.variants[key];\r\n\t\t\t\tbuttons[key] = {\r\n\t\t\t\t\tsize: [960, 960],\r\n\t\t\t\t\toffset: [0, 0],\r\n\t\t\t\t\timages: [variant],\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\treturn { label: component.label, name: component.name, buttons };\r\n\t\t});\r\n\t}\r\n\r\n\tprivate get parts(): { [id: number]: IPartButtonImage } {\r\n\t\tconst ret: { [id: string]: IPartButtonImage } = {};\r\n\t\tlet collection: IAsset[][];\r\n\t\tlet offset: IPartButtonImage['offset'];\r\n\t\tlet size: IPartButtonImage['size'];\r\n\t\tconst data = this.charData;\r\n\t\tconst currentPose = getPose(data, this.character);\r\n\t\tswitch (this.part) {\r\n\t\t\tcase 'head':\r\n\t\t\t\tfor (\r\n\t\t\t\t\tlet headKeyIdx = 0;\r\n\t\t\t\t\theadKeyIdx < currentPose.compatibleHeads.length;\r\n\t\t\t\t\t++headKeyIdx\r\n\t\t\t\t) {\r\n\t\t\t\t\tconst headKey = currentPose.compatibleHeads[headKeyIdx];\r\n\t\t\t\t\tconst heads = data.heads[headKey];\r\n\t\t\t\t\tfor (let headIdx = 0; headIdx < heads.variants.length; ++headIdx) {\r\n\t\t\t\t\t\tconst headImages = heads.variants[headIdx];\r\n\t\t\t\t\t\tret[`${headKeyIdx}_${headIdx}`] = {\r\n\t\t\t\t\t\t\timages: headImages,\r\n\t\t\t\t\t\t\tsize: heads.size,\r\n\t\t\t\t\t\t\toffset: heads.offset,\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn ret;\r\n\t\t\tcase 'variant':\r\n\t\t\t\tcollection = currentPose.variant;\r\n\t\t\t\tsize = currentPose.size;\r\n\t\t\t\toffset = currentPose.offset;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'left':\r\n\t\t\t\tcollection = currentPose.left;\r\n\t\t\t\tsize = currentPose.size;\r\n\t\t\t\toffset = currentPose.offset;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'right':\r\n\t\t\t\tcollection = currentPose.right;\r\n\t\t\t\tsize = currentPose.size;\r\n\t\t\t\toffset = currentPose.offset;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'pose':\r\n\t\t\t\tconst currentStyle = data.styles[this.character.styleId];\r\n\t\t\t\tfor (let poseIdx = 0; poseIdx < data.poses.length; ++poseIdx) {\r\n\t\t\t\t\tconst pose = data.poses[poseIdx];\r\n\t\t\t\t\tif (pose.style !== currentStyle.name) continue;\r\n\t\t\t\t\tret[poseIdx] = this.generatePosePreview(pose);\r\n\t\t\t\t}\r\n\t\t\t\treturn ret;\r\n\t\t\tcase 'style':\r\n\t\t\t\tconst styles = data.styles;\r\n\t\t\t\tconst dedupedStyleGroups = styles\r\n\t\t\t\t\t.map(style => style.styleGroup)\r\n\t\t\t\t\t.filter((style, idx, all) => {\r\n\t\t\t\t\t\tif (all.indexOf(style) !== idx) return false;\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\tfor (const styleGroup of dedupedStyleGroups) {\r\n\t\t\t\t\tconst firstStyle = styles.find(\r\n\t\t\t\t\t\tstyle => style.styleGroup === styleGroup\r\n\t\t\t\t\t)!;\r\n\t\t\t\t\tconst firstPose = data.poses.find(\r\n\t\t\t\t\t\tpose => pose.style === firstStyle.name\r\n\t\t\t\t\t)!;\r\n\t\t\t\t\tret[styleGroup] = this.generatePosePreview(firstPose);\r\n\t\t\t\t}\r\n\t\t\t\treturn ret;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error('Unrecognised pose part: ' + this.part);\r\n\t\t}\r\n\t\tfor (let partIdx = 0; partIdx < collection.length; ++partIdx) {\r\n\t\t\tconst part = collection[partIdx];\r\n\t\t\tret[partIdx] = {\r\n\t\t\t\timages: part,\r\n\t\t\t\tsize,\r\n\t\t\t\toffset,\r\n\t\t\t};\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprivate generatePosePreview(pose: Pose<IAsset>): IPartButtonImage {\r\n\t\tconst data = this.charData;\r\n\t\tconst heads = data.heads[pose.compatibleHeads[0]];\r\n\t\tconst head = heads ? heads.variants[0] : null;\r\n\t\tlet images: IAsset[] = [];\r\n\r\n\t\tfor (const order of pose.renderOrder) {\r\n\t\t\tswitch (order.toUpperCase()) {\r\n\t\t\t\tcase 'S':\r\n\t\t\t\t\tif (pose.static) images = images.concat(pose.static);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'V':\r\n\t\t\t\t\tif (pose.variant.length > 0) images = images.concat(pose.variant[0]);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'L':\r\n\t\t\t\t\tif (pose.left.length > 0) images = images.concat(pose.left[0]);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'R':\r\n\t\t\t\t\tif (pose.right.length > 0) images = images.concat(pose.right[0]);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'H':\r\n\t\t\t\t\tif (head) images = images.concat(head);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\timages,\r\n\t\t\tsize: pose.size,\r\n\t\t\toffset: pose.offset,\r\n\t\t};\r\n\t}\r\n\r\n\tprivate updatePose() {\r\n\t\tconst data = this.charData;\r\n\t\tlet selection = data.styles.filter(\r\n\t\t\tstyle => style.styleGroup === this.styleData.lastBase\r\n\t\t);\r\n\t\tfor (const component of data.styleComponents) {\r\n\t\t\tconst subSelect = selection.filter(styleComponent => {\r\n\t\t\t\treturn (\r\n\t\t\t\t\tstyleComponent.components[component.name] ===\r\n\t\t\t\t\tthis.styleData.components[component.name]\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t\t\tif (subSelect.length > 0) selection = subSelect;\r\n\t\t}\r\n\t\tthis.setPart('style', data.styles.indexOf(selection[0]));\r\n\t}\r\n\r\n\tprivate choose(index: string) {\r\n\t\tif (this.part === 'style') {\r\n\t\t\tthis.styleData.lastBase = index;\r\n\t\t\tthis.updatePose();\r\n\t\t} else if (this.part === 'head') {\r\n\t\t\tconst [headTypeIdx, headIdx] = index\r\n\t\t\t\t.split('_', 2)\r\n\t\t\t\t.map(part => parseInt(part, 10));\r\n\t\t\tthis.setPart('headType', headTypeIdx);\r\n\t\t\tthis.setPart('head', headIdx);\r\n\t\t} else {\r\n\t\t\tthis.setPart(this.part, parseInt(index, 10));\r\n\t\t}\r\n\t}\r\n\r\n\tprivate choose_component(component: string, index: string) {\r\n\t\tthis.styleData.components[component] = index;\r\n\t\tthis.updatePose();\r\n\t}\r\n\r\n\tprivate onFileUpload(e: Event) {\r\n\t\t/*\r\n\t\tconst uploadInput = this.$refs.upload as HTMLInputElement;\r\n\t\tif (!uploadInput.files) return;\r\n\t\tfor (const file of uploadInput.files) {\r\n\t\t\t(nr => {\r\n\t\t\t\tconst name = 'customAsset' + nr;\r\n\t\t\t\tconst url = registerAsset(name, file);\r\n\t\t\t\tthis.$emit('add-custom-asset', name);\r\n\t\t\t})(++this.customAssetCount);\r\n\t\t}\r\n\t\t*/\r\n\t}\r\n\r\n\tprivate async uploadFromURL() {\r\n\t\t/*\r\n\t\tconst url = prompt('Enter the URL of the image');\r\n\t\tif (!url) return;\r\n\t\tconst name = 'customAsset' + ++this.customAssetCount;\r\n\t\tawait registerAssetWithURL(name, url);\r\n\t\tthis.$emit('add-custom-asset', name);\r\n\t\t*/\r\n\t}\r\n\r\n\tprivate setPart(part: ISetPartAction['part'], index: number): void {\r\n\t\tthis.history.transaction(() => {\r\n\t\t\tthis.$store.dispatch('objects/setPart', {\r\n\t\t\t\tid: this.character.id,\r\n\t\t\t\tpart,\r\n\t\t\t\tval: index,\r\n\t\t\t} as ISetPartAction);\r\n\t\t});\r\n\t}\r\n}\r\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./parts.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./parts.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./parts.vue?vue&type=template&id=ec1eca48&scoped=true&\"\nimport script from \"./parts.vue?vue&type=script&lang=ts&\"\nexport * from \"./parts.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./parts.vue?vue&type=style&index=0&id=ec1eca48&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"ec1eca48\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop, Mixins } from 'vue-property-decorator';\nimport { State } from 'vuex-class-decorator';\nimport { IHistorySupport } from '@/plugins/vuex-history';\nimport { Part } from '@/models/constants';\nimport {\n\tgetData,\n\tgetParts,\n\tISeekPoseAction,\n\tISetCloseMutation,\n\tISeekPosePartAction,\n\tICharacter,\n\tISeekStyleAction,\n} from '@/store/objectTypes/characters';\nimport { ISetObjectFlipMutation } from '@/store/objects';\nimport Toggle from '@/components/toggle.vue';\nimport PositionAndSize from '@/components/toolbox/commonsFieldsets/positionAndSize.vue';\nimport Layers from '@/components/toolbox/commonsFieldsets/layers.vue';\nimport Opacity from '@/components/toolbox/commonsFieldsets/opacity.vue';\nimport Delete from '@/components/toolbox/commonsFieldsets/delete.vue';\nimport Parts from './character/parts.vue';\nimport { Character } from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\nimport { IAsset } from '../../../store/content';\nimport { PanelMixin } from './panelMixin';\nimport { Store } from 'vuex';\nimport { IRootState } from '../../../store';\n\n@Component({\n\tcomponents: {\n\t\tToggle,\n\t\tPositionAndSize,\n\t\tLayers,\n\t\tOpacity,\n\t\tDelete,\n\t\tParts,\n\t},\n})\nexport default class CharacterPanel extends Mixins(PanelMixin) {\n\tpublic $store!: Store<IRootState>;\n\n\tprivate get character(): ICharacter {\n\t\tconst obj = this.$store.state.objects.objects[\n\t\t\tthis.$store.state.ui.selection!\n\t\t];\n\t\tif (obj.type !== 'character') return undefined!;\n\t\treturn obj as ICharacter;\n\t}\n\n\tprivate panelForParts: Part | null = null;\n\n\tprivate get history(): IHistorySupport {\n\t\treturn this.$root as any;\n\t}\n\n\tprivate get charData(): Readonly<Character<IAsset>> {\n\t\treturn getData(this.$store, this.character);\n\t}\n\n\tprivate get label(): string {\n\t\treturn this.charData.label;\n\t}\n\n\tprivate get parts(): string[] {\n\t\treturn getParts(this.charData, this.character);\n\t}\n\n\tprivate get hasMultipleStyles(): boolean {\n\t\treturn this.charData.styles.length > 1;\n\t}\n\n\tprivate get hasMultiplePoses(): boolean {\n\t\tconst style = this.charData.styles[this.character.styleId];\n\t\treturn this.charData.poses.filter(x => x.style === style.name).length > 1;\n\t}\n\n\tprivate seekPose(delta: number): void {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/seekPose', {\n\t\t\t\tid: this.character.id,\n\t\t\t\tdelta,\n\t\t\t} as ISeekPoseAction);\n\t\t});\n\t}\n\n\tprivate seekStyle(delta: number): void {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/seekStyle', {\n\t\t\t\tid: this.character.id,\n\t\t\t\tdelta,\n\t\t\t} as ISeekStyleAction);\n\t\t});\n\t}\n\n\tprivate seekPart(part: Part, delta: number): void {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/seekPart', {\n\t\t\t\tid: this.character.id,\n\t\t\t\tdelta,\n\t\t\t\tpart,\n\t\t\t} as ISeekPosePartAction);\n\t\t});\n\t}\n\n\tprivate captialize(str: string) {\n\t\treturn str.charAt(0).toUpperCase() + str.substring(1);\n\t}\n\n\tprivate get flip() {\n\t\treturn this.character.flip;\n\t}\n\n\tprivate set flip(newValue: boolean) {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.commit('objects/setFlip', {\n\t\t\t\tid: this.character.id,\n\t\t\t\tflip: newValue,\n\t\t\t} as ISetObjectFlipMutation);\n\t\t});\n\t}\n\n\tprivate get closeUp() {\n\t\treturn this.character.close;\n\t}\n\n\tprivate set closeUp(newValue: boolean) {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.commit('objects/setClose', {\n\t\t\t\tid: this.character.id,\n\t\t\t\tclose: newValue,\n\t\t\t} as ISetCloseMutation);\n\t\t});\n\t}\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./character.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./character.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./character.vue?vue&type=template&id=8f165bec&scoped=true&\"\nimport script from \"./character.vue?vue&type=script&lang=ts&\"\nexport * from \"./character.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./character.vue?vue&type=style&index=0&id=8f165bec&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"8f165bec\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"panel\"},[_c('h1',[_vm._v(\"Custom Sprite\")]),_c('position-and-size',{attrs:{\"obj\":_vm.sprite}}),_c('layers',{attrs:{\"obj\":_vm.sprite}}),_c('opacity',{attrs:{\"obj\":_vm.sprite}}),_c('toggle',{attrs:{\"label\":\"Flip?\"},model:{value:(_vm.flip),callback:function ($$v) {_vm.flip=$$v},expression:\"flip\"}}),_c('delete',{attrs:{\"obj\":_vm.sprite}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop, Mixins } from 'vue-property-decorator';\nimport { isWebPSupported } from '@/asset-manager';\nimport { Character } from '@/models/character';\nimport Toggle from '@/components/toggle.vue';\nimport PositionAndSize from '@/components/toolbox/commonsFieldsets/positionAndSize.vue';\nimport Layers from '@/components/toolbox/commonsFieldsets/layers.vue';\nimport Opacity from '@/components/toolbox/commonsFieldsets/opacity.vue';\nimport Delete from '@/components/toolbox/commonsFieldsets/delete.vue';\nimport { IRenderable } from '@/models/renderable';\nimport { Sprite } from '@/models/sprite';\nimport { ISprite } from '@/store/objectTypes/sprite';\nimport { ICommand } from '@/eventbus/command';\nimport eventBus from '@/eventbus/event-bus';\nimport { IHistorySupport } from '@/plugins/vuex-history';\nimport {\n\tIObjectSetOnTopAction,\n\tISetObjectFlipMutation,\n\tISetObjectPositionMutation,\n\tISetObjectOpacityMutation,\n\tIObjectShiftLayerAction,\n} from '@/store/objects';\nimport { PanelMixin } from './panelMixin';\nimport { Store } from 'vuex';\nimport { IRootState } from '../../../store';\n\n@Component({\n\tcomponents: {\n\t\tToggle,\n\t\tPositionAndSize,\n\t\tLayers,\n\t\tOpacity,\n\t\tDelete,\n\t},\n})\nexport default class SpritePanel extends Mixins(PanelMixin) {\n\tpublic $store!: Store<IRootState>;\n\n\tprivate get sprite(): ISprite {\n\t\tconst obj = this.$store.state.objects.objects[\n\t\t\tthis.$store.state.ui.selection!\n\t\t];\n\t\tif (obj.type !== 'sprite') return undefined!;\n\t\treturn obj as ISprite;\n\t}\n\n\tprivate get history(): IHistorySupport {\n\t\treturn this.$root as any;\n\t}\n\n\tprivate get flip() {\n\t\treturn this.sprite.flip;\n\t}\n\n\tprivate set flip(newValue: boolean) {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.commit('objects/setFlip', {\n\t\t\t\tid: this.sprite.id,\n\t\t\t\tflip: newValue,\n\t\t\t} as ISetObjectFlipMutation);\n\t\t});\n\t}\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sprite.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sprite.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./sprite.vue?vue&type=template&id=1ef64526&scoped=true&\"\nimport script from \"./sprite.vue?vue&type=script&lang=ts&\"\nexport * from \"./sprite.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./sprite.vue?vue&type=style&index=0&id=1ef64526&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1ef64526\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"panel\"},[_c('h1',[_vm._v(\"Textbox\")]),_c('div',[_c('label',{attrs:{\"for\":\"text_style\"}},[_vm._v(\"Style:\")]),_c('br'),_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.textBoxStyle),expression:\"textBoxStyle\"}],attrs:{\"id\":\"text_style\"},on:{\"keydown\":function($event){$event.stopPropagation();},\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.textBoxStyle=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},[_c('option',{attrs:{\"value\":\"normal\"}},[_vm._v(\"Normal\")]),_c('option',{attrs:{\"value\":\"corrupt\"}},[_vm._v(\"Corrupt\")]),_c('option',{attrs:{\"value\":\"custom\"}},[_vm._v(\"Custom\")])])]),_c('div',[_c('label',{attrs:{\"for\":\"current_talking\"}},[_vm._v(\"Person talking:\")]),_c('br'),_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.talkingDefaults),expression:\"talkingDefaults\"}],attrs:{\"id\":\"current_talking\"},on:{\"keydown\":function($event){$event.stopPropagation();},\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.talkingDefaults=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},[_c('option',{attrs:{\"value\":\"No-one\"}},[_vm._v(\"No-one\")]),_c('option',{attrs:{\"value\":\"Sayori\"}},[_vm._v(\"Sayori\")]),_c('option',{attrs:{\"value\":\"Yuri\"}},[_vm._v(\"Yuri\")]),_c('option',{attrs:{\"value\":\"Natsuki\"}},[_vm._v(\"Natsuki\")]),_c('option',{attrs:{\"value\":\"Monika\"}},[_vm._v(\"Monika\")]),_c('option',{attrs:{\"value\":\"FeMC\"}},[_vm._v(\"FeMC\")]),_c('option',{attrs:{\"value\":\"MC\"}},[_vm._v(\"MC\")]),_c('option',{attrs:{\"value\":\"Chad\"}},[_vm._v(\"Chad\")]),_c('option',{attrs:{\"value\":\"Amy\"}},[_vm._v(\"Amy\")]),_c('option',{attrs:{\"value\":\"Other\"}},[_vm._v(\"Other\")])])]),_c('div',[_c('label',{attrs:{\"for\":\"custom_name\"}},[_vm._v(\"Other name:\")]),_c('br'),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.talkingOther),expression:\"talkingOther\"}],attrs:{\"id\":\"custom_name\"},domProps:{\"value\":(_vm.talkingOther)},on:{\"keydown\":function($event){$event.stopPropagation();},\"input\":function($event){if($event.target.composing){ return; }_vm.talkingOther=$event.target.value}}})]),_c('toggle',{attrs:{\"label\":\"Controls visible?\"},model:{value:(_vm.showControls),callback:function ($$v) {_vm.showControls=$$v},expression:\"showControls\"}}),_c('toggle',{attrs:{\"label\":\"Able to skip?\"},model:{value:(_vm.allowSkipping),callback:function ($$v) {_vm.allowSkipping=$$v},expression:\"allowSkipping\"}}),_c('toggle',{attrs:{\"label\":\"Continue arrow?\"},model:{value:(_vm.showContinueArrow),callback:function ($$v) {_vm.showContinueArrow=$$v},expression:\"showContinueArrow\"}}),_c('div',{attrs:{\"id\":\"dialog_text_wrapper\"}},[_c('label',{attrs:{\"for\":\"dialog_text\"}},[_vm._v(\"Dialog:\")]),_c('textarea',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.dialog),expression:\"dialog\"}],attrs:{\"id\":\"dialog_text\"},domProps:{\"value\":(_vm.dialog)},on:{\"keydown\":function($event){$event.stopPropagation();},\"input\":function($event){if($event.target.composing){ return; }_vm.dialog=$event.target.value}}})]),_c('position-and-size',{attrs:{\"obj\":_vm.textbox}}),_c('button',{on:{\"click\":_vm.splitTextbox}},[_vm._v(\"Split textbox\")]),_c('layers',{attrs:{\"obj\":_vm.textbox}}),_c('opacity',{attrs:{\"obj\":_vm.textbox}}),_c('toggle',{attrs:{\"label\":\"Flip?\"},model:{value:(_vm.flip),callback:function ($$v) {_vm.flip=$$v},expression:\"flip\"}}),(_vm.textBoxStyle === 'custom')?_c('fieldset',[_c('legend',[_vm._v(\"Customization:\")]),_c('label',{attrs:{\"for\":\"textbox_color\"}},[_vm._v(\"Color:\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.textboxColor),expression:\"textboxColor\"}],attrs:{\"id\":\"textbox_color\",\"type\":\"color\"},domProps:{\"value\":(_vm.textboxColor)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.textboxColor=$event.target.value}}}),_c('br'),_c('label',{attrs:{\"for\":\"custom_namebox_width\"}},[_vm._v(\"Namebox width:\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.customNameboxWidth),expression:\"customNameboxWidth\",modifiers:{\"number\":true}}],attrs:{\"id\":\"custom_namebox_width\",\"type\":\"number\"},domProps:{\"value\":(_vm.customNameboxWidth)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.customNameboxWidth=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}}),_c('br'),_c('label',{attrs:{\"for\":\"derive_custom_colors\"}},[_vm._v(\"Derive other colors:\")]),_c('toggle',{attrs:{\"id\":\"derive_custom_colors\"},model:{value:(_vm.deriveCustomColors),callback:function ($$v) {_vm.deriveCustomColors=$$v},expression:\"deriveCustomColors\"}}),(!_vm.deriveCustomColors)?[_c('label',{attrs:{\"for\":\"custom_controls_color\"}},[_vm._v(\"Controls Color:\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.customControlsColor),expression:\"customControlsColor\"}],attrs:{\"id\":\"custom_controls_color\",\"type\":\"color\"},domProps:{\"value\":(_vm.customControlsColor)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.customControlsColor=$event.target.value}}}),_c('br'),_c('label',{attrs:{\"for\":\"custom_namebox_color\"}},[_vm._v(\"Namebox Color:\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.customNameboxColor),expression:\"customNameboxColor\"}],attrs:{\"id\":\"custom_namebox_color\",\"type\":\"color\"},domProps:{\"value\":(_vm.customNameboxColor)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.customNameboxColor=$event.target.value}}}),_c('br'),_c('label',{attrs:{\"for\":\"custom_namebox_stroke\"}},[_vm._v(\"Namebox text stroke:\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.customNameboxStroke),expression:\"customNameboxStroke\"}],attrs:{\"id\":\"custom_namebox_stroke\",\"type\":\"color\"},domProps:{\"value\":(_vm.customNameboxStroke)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.customNameboxStroke=$event.target.value}}})]:_vm._e()],2):_vm._e(),_c('delete',{attrs:{\"obj\":_vm.textbox}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop, Watch, Mixins } from 'vue-property-decorator';\nimport {\n\tITextBox,\n\tISetTextBoxControlsVisibleMutation,\n\tISetTextBoxControlsSkipMutation,\n\tISetTextBoxControlsContinueMutation,\n\tISetTextBoxTextMutation,\n\tISetTextBoxStyleAction,\n\tISetTextBoxCustomColorMutation,\n\tISetTextBoxTalkingDefaultMutation,\n\tISetTextBoxTalkingOtherMutation,\n\tISetTextBoxCustomControlsColorMutation,\n\tISetTextBoxNameboxColorMutation,\n\tISetTextBoxNameboxWidthMutation,\n\tISetTextBoxNameboxStrokeMutation,\n\tISetTextBoxDeriveCustomColorMutation,\n\tISplitTextbox,\n} from '@/store/objectTypes/textbox';\nimport Toggle from '@/components/toggle.vue';\nimport { State } from 'vuex-class-decorator';\nimport { IHistorySupport } from '@/plugins/vuex-history';\nimport PositionAndSize from '@/components/toolbox/commonsFieldsets/positionAndSize.vue';\nimport Layers from '@/components/toolbox/commonsFieldsets/layers.vue';\nimport Opacity from '@/components/toolbox/commonsFieldsets/opacity.vue';\nimport Delete from '@/components/toolbox/commonsFieldsets/delete.vue';\nimport { ISetObjectFlipMutation } from '@/store/objects';\nimport { PanelMixin } from './panelMixin';\nimport { Store } from 'vuex';\nimport { IRootState } from '../../../store';\n\n@Component({\n\tcomponents: {\n\t\tToggle,\n\t\tPositionAndSize,\n\t\tLayers,\n\t\tOpacity,\n\t\tDelete,\n\t},\n})\nexport default class TextPanel extends Mixins(PanelMixin) {\n\tpublic $store!: Store<IRootState>;\n\n\tprivate get textbox(): ITextBox {\n\t\tconst obj = this.$store.state.objects.objects[\n\t\t\tthis.$store.state.ui.selection!\n\t\t];\n\t\tif (obj.type !== 'textBox') return undefined!;\n\t\treturn obj as ITextBox;\n\t}\n\n\tprivate get history(): IHistorySupport {\n\t\treturn this.$root as any;\n\t}\n\n\tprivate splitTextbox(): void {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/splitTextbox', {\n\t\t\t\tid: this.textbox.id,\n\t\t\t} as ISplitTextbox);\n\t\t});\n\t}\n\n\tprivate get talkingDefaults(): ISetTextBoxTalkingDefaultMutation['talkingDefault'] {\n\t\treturn this.textbox.talkingDefault;\n\t}\n\n\tprivate set talkingDefaults(\n\t\ttalkingDefault: ISetTextBoxTalkingDefaultMutation['talkingDefault']\n\t) {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.commit('objects/setTalkingDefault', {\n\t\t\t\tid: this.textbox.id,\n\t\t\t\ttalkingDefault,\n\t\t\t} as ISetTextBoxTalkingDefaultMutation);\n\t\t});\n\t}\n\n\tprivate get talkingOther(): string {\n\t\treturn this.textbox.talkingOther;\n\t}\n\n\tprivate set talkingOther(talkingOther: string) {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.commit('objects/setTalkingOther', {\n\t\t\t\tid: this.textbox.id,\n\t\t\t\ttalkingOther,\n\t\t\t} as ISetTextBoxTalkingOtherMutation);\n\t\t});\n\t}\n\n\tprivate get showControls(): boolean {\n\t\treturn this.textbox.controls;\n\t}\n\n\tprivate set showControls(controls: boolean) {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.commit('objects/setControlsVisible', {\n\t\t\t\tid: this.textbox.id,\n\t\t\t\tcontrols,\n\t\t\t} as ISetTextBoxControlsVisibleMutation);\n\t\t});\n\t}\n\n\tprivate get allowSkipping(): boolean {\n\t\treturn this.textbox.controls;\n\t}\n\n\tprivate set allowSkipping(skip: boolean) {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.commit('objects/setSkipable', {\n\t\t\t\tid: this.textbox.id,\n\t\t\t\tskip,\n\t\t\t} as ISetTextBoxControlsSkipMutation);\n\t\t});\n\t}\n\n\tprivate get showContinueArrow(): boolean {\n\t\treturn this.textbox.continue;\n\t}\n\n\tprivate set showContinueArrow(value: boolean) {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.commit('objects/setContinueArrow', {\n\t\t\t\tid: this.textbox.id,\n\t\t\t\tcontinue: value,\n\t\t\t} as ISetTextBoxControlsContinueMutation);\n\t\t});\n\t}\n\n\tprivate get dialog(): string {\n\t\treturn this.textbox.text;\n\t}\n\n\tprivate set dialog(text: string) {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.commit('objects/setText', {\n\t\t\t\tid: this.textbox.id,\n\t\t\t\ttext,\n\t\t\t} as ISetTextBoxTextMutation);\n\t\t});\n\t}\n\n\tprivate get flip(): boolean {\n\t\treturn this.textbox.flip;\n\t}\n\n\tprivate set flip(flip: boolean) {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.commit('objects/setFlip', {\n\t\t\t\tid: this.textbox.id,\n\t\t\t\tflip,\n\t\t\t} as ISetObjectFlipMutation);\n\t\t});\n\t}\n\n\tprivate get textBoxStyle(): ITextBox['style'] {\n\t\treturn this.textbox.style;\n\t}\n\n\tprivate set textBoxStyle(style: ITextBox['style']) {\n\t\tthis.$store.dispatch('objects/setStyle', {\n\t\t\tid: this.textbox.id,\n\t\t\tstyle,\n\t\t} as ISetTextBoxStyleAction);\n\t}\n\n\tprivate get textboxColor(): string {\n\t\treturn this.textbox.customColor;\n\t}\n\n\tprivate set textboxColor(color: string) {\n\t\tthis.$store.commit('objects/setCustomColor', {\n\t\t\tid: this.textbox.id,\n\t\t\tcolor,\n\t\t} as ISetTextBoxCustomColorMutation);\n\t}\n\n\tprivate get deriveCustomColors(): boolean {\n\t\treturn this.textbox.deriveCustomColors;\n\t}\n\n\tprivate set deriveCustomColors(deriveCustomColors: boolean) {\n\t\tthis.$store.commit('objects/setDeriveCustomColors', {\n\t\t\tid: this.textbox.id,\n\t\t\tderiveCustomColors,\n\t\t} as ISetTextBoxDeriveCustomColorMutation);\n\t}\n\n\tprivate get customControlsColor(): string {\n\t\treturn this.textbox.customControlsColor;\n\t}\n\n\tprivate set customControlsColor(customControlsColor: string) {\n\t\tthis.$store.commit('objects/setControlsColor', {\n\t\t\tid: this.textbox.id,\n\t\t\tcustomControlsColor,\n\t\t} as ISetTextBoxCustomControlsColorMutation);\n\t}\n\n\tprivate get customNameboxColor(): string {\n\t\treturn this.textbox.customNameboxColor;\n\t}\n\n\tprivate set customNameboxColor(customNameboxColor: string) {\n\t\tthis.$store.commit('objects/setNameboxColor', {\n\t\t\tid: this.textbox.id,\n\t\t\tcustomNameboxColor,\n\t\t} as ISetTextBoxNameboxColorMutation);\n\t}\n\n\tprivate get customNameboxWidth(): number {\n\t\treturn this.textbox.customNameboxWidth;\n\t}\n\n\tprivate set customNameboxWidth(customNameboxWidth: number) {\n\t\tthis.$store.commit('objects/setNameboxWidth', {\n\t\t\tid: this.textbox.id,\n\t\t\tcustomNameboxWidth,\n\t\t} as ISetTextBoxNameboxWidthMutation);\n\t}\n\n\tprivate get customNameboxStroke(): string {\n\t\treturn this.textbox.customNameboxStroke;\n\t}\n\n\tprivate set customNameboxStroke(customNameboxStroke: string) {\n\t\tthis.$store.commit('objects/setNameboxStroke', {\n\t\t\tid: this.textbox.id,\n\t\t\tcustomNameboxStroke,\n\t\t} as ISetTextBoxNameboxStrokeMutation);\n\t}\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./textbox.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./textbox.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./textbox.vue?vue&type=template&id=63f5df46&scoped=true&\"\nimport script from \"./textbox.vue?vue&type=script&lang=ts&\"\nexport * from \"./textbox.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./textbox.vue?vue&type=style&index=0&id=63f5df46&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"63f5df46\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"panel\"},[_c('h1',[_vm._v(\"Credits\")]),_c('p',[_vm._v(\"\\n\\t\\tAll assets used are IP of Team Salvato and created by them, unless noted\\n\\t\\totherwise.\\n\\t\")]),_c('p',[_vm._v(\"\\n\\t\\tUnused House Background by\\n\\t\\t\"),_c('a',{attrs:{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.deviantart.com/fatelogic/art/VN-Background-Practice-295671161\"}},[_vm._v(\"Fatelogic\")])]),_c('p',[_vm._v(\"\\n\\t\\tDoki Doki Dialog Generator developed by EDave64\\n\\t\\t\"),_c('br'),_vm._v(\"Based on gemdude46's DDLC Shitpost generator\\n\\t\")]),_c('p',[_vm._v(\"\\n\\t\\tMC Classic Sprite by Childish-N\\n\\t\\t\"),_c('br'),_vm._v(\"MC Classic Chibi by GyleToTheRescue\\n\\t\")]),_c('p',[_vm._v(\"\\n\\t\\tMC Sprite by Childish-N\\n\\t\\t\"),_c('br'),_vm._v(\"MC Casual Sprite by SlightlySimple\\n\\t\\t\"),_c('br'),_vm._v(\"MC Chibi by SlightlySimple\\n\\t\")]),_c('p',[_vm._v(\"\\n\\t\\tMC Chad Sprite by Cylent-Nite\\n\\t\\t\"),_c('br'),_vm._v(\"MC Chad Poses and expressions by SlightlySimple\\n\\t\\t\"),_c('br'),_vm._v(\"MC Chad Poses\\n\\t\\tand chibi by Meddy-sin\\n\\t\")]),_c('p',[_vm._v(\"\\n\\t\\tFeMC Sprite by Meddy-sin\\n\\t\\t\"),_c('br'),_vm._v(\"FeMC Casual Sprite by SlightlySimple\\n\\t\")]),_c('p',[_vm._v(\"Classic Amy Sprite by Meddy-sin\")]),_c('p',[_vm._v(\"Amy Sprite by Meddy-sin and SlightlySimple\")]),_c('p',[_vm._v(\"Special thanks to SlightlySimple for testing and technical help\")])])}]\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop, Mixins } from 'vue-property-decorator';\nimport { PanelMixin } from './panelMixin';\n\n@Component({\n\tcomponents: {},\n})\nexport default class AddPanel extends Mixins(PanelMixin) {}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./credits.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./credits.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./credits.vue?vue&type=template&id=72cb4a6e&scoped=true&\"\nimport script from \"./credits.vue?vue&type=script&lang=ts&\"\nexport * from \"./credits.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./credits.vue?vue&type=style&index=0&id=72cb4a6e&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"72cb4a6e\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"panel\"},[_c('h1',[_vm._v(\"Background\")]),_c('background-settings',{attrs:{\"value\":_vm.value}}),_vm._l((_vm.backgrounds),function(background){return _c('background-button',{key:background,attrs:{\"background\":background},on:{\"input\":function($event){return _vm.setBackground(background)}}})}),_c('div',{staticClass:\"btn upload-background\",on:{\"click\":function($event){return _vm.$refs.upload.click()}}},[_vm._v(\"\\n\\t\\tUpload\\n\\t\\t\"),_c('input',{ref:\"upload\",attrs:{\"type\":\"file\"},on:{\"change\":_vm.onFileUpload}})])],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{background: true, active: _vm.isActive},style:(_vm.style),attrs:{\"title\":_vm.background.name},on:{\"click\":function($event){return _vm.$emit('input', _vm.background)}}},[_vm._v(_vm._s(_vm.title))])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop, Watch } from 'vue-property-decorator';\nimport { color } from '@/models/background';\nimport { VariantBackground } from '@/models/variant-background';\nimport { isWebPSupported, getAAsset } from '@/asset-manager';\nimport { Background } from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\nimport { IAsset } from '@/store/content';\nimport { ErrorAsset } from '../../../../models/error-asset';\nimport { Store } from 'vuex';\nimport { IRootState } from '../../../../store';\n\n@Component({\n\tcomponents: {},\n})\nexport default class BackgroundButton extends Vue {\n\tpublic $store!: Store<IRootState>;\n\t@Prop({ required: true }) private readonly background!: string;\n\n\tprivate isWebPSupported: boolean | null = null;\n\tprivate assets: Array<HTMLImageElement | ErrorAsset> = [];\n\n\tprivate get bgData(): Background<IAsset> | null {\n\t\tconst backgrounds: Map<\n\t\t\tBackground<IAsset>['label'],\n\t\t\tBackground<IAsset>\n\t\t> = this.$store.getters['content/getBackgrounds'];\n\t\treturn backgrounds.get(this.background) || null;\n\t}\n\n\tprivate get isActive(): boolean {\n\t\treturn this.background === this.$store.state.background.current;\n\t}\n\n\tprivate async created() {\n\t\tif (this.bgData) {\n\t\t\tthis.assets = await Promise.all(\n\t\t\t\tthis.bgData.variants[0].map(asset => getAAsset(asset, false))\n\t\t\t);\n\t\t}\n\t}\n\n\tprivate get title(): string {\n\t\tswitch (this.background) {\n\t\t\tcase 'buildin.static-color':\n\t\t\t\treturn 'Static color';\n\t\t\tcase 'buildin.transparent':\n\t\t\t\treturn 'Transparent';\n\t\t}\n\t\treturn this.bgData!.label;\n\t}\n\n\tprivate get style(): { [id: string]: string } {\n\t\tswitch (this.background) {\n\t\t\tcase 'buildin.static-color':\n\t\t\t\treturn {\n\t\t\t\t\t'background-color': this.$store.state.background.color,\n\t\t\t\t};\n\t\t\tcase 'buildin.transparent':\n\t\t\t\treturn {};\n\t\t}\n\t\tconst variant = this.bgData!.variants[0];\n\t\tconst urls = (this.assets.filter(\n\t\t\timg => img instanceof HTMLImageElement\n\t\t) as HTMLImageElement[])\n\t\t\t.map(img => `url('${img.src}')`)\n\t\t\t.join(',');\n\t\treturn {\n\t\t\tbackgroundImage: urls,\n\t\t};\n\t}\n}\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./button.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./button.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./button.vue?vue&type=template&id=b81baf32&scoped=true&\"\nimport script from \"./button.vue?vue&type=script&lang=ts&\"\nexport * from \"./button.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./button.vue?vue&type=style&index=0&id=b81baf32&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"b81baf32\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('fieldset',[_c('legend',[_vm._v(\"Settings:\")]),(_vm.isColor)?[_c('label',{attrs:{\"for\":\"bg_color\"}},[_vm._v(\"Color:\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.color),expression:\"color\"}],attrs:{\"id\":\"bg_color\",\"type\":\"color\"},domProps:{\"value\":(_vm.color)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.color=$event.target.value}}})]:_vm._e(),(_vm.isVariant)?[_c('table',[_c('tr',[_c('td',{attrs:{\"colspan\":\"3\"}},[_c('toggle',{attrs:{\"label\":\"Flipped?\"},model:{value:(_vm.flipped),callback:function ($$v) {_vm.flipped=$$v},expression:\"flipped\"}})],1)]),(_vm.hasVariants)?_c('tr',[_c('td',[_c('button',{on:{\"click\":function($event){return _vm.seekVariant(-1)}}},[_vm._v(\"<\")])]),_c('td',[_vm._v(\"Variant\")]),_c('td',[_c('button',{on:{\"click\":function($event){return _vm.seekVariant(1)}}},[_vm._v(\">\")])])]):_vm._e()])]:_vm._e()],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop, Watch } from 'vue-property-decorator';\nimport { VariantBackground } from '@/models/variant-background';\nimport { isWebPSupported } from '@/asset-manager';\nimport Toggle from '@/components/toggle.vue';\nimport { State } from 'vuex-class-decorator';\nimport { Background } from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\nimport { Store } from 'vuex';\nimport { IRootState } from '@/store';\nimport { IAsset } from '@/store/content';\nimport { IHistorySupport } from '@/plugins/vuex-history';\nimport {\n\tISetColorMutation,\n\tISetFlipMutation,\n\tISeekVariantAction,\n} from '@/store/background';\n\n@Component({\n\tcomponents: { Toggle },\n})\nexport default class BackgroundSettings extends Vue {\n\tpublic $store!: Store<IRootState>;\n\t@State('current', { namespace: 'background' })\n\tprivate currentBackgroundId!: string;\n\n\tprivate get history(): IHistorySupport {\n\t\treturn this.$root as any;\n\t}\n\n\tprivate get bgData(): Background<IAsset> | null {\n\t\treturn (\n\t\t\tthis.$store.state.content.current.backgrounds.find(\n\t\t\t\tbackground => background.label === this.currentBackgroundId\n\t\t\t) || null\n\t\t);\n\t}\n\n\tprivate get isColor(): boolean {\n\t\treturn this.currentBackgroundId === 'buildin.static-color';\n\t}\n\n\tprivate get color(): string {\n\t\treturn this.$store.state.background.color;\n\t}\n\n\tprivate set color(color: string) {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.commit('background/setColor', {\n\t\t\t\tcolor,\n\t\t\t} as ISetColorMutation);\n\t\t});\n\t}\n\n\tprivate get flipped(): boolean {\n\t\treturn this.$store.state.background.flipped;\n\t}\n\n\tprivate set flipped(flipped: boolean) {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.commit('background/setFlipped', {\n\t\t\t\tflipped,\n\t\t\t} as ISetFlipMutation);\n\t\t});\n\t}\n\n\tprivate get isVariant() {\n\t\treturn !!this.bgData;\n\t}\n\n\tprivate get hasVariants() {\n\t\treturn this.bgData ? this.bgData.variants.length > 1 : false;\n\t}\n\n\tprivate seekVariant(delta: 1 | -1) {\n\t\tthis.history.transaction(() => {\n\t\t\tthis.$store.dispatch('background/seekVariant', {\n\t\t\t\tdelta,\n\t\t\t} as ISeekVariantAction);\n\t\t});\n\t}\n}\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./settings.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./settings.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./settings.vue?vue&type=template&id=264bc145&scoped=true&\"\nimport script from \"./settings.vue?vue&type=script&lang=ts&\"\nexport * from \"./settings.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./settings.vue?vue&type=style&index=0&id=264bc145&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"264bc145\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop, Mixins } from 'vue-property-decorator';\nimport { registerAsset, getAsset } from '@/asset-manager';\nimport { IBackground, color } from '@/models/background';\nimport { VariantBackground } from '@/models/variant-background';\nimport BackgroundButton from './background/button.vue';\nimport BackgroundSettings from './background/settings.vue';\nimport { State } from 'vuex-class-decorator';\nimport { Store } from 'vuex';\nimport { IRootState } from '../../../store';\nimport { IAsset, IReplaceContentPackAction } from '../../../store/content';\nimport {\n\tBackground,\n\tContentPack,\n} from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\nimport { ISetCurrentMutation } from '../../../store/background';\nimport { PanelMixin } from './panelMixin';\n\n@Component({\n\tcomponents: {\n\t\tBackgroundButton,\n\t\tBackgroundSettings,\n\t},\n})\nexport default class BackgroundsPanel extends Mixins(PanelMixin) {\n\tpublic $store!: Store<IRootState>;\n\n\t@Prop({ required: true }) private readonly value!: IBackground;\n\n\tprivate uploadedBackgroundsPack: ContentPack<string> = {\n\t\tpackId: 'buildin.uploadedBackgrounds',\n\t\tpackCredits: '',\n\t\tcharacters: [],\n\t\tfonts: [],\n\t\tsprites: [],\n\t\tpoemStyles: [],\n\t\tbackgrounds: [],\n\t};\n\tprivate customPathLookup: { [name: string]: string } = {};\n\tprivate customBGCount = 0;\n\n\tprivate get backgrounds(): string[] {\n\t\treturn [\n\t\t\t...this.$store.state.content.current.backgrounds.map(\n\t\t\t\tbackground => background.label\n\t\t\t),\n\t\t\t'buildin.static-color',\n\t\t\t'buildin.transparent',\n\t\t];\n\t}\n\n\tprivate setBackground(id: string) {\n\t\tthis.$store.commit('background/setCurrent', {\n\t\t\tcurrent: id,\n\t\t} as ISetCurrentMutation);\n\t}\n\n\tprivate onFileUpload(e: Event) {\n\t\tconst uploadInput = this.$refs.upload as HTMLInputElement;\n\t\tif (!uploadInput.files) return;\n\t\tfor (const file of uploadInput.files) {\n\t\t\t(nr => {\n\t\t\t\tconst name = 'customBg' + nr;\n\t\t\t\tconst url = registerAsset(name, file);\n\t\t\t\tthis.uploadedBackgroundsPack.backgrounds.push({\n\t\t\t\t\tlabel: '',\n\t\t\t\t\tvariants: [[url]],\n\t\t\t\t});\n\t\t\t\tthis.$store.dispatch('content/replaceContentPack', {\n\t\t\t\t\tcontentPack: this.uploadedBackgroundsPack,\n\t\t\t\t} as IReplaceContentPackAction);\n\t\t\t\t// backgrounds.push(new Background(name, file.name, true));\n\t\t\t\tthis.$set(this.customPathLookup, name, url);\n\t\t\t})(++this.customBGCount);\n\t\t}\n\t}\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./backgrounds.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./backgrounds.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./backgrounds.vue?vue&type=template&id=62b25c75&scoped=true&\"\nimport script from \"./backgrounds.vue?vue&type=script&lang=ts&\"\nexport * from \"./backgrounds.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./backgrounds.vue?vue&type=style&index=0&id=62b25c75&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"62b25c75\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"panel\"},[_c('h1',[_vm._v(\"Content Packs\")]),_c('button',{on:{\"click\":_vm.addNew}},[_vm._v(\"Add new Pack\")]),_c('fieldset',[_c('legend',[_vm._v(\"Installed Packs:\")]),_c('div',{staticClass:\"list\"},_vm._l((_vm.packs),function(pack){return _c('div',{key:pack.name,class:{ active: pack.name === _vm.name },on:{\"click\":function($event){return _vm.select(pack.name)}}},[_vm._v(_vm._s(pack.name))])}),0)]),_c('label',{attrs:{\"for\":\"pack_name\"}},[_vm._v(\"Name:\")]),_c('input',{attrs:{\"id\":\"pack_name\",\"readonly\":\"\"},domProps:{\"value\":_vm.name}}),_c('label',{attrs:{\"for\":\"pack_credits\"}},[_vm._v(\"Credits:\")]),_c('div',{attrs:{\"id\":\"pack_credits\"},domProps:{\"innerHTML\":_vm._s(_vm.credits)}}),(_vm.activatable)?_c('button',{on:{\"click\":_vm.activate}},[_vm._v(\"Activate\")]):_vm._e(),(_vm.deactivatable)?_c('button',{on:{\"click\":_vm.deactivate}},[_vm._v(\"Deactivate\")]):_vm._e(),(_vm.installable)?_c('button',{on:{\"click\":_vm.install}},[_vm._v(\"Install\")]):_vm._e(),(_vm.uninstallable)?_c('button',{on:{\"click\":_vm.uninstall}},[_vm._v(\"Uninstall\")]):_vm._e(),(_vm.needRestart)?_c('div',[_vm._v(\"\\n\\t\\tThe tool need restart for changes to take effect.\\n\\t\\t\"),_c('button',{on:{\"click\":_vm.restart}},[_vm._v(\"Restart Now\")])]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","const allowedTags = [\r\n\t'h3',\r\n\t'h4',\r\n\t'h5',\r\n\t'h6',\r\n\t'blockquote',\r\n\t'p',\r\n\t'a',\r\n\t'ul',\r\n\t'ol',\r\n\t'nl',\r\n\t'li',\r\n\t'b',\r\n\t'i',\r\n\t'strong',\r\n\t'em',\r\n\t'strike',\r\n\t'code',\r\n\t'hr',\r\n\t'br',\r\n\t'div',\r\n\t'table',\r\n\t'thead',\r\n\t'caption',\r\n\t'tbody',\r\n\t'tr',\r\n\t'th',\r\n\t'td',\r\n\t'pre',\r\n];\r\nconst allowedAttributes: { [tagName: string]: string[] | undefined } = {\r\n\ta: ['href'],\r\n\timg: ['src'],\r\n};\r\nconst schemaLimitedAttributes = ['href', 'src'];\r\nconst allowedSchemas = ['http', 'https'];\r\nconst enforceAttributes: {\r\n\t[tagName: string]: { [attr: string]: string } | undefined;\r\n} = {\r\n\ta: {\r\n\t\ttarget: '_blank',\r\n\t\trel: 'noopener noreferrer',\r\n\t},\r\n};\r\n\r\nexport function sanitize(html: string) {\r\n\tconst retDoc = document.createElement('div');\r\n\tconst doc = document.createElement('div');\r\n\tdoc.innerHTML = html;\r\n\r\n\tfor (const node of Array.from(doc.childNodes)) {\r\n\t\tfor (const sanitizedNode of sanitizeElement(node as Element)) {\r\n\t\t\tretDoc.appendChild(sanitizedNode);\r\n\t\t}\r\n\t}\r\n\r\n\treturn retDoc.innerHTML;\r\n}\r\n\r\nconst protocolMatcher = /^(\\w+):/;\r\n\r\nfunction sanitizeElement(node: Node): Node[] {\r\n\tif (node.nodeType !== Node.ELEMENT_NODE) return [node];\r\n\tconst el = node as Element;\r\n\tlet ret: Node[] = [];\r\n\tconst tagName = el.tagName.toLowerCase();\r\n\tif (allowedTags.includes(tagName)) {\r\n\t\tret.push(el);\r\n\t\tconst attrs: Attr[] = Array.prototype.slice.call(el.attributes);\r\n\t\tconst allowedAttrs = allowedAttributes[tagName] || [];\r\n\t\tfor (const attr of attrs) {\r\n\t\t\tif (!allowedAttrs.includes(attr.name)) {\r\n\t\t\t\tel.removeAttribute(attr.name);\r\n\t\t\t} else if (schemaLimitedAttributes.includes(attr.name)) {\r\n\t\t\t\tconst protocolMatch = attr.value.match(protocolMatcher);\r\n\t\t\t\tif (protocolMatch && !allowedSchemas.includes(protocolMatch[1])) {\r\n\t\t\t\t\tel.removeAttribute(attr.name);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst enforce = enforceAttributes[tagName];\r\n\t\tif (enforce) {\r\n\t\t\tfor (const attrName in enforce) {\r\n\t\t\t\tif (!enforce.hasOwnProperty(attrName)) continue;\r\n\t\t\t\tel.setAttribute(attrName, enforce[attrName]);\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\tret.push(document.createTextNode(`<${tagName}>`));\r\n\t\tfor (const subNode of el.childNodes) {\r\n\t\t\tret = ret.concat(sanitizeElement(subNode));\r\n\t\t}\r\n\t\tret.push(document.createTextNode(`</${tagName}>`));\r\n\t}\r\n\treturn ret;\r\n}\r\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop, Mixins } from 'vue-property-decorator';\r\nimport { PanelMixin } from './panelMixin';\r\nimport environment from '../../../environments/environment';\r\nimport { ContentPack } from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\r\nimport { sanitize } from './character-pack-sanitizer';\r\nimport { Store } from 'vuex';\r\nimport { IRootState } from '../../../store';\r\n\r\ninterface IPack {\r\n\tname: string;\r\n\tcredits: string;\r\n\tinstalled: boolean;\r\n\tqueuedUninstall: boolean;\r\n\tactive: boolean;\r\n\tfreshInstall: boolean;\r\n\turl: string;\r\n}\r\n\r\n@Component({\r\n\tcomponents: {},\r\n})\r\nexport default class CharacterPackPanel extends Mixins(PanelMixin) {\r\n\tpublic $store!: Store<IRootState>;\r\n\tprivate selectedPack: IPack | null = null;\r\n\tprivate needRestart = false;\r\n\r\n\tprivate created() {\r\n\t\tconst packs = environment.installedCharacterPacks;\r\n\t\tconsole.log('packs:', packs);\r\n\t}\r\n\r\n\tprivate get packs(): IPack[] {\r\n\t\tconst packs = this.$store.state.content.contentPacks;\r\n\t\treturn packs.map(\r\n\t\t\tpack =>\r\n\t\t\t\t({\r\n\t\t\t\t\tname: pack.packId,\r\n\t\t\t\t\tcredits: pack.packCredits,\r\n\t\t\t\t\tinstalled: true,\r\n\t\t\t\t\tactive: true,\r\n\t\t\t\t\tqueuedUninstall: false,\r\n\t\t\t\t\tfreshInstall: false,\r\n\t\t\t\t\turl: '',\r\n\t\t\t\t} as IPack)\r\n\t\t);\r\n\t}\r\n\r\n\tprivate select(name: string) {\r\n\t\tthis.selectedPack = this.packs.find(pack => pack.name === name) || null;\r\n\t}\r\n\r\n\tprivate async addNew() {\r\n\t\tconst url = await environment.prompt(\r\n\t\t\t'Enter the URL of the character pack:'\r\n\t\t);\r\n\t\tif (!url) return;\r\n\t\tawait this.$store.dispatch('content/loadContentPacks', url);\r\n\t}\r\n\r\n\tprivate restart() {\r\n\t\tlocation.reload(true);\r\n\t}\r\n\r\n\tprivate get name(): string {\r\n\t\tif (!this.selectedPack) return '';\r\n\t\treturn this.selectedPack.name;\r\n\t}\r\n\tprivate get credits(): string {\r\n\t\tif (!this.selectedPack) return '';\r\n\t\treturn sanitize(this.selectedPack.credits || '');\r\n\t}\r\n\tprivate get activatable(): boolean {\r\n\t\tif (!environment.isPackInstallingSupported) return false;\r\n\t\tif (!this.selectedPack) return false;\r\n\t\tif (!this.selectedPack.installed) return false;\r\n\t\tif (this.selectedPack.queuedUninstall) return false;\r\n\t\tif (this.selectedPack.freshInstall) return false;\r\n\t\treturn !this.selectedPack.active;\r\n\t}\r\n\tprivate get deactivatable(): boolean {\r\n\t\tif (!environment.isPackInstallingSupported) return false;\r\n\t\tif (!this.selectedPack) return false;\r\n\t\tif (!this.selectedPack.installed) return false;\r\n\t\tif (this.selectedPack.queuedUninstall) return false;\r\n\t\tif (this.selectedPack.freshInstall) return false;\r\n\t\treturn this.selectedPack.active;\r\n\t}\r\n\tprivate get installable(): boolean {\r\n\t\tif (!environment.isPackInstallingSupported) return false;\r\n\t\tif (!this.selectedPack) return false;\r\n\t\treturn this.selectedPack.queuedUninstall || !this.selectedPack.installed;\r\n\t}\r\n\tprivate get uninstallable(): boolean {\r\n\t\tif (!environment.isPackInstallingSupported) return false;\r\n\t\tif (!this.selectedPack) return false;\r\n\t\tif (this.selectedPack.freshInstall) return false;\r\n\t\treturn !(this.selectedPack.queuedUninstall || !this.selectedPack.installed);\r\n\t}\r\n\r\n\tprivate install(): void {\r\n\t\tif (!this.selectedPack) return;\r\n\t\tenvironment.installContentPack(this.selectedPack.url);\r\n\t\tif (this.selectedPack.queuedUninstall) {\r\n\t\t\tthis.selectedPack.queuedUninstall = false;\r\n\t\t} else {\r\n\t\t\tthis.selectedPack.installed = true;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate uninstall(): void {\r\n\t\tif (!this.selectedPack) return;\r\n\t\tenvironment.uninstallContentPack(this.selectedPack.url);\r\n\t\tthis.selectedPack.queuedUninstall = true;\r\n\t\tthis.needRestart = true;\r\n\t}\r\n\r\n\tprivate activate(): void {\r\n\t\tif (!this.selectedPack) return;\r\n\t\tenvironment.activateContentPack(this.selectedPack.url);\r\n\t\tthis.selectedPack.active = true;\r\n\t\tthis.needRestart = true;\r\n\t}\r\n\r\n\tprivate deactivate(): void {\r\n\t\tif (!this.selectedPack) return;\r\n\t\tenvironment.deactivateContentPack(this.selectedPack.url);\r\n\t\tthis.selectedPack.active = false;\r\n\t\tthis.needRestart = true;\r\n\t}\r\n}\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./content-pack.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./content-pack.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./content-pack.vue?vue&type=template&id=74799c18&scoped=true&\"\nimport script from \"./content-pack.vue?vue&type=script&lang=ts&\"\nexport * from \"./content-pack.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./content-pack.vue?vue&type=style&index=0&id=74799c18&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"74799c18\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// App.vue has currently so many responsiblities that it's best to break it into chunks\n// tslint:disable:member-ordering\nimport { Component, Vue, Watch, Prop } from 'vue-property-decorator';\nimport { State } from 'vuex-class-decorator';\n\nimport GeneralPanel from './panels/general.vue';\nimport AddPanel from './panels/add.vue';\nimport CharacterPanel from './panels/character.vue';\nimport SpritePanel from './panels/sprite.vue';\nimport TextBoxPanel from './panels/textbox.vue';\nimport CreditsPanel from './panels/credits.vue';\nimport BackgroundsPanel from './panels/backgrounds.vue';\nimport ContentPacksPanel from './panels/content-pack.vue';\nimport { IObject } from '@/store/objects';\nimport { IBackground } from '@/models/background';\nimport { Store } from 'vuex';\nimport { IRootState } from '@/store';\nimport environment from '@/environments/environment';\n\ntype PanelNames =\n\t| 'add'\n\t| 'backgrounds'\n\t| 'credits'\n\t| 'selection'\n\t| 'content-packs'\n\t| '';\n\n@Component({\n\tcomponents: {\n\t\tGeneralPanel,\n\t\tAddPanel,\n\t\tBackgroundsPanel,\n\t\tCreditsPanel,\n\t\tCharacterPanel,\n\t\tTextBoxPanel,\n\t\tSpritePanel,\n\t\tContentPacksPanel,\n\t},\n})\nexport default class ToolBox extends Vue {\n\tpublic $store!: Store<IRootState>;\n\n\t@State('vertical', { namespace: 'ui' }) private readonly vertical!: boolean;\n\n\tprivate create() {\n\t\tenvironment.onPanelChange((panel: string) => {\n\t\t\tthis.panelSelection = panel as PanelNames;\n\t\t});\n\t}\n\n\tprivate get selection(): string | null {\n\t\treturn this.$store.state.ui.selection;\n\t}\n\n\tprivate panelSelection: PanelNames = '';\n\n\tprivate get panel() {\n\t\tif (this.panelSelection === 'selection') {\n\t\t\tif (this.selection === null) {\n\t\t\t\tthis.panelSelection = '';\n\t\t\t} else {\n\t\t\t\tconst obj = this.$store.state.objects.objects[this.selection];\n\t\t\t\treturn obj.type;\n\t\t\t}\n\t\t}\n\t\treturn this.panelSelection;\n\t}\n\n\tprivate setPanel(name: PanelNames) {\n\t\tif (name === this.panelSelection) name = '';\n\t\tthis.panelSelection = name;\n\t\tif (this.selection) {\n\t\t\tthis.$store.commit('ui/setSelection', null);\n\t\t}\n\t}\n\n\t@Watch('selection')\n\tprivate onSelectionChange(newSelection: IObject | null) {\n\t\tif (newSelection) {\n\t\t\tthis.panelSelection = 'selection';\n\t\t\treturn;\n\t\t}\n\t\tif (this.panelSelection === 'selection') {\n\t\t\tthis.panelSelection = '';\n\t\t}\n\t}\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./toolbox.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./toolbox.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./toolbox.vue?vue&type=template&id=9787d770&\"\nimport script from \"./toolbox.vue?vue&type=script&lang=ts&\"\nexport * from \"./toolbox.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./toolbox.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{ vertical: _vm.vertical },attrs:{\"id\":\"messageConsole\"}},[(_vm.showLoading)?_c('p',[_vm._v(\"Loading...\")]):_vm._e(),_vm._l((_vm.messages),function(message,i){return _c('p',{key:message + '_' + i},[_vm._v(_vm._s(message))])})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\nimport { Component, Vue, Prop, Watch } from 'vue-property-decorator';\nimport { State } from 'vuex-class-decorator';\nimport EventBus, {\n\tAssetFailureEvent,\n\tCustomAssetFailureEvent,\n} from '@/eventbus/event-bus';\n\n@Component({\n\tcomponents: {},\n})\nexport default class MessageConsole extends Vue {\n\t@Prop({ required: true, type: Boolean }) private readonly loading!: boolean;\n\n\t@State('vertical', { namespace: 'ui' }) private readonly vertical!: boolean;\n\tprivate messages: string[] = [];\n\tprivate showLoading: boolean = false;\n\tprivate showLoadingTimeout: number = 0;\n\tprivate hideLoadingTimeout: number = 0;\n\n\tprivate created() {\n\t\tthis.onLoadingChange(this.loading);\n\t\tEventBus.subscribe(AssetFailureEvent, ev => {\n\t\t\tthis.messages.push(`Failed to load asset '${ev.path}'`);\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.messages.pop();\n\t\t\t}, 5000);\n\t\t});\n\n\t\tEventBus.subscribe(CustomAssetFailureEvent, ev => {\n\t\t\tthis.messages.push(\n\t\t\t\t'Failed to load custom asset. Try to download it manually and then upload it.'\n\t\t\t);\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.messages.pop();\n\t\t\t}, 50000);\n\t\t});\n\t}\n\n\t@Watch('loading')\n\tprivate onLoadingChange(newValue: boolean) {\n\t\tif (newValue) {\n\t\t\tif (this.hideLoadingTimeout) {\n\t\t\t\tclearTimeout(this.hideLoadingTimeout);\n\t\t\t\tthis.hideLoadingTimeout = 0;\n\t\t\t}\n\t\t\tif (!this.showLoading && !this.showLoadingTimeout) {\n\t\t\t\tthis.showLoadingTimeout = setTimeout(() => {\n\t\t\t\t\tthis.showLoading = true;\n\t\t\t\t\tthis.showLoadingTimeout = 0;\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.showLoadingTimeout) {\n\t\t\t\tclearTimeout(this.showLoadingTimeout);\n\t\t\t\tthis.showLoadingTimeout = 0;\n\t\t\t}\n\t\t\tif (this.showLoading && !this.hideLoadingTimeout) {\n\t\t\t\tthis.hideLoadingTimeout = setTimeout(() => {\n\t\t\t\t\tthis.showLoading = false;\n\t\t\t\t\tthis.hideLoadingTimeout = 0;\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t}\n\t}\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./message-console.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./message-console.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./message-console.vue?vue&type=template&id=24b2b581&scoped=true&\"\nimport script from \"./message-console.vue?vue&type=script&lang=ts&\"\nexport * from \"./message-console.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./message-console.vue?vue&type=style&index=0&id=24b2b581&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"24b2b581\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('canvas',{ref:\"sd\",style:({ width: _vm.canvasWidth + 'px', height: _vm.canvasHeight + 'px' }),attrs:{\"id\":\"scaled_display\",\"height\":\"720\",\"width\":\"1280\",\"draggable\":\"\"},on:{\"click\":_vm.onUiClick,\"touchstart\":_vm.onTouchStart,\"dragstart\":_vm.onDragStart,\"touchmove\":_vm.onSpriteDragMove,\"mousemove\":_vm.onSpriteDragMove,\"touchend\":_vm.onSpriteDrop,\"mouseup\":_vm.onSpriteDrop,\"dragover\":_vm.onDragOver,\"drop\":_vm.onDrop,\"mouseenter\":_vm.onMouseEnter}},[_vm._v(\"HTML5 is required to use the Doki Doki Dialog Generator.\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { IBackground } from './background';\r\nimport { RenderContext } from '@/renderer/rendererContext';\r\nimport { getAAsset } from '@/asset-manager';\r\nimport { IAsset } from '@/store/content';\r\n\r\nexport class VariantBackground implements IBackground {\r\n\tpublic constructor(\r\n\t\tpublic readonly name: string,\r\n\t\tpublic readonly variant: IAsset[],\r\n\t\tpublic readonly flip: boolean = false\r\n\t) {}\r\n\r\n\tpublic async render(rx: RenderContext): Promise<void> {\r\n\t\tconst assets = await Promise.all(\r\n\t\t\tthis.variant.map(img => getAAsset(img, rx.hq))\r\n\t\t);\r\n\t\tfor (const asset of assets) {\r\n\t\t\trx.drawImage({ image: asset, x: 0, y: 0, flip: this.flip });\r\n\t\t}\r\n\t}\r\n}\r\n","export class RenderAbortedException {}\n","import { RenderAbortedException } from './renderAbortedException';\nimport { Renderer } from './renderer';\nimport { ErrorAsset } from '@/models/error-asset';\n\nexport class RenderContext {\n\tprivate aborted: boolean = false;\n\n\tpublic constructor(\n\t\tprivate fsCtx: CanvasRenderingContext2D,\n\t\tpublic readonly hq: boolean,\n\t\tpublic readonly preview: boolean\n\t) {}\n\n\tpublic drawText(\n\t\tparams: { text: string; align?: CanvasTextAlign; font?: string } & IRPos &\n\t\t\tIOOutline &\n\t\t\tIOFill\n\t) {\n\t\tif (this.aborted) throw new RenderAbortedException();\n\t\tthis.fsCtx.save();\n\n\t\tconst { font, align, x = 0, y = 0, text = '' } = {\n\t\t\t...{\n\t\t\t\tfont: '20px aller',\n\t\t\t\talign: 'left' as CanvasTextAlign,\n\t\t\t},\n\t\t\t...params,\n\t\t};\n\n\t\tthis.fsCtx.lineJoin = 'round';\n\t\tthis.fsCtx.textAlign = align;\n\t\tthis.fsCtx.font = font;\n\n\t\tif (params.outline) {\n\t\t\tthis.fsCtx.strokeStyle = params.outline.style;\n\t\t\tthis.fsCtx.lineWidth = params.outline.width;\n\t\t\tthis.fsCtx.strokeText(text, x, y);\n\t\t}\n\n\t\tif (params.fill) {\n\t\t\tthis.fsCtx.fillStyle = params.fill.style;\n\t\t\tthis.fsCtx.fillText(text, x, y);\n\t\t}\n\n\t\tthis.fsCtx.restore();\n\t}\n\n\tpublic measureText(\n\t\tparams: {\n\t\t\ttext: string;\n\t\t\talign?: CanvasTextAlign;\n\t\t\tfont?: string;\n\t\t} & IOOutline &\n\t\t\tIOFill\n\t): TextMetrics {\n\t\tif (this.aborted) throw new RenderAbortedException();\n\t\tthis.fsCtx.save();\n\n\t\tconst { font, align, text = '' } = {\n\t\t\t...{\n\t\t\t\tfont: '20px aller',\n\t\t\t\talign: 'left' as CanvasTextAlign,\n\t\t\t},\n\t\t\t...params,\n\t\t};\n\n\t\tthis.fsCtx.lineJoin = 'round';\n\t\tthis.fsCtx.textAlign = align;\n\t\tthis.fsCtx.font = font;\n\n\t\tif (params.outline) {\n\t\t\tthis.fsCtx.strokeStyle = params.outline.style;\n\t\t\tthis.fsCtx.lineWidth = params.outline.width;\n\t\t}\n\n\t\tif (params.fill) {\n\t\t\tthis.fsCtx.fillStyle = params.fill.style;\n\t\t}\n\t\tconst ret = this.fsCtx.measureText(text);\n\t\tthis.fsCtx.restore();\n\t\treturn ret;\n\t}\n\n\tpublic drawImage(\n\t\tparams: {\n\t\t\timage: HTMLImageElement | ErrorAsset | Renderer;\n\t\t\tflip?: boolean;\n\t\t} & IRPos &\n\t\t\tIOSize &\n\t\t\tIOShadow &\n\t\t\tIOOpacity\n\t): void {\n\t\tif (this.aborted) throw new RenderAbortedException();\n\t\tif (params.image instanceof ErrorAsset) return;\n\t\tconst { image, flip, x, y, w, h, opacity } = {\n\t\t\tflip: false,\n\t\t\tw: params.image.width,\n\t\t\th: params.image.height,\n\t\t\topacity: 100,\n\t\t\t...params,\n\t\t};\n\n\t\tthis.fsCtx.save();\n\n\t\tif (opacity < 100) {\n\t\t\tthis.fsCtx.globalAlpha = opacity / 100;\n\t\t}\n\n\t\tif (params.shadow) {\n\t\t\tconst shadow = params.shadow;\n\t\t\tif (shadow.color) {\n\t\t\t\tthis.fsCtx.shadowColor = shadow.color;\n\t\t\t}\n\t\t\tif (shadow.blur) {\n\t\t\t\tthis.fsCtx.shadowBlur = shadow.blur;\n\t\t\t}\n\t\t\tif (shadow.offsetX) {\n\t\t\t\tthis.fsCtx.shadowOffsetX = shadow.offsetX;\n\t\t\t}\n\t\t\tif (shadow.offsetY) {\n\t\t\t\tthis.fsCtx.shadowOffsetY = shadow.offsetY;\n\t\t\t}\n\t\t}\n\n\t\tthis.fsCtx.translate(x + w / 2, y + h / 2);\n\t\tthis.fsCtx.scale(flip ? -1 : 1, 1);\n\n\t\tif (image instanceof Renderer) {\n\t\t\timage.paintOnto(this.fsCtx, -w / 2, -h / 2, w, h);\n\t\t} else {\n\t\t\tthis.fsCtx.drawImage(image as HTMLImageElement, -w / 2, -h / 2, w, h);\n\t\t}\n\n\t\tthis.fsCtx.restore();\n\t}\n\n\tpublic drawRect({\n\t\tx,\n\t\ty,\n\t\tw,\n\t\th,\n\t\toutline,\n\t\tfill,\n\t\tcomposition,\n\t}: IRPos & IRSize & IOOutline & IOFill & IOComposition) {\n\t\tif (this.aborted) throw new RenderAbortedException();\n\t\tthis.fsCtx.save();\n\t\tthis.fsCtx.beginPath();\n\t\tthis.fsCtx.rect(x, y, w, h);\n\n\t\tif (composition) {\n\t\t\tthis.fsCtx.globalCompositeOperation = composition;\n\t\t}\n\n\t\tif (fill) {\n\t\t\tthis.fsCtx.fillStyle = fill.style;\n\t\t\tthis.fsCtx.fill();\n\t\t}\n\t\tif (outline) {\n\t\t\tthis.fsCtx.strokeStyle = outline.style;\n\t\t\tthis.fsCtx.lineWidth = outline.width;\n\t\t\tthis.fsCtx.stroke();\n\t\t}\n\t\tthis.fsCtx.restore();\n\t}\n\n\tpublic drawPath({\n\t\toutline,\n\t\tfill,\n\t\tpath,\n\t}: { path: (ctx: CanvasPath) => void } & IOOutline & IOFill) {\n\t\tif (this.aborted) throw new RenderAbortedException();\n\t\tthis.fsCtx.save();\n\t\tthis.fsCtx.beginPath();\n\t\tpath(this.fsCtx);\n\n\t\tif (fill) {\n\t\t\tthis.fsCtx.fillStyle = fill.style;\n\t\t\tthis.fsCtx.fill();\n\t\t}\n\t\tif (outline) {\n\t\t\tthis.fsCtx.strokeStyle = outline.style;\n\t\t\tthis.fsCtx.lineWidth = outline.width;\n\t\t\tthis.fsCtx.stroke();\n\t\t}\n\t\tthis.fsCtx.restore();\n\t}\n\n\tpublic patternFrom(\n\t\timage: HTMLImageElement | Renderer,\n\t\trepetition: 'repeat' | 'repeat-x' | 'repeat-y' | 'no-repeat' = 'repeat'\n\t): CanvasPattern {\n\t\tif (image instanceof Renderer) {\n\t\t\timage = (image as any).previewCanvas;\n\t\t}\n\t\treturn this.fsCtx.createPattern(\n\t\t\t(image as any) as CanvasImageSource,\n\t\t\trepetition\n\t\t)!;\n\t}\n\n\tpublic customTransform(\n\t\ttransform: (transformContext: CanvasRenderingContext2D) => void,\n\t\trender: (rx: RenderContext) => void\n\t) {\n\t\tthis.fsCtx.save();\n\t\ttransform(this.fsCtx);\n\t\trender(this);\n\t\tthis.fsCtx.restore();\n\t}\n\n\tpublic linearGradient(\n\t\tx0: number,\n\t\ty0: number,\n\t\tx1: number,\n\t\ty1: number\n\t): CanvasGradient {\n\t\treturn this.fsCtx.createLinearGradient(x0, y0, x1, y1);\n\t}\n\n\tpublic abort(): void {\n\t\tthis.aborted = true;\n\t}\n}\n\nconst optSize = { w: 0, h: 0 };\nconst optShadow = {\n\tblur: 0,\n\tcolor: 'none',\n\toffsetX: 0,\n\toffsetY: 0,\n};\n\nexport interface IShadow {\n\tblur?: number;\n\tcolor?: string;\n\toffsetX?: number;\n\toffsetY?: number;\n}\n\nexport interface IOutline {\n\tstyle: string;\n\twidth: number;\n}\n\nexport interface IFill {\n\tstyle: string | CanvasGradient | CanvasPattern;\n}\n\ninterface IOShadow {\n\tshadow?: IShadow;\n}\n\ninterface IOComposition {\n\tcomposition?: CanvasRenderingContext2D['globalCompositeOperation'];\n}\n\ninterface IRPos {\n\tx: number;\n\ty: number;\n}\n\ninterface IRSize {\n\tw: number;\n\th: number;\n}\n\ninterface IOSize {\n\tw?: number;\n\th?: number;\n}\n\ninterface IOOutline {\n\toutline?: IOutline;\n}\ninterface IOOpacity {\n\topacity?: number;\n}\n\ninterface IOFill {\n\tfill?: IFill;\n}\n","import { RenderContext } from './rendererContext';\nimport { RenderAbortedException } from './renderAbortedException';\n\nexport class Renderer {\n\tprivate previewCanvas: HTMLCanvasElement;\n\tprivate runningContext: RenderContext | null = null;\n\n\tpublic constructor(w: number = 1280, h: number = 720) {\n\t\tthis.previewCanvas = document.createElement('canvas');\n\t\tthis.previewCanvas.width = w;\n\t\tthis.previewCanvas.height = h;\n\t}\n\n\tpublic async render(\n\t\trenderCallback: (rc: RenderContext) => Promise<void>,\n\t\thq: boolean = true\n\t): Promise<boolean> {\n\t\tif (this.runningContext) {\n\t\t\tthis.runningContext.abort();\n\t\t}\n\n\t\tconst ctx = this.previewCanvas.getContext('2d')!;\n\t\tctx.clearRect(0, 0, this.previewCanvas.width, this.previewCanvas.height);\n\t\tconst context = (this.runningContext = new RenderContext(ctx, hq, true));\n\t\ttry {\n\t\t\tawait renderCallback(this.runningContext);\n\t\t} catch (e) {\n\t\t\tif (e instanceof RenderAbortedException) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthrow e;\n\t\t} finally {\n\t\t\tif (context === this.runningContext) {\n\t\t\t\tthis.runningContext = null;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tpublic get width(): number {\n\t\treturn this.previewCanvas.width;\n\t}\n\n\tpublic get height(): number {\n\t\treturn this.previewCanvas.height;\n\t}\n\n\tpublic paintOnto(\n\t\tc: CanvasRenderingContext2D,\n\t\tx: number,\n\t\ty: number,\n\t\tw?: number,\n\t\th?: number\n\t) {\n\t\tif (w && h) {\n\t\t\tc.drawImage(this.previewCanvas, x, y, w, h);\n\t\t} else {\n\t\t\tc.drawImage(this.previewCanvas, x, y);\n\t\t}\n\t}\n\n\tpublic async download(\n\t\trenderCallback: (rc: RenderContext) => Promise<void>,\n\t\tfilename: string\n\t): Promise<string> {\n\t\tconst downloadCanvas = document.createElement('canvas');\n\t\tdownloadCanvas.width = this.previewCanvas.width;\n\t\tdownloadCanvas.height = this.previewCanvas.height;\n\n\t\tconst ctx = downloadCanvas.getContext('2d')!;\n\t\tctx.clearRect(0, 0, this.previewCanvas.width, this.previewCanvas.height);\n\t\tawait renderCallback(new RenderContext(ctx, true, false));\n\n\t\tlet url;\n\t\tif (undefined === window.navigator.msSaveOrOpenBlob) {\n\t\t\tconst a = document.createElement('a');\n\t\t\ta.setAttribute('download', filename);\n\t\t\turl = await this.createObjectURL(downloadCanvas);\n\t\t\ta.setAttribute('href', url);\n\t\t\tdocument.body.appendChild(a);\n\t\t\ta.click();\n\t\t\tdocument.body.removeChild(a);\n\t\t} else {\n\t\t\turl = downloadCanvas.toDataURL();\n\t\t\tconst blob = this.dataURItoBlob(url);\n\n\t\t\tif (window.URL && window.URL.createObjectURL) {\n\t\t\t\turl = URL.createObjectURL(blob);\n\t\t\t}\n\n\t\t\t// IE-specific code\n\t\t\twindow.navigator.msSaveBlob(blob, filename);\n\t\t}\n\n\t\treturn url;\n\t}\n\n\tpublic createObjectURL(canvas: HTMLCanvasElement): Promise<string> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (canvas.toBlob && window.URL && window.URL.createObjectURL) {\n\t\t\t\tcanvas.toBlob(blob => {\n\t\t\t\t\tif (!blob) {\n\t\t\t\t\t\treject();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tresolve(URL.createObjectURL(blob));\n\t\t\t\t}, 'image/png');\n\t\t\t} else if (window.URL && window.URL.createObjectURL) {\n\t\t\t\tconst url = canvas.toDataURL();\n\t\t\t\tconst blob = this.dataURItoBlob(url);\n\t\t\t\tresolve(URL.createObjectURL(blob));\n\t\t\t} else {\n\t\t\t\tresolve(canvas.toDataURL());\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic getDataAt(x: number, y: number): Uint8ClampedArray {\n\t\tconst ctx = this.previewCanvas.getContext('2d');\n\n\t\treturn ctx!.getImageData(x, y, 1, 1).data;\n\t}\n\n\tprivate dataURItoBlob(dataURI: string) {\n\t\tconst binStr = atob(dataURI.split(',')[1]);\n\t\tconst len = binStr.length;\n\t\tconst arr = new Uint8Array(len);\n\n\t\tfor (let i = 0; i < len; i++) {\n\t\t\tarr[i] = binStr.charCodeAt(i);\n\t\t}\n\n\t\treturn new Blob([arr], { type: 'image/png' });\n\t}\n}\n","import { RenderContext } from '@/renderer/rendererContext';\nimport { getAsset } from '@/asset-manager';\nimport { screenWidth, screenHeight } from './constants';\n\nexport interface IBackground {\n\tname: string;\n\tnsfw?: boolean;\n\trender(rx: RenderContext): Promise<void>;\n}\n\nexport class Background implements IBackground {\n\tpublic readonly path: string;\n\tpublic flip: boolean = false;\n\tpublic constructor(\n\t\tpath: string,\n\t\tpublic readonly name: string,\n\t\tpublic readonly custom: boolean = false,\n\t\tpublic readonly scale: string = '',\n\t\tpublic installed: boolean = false\n\t) {\n\t\tthis.path = (custom ? '' : '/backgrounds/') + path;\n\t}\n\n\tpublic async render(rx: RenderContext): Promise<void> {\n\t\tconst image = await getAsset(this.path, rx.hq);\n\t\tif (!(image instanceof HTMLImageElement)) return;\n\t\tlet x = 0;\n\t\tlet y = 0;\n\t\tlet w = image.width;\n\t\tlet h = image.height;\n\n\t\tswitch (this.scale) {\n\t\t\tcase '':\n\t\t\t\tx = screenWidth / 2 - w / 2;\n\t\t\t\ty = screenHeight / 2 - h / 2;\n\t\t\t\tbreak;\n\t\t\tcase 'stretch':\n\t\t\t\tw = screenWidth;\n\t\t\t\th = screenHeight;\n\t\t\t\tbreak;\n\t\t\tcase 'cover':\n\t\t\t\tconst ratio = w / h;\n\t\t\t\tconst screenRatio = screenWidth / screenHeight;\n\n\t\t\t\tif (ratio > screenRatio) {\n\t\t\t\t\th = screenHeight;\n\t\t\t\t\tw = h * ratio;\n\t\t\t\t} else {\n\t\t\t\t\tw = screenWidth;\n\t\t\t\t\th = w / ratio;\n\t\t\t\t}\n\n\t\t\t\tx = screenWidth / 2 - w / 2;\n\t\t\t\ty = screenHeight / 2 - h / 2;\n\t\t}\n\n\t\trx.drawImage({\n\t\t\timage,\n\t\t\tx,\n\t\t\ty,\n\t\t\tw,\n\t\t\th,\n\t\t\tflip: this.flip,\n\t\t});\n\t}\n}\n\nexport const color = {\n\tname: 'Static color',\n\tcolor: '#000000',\n\n\tasync render(rx: RenderContext): Promise<void> {\n\t\trx.drawRect({ x: 0, y: 0, w: 1280, h: 720, fill: { style: this.color } });\n\t},\n};\n\nexport const transparent = {\n\tname: 'Transparent',\n\t// tslint:disable-next-line: no-empty\n\tasync render(rx: RenderContext): Promise<void> {},\n};\n","import { RenderContext } from '@/renderer/rendererContext';\nimport { getAsset, getAAsset } from '@/asset-manager';\nimport { Renderer } from '@/renderer/renderer';\nimport { IRenderable } from './renderable';\nimport { IDragable } from './dragable';\nimport {\n\tICharacter,\n\tgetPose,\n\tgetParts,\n\tgetHeads,\n\tCloseUpYOffset,\n\tgetDataG,\n} from '@/store/objectTypes/characters';\nimport {\n\tPose,\n\tCharacter as CharacterModel,\n} from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\nimport { IAsset } from '@/store/content';\nimport { IRootState } from '@/store';\nimport { Store } from 'vuex';\nimport { ErrorAsset } from './error-asset';\n\nexport class Character implements IRenderable, IDragable {\n\tpublic styleData = {\n\t\tlastBase: '',\n\t\tcomponents: {} as { [component: string]: string },\n\t};\n\tprivate lq: boolean = true;\n\tprivate localRenderer = new Renderer(960, 960);\n\tprivate lastVersion = -1;\n\tprivate hitDetectionFallback = false;\n\n\tpublic get id(): string {\n\t\treturn this.obj.id;\n\t}\n\n\tpublic constructor(\n\t\tpublic readonly obj: ICharacter,\n\t\tprivate $store: Store<IRootState>\n\t) {}\n\n\tpublic async updateLocalCanvas() {\n\t\tawait this.localRenderer.render(async rx => {\n\t\t\tconst data = this.getData();\n\t\t\tconst pose = getPose(data, this.obj) as Pose<IAsset>;\n\t\t\tlet assets: Array<IAsset | 'head'> = [];\n\t\t\tlet headAssets: IAsset[] = [];\n\t\t\tconst partKeys = getParts(data, this.obj);\n\t\t\tconst currentHeads = getHeads(data, this.obj);\n\n\t\t\tconsole.log(pose.renderOrder);\n\t\t\tfor (const renderPart of pose.renderOrder.toLowerCase()) {\n\t\t\t\tswitch (renderPart) {\n\t\t\t\t\tcase 'l':\n\t\t\t\t\t\tassets = ([] as Array<IAsset | 'head'>).concat(\n\t\t\t\t\t\t\tassets,\n\t\t\t\t\t\t\tpose.left[this.obj.posePositions.left]\n\t\t\t\t\t\t);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'r':\n\t\t\t\t\t\tassets = ([] as Array<IAsset | 'head'>).concat(\n\t\t\t\t\t\t\tassets,\n\t\t\t\t\t\t\tpose.right[this.obj.posePositions.right]\n\t\t\t\t\t\t);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 's':\n\t\t\t\t\t\tassets = ([] as Array<IAsset | 'head'>).concat(assets, pose.static);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'v':\n\t\t\t\t\t\tassets = ([] as Array<IAsset | 'head'>).concat(\n\t\t\t\t\t\t\tassets,\n\t\t\t\t\t\t\tpose.variant[this.obj.posePositions.variant]\n\t\t\t\t\t\t);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'h':\n\t\t\t\t\t\theadAssets = currentHeads\n\t\t\t\t\t\t\t? currentHeads.variants[this.obj.posePositions.head]\n\t\t\t\t\t\t\t: [];\n\t\t\t\t\t\tassets.push('head');\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tassets = assets.filter(asset => asset);\n\t\t\tconst [loadedAssets, loadedHeadAssets]: [\n\t\t\t\tArray<HTMLImageElement | ErrorAsset | string>,\n\t\t\t\tArray<HTMLImageElement | ErrorAsset>\n\t\t\t] = await Promise.all([\n\t\t\t\tPromise.all(\n\t\t\t\t\tassets.map(asset =>\n\t\t\t\t\t\ttypeof asset === 'string'\n\t\t\t\t\t\t\t? Promise.resolve(asset)\n\t\t\t\t\t\t\t: getAAsset(asset, rx.hq)\n\t\t\t\t\t)\n\t\t\t\t),\n\t\t\t\tPromise.all(headAssets.map(asset => getAAsset(asset, rx.hq))),\n\t\t\t]);\n\n\t\t\tfor (const loadedAsset of loadedAssets) {\n\t\t\t\tif (loadedAsset === 'head') {\n\t\t\t\t\tfor (const loadedheadAsset of loadedHeadAssets) {\n\t\t\t\t\t\trx.drawImage({\n\t\t\t\t\t\t\timage: loadedheadAsset,\n\t\t\t\t\t\t\tx: pose.headAnchor[0],\n\t\t\t\t\t\t\ty: pose.headAnchor[1],\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\trx.drawImage({ image: loadedAsset, x: 0, y: 0 });\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.lastVersion = this.obj.version;\n\t\t});\n\t}\n\n\tpublic get width() {\n\t\tconst zoom = this.obj.close ? 2 : 1;\n\t\treturn this.obj.width * zoom;\n\t}\n\n\tpublic get height() {\n\t\tconst zoom = this.obj.close ? 2 : 1;\n\t\treturn this.obj.height * zoom;\n\t}\n\n\tpublic get x() {\n\t\treturn this.obj.x;\n\t}\n\n\tpublic get y() {\n\t\treturn (this.obj.close ? CloseUpYOffset : 0) + this.obj.y;\n\t}\n\n\tpublic async render(selected: boolean, rx: RenderContext) {\n\t\tif (this.lastVersion !== this.obj.version || this.lq !== !rx.hq) {\n\t\t\tawait this.updateLocalCanvas();\n\t\t}\n\n\t\tconst w = this.width;\n\t\tconst h = this.height;\n\t\tconst x = this.x - w / 2;\n\t\tconst y = this.y;\n\n\t\trx.drawImage({\n\t\t\timage: this.localRenderer,\n\t\t\tx,\n\t\t\ty,\n\t\t\tw,\n\t\t\th,\n\t\t\tflip: this.obj.flip,\n\t\t\tshadow: selected && rx.preview ? { blur: 20, color: 'red' } : undefined,\n\t\t\topacity: this.obj.opacity,\n\t\t});\n\t}\n\n\tpublic hitTest(hx: number, hy: number): boolean {\n\t\tconst scaledX = hx - (this.x - this.width / 2);\n\t\tconst scaledY = hy - this.y;\n\n\t\tif (scaledX < 0 || scaledX > this.width) return false;\n\t\tif (scaledY < 0 || scaledY > this.height) return false;\n\n\t\tif (!this.hitDetectionFallback) {\n\t\t\ttry {\n\t\t\t\tconst flippedX = this.obj.flip ? this.width - scaledX : scaledX;\n\t\t\t\tconst scaleX = 960 / this.width;\n\t\t\t\tconst scaleY = 960 / this.height;\n\t\t\t\tconst data = this.localRenderer.getDataAt(\n\t\t\t\t\tMath.round(flippedX * scaleX),\n\t\t\t\t\tMath.round(scaledY * scaleY)\n\t\t\t\t);\n\t\t\t\treturn data[3] !== 0;\n\t\t\t} catch (e) {\n\t\t\t\t// On chrome for android, the hit test tends to fail because of cross-origin shenanigans, even though\n\t\t\t\t// we only ever load from one origin. ¯\\_(ツ)_/¯\n\t\t\t\t// So we have a fallback that doesn't read the contents of the canvas. This looses accuracy, but at\n\t\t\t\t// least works always.\n\t\t\t\tif (e instanceof DOMException && e.message.includes('cross-origin')) {\n\t\t\t\t\tthis.hitDetectionFallback = true;\n\t\t\t\t} else {\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tpublic getData(): CharacterModel<IAsset> {\n\t\treturn getDataG(this.$store.getters, this.obj);\n\t}\n}\n","import { RenderContext } from '@/renderer/rendererContext';\nimport { getAAsset } from '@/asset-manager';\nimport { IRenderable } from './renderable';\nimport { IDragable } from './dragable';\nimport { ErrorAsset } from './error-asset';\nimport { ISprite } from '@/store/objectTypes/sprite';\nimport eventBus, { InvalidateRenderEvent } from '@/eventbus/event-bus';\n\nconst BaseXPosition = 640;\n\nexport class Sprite implements IRenderable, IDragable {\n\tpublic ratio: number = 0;\n\tpublic lockedRatio: boolean = true;\n\tprivate asset: HTMLImageElement | null = null;\n\n\tpublic get id(): string {\n\t\treturn this.obj.id;\n\t}\n\tpublic get infront(): boolean {\n\t\treturn this.obj.onTop;\n\t}\n\n\tpublic constructor(public readonly obj: ISprite) {\n\t\tgetAAsset(obj.asset)\n\t\t\t.then(asset => {\n\t\t\t\tif (asset instanceof ErrorAsset) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.asset = asset;\n\t\t\t\teventBus.fire(new InvalidateRenderEvent());\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tconsole.error(`Failed to load asset: ${err}`);\n\t\t\t});\n\t}\n\n\tpublic async render(selected: boolean, rx: RenderContext) {\n\t\tif (!this.asset) return;\n\t\tconst x = this.obj.x - this.obj.width / 2;\n\t\trx.drawImage({\n\t\t\timage: this.asset,\n\t\t\tx,\n\t\t\ty: this.obj.y,\n\t\t\tw: this.obj.width,\n\t\t\th: this.obj.height,\n\t\t\tshadow: selected && rx.preview ? { blur: 20, color: 'red' } : undefined,\n\t\t\tflip: this.obj.flip,\n\t\t\topacity: this.obj.opacity,\n\t\t});\n\t}\n\n\tpublic hitTest(hx: number, hy: number): boolean {\n\t\tconst hitX = hx - this.obj.x + this.obj.width / 2;\n\t\tconst hitY = hy - this.obj.y;\n\t\treturn (\n\t\t\thitX >= 0 &&\n\t\t\thitX <= this.obj.width &&\n\t\t\thitY >= 0 &&\n\t\t\thitY <= this.obj.height\n\t\t);\n\t}\n}\n","export const ScreenWidth = 1280;\n\nexport const TextBoxWidth = 816;\nexport const TextBoxCorruptedWidth = 900;\nexport const TextBoxHeight = 146;\nexport const TextBoxY = 568;\nexport const TextBoxKerning = 0;\nexport const TextBoxLineHeight = 29;\nexport const TextBoxCorruptedKerning = 8;\nexport const TextBoxTextXOffset = 38;\nexport const TextBoxTextYOffset = 50;\n\nexport const TextBoxTextCorruptedXOffset = 9;\nexport const TextBoxTextCorruptedYOffset = 9;\n\nexport const NameboxHeight = 39;\nexport const NameboxWidth = 168;\nexport const NameboxXOffset = 34;\nexport const NameboxTextYOffset = 29;\n\nexport const ControlsYBottomOffset = 12;\nexport const ControlsXHistoryOffset = -126;\nexport const ControlsXSkipOffset = -72;\nexport const ControlsXStuffOffset = -38;\n\nexport const ArrowXRightOffset = 30.75;\nexport const ArrowYBottomOffset = 26;\n\nexport const GlowRX = 426;\nexport const GlowRY = 58;\n\nexport const NameboxTextStyle = {\n\talign: 'center' as CanvasTextAlign,\n\tfont: '24px riffic',\n\toutline: {\n\t\tstyle: '#b59',\n\t\twidth: 6,\n\t},\n\tfill: {\n\t\tstyle: 'white',\n\t},\n};\n\nexport const ControlsTextStyle = {\n\talign: 'left' as CanvasTextAlign,\n\tfont: '13px aller',\n\tfill: {\n\t\tstyle: '#522',\n\t},\n};\n\nexport const ControlsTextDisabledStyle = {\n\t...ControlsTextStyle,\n\tfill: {\n\t\tstyle: '#a66',\n\t},\n};\n\nexport const TextBoxStyle = {\n\talign: 'left' as CanvasTextAlign,\n\tfont: '24px aller',\n\toutline: {\n\t\tstyle: '#523140',\n\t\twidth: 4,\n\t},\n\tfill: {\n\t\tstyle: '#fff',\n\t},\n};\n\nexport const TextBoxCorruptedStyle = {\n\talign: 'left' as CanvasTextAlign,\n\tfont: '24px verily',\n\toutline: {\n\t\tstyle: '#000',\n\t\twidth: 20,\n\t},\n\tfill: {\n\t\tstyle: '#fff',\n\t},\n};\n\nexport const TextBoxX = ScreenWidth / 2 - TextBoxWidth / 2; // 232\nexport const TextBoxCorruptedX = ScreenWidth / 2 - TextBoxCorruptedWidth / 2;\nexport const TextBoxTextX = TextBoxX + TextBoxTextXOffset;\nexport const TextBoxTextY = TextBoxY + TextBoxTextYOffset;\n\nexport const NameboxY = TextBoxY - NameboxHeight;\nexport const NameboxX = TextBoxX + NameboxXOffset;\nexport const NameboxTextX = NameboxX + NameboxWidth / 2;\nexport const NameboxTextY = NameboxY + NameboxTextYOffset;\n\nexport const ControlsXHistory = TextBoxX + ControlsXHistoryOffset;\nexport const ControlsXSkip = TextBoxX + ControlsXSkipOffset;\nexport const ControlsXStuff = TextBoxX + ControlsXStuffOffset;\n","export function roundedRectangle(\n\tctx: CanvasPath,\n\tx: number,\n\ty: number,\n\tw: number,\n\th: number,\n\tr: number\n) {\n\tif (w < 2 * r) r = w / 2;\n\tif (h < 2 * r) r = h / 2;\n\tctx.moveTo(x + r, y);\n\tctx.arcTo(x + w, y, x + w, y + h, r);\n\tctx.arcTo(x + w, y + h, x, y + h, r);\n\tctx.arcTo(x, y + h, x, y, r);\n\tctx.arcTo(x, y, x + w, y, r);\n\tctx.closePath();\n}\n\nexport function roundedTopRectangle(\n\tctx: CanvasPath,\n\tx: number,\n\ty: number,\n\tw: number,\n\th: number,\n\tr: number\n) {\n\tif (w < 2 * r) r = w / 2;\n\tif (h < 2 * r) r = h / 2;\n\tctx.moveTo(x + r, y);\n\tctx.arcTo(x + w, y, x + w, y + h, r);\n\tctx.lineTo(x + w, y + h);\n\tctx.lineTo(x, y + h);\n\tctx.arcTo(x, y, x + w, y, r);\n\tctx.closePath();\n}\n","import { IColor } from './color';\nimport { RGBAColor } from './rgb';\n\nexport class HSLAColor implements IColor {\n\tpublic constructor(\n\t\tpublic readonly h: number,\n\t\tpublic readonly s: number,\n\t\tpublic readonly l: number,\n\t\tpublic readonly a: number\n\t) {}\n\n\tpublic toCss(): string {\n\t\tif (this.a >= 1) {\n\t\t\treturn `hsl(${this.h}, ${this.s}, ${this.l})`;\n\t\t}\n\t\treturn `hsla(${this.h}, ${this.s}, ${this.l}, ${this.a})`;\n\t}\n\n\tpublic shift(deltas: HSLAColor): HSLAColor {\n\t\tlet { h, s, l, a } = this;\n\t\th += deltas.h;\n\t\tif (h >= 1) {\n\t\t\th -= 1;\n\t\t} else if (h < 0) {\n\t\t\th += 1;\n\t\t}\n\t\tif (s + deltas.s > 1 || s + deltas.s < 0) {\n\t\t\ts -= deltas.s;\n\t\t} else {\n\t\t\ts += deltas.s;\n\t\t}\n\t\tif (l + deltas.l > 1 || l + deltas.l < 0) {\n\t\t\tl -= deltas.l;\n\t\t} else {\n\t\t\tl += deltas.l;\n\t\t}\n\t\tif (a + deltas.a > 1 || a + deltas.a < 0) {\n\t\t\ta -= deltas.a;\n\t\t} else {\n\t\t\ta += deltas.a;\n\t\t}\n\t\treturn new HSLAColor(h, s, l, a);\n\t}\n\n\tpublic toRgb(): RGBAColor {\n\t\tconst { h, s, l, a } = this;\n\t\tlet r: number;\n\t\tlet g: number;\n\t\tlet b: number;\n\n\t\tif (s === 0) {\n\t\t\tr = g = b = l; // achromatic\n\t\t} else {\n\t\t\tconst q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n\t\t\tconst p = 2 * l - q;\n\t\t\tr = this.hue2rgb(p, q, h + 1 / 3);\n\t\t\tg = this.hue2rgb(p, q, h);\n\t\t\tb = this.hue2rgb(p, q, h - 1 / 3);\n\t\t}\n\n\t\treturn new RGBAColor(\n\t\t\tMath.round(r * 255),\n\t\t\tMath.round(g * 255),\n\t\t\tMath.round(b * 255),\n\t\t\ta\n\t\t);\n\t}\n\n\tpublic toHSL(): HSLAColor {\n\t\treturn this;\n\t}\n\n\tprivate hue2rgb(p: number, q: number, t: number) {\n\t\tif (t < 0) t += 1;\n\t\tif (t > 1) t -= 1;\n\t\tif (t < 1 / 6) return p + (q - p) * 6 * t;\n\t\tif (t < 1 / 2) return q;\n\t\tif (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\n\t\treturn p;\n\t}\n}\n","import { HSLAColor } from './hsl';\n\nexport class RGBAColor {\n\tpublic static validCss(str: string): boolean {\n\t\treturn this.validCssRgb(str) || this.validHex(str);\n\t}\n\n\tpublic static fromCss(str: string): RGBAColor {\n\t\tif (this.validCssRgb(str)) {\n\t\t\treturn this.fromCssRgb(str);\n\t\t}\n\t\tif (this.validHex(str)) {\n\t\t\treturn this.fromHex(str);\n\t\t}\n\t\tthrow new Error('Invalid RGB color format');\n\t}\n\n\tpublic static validCssRgb(str: string): boolean {\n\t\treturn this.rgbEx.test(str) || this.rgbaEx.test(str);\n\t}\n\n\tpublic static fromCssRgb(str: string): RGBAColor {\n\t\tif (!this.validCssRgb(str)) throw new Error('Invalid RGB color format');\n\t\tconst rgbHead = str.slice(0, -1);\n\t\tconst parentesisPos = rgbHead.indexOf('(');\n\t\tconst rbgTail = rgbHead.slice(parentesisPos + 1);\n\t\tconst elements = rbgTail.split(',').map(x => parseFloat(x.trim()));\n\t\treturn new RGBAColor(\n\t\t\telements[0],\n\t\t\telements[1],\n\t\t\telements[2],\n\t\t\telements.length === 4 ? elements[3] : 1\n\t\t);\n\t}\n\n\tpublic static validHex(str: string): boolean {\n\t\treturn this.hexShortEx.test(str) || this.hexLongEx.test(str);\n\t}\n\n\tpublic static fromHex(str: string): RGBAColor {\n\t\tif (!this.validHex(str)) throw new Error('Invalid Hex color format');\n\t\tconst hexTail = str.slice(1);\n\t\tif (hexTail.length === 3) {\n\t\t\treturn new RGBAColor(\n\t\t\t\tparseInt(hexTail[0] + hexTail[0], 16),\n\t\t\t\tparseInt(hexTail[1] + hexTail[1], 16),\n\t\t\t\tparseInt(hexTail[2] + hexTail[2], 16),\n\t\t\t\t1\n\t\t\t);\n\t\t}\n\t\tif (hexTail.length === 4) {\n\t\t\treturn new RGBAColor(\n\t\t\t\tparseInt(hexTail[0] + hexTail[0], 16),\n\t\t\t\tparseInt(hexTail[1] + hexTail[1], 16),\n\t\t\t\tparseInt(hexTail[2] + hexTail[2], 16),\n\t\t\t\tparseInt(hexTail[3] + hexTail[3], 16) / 255\n\t\t\t);\n\t\t}\n\t\tif (hexTail.length === 6) {\n\t\t\treturn new RGBAColor(\n\t\t\t\tparseInt(hexTail[0] + hexTail[1], 16),\n\t\t\t\tparseInt(hexTail[2] + hexTail[3], 16),\n\t\t\t\tparseInt(hexTail[4] + hexTail[5], 16),\n\t\t\t\t1\n\t\t\t);\n\t\t}\n\t\tif (hexTail.length === 8) {\n\t\t\treturn new RGBAColor(\n\t\t\t\tparseInt(hexTail[0] + hexTail[1], 16),\n\t\t\t\tparseInt(hexTail[2] + hexTail[3], 16),\n\t\t\t\tparseInt(hexTail[4] + hexTail[5], 16),\n\t\t\t\tparseInt(hexTail[6] + hexTail[7], 16) / 255\n\t\t\t);\n\t\t}\n\t\tthrow new Error('Invalid Hex color format length');\n\t}\n\n\tprivate static rgbEx = /^rgb\\((\\d*?)\\,(\\d*?)\\,(\\d*?)\\)$/i;\n\tprivate static rgbaEx = /^rgba\\((\\d{1,3})\\,(\\d{1,3})\\,(\\d{1,3})\\,([\\d\\.]+)\\)$/i;\n\tprivate static hexShortEx = /^\\#[0-9A-Z]{3,4}$/i;\n\tprivate static hexLongEx = /^\\#[0-9A-Z]{6,8}$/i;\n\n\tpublic constructor(\n\t\tpublic readonly r: number,\n\t\tpublic readonly g: number,\n\t\tpublic readonly b: number,\n\t\tpublic readonly a: number\n\t) {}\n\n\tpublic toCss(): string {\n\t\tif (this.a > 1) {\n\t\t\treturn `rgb(${this.r},${this.g},${this.b})`;\n\t\t}\n\t\treturn `rgba(${this.r},${this.g},${this.b},${this.a})`;\n\t}\n\n\tpublic toRgb(): RGBAColor {\n\t\treturn this;\n\t}\n\n\tpublic toHSL(): HSLAColor {\n\t\tlet { r, g, b } = this;\n\t\tconst { a } = this;\n\t\t(r /= 255), (g /= 255), (b /= 255);\n\t\tconst max = Math.max(r, g, b);\n\t\tconst min = Math.min(r, g, b);\n\t\tlet h: number;\n\t\tlet s: number;\n\t\tconst l: number = (max + min) / 2;\n\n\t\tif (max === min) {\n\t\t\th = s = 0; // achromatic\n\t\t} else {\n\t\t\tconst d = max - min;\n\t\t\ts = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n\t\t\tswitch (max) {\n\t\t\t\tcase r:\n\t\t\t\t\th = (g - b) / d + (g < b ? 6 : 0);\n\t\t\t\t\tbreak;\n\t\t\t\tcase g:\n\t\t\t\t\th = (b - r) / d + 2;\n\t\t\t\t\tbreak;\n\t\t\t\tcase b:\n\t\t\t\t\th = (r - g) / d + 4;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\th! /= 6;\n\t\t}\n\n\t\treturn new HSLAColor(h!, s, l, a);\n\t}\n}\n","import { RenderContext } from '@/renderer/rendererContext';\nimport { getAsset } from '@/asset-manager';\nimport { ITextBox } from '@/store/objectTypes/textbox';\nimport { IRenderable } from './renderable';\nimport {\n\tNameboxTextStyle,\n\tControlsTextStyle,\n\tControlsTextDisabledStyle,\n\tTextBoxTextCorruptedYOffset,\n\tTextBoxTextCorruptedXOffset,\n\tTextBoxCorruptedStyle,\n\tTextBoxStyle,\n\tTextBoxCorruptedKerning,\n\tTextBoxKerning,\n\tTextBoxLineHeight,\n\tTextBoxWidth,\n\tNameboxHeight,\n\tTextBoxHeight,\n\tTextBoxCorruptedWidth,\n\tNameboxXOffset,\n\tNameboxWidth,\n\tNameboxTextYOffset,\n\tControlsXHistoryOffset,\n\tControlsXSkipOffset,\n\tControlsXStuffOffset,\n\tArrowXRightOffset,\n\tArrowYBottomOffset,\n\tTextBoxTextYOffset,\n\tTextBoxTextXOffset,\n\tControlsYBottomOffset,\n\tGlowRY,\n\tGlowRX,\n} from './textBoxConstants';\nimport { Renderer } from '@/renderer/renderer';\nimport { roundedRectangle, roundedTopRectangle } from '@/renderer/pathTools';\nimport { RGBAColor } from '@/util/colors/rgb';\nimport { HSLAColor } from '@/util/colors/hsl';\n\nexport class TextBox implements IRenderable {\n\tpublic display: boolean = true;\n\tprivate lastVersion = -1;\n\tprivate lastX = 0;\n\tprivate lastY = 0;\n\tprivate lastH = 0;\n\tprivate lastW = 0;\n\tprivate localRenderer = new Renderer(1280, 720);\n\n\tpublic constructor(public obj: ITextBox) {}\n\n\tpublic get id() {\n\t\treturn this.obj.id;\n\t}\n\n\tpublic get width(): number {\n\t\treturn this.obj.style === 'custom' ? this.obj.width : TextBoxWidth;\n\t}\n\n\tpublic get height(): number {\n\t\treturn (\n\t\t\t(this.obj.style === 'custom' ? this.obj.height : TextBoxHeight) +\n\t\t\tNameboxHeight\n\t\t);\n\t}\n\n\tpublic hitTest(hx: number, hy: number): boolean {\n\t\tconst w = this.width;\n\t\tconst h = this.height;\n\n\t\tconst w2 = w / 2;\n\t\tconst x1 = this.obj.x - w2;\n\t\tconst x2 = x1 + w;\n\t\tconst y1 = this.obj.y;\n\t\tconst y2 = y1 + h;\n\t\treturn x1 <= hx && x2 >= hx && y1 <= hy && y2 >= hy;\n\t}\n\n\tpublic async render(selected: boolean, rx: RenderContext) {\n\t\tif (\n\t\t\tthis.lastVersion !== this.obj.version ||\n\t\t\tthis.lastX !== this.obj.x ||\n\t\t\tthis.lastY !== this.obj.y ||\n\t\t\tthis.lastH !== this.obj.height ||\n\t\t\tthis.lastW !== this.obj.width\n\t\t) {\n\t\t\tawait this.updateLocalCanvas();\n\t\t\tthis.lastVersion = this.obj.version;\n\t\t\tthis.lastX = this.obj.x;\n\t\t\tthis.lastY = this.obj.y;\n\t\t}\n\n\t\trx.drawImage({\n\t\t\timage: this.localRenderer,\n\t\t\tx: 0,\n\t\t\ty: 0,\n\t\t\tflip: this.obj.flip,\n\t\t\tshadow: selected && rx.preview ? { blur: 20, color: 'red' } : undefined,\n\t\t\topacity: this.obj.opacity,\n\t\t});\n\t}\n\n\tpublic get controlColor(): string {\n\t\tif (this.obj.deriveCustomColors) {\n\t\t\tconst base = RGBAColor.fromCss(this.obj.customColor).toHSL();\n\t\t\tconst delta = new HSLAColor(\n\t\t\t\t0.08045977011494243,\n\t\t\t\t-0.5714285714285714,\n\t\t\t\t-0.5960784313725489,\n\t\t\t\t0\n\t\t\t);\n\t\t\treturn base\n\t\t\t\t.shift(delta)\n\t\t\t\t.toRgb()\n\t\t\t\t.toCss();\n\t\t}\n\t\treturn this.obj.customControlsColor;\n\t}\n\n\tpublic get controlsStyle() {\n\t\tif (this.obj.style !== 'custom') return ControlsTextStyle;\n\t\treturn {\n\t\t\t...ControlsTextStyle,\n\t\t\tfill: {\n\t\t\t\tstyle: this.controlColor,\n\t\t\t},\n\t\t};\n\t}\n\n\tpublic get controlsDisableStyle() {\n\t\tif (this.obj.style !== 'custom') return ControlsTextDisabledStyle;\n\n\t\tconst col = RGBAColor.fromCss(this.controlColor).toHSL();\n\t\tconst delta = new HSLAColor(0, -0.14285714285714296, 0.3, 0);\n\t\tconst disColor = col\n\t\t\t.shift(delta)\n\t\t\t.toRgb()\n\t\t\t.toCss();\n\n\t\treturn {\n\t\t\t...ControlsTextStyle,\n\n\t\t\tfill: {\n\t\t\t\tstyle: disColor,\n\t\t\t},\n\t\t};\n\t}\n\n\tpublic async updateLocalCanvas() {\n\t\tconst base = RGBAColor.fromCss(this.obj.customColor).toHSL();\n\t\tconst target = RGBAColor.fromCss('#552222').toHSL();\n\n\t\tawait this.localRenderer.render(async rx => {\n\t\t\tconst w = this.width;\n\t\t\tconst h = this.height;\n\t\t\tconst w2 = w / 2;\n\t\t\tconst x = this.obj.x - w2;\n\t\t\tconst y = this.obj.y;\n\n\t\t\tawait this.renderBackdrop(rx, x, y + NameboxHeight);\n\n\t\t\tif (this.obj.talkingDefault !== 'No-one') {\n\t\t\t\tconst name =\n\t\t\t\t\tthis.obj.talkingDefault === 'Other'\n\t\t\t\t\t\t? this.obj.talkingOther\n\t\t\t\t\t\t: this.obj.talkingDefault;\n\t\t\t\tawait this.renderNamebox(rx, x + NameboxXOffset, y, name);\n\t\t\t}\n\n\t\t\tthis.renderText(rx, x, y);\n\n\t\t\tconst bottom = y + h;\n\t\t\tconst controlsY = bottom - ControlsYBottomOffset;\n\t\t\tconst controlsCenter = x + w / 2;\n\n\t\t\tif (this.obj.controls) {\n\t\t\t\trx.drawText({\n\t\t\t\t\ttext: 'History',\n\t\t\t\t\tx: controlsCenter + ControlsXHistoryOffset,\n\t\t\t\t\ty: controlsY,\n\t\t\t\t\t...this.controlsStyle,\n\t\t\t\t});\n\t\t\t\trx.drawText({\n\t\t\t\t\ttext: 'Skip',\n\t\t\t\t\tx: controlsCenter + ControlsXSkipOffset,\n\t\t\t\t\ty: controlsY,\n\t\t\t\t\t...(this.obj.skip ? this.controlsStyle : this.controlsDisableStyle),\n\t\t\t\t});\n\t\t\t\trx.drawText({\n\t\t\t\t\ttext: 'Auto   Save   Load   Settings',\n\t\t\t\t\tx: controlsCenter + ControlsXStuffOffset,\n\t\t\t\t\ty: controlsY,\n\t\t\t\t\t...this.controlsStyle,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (this.obj.continue) {\n\t\t\t\trx.drawImage({\n\t\t\t\t\timage: await getAsset('next'),\n\t\t\t\t\tx: x + w - ArrowXRightOffset,\n\t\t\t\t\ty: bottom - ArrowYBottomOffset,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate get nameboxOutlineColor(): string {\n\t\tif (this.obj.deriveCustomColors) {\n\t\t\tconst base = RGBAColor.fromCss(this.obj.customColor).toHSL();\n\t\t\tconst delta = new HSLAColor(\n\t\t\t\t-0.03065134099616873,\n\t\t\t\t-0.5714285714285714,\n\t\t\t\t-0.29607843137254896,\n\t\t\t\t0\n\t\t\t);\n\t\t\treturn base\n\t\t\t\t.shift(delta)\n\t\t\t\t.toRgb()\n\t\t\t\t.toCss();\n\t\t}\n\t\treturn this.obj.customNameboxStroke;\n\t}\n\n\tprivate get nameboxBackgroundColor(): string {\n\t\tif (this.obj.deriveCustomColors) {\n\t\t\tconst base = RGBAColor.fromCss(this.obj.customColor).toHSL();\n\t\t\tconst delta = new HSLAColor(\n\t\t\t\t0.002028397565922768,\n\t\t\t\t0,\n\t\t\t\t0.13725490196078438,\n\t\t\t\t0\n\t\t\t);\n\t\t\treturn base\n\t\t\t\t.shift(delta)\n\t\t\t\t.toRgb()\n\t\t\t\t.toCss();\n\t\t}\n\t\treturn this.obj.customNameboxColor;\n\t}\n\n\tprivate async renderNamebox(\n\t\trx: RenderContext,\n\t\tx: number,\n\t\ty: number,\n\t\tname: string\n\t): Promise<void> {\n\t\tlet w: number;\n\t\tconst h = NameboxHeight;\n\t\tlet style: typeof NameboxTextStyle = NameboxTextStyle;\n\t\tif (this.obj.style === 'custom') {\n\t\t\tconst hslOutline = RGBAColor.fromCss(this.nameboxOutlineColor).toHSL();\n\t\t\tstyle = {\n\t\t\t\t...style,\n\n\t\t\t\toutline: {\n\t\t\t\t\tstyle: this.nameboxOutlineColor,\n\t\t\t\t\twidth: 6,\n\t\t\t\t},\n\t\t\t\tfill: {\n\t\t\t\t\tstyle: hslOutline.l > 0.6 ? '#000000' : '#FFFFFF',\n\t\t\t\t},\n\t\t\t};\n\t\t\tw = this.obj.customNameboxWidth;\n\t\t\trx.customTransform(\n\t\t\t\tctx => {\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\troundedTopRectangle(ctx, x, y, w, h, 12);\n\t\t\t\t\tctx.clip();\n\t\t\t\t},\n\t\t\t\tsubRx => {\n\t\t\t\t\tconst gradient = subRx.linearGradient(x, y, x, y + NameboxHeight);\n\t\t\t\t\tconst baseBG = RGBAColor.fromCss(this.nameboxBackgroundColor);\n\t\t\t\t\tconst color = new RGBAColor(baseBG.r, baseBG.g, baseBG.b, 244);\n\t\t\t\t\tconst delta = new HSLAColor(\n\t\t\t\t\t\t-0.004901960784313708,\n\t\t\t\t\t\t-0.8599999999999999,\n\t\t\t\t\t\t-0.16274509803921566,\n\t\t\t\t\t\t0\n\t\t\t\t\t);\n\t\t\t\t\tconst targetColor = color\n\t\t\t\t\t\t.toHSL()\n\t\t\t\t\t\t.shift(delta)\n\t\t\t\t\t\t.toRgb();\n\t\t\t\t\tgradient.addColorStop(0, color.toCss());\n\t\t\t\t\tgradient.addColorStop(0.82, color.toCss());\n\t\t\t\t\tgradient.addColorStop(1, targetColor.toCss());\n\t\t\t\t\tsubRx.drawRect({\n\t\t\t\t\t\tx,\n\t\t\t\t\t\ty,\n\t\t\t\t\t\tw: this.obj.width,\n\t\t\t\t\t\th: this.obj.height,\n\t\t\t\t\t\tfill: {\n\t\t\t\t\t\t\tstyle: gradient,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t);\n\t\t} else {\n\t\t\tw = NameboxWidth;\n\t\t\trx.drawImage({\n\t\t\t\timage: await getAsset('namebox'),\n\t\t\t\tx,\n\t\t\t\ty,\n\t\t\t});\n\t\t}\n\t\trx.drawText({\n\t\t\tx: x + w / 2,\n\t\t\ty: y + NameboxTextYOffset,\n\t\t\ttext: name,\n\t\t\t...style,\n\t\t});\n\t}\n\n\tprivate async renderBackdrop(\n\t\trx: RenderContext,\n\t\tx: number,\n\t\ty: number\n\t): Promise<void> {\n\t\tif (this.obj.style === 'custom') {\n\t\t\tconst hslColor = RGBAColor.fromCss(this.obj.customColor).toHSL();\n\t\t\tconst dotPattern = new Renderer(47, 47);\n\t\t\tdotPattern.render(async (dotRx: RenderContext) => {\n\t\t\t\tconst fillDelta = new HSLAColor(\n\t\t\t\t\t0.004269293924466178,\n\t\t\t\t\t-0.01869158878504662,\n\t\t\t\t\t-0.039215686274509665,\n\t\t\t\t\t0\n\t\t\t\t);\n\t\t\t\tconst fill = {\n\t\t\t\t\tstyle: hslColor\n\t\t\t\t\t\t.shift(fillDelta)\n\t\t\t\t\t\t.toRgb()\n\t\t\t\t\t\t.toCss(),\n\t\t\t\t};\n\n\t\t\t\tdotRx.drawPath({\n\t\t\t\t\tpath: ctx => {\n\t\t\t\t\t\tctx.ellipse(0, 0, 9.5, 9.5, 0, 0, 2 * Math.PI);\n\t\t\t\t\t},\n\t\t\t\t\tfill,\n\t\t\t\t});\n\t\t\t\tdotRx.drawPath({\n\t\t\t\t\tpath: ctx => {\n\t\t\t\t\t\tctx.ellipse(47, 0, 9.5, 9.5, 0, 0, 2 * Math.PI);\n\t\t\t\t\t},\n\t\t\t\t\tfill,\n\t\t\t\t});\n\t\t\t\tdotRx.drawPath({\n\t\t\t\t\tpath: ctx => {\n\t\t\t\t\t\tctx.ellipse(0, 47, 9.5, 9.5, 0, 0, 2 * Math.PI);\n\t\t\t\t\t},\n\t\t\t\t\tfill,\n\t\t\t\t});\n\t\t\t\tdotRx.drawPath({\n\t\t\t\t\tpath: ctx => {\n\t\t\t\t\t\tctx.ellipse(47, 47, 9.5, 9.5, 0, 0, 2 * Math.PI);\n\t\t\t\t\t},\n\t\t\t\t\tfill,\n\t\t\t\t});\n\t\t\t\tdotRx.drawPath({\n\t\t\t\t\tpath: ctx => {\n\t\t\t\t\t\tctx.ellipse(23.5, 24.5, 9.5, 9.5, 0, 0, 2 * Math.PI);\n\t\t\t\t\t},\n\t\t\t\t\tfill,\n\t\t\t\t});\n\t\t\t}, true);\n\t\t\trx.customTransform(\n\t\t\t\tctx => {\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\troundedRectangle(\n\t\t\t\t\t\tctx,\n\t\t\t\t\t\tx + 1.5,\n\t\t\t\t\t\ty + 1.5,\n\t\t\t\t\t\tthis.obj.width - 3,\n\t\t\t\t\t\tthis.obj.height - 3,\n\t\t\t\t\t\t12\n\t\t\t\t\t);\n\t\t\t\t\tctx.clip();\n\t\t\t\t},\n\t\t\t\tsubRx => {\n\t\t\t\t\tconst h = this.obj.height;\n\t\t\t\t\tconst w = this.obj.width;\n\t\t\t\t\tconst gradient = subRx.linearGradient(x, y, x, y + h);\n\t\t\t\t\tconst color = RGBAColor.fromHex(this.obj.customColor);\n\t\t\t\t\tgradient.addColorStop(0, color.toCss());\n\t\t\t\t\tgradient.addColorStop(\n\t\t\t\t\t\t1,\n\t\t\t\t\t\t`rgba(${color.r},${color.g},${color.b},0.6667)`\n\t\t\t\t\t);\n\t\t\t\t\tsubRx.drawRect({\n\t\t\t\t\t\tx,\n\t\t\t\t\t\ty,\n\t\t\t\t\t\tw,\n\t\t\t\t\t\th,\n\t\t\t\t\t\tfill: {\n\t\t\t\t\t\t\tstyle: gradient,\n\t\t\t\t\t\t},\n\t\t\t\t\t\toutline: {\n\t\t\t\t\t\t\tstyle: '#ffdfee',\n\t\t\t\t\t\t\twidth: 6,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\tsubRx.customTransform(\n\t\t\t\t\t\tctx => {\n\t\t\t\t\t\t\tctx.translate(x, y);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsubSubRx => {\n\t\t\t\t\t\t\tconst pattern = subRx.patternFrom(dotPattern);\n\t\t\t\t\t\t\tsubRx.drawRect({\n\t\t\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\t\t\ty: 0,\n\t\t\t\t\t\t\t\tw,\n\t\t\t\t\t\t\t\th,\n\t\t\t\t\t\t\t\tfill: {\n\t\t\t\t\t\t\t\t\tstyle: pattern,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcomposition: 'source-atop',\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tconst glowGradient = subRx.linearGradient(\n\t\t\t\t\t\tx,\n\t\t\t\t\t\ty + h - GlowRY,\n\t\t\t\t\t\tx,\n\t\t\t\t\t\ty + h\n\t\t\t\t\t);\n\t\t\t\t\tglowGradient.addColorStop(0, 'rgba(255,255,255,0.3137)');\n\t\t\t\t\tglowGradient.addColorStop(0.5, 'rgba(255,255,255,0.0627)');\n\t\t\t\t\tglowGradient.addColorStop(1, 'rgba(255,255,255,0)');\n\t\t\t\t\tsubRx.drawPath({\n\t\t\t\t\t\tpath: ctx => {\n\t\t\t\t\t\t\tctx.ellipse(x + w / 2, y + h, GlowRX, GlowRY, 0, 0, 2 * Math.PI);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfill: {\n\t\t\t\t\t\t\tstyle: glowGradient,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t);\n\t\t\tconst outlineDelta = new HSLAColor(\n\t\t\t\t0.0023347701149424305,\n\t\t\t\t0,\n\t\t\t\t0.10784313725490202,\n\t\t\t\t0\n\t\t\t);\n\t\t\tconst outlineColor = hslColor\n\t\t\t\t.shift(outlineDelta)\n\t\t\t\t.toRgb()\n\t\t\t\t.toCss();\n\t\t\trx.drawPath({\n\t\t\t\tpath: path => {\n\t\t\t\t\troundedRectangle(\n\t\t\t\t\t\tpath,\n\t\t\t\t\t\tx + 1.5,\n\t\t\t\t\t\ty + 1.5,\n\t\t\t\t\t\tthis.obj.width - 3,\n\t\t\t\t\t\tthis.obj.height - 3,\n\t\t\t\t\t\t12\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\toutline: {\n\t\t\t\t\tstyle: outlineColor,\n\t\t\t\t\twidth: 3,\n\t\t\t\t},\n\t\t\t});\n\t\t} else {\n\t\t\tif (this.obj.style === 'corrupt') {\n\t\t\t\tx += (TextBoxWidth - TextBoxCorruptedWidth) / 2;\n\t\t\t}\n\t\t\tconst image = await getAsset(\n\t\t\t\tthis.obj.style === 'corrupt' ? 'textbox_monika' : 'textbox'\n\t\t\t);\n\t\t\trx.drawImage({ image, x, y });\n\t\t}\n\t}\n\n\tprivate renderText(rx: RenderContext, baseX: number, baseY: number): void {\n\t\tconst text: DialogLetter[][] = [];\n\n\t\tlet b = false;\n\n\t\tfor (const line of this.obj.text.split('\\n')) {\n\t\t\tlet cl;\n\t\t\ttext.push((cl = []));\n\t\t\tfor (const l of line) {\n\t\t\t\tif (l === '[') {\n\t\t\t\t\tb = true;\n\t\t\t\t} else if (l === ']') {\n\t\t\t\t\tb = false;\n\t\t\t\t} else {\n\t\t\t\t\tcl.push({ l, b });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst startX = baseX + TextBoxTextXOffset;\n\t\tlet y = baseY + NameboxHeight + TextBoxTextYOffset;\n\n\t\tif (text[0] && text[0][0] && text[0][0].b) {\n\t\t\ty += TextBoxTextCorruptedYOffset;\n\t\t}\n\n\t\tfor (const line of text) {\n\t\t\tlet x = startX;\n\n\t\t\tif (line[0] && line[0].b) {\n\t\t\t\tx += TextBoxTextCorruptedXOffset;\n\t\t\t}\n\t\t\tfor (const letter of line) {\n\t\t\t\tconst ct = letter.l;\n\t\t\t\tconst cb = letter.b;\n\n\t\t\t\trx.drawText({\n\t\t\t\t\ttext: ct,\n\t\t\t\t\tx,\n\t\t\t\t\ty,\n\t\t\t\t\t...(cb ? TextBoxCorruptedStyle : TextBoxStyle),\n\t\t\t\t});\n\t\t\t\tx += rx.measureText({\n\t\t\t\t\ttext: ct,\n\t\t\t\t\t...(cb ? TextBoxCorruptedStyle : TextBoxStyle),\n\t\t\t\t}).width;\n\t\t\t\tx += cb ? TextBoxCorruptedKerning : TextBoxKerning;\n\t\t\t}\n\t\t\ty += TextBoxLineHeight;\n\t\t}\n\t}\n}\n\ninterface DialogLetter {\n\tl: string;\n\tb: boolean;\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n// App.vue has currently so many responsiblities that it's best to break it into chunks\r\n// tslint:disable:member-ordering\r\nimport { Component, Vue, Watch, Prop } from 'vue-property-decorator';\r\nimport { State } from 'vuex-class-decorator';\r\nimport { VariantBackground } from '../models/variant-background';\r\nimport { Store } from 'vuex';\r\nimport { IRootState } from '@/store';\r\nimport { Renderer } from '@/renderer/renderer';\r\nimport { IRenderable } from '@/models/renderable';\r\nimport { IBackground, color } from '@/models/background';\r\nimport { IHistorySupport } from '@/plugins/vuex-history';\r\nimport { RenderContext } from '@/renderer/rendererContext';\r\nimport { getAsset, registerAsset } from '@/asset-manager';\r\nimport eventBus, { InvalidateRenderEvent } from '@/eventbus/event-bus';\r\nimport { ICreateTextBoxAction, ITextBox } from '@/store/objectTypes/textbox';\r\nimport {\r\n\tIObject,\r\n\tISetObjectPositionMutation,\r\n\tIRemoveObjectAction,\r\n\tIObjectsState,\r\n} from '@/store/objects';\r\nimport { ICreateSpriteAction, ISprite } from '@/store/objectTypes/sprite';\r\nimport { Character } from '@/models/character';\r\nimport {\r\n\tIShiftCharacterSlotAction,\r\n\tICharacter,\r\n} from '@/store/objectTypes/characters';\r\nimport { Sprite } from '@/models/sprite';\r\nimport { TextBox } from '@/models/textbox';\r\nimport { ISetCurrentMutation } from '@/store/background';\r\nimport content from '@/store/content';\r\n\r\n@Component({})\r\nexport default class Render extends Vue {\r\n\tpublic $store!: Store<IRootState>;\r\n\r\n\tprivate sdCtx: CanvasRenderingContext2D | undefined;\r\n\r\n\tprivate get selection(): string | null {\r\n\t\treturn this.$store.state.ui.selection;\r\n\t}\r\n\r\n\tprivate renderer: Renderer = new Renderer();\r\n\tprivate currentlyRendering: boolean = false;\r\n\r\n\tprivate queuedRender: number | null = null;\r\n\tprivate showingLast: boolean = false;\r\n\r\n\tprivate dropSpriteCount = 0;\r\n\tprivate dropPreventClick = false;\r\n\r\n\t@Prop({ type: Number, default: 0 }) private readonly canvasWidth!: number;\r\n\t@Prop({ type: Number, default: 0 }) private readonly canvasHeight!: number;\r\n\r\n\t@State('lqRendering', { namespace: 'ui' })\r\n\tprivate readonly lqRendering!: boolean;\r\n\r\n\tpublic async blendOver(imageUrl: string): Promise<void> {\r\n\t\tconst completed = await this.renderer.render(rc => {\r\n\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\tconst img = new Image();\r\n\t\t\t\timg.addEventListener('load', () => {\r\n\t\t\t\t\trc.drawImage({\r\n\t\t\t\t\t\timage: img,\r\n\t\t\t\t\t\tx: 0,\r\n\t\t\t\t\t\ty: 0,\r\n\t\t\t\t\t\tw: 1280,\r\n\t\t\t\t\t\th: 720,\r\n\t\t\t\t\t});\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t});\r\n\t\t\t\timg.src = imageUrl;\r\n\t\t\t});\r\n\t\t}, true);\r\n\t\tif (completed) this.display();\r\n\t}\r\n\r\n\tpublic async download(): Promise<void> {\r\n\t\tconst url = await this.renderer.download(this.renderCallback, 'panel.png');\r\n\r\n\t\tthis.history.transaction(async () => {\r\n\t\t\tconst oldUrl = this.$store.state.ui.lastDownload;\r\n\r\n\t\t\tthis.$store.commit('ui/setLastDownload', url);\r\n\t\t\tif (oldUrl) {\r\n\t\t\t\tURL.revokeObjectURL(oldUrl);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate get history(): IHistorySupport {\r\n\t\treturn this.$root as any;\r\n\t}\r\n\r\n\tprivate get currentBackground(): IBackground | null {\r\n\t\tswitch (this.$store.state.background.current) {\r\n\t\t\tcase 'buildin.static-color':\r\n\t\t\t\tcolor.color = this.$store.state.background.color;\r\n\t\t\t\treturn color;\r\n\t\t\tdefault:\r\n\t\t\t\tconst current = this.$store.state.content.current.backgrounds.find(\r\n\t\t\t\t\tbackground =>\r\n\t\t\t\t\t\tbackground.label === this.$store.state.background.current\r\n\t\t\t\t)!;\r\n\t\t\t\tif (!current) return null;\r\n\t\t\t\tconst variant = current.variants[this.$store.state.background.variant];\r\n\t\t\t\tif (!variant) return null;\r\n\t\t\t\treturn new VariantBackground(\r\n\t\t\t\t\tcurrent.label,\r\n\t\t\t\t\tvariant,\r\n\t\t\t\t\tthis.$store.state.background.flipped\r\n\t\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate invalidateRender() {\r\n\t\tif (this.queuedRender) return;\r\n\t\tthis.queuedRender = requestAnimationFrame(() => this.render_());\r\n\t}\r\n\r\n\tprivate async renderLoadingScreen(): Promise<void> {\r\n\t\tconst completed = await this.renderer.render(async rc => {\r\n\t\t\trc.drawText({\r\n\t\t\t\ttext: 'Starting...',\r\n\t\t\t\tx: this.renderer.width / 2,\r\n\t\t\t\ty: this.renderer.height / 2,\r\n\t\t\t\talign: 'center',\r\n\t\t\t\toutline: {\r\n\t\t\t\t\twidth: 5,\r\n\t\t\t\t\tstyle: '#b59',\r\n\t\t\t\t},\r\n\t\t\t\tfont: '32px riffic',\r\n\t\t\t\tfill: {\r\n\t\t\t\t\tstyle: 'white',\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t}, true);\r\n\t\tif (completed) this.display();\r\n\t}\r\n\r\n\tprivate async render_(): Promise<void> {\r\n\t\tif (this.queuedRender) {\r\n\t\t\tcancelAnimationFrame(this.queuedRender);\r\n\t\t\tthis.queuedRender = null;\r\n\t\t}\r\n\r\n\t\tif (this.$store.state.unsafe) return;\r\n\r\n\t\tconst completed = await this.renderer.render(\r\n\t\t\tthis.renderCallback,\r\n\t\t\t!this.lqRendering\r\n\t\t);\r\n\t\tif (completed) {\r\n\t\t\tthis.display();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate async renderCallback(rx: RenderContext): Promise<void> {\r\n\t\tthis.currentlyRendering = true;\r\n\t\ttry {\r\n\t\t\tif (rx.preview) {\r\n\t\t\t\trx.drawImage({\r\n\t\t\t\t\tx: 0,\r\n\t\t\t\t\ty: 0,\r\n\t\t\t\t\timage: await getAsset('backgrounds/transparent'),\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif (this.currentBackground) {\r\n\t\t\t\tawait this.currentBackground.render(rx);\r\n\t\t\t}\r\n\r\n\t\t\tfor (const object of this.renderObjects) {\r\n\t\t\t\tawait object.render(this.selection === object.id, rx);\r\n\t\t\t}\r\n\t\t} finally {\r\n\t\t\tthis.currentlyRendering = false;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate async created(): Promise<void> {\r\n\t\teventBus.subscribe(InvalidateRenderEvent, command => this.invalidateRender);\r\n\t\tthis.$store.subscribe(this.invalidateRender);\r\n\t}\r\n\r\n\tprivate mounted(): void {\r\n\t\tconst sd = this.$refs.sd as HTMLCanvasElement;\r\n\t\tthis.sdCtx = sd.getContext('2d') || undefined;\r\n\r\n\t\tthis.renderLoadingScreen();\r\n\t\tthis.invalidateRender();\r\n\t}\r\n\r\n\t@Watch('canvasWidth')\r\n\t@Watch('canvasHeight')\r\n\tprivate display(): void {\r\n\t\tif (!this.sdCtx) return;\r\n\t\tthis.showingLast = false;\r\n\t\tthis.renderer.paintOnto(this.sdCtx, 0, 0, 1280, 720);\r\n\t}\r\n\r\n\tprivate toRendererCoordinate(x: number, y: number): [number, number] {\r\n\t\tconst sd = this.$refs.sd as HTMLCanvasElement;\r\n\t\tconst rx = x - sd.offsetLeft;\r\n\t\tconst ry = y - sd.offsetTop;\r\n\t\tconst sx = (rx / sd.offsetWidth) * sd.width;\r\n\t\tconst sy = (ry / sd.offsetWidth) * sd.width;\r\n\t\treturn [sx, sy];\r\n\t}\r\n\r\n\tprivate onUiClick(e: MouseEvent): void {\r\n\t\tif (this.dropPreventClick) {\r\n\t\t\tthis.dropPreventClick = false;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst [sx, sy] = this.toRendererCoordinate(e.clientX, e.clientY);\r\n\r\n\t\tconst objects = this.objectsAt(sx, sy);\r\n\r\n\t\tconst currentObjectIdx = objects.findIndex(\r\n\t\t\tobj => obj.id === this.selection\r\n\t\t);\r\n\t\tlet selectedObject: IRenderable | null;\r\n\r\n\t\tif (currentObjectIdx === 0) {\r\n\t\t\tselectedObject = null;\r\n\t\t} else if (currentObjectIdx !== -1) {\r\n\t\t\t// Select the next lower character\r\n\t\t\tselectedObject = objects[currentObjectIdx - 1];\r\n\t\t} else {\r\n\t\t\tselectedObject = objects[objects.length - 1] || null;\r\n\t\t}\r\n\r\n\t\tthis.$store.commit(\r\n\t\t\t'ui/setSelection',\r\n\t\t\tselectedObject ? selectedObject.id : null\r\n\t\t);\r\n\t}\r\n\r\n\tprivate objectsAt(x: number, y: number): IRenderable[] {\r\n\t\treturn this.renderObjects.filter(renderObject =>\r\n\t\t\trenderObject.hitTest(x, y)\r\n\t\t);\r\n\t}\r\n\r\n\tprivate draggedObject: IObject | null = null;\r\n\tprivate dragXOffset: number = 0;\r\n\tprivate dragYOffset: number = 0;\r\n\tprivate dragXOriginal: number = 0;\r\n\tprivate dragYOriginal: number = 0;\r\n\r\n\tprivate onDragStart(e: DragEvent) {\r\n\t\te.preventDefault();\r\n\t\tif (!this.selection) return;\r\n\t\tthis.draggedObject = this.$store.state.objects.objects[this.selection];\r\n\t\tconst [x, y] = this.toRendererCoordinate(e.clientX, e.clientY);\r\n\t\tthis.dragXOffset = x - this.draggedObject.x;\r\n\t\tthis.dragYOffset = y - this.draggedObject.y;\r\n\t\tthis.dragXOriginal = this.draggedObject.x;\r\n\t\tthis.dragYOriginal = this.draggedObject.y;\r\n\t}\r\n\r\n\tprivate onTouchStart(e: TouchEvent) {\r\n\t\tif (!this.selection) return;\r\n\t\tthis.draggedObject = this.$store.state.objects.objects[this.selection];\r\n\t\tconst [x, y] = this.toRendererCoordinate(\r\n\t\t\te.touches[0].clientX,\r\n\t\t\te.touches[0].clientY\r\n\t\t);\r\n\t\tthis.dragXOffset = x - this.draggedObject.x;\r\n\t\tthis.dragYOffset = y - this.draggedObject.y;\r\n\t\tthis.dragXOriginal = this.draggedObject.x;\r\n\t\tthis.dragYOriginal = this.draggedObject.y;\r\n\t}\r\n\r\n\tprivate onDragOver(e: DragEvent) {\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\t\te.dataTransfer!.dropEffect = 'copy';\r\n\t}\r\n\r\n\tprivate onSpriteDragMove(e: MouseEvent | TouchEvent) {\r\n\t\tif (this.draggedObject) {\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\t// Formatter quirk\r\n\t\t\t// tslint:disable:indent\r\n\t\t\tlet [x, y] =\r\n\t\t\t\te instanceof MouseEvent\r\n\t\t\t\t\t? this.toRendererCoordinate(e.clientX, e.clientY)\r\n\t\t\t\t\t: this.toRendererCoordinate(\r\n\t\t\t\t\t\t\te.touches[0].clientX,\r\n\t\t\t\t\t\t\te.touches[0].clientY\r\n\t\t\t\t\t  );\r\n\t\t\t// tslint:enable:indent\r\n\t\t\tx -= this.dragXOffset;\r\n\t\t\ty -= this.dragYOffset;\r\n\r\n\t\t\tconst deltaX = Math.abs(x - this.dragXOriginal);\r\n\t\t\tconst deltaY = Math.abs(y - this.dragYOriginal);\r\n\r\n\t\t\tif (deltaX + deltaY > 1) this.dropPreventClick = true;\r\n\r\n\t\t\tif (e.shiftKey) {\r\n\t\t\t\tif (deltaX > deltaY) {\r\n\t\t\t\t\ty = this.dragYOriginal;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tx = this.dragXOriginal;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.history.transaction(() => {\r\n\t\t\t\tthis.$store.dispatch('objects/setPosition', {\r\n\t\t\t\t\tid: this.draggedObject!.id,\r\n\t\t\t\t\tx,\r\n\t\t\t\t\ty,\r\n\t\t\t\t} as ISetObjectPositionMutation);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate async onDrop(e: DragEvent) {\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\r\n\t\tif (!e.dataTransfer) return;\r\n\r\n\t\tfor (const item of e.dataTransfer.items) {\r\n\t\t\tif (item.kind === 'file' && item.type.match(/image.*/)) {\r\n\t\t\t\tconst name = 'dropCustomAsset' + ++this.dropSpriteCount;\r\n\t\t\t\tconst url = registerAsset(name, item.getAsFile()!);\r\n\r\n\t\t\t\tthis.history.transaction(async () => {\r\n\t\t\t\t\tawait this.$store.dispatch('objects/createSprite', {\r\n\t\t\t\t\t\tasset: {\r\n\t\t\t\t\t\t\thq: url,\r\n\t\t\t\t\t\t\tlq: url,\r\n\t\t\t\t\t\t\tsourcePack: 'dddg.generated.uploaded-sprites',\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t} as ICreateSpriteAction);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate onSpriteDrop(e: MouseEvent | TouchEvent) {\r\n\t\tif (this.draggedObject) {\r\n\t\t\tif ('TouchEvent' in window && e instanceof TouchEvent) {\r\n\t\t\t\tthis.dropPreventClick = false;\r\n\t\t\t}\r\n\t\t\tthis.draggedObject = null;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate onMouseEnter(e: MouseEvent) {\r\n\t\tif (e.buttons !== 1) {\r\n\t\t\tthis.draggedObject = null;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate renderObjectCache: { [id: string]: IRenderable } = {};\r\n\tprivate get renderObjects() {\r\n\t\tconst objectsState = this.$store.state.objects;\r\n\t\tconst order = [...objectsState.order, ...objectsState.onTopOrder];\r\n\t\tconst objects = this.$store.state.objects.objects;\r\n\t\tconst toUncache = Object.keys(this.renderObjectCache).filter(\r\n\t\t\tid => !order.includes(id)\r\n\t\t);\r\n\r\n\t\tfor (const id of toUncache) {\r\n\t\t\tif (this.selection === id) {\r\n\t\t\t\tthis.history.transaction(() => {\r\n\t\t\t\t\tthis.$store.commit('ui/setSelection', id);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tthis.$delete(this.renderObjectCache, id);\r\n\t\t}\r\n\r\n\t\treturn order.map(id => {\r\n\t\t\tif (!this.renderObjectCache[id]) {\r\n\t\t\t\tconst obj = objects[id];\r\n\t\t\t\tswitch (obj.type) {\r\n\t\t\t\t\tcase 'sprite':\r\n\t\t\t\t\t\tthis.renderObjectCache[id] = new Sprite((obj as any) as ISprite);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'character':\r\n\t\t\t\t\t\tthis.renderObjectCache[id] = new Character(\r\n\t\t\t\t\t\t\t(obj as any) as ICharacter,\r\n\t\t\t\t\t\t\tthis.$store\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'textBox':\r\n\t\t\t\t\t\tthis.renderObjectCache[id] = new TextBox((obj as any) as ITextBox);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.renderObjectCache[id].obj = objects[id];\r\n\t\t\treturn this.renderObjectCache[id];\r\n\t\t});\r\n\t}\r\n}\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./render.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./render.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./render.vue?vue&type=template&id=779f8857&\"\nimport script from \"./render.vue?vue&type=script&lang=ts&\"\nexport * from \"./render.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n// App.vue has currently so many responsiblities that it's best to break it into chunks\n// tslint:disable:member-ordering\nimport { Component, Vue } from 'vue-property-decorator';\nimport { State } from 'vuex-class-decorator';\nimport { Store } from 'vuex';\nimport { IRootState } from '@/store';\nimport { IRenderable } from '@/models/renderable';\nimport { IHistorySupport } from '@/plugins/vuex-history';\nimport { ICreateTextBoxAction } from '@/store/objectTypes/textbox';\nimport {\n\tIObject,\n\tISetObjectPositionMutation,\n\tIRemoveObjectAction,\n} from '@/store/objects';\nimport { Character } from '@/models/character';\nimport {\n\tIShiftCharacterSlotAction,\n\tICharacter,\n} from '@/store/objectTypes/characters';\nimport ToolBox from '@/components/toolbox/toolbox.vue';\nimport MessageConsole from '@/components/message-console.vue';\nimport Render from '@/components/render.vue';\nimport { ISetCurrentMutation } from '@/store/background';\n\n@Component({\n\tcomponents: {\n\t\tToolBox,\n\t\tMessageConsole,\n\t\tRender,\n\t},\n})\nexport default class App extends Vue {\n\tpublic canvasWidth: number = 0;\n\tpublic canvasHeight: number = 0;\n\tpublic $store!: Store<IRootState>;\n\tprivate blendOver: string | null = null;\n\n\tprivate uiSize: number = 192;\n\tprivate currentlyRendering: boolean = false;\n\n\tprivate panel: string = '';\n\n\tprivate drawLastDownload(): void {\n\t\tconst last = this.$store.state.ui.lastDownload;\n\t\tif (!last) return;\n\t\t(this.$refs.render as Render).blendOver(last);\n\t}\n\n\tprivate get history(): IHistorySupport {\n\t\treturn this.$root as any;\n\t}\n\n\tprivate setBlendOver(): void {\n\t\tthis.blendOver = this.$store.state.ui.lastDownload;\n\t}\n\n\tprivate async created(): Promise<void> {\n\t\t// Moving this to the \"mounted\"-handler crashes safari over version 12.\n\t\t// My best guess is because it runs in a microtask, which have been added in that Version.\n\t\tthis.updateArea();\n\t\twindow.addEventListener('resize', this.updateArea);\n\t\twindow.removeEventListener('keydown', this.onKeydown);\n\t\twindow.addEventListener('keydown', this.onKeydown);\n\t\tif (Object.keys(this.$store.state.objects.objects).length === 0) {\n\t\t\tthis.$store.dispatch('objects/createTextBox', {} as ICreateTextBoxAction);\n\t\t}\n\n\t\tthis.history.transaction(async () => {\n\t\t\tawait this.$store.dispatch('content/loadContentPacks', [\n\t\t\t\t`${process.env.BASE_URL}packs/buildin.base.backgrounds.json`,\n\t\t\t\t`${process.env.BASE_URL}packs/buildin.base.monika.json`,\n\t\t\t\t`${process.env.BASE_URL}packs/buildin.base.sayori.json`,\n\t\t\t\t`${process.env.BASE_URL}packs/buildin.base.natsuki.json`,\n\t\t\t\t`${process.env.BASE_URL}packs/buildin.base.yuri.json`,\n\t\t\t\t`${process.env.BASE_URL}packs/buildin.extra.mc.json`,\n\t\t\t\t`${process.env.BASE_URL}packs/buildin.extra.mc_chad.json`,\n\t\t\t\t`${process.env.BASE_URL}packs/buildin.extra.mc_classic.json`,\n\t\t\t\t`${process.env.BASE_URL}packs/buildin.extra.femc.json`,\n\t\t\t\t`${process.env.BASE_URL}packs/buildin.extra.classic_amy.json`,\n\t\t\t\t`${process.env.BASE_URL}packs/buildin.extra.amy.json`,\n\t\t\t]);\n\n\t\t\tawait this.$store.commit('background/setCurrent', {\n\t\t\t\tcurrent: 'Clubroom',\n\t\t\t} as ISetCurrentMutation);\n\t\t});\n\t}\n\n\tprivate destroyed(): void {\n\t\twindow.removeEventListener('keydown', this.onKeydown);\n\t}\n\n\tprivate mounted(): void {\n\t\twindow.addEventListener('keypress', e => {\n\t\t\tif (e.keyCode === 27) {\n\t\t\t\tthis.history.transaction(() => {\n\t\t\t\t\tthis.$store.commit('ui/setSelection', null);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate optimum(sw: number, sh: number): [number, number] {\n\t\tlet rh = sw / (16 / 9);\n\t\tlet rw = sh * (16 / 9);\n\n\t\tif (rh > sh) {\n\t\t\trh = sh;\n\t\t} else {\n\t\t\trw = sw;\n\t\t}\n\n\t\treturn [rw, rh];\n\t}\n\n\tprivate optimizeWithMenu(sw: number, sh: number): [number, number, boolean] {\n\t\tconst opth = this.optimum(sw, sh - this.uiSize);\n\t\tconst optv = this.optimum(sw - this.uiSize, sh);\n\n\t\tif (opth[0] * opth[1] > optv[0] * optv[1]) {\n\t\t\treturn [opth[0], opth[1], false];\n\t\t} else {\n\t\t\treturn [optv[0], optv[1], true];\n\t\t}\n\t}\n\n\tprivate updateArea(): void {\n\t\tconst [cw, ch, v] = this.optimizeWithMenu(\n\t\t\tdocument.documentElement.clientWidth,\n\t\t\tdocument.documentElement.clientHeight\n\t\t);\n\n\t\tthis.canvasWidth = cw;\n\t\tthis.canvasHeight = ch;\n\t\tthis.$store.commit('ui/setVertical', v);\n\t}\n\n\tprivate onKeydown(e: KeyboardEvent) {\n\t\tthis.history.transaction(() => {\n\t\t\tconst selection = this.$store.state.objects.objects[\n\t\t\t\tthis.$store.state.ui.selection!\n\t\t\t];\n\t\t\tif (!selection) return;\n\t\t\tif (e.key === 'Delete') {\n\t\t\t\tthis.$store.dispatch('objects/removeObject', {\n\t\t\t\t\tid: selection.id,\n\t\t\t\t} as IRemoveObjectAction);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (e.key === 'z' && e.ctrlKey) {\n\t\t\t\tthis.$store.commit('history/undo');\n\t\t\t\treturn;\n\t\t\t} else if (e.key === 'y' && e.ctrlKey) {\n\t\t\t\tthis.$store.commit('history/redo');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (selection.type === 'character') {\n\t\t\t\tconst character = selection as ICharacter;\n\t\t\t\tif (character.freeMove) {\n\t\t\t\t\tif (e.key === 'ArrowLeft') {\n\t\t\t\t\t\tthis.$store.dispatch('objects/shiftCharacterSlot', {\n\t\t\t\t\t\t\tid: character.id,\n\t\t\t\t\t\t\tdelta: -1,\n\t\t\t\t\t\t} as IShiftCharacterSlotAction);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (e.key === 'ArrowRight') {\n\t\t\t\t\t\tthis.$store.dispatch('objects/shiftCharacterSlot', {\n\t\t\t\t\t\t\tid: character.id,\n\t\t\t\t\t\t\tdelta: 1,\n\t\t\t\t\t\t} as IShiftCharacterSlotAction);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet { x, y } = selection;\n\t\t\tif (e.key === 'ArrowLeft') {\n\t\t\t\tx -= e.shiftKey ? 1 : 20;\n\t\t\t} else if (selection && e.key === 'ArrowRight') {\n\t\t\t\tx += e.shiftKey ? 1 : 20;\n\t\t\t} else if (selection && e.key === 'ArrowUp') {\n\t\t\t\ty -= e.shiftKey ? 1 : 20;\n\t\t\t} else if (selection && e.key === 'ArrowDown') {\n\t\t\t\ty += e.shiftKey ? 1 : 20;\n\t\t\t} else {\n\t\t\t\tconsole.log(e);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.$store.dispatch('objects/setPosition', {\n\t\t\t\tid: selection.id,\n\t\t\t\tx,\n\t\t\t\ty,\n\t\t\t} as ISetObjectPositionMutation);\n\t\t\tconsole.log(e);\n\t\t\treturn;\n\t\t});\n\t}\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=66e85f2a&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import { ICommand } from '@/eventbus/command';\nimport { getAAsset } from '@/asset-manager';\nimport { IObjectsState, ICreateObjectMutation, IObject } from '@/store/objects';\nimport { MutationTree, ActionTree } from 'vuex';\nimport { IRootState } from '..';\nimport { IAsset } from '../content';\n\nexport interface ISprite extends IObject {\n\ttype: 'sprite';\n\tasset: IAsset;\n}\n\nexport const spriteMutations: MutationTree<IObjectsState> = {};\n\nlet lastSpriteId = 0;\n\nexport const spriteActions: ActionTree<IObjectsState, IRootState> = {\n\tasync createSprite({ state, commit }, command: ICreateSpriteAction) {\n\t\tconst asset = await getAAsset(command.asset, false);\n\t\tif (!(asset instanceof HTMLImageElement)) return;\n\t\tcommit('create', {\n\t\t\tobject: {\n\t\t\t\tasset: command.asset,\n\t\t\t\tflip: false,\n\t\t\t\theight: asset.height,\n\t\t\t\twidth: asset.width,\n\t\t\t\tid: 'sprite_' + ++lastSpriteId,\n\t\t\t\tonTop: false,\n\t\t\t\topacity: 100,\n\t\t\t\tpreserveRatio: true,\n\t\t\t\tratio: asset.width / asset.height,\n\t\t\t\ttype: 'sprite',\n\t\t\t\tversion: 0,\n\t\t\t\tx: 640,\n\t\t\t\ty: 0,\n\t\t\t} as ISprite,\n\t\t} as ICreateObjectMutation);\n\t},\n};\n\nexport interface ICreateSpriteAction extends ICommand {\n\treadonly asset: IAsset;\n}\n","import { ICommand } from '@/eventbus/command';\nimport {\n\tIObjectsState,\n\tICreateObjectMutation,\n\tIObject,\n\tISetObjectPositionMutation,\n\tISetObjectFlipMutation,\n} from '@/store/objects';\nimport { MutationTree, ActionTree } from 'vuex';\nimport {\n\tNameboxY,\n\tTextBoxWidth,\n\tTextBoxHeight,\n} from '@/models/textBoxConstants';\nimport { ISetSpriteSizeMutation } from './characters';\n\nexport interface ITextBox extends IObject {\n\ttype: 'textBox';\n\ttext: string;\n\ttalkingDefault:\n\t\t| 'No-one'\n\t\t| 'Sayori'\n\t\t| 'Monika'\n\t\t| 'Natsuki'\n\t\t| 'Yuri'\n\t\t| 'MC'\n\t\t| 'FeMC'\n\t\t| 'Chad'\n\t\t| 'Amy'\n\t\t| 'Other';\n\ttalkingOther: string;\n\tstyle: 'normal' | 'corrupt' | 'custom';\n\tcustomColor: string;\n\tderiveCustomColors: boolean;\n\tcustomControlsColor: string;\n\tcustomNameboxColor: string;\n\tcustomNameboxStroke: string;\n\tcustomNameboxWidth: number;\n\tcontrols: boolean;\n\tskip: boolean;\n\tcontinue: boolean;\n}\n\nexport const textBoxMutations: MutationTree<IObjectsState> = {\n\tsetText(state, command: ISetTextBoxTextMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.text = command.text;\n\t\t++obj.version;\n\t},\n\tsetTalkingDefault(state, command: ISetTextBoxTalkingDefaultMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.talkingDefault = command.talkingDefault;\n\t\t++obj.version;\n\t},\n\tsetTalkingOther(state, command: ISetTextBoxTalkingOtherMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.talkingOther = command.talkingOther;\n\t\tobj.talkingDefault = 'Other';\n\t\t++obj.version;\n\t},\n\tsetStyle(state, command: ISetTextBoxStyleMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.style = command.style;\n\t\t++obj.version;\n\t},\n\tsetControlsVisible(state, command: ISetTextBoxControlsVisibleMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.controls = command.controls;\n\t\t++obj.version;\n\t},\n\tsetControlsColor(state, command: ISetTextBoxCustomControlsColorMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.customControlsColor = command.customControlsColor;\n\t\t++obj.version;\n\t},\n\tsetDeriveCustomColors(state, command: ISetTextBoxDeriveCustomColorMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.deriveCustomColors = command.deriveCustomColors;\n\t\t++obj.version;\n\t},\n\tsetNameboxColor(state, command: ISetTextBoxNameboxColorMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.customNameboxColor = command.customNameboxColor;\n\t\t++obj.version;\n\t},\n\tsetNameboxStroke(state, command: ISetTextBoxNameboxStrokeMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.customNameboxStroke = command.customNameboxStroke;\n\t\t++obj.version;\n\t},\n\tsetNameboxWidth(state, command: ISetTextBoxNameboxWidthMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.customNameboxWidth = command.customNameboxWidth;\n\t\t++obj.version;\n\t},\n\tsetSkipable(state, command: ISetTextBoxControlsSkipMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.skip = command.skip;\n\t\t++obj.version;\n\t},\n\tsetContinueArrow(state, command: ISetTextBoxControlsContinueMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.continue = command.continue;\n\t\t++obj.version;\n\t},\n\tsetCustomColor(state, command: ISetTextBoxCustomColorMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.customColor = command.color;\n\t\t++obj.version;\n\t},\n};\n\nlet lastTextBoxId = 0;\n\nexport const textBoxActions: ActionTree<IObjectsState, never> = {\n\tcreateTextBox({ commit }, command: ICreateTextBoxAction): string {\n\t\tconst id = 'textBox_' + ++lastTextBoxId;\n\t\tcommit('create', {\n\t\t\tobject: {\n\t\t\t\tflip: false,\n\t\t\t\tid,\n\t\t\t\tonTop: true,\n\t\t\t\topacity: 100,\n\t\t\t\ttype: 'textBox',\n\t\t\t\tversion: 0,\n\t\t\t\tx: 640,\n\t\t\t\ty: NameboxY,\n\t\t\t\twidth: TextBoxWidth,\n\t\t\t\theight: TextBoxHeight,\n\t\t\t\tpreserveRatio: false,\n\t\t\t\tratio: TextBoxWidth / TextBoxHeight,\n\t\t\t\tcontinue: true,\n\t\t\t\tcontrols: true,\n\t\t\t\tskip: true,\n\t\t\t\tstyle: 'normal',\n\t\t\t\tcustomColor: '#ffa8d2',\n\t\t\t\tderiveCustomColors: true,\n\t\t\t\tcustomControlsColor: '#552222',\n\t\t\t\tcustomNameboxColor: '#ffeef6',\n\t\t\t\tcustomNameboxWidth: 168,\n\t\t\t\tcustomNameboxStroke: '#bb5599',\n\t\t\t\ttalkingDefault: 'No-one',\n\t\t\t\ttalkingOther: '',\n\t\t\t\ttext: '',\n\t\t\t} as ITextBox,\n\t\t} as ICreateObjectMutation);\n\t\treturn id;\n\t},\n\n\tsetStyle({ commit }, command: ISetTextBoxStyleAction) {\n\t\tcommit('setStyle', {\n\t\t\tid: command.id,\n\t\t\tstyle: command.style,\n\t\t} as ISetTextBoxStyleMutation);\n\t},\n\n\tasync splitTextbox({ commit, state, dispatch }, command: ISplitTextbox) {\n\t\tconst obj = state.objects[command.id];\n\t\tconst newWidth = (obj.width - 4) / 2;\n\t\tcommit('setSize', {\n\t\t\tid: command.id,\n\t\t\twidth: newWidth,\n\t\t\theight: obj.height,\n\t\t});\n\t\tcommit('setStyle', {\n\t\t\tid: command.id,\n\t\t\tstyle: 'custom',\n\t\t} as ISetTextBoxStyleMutation);\n\t\tcommit('setPosition', {\n\t\t\tid: command.id,\n\t\t\tx: obj.x - newWidth / 2,\n\t\t\ty: obj.y,\n\t\t} as ISetObjectPositionMutation);\n\t\tconst id = (await dispatch(\n\t\t\t'createTextBox',\n\t\t\t{} as ICreateTextBoxAction\n\t\t)) as string;\n\t\tcommit('setPosition', {\n\t\t\tid,\n\t\t\tx: obj.x + newWidth + 2,\n\t\t\ty: obj.y,\n\t\t} as ISetObjectPositionMutation);\n\t\tcommit('setSize', {\n\t\t\tid,\n\t\t\twidth: newWidth,\n\t\t\theight: obj.height,\n\t\t} as ISetSpriteSizeMutation);\n\t\tcommit('setStyle', {\n\t\t\tid,\n\t\t\tstyle: 'custom',\n\t\t} as ISetTextBoxStyleMutation);\n\t\tif (obj.flip) {\n\t\t\tcommit('setFlip', {\n\t\t\t\tid,\n\t\t\t\tflip: obj.flip,\n\t\t\t} as ISetObjectFlipMutation);\n\t\t}\n\t},\n};\n\nexport interface ISetTextBoxTextMutation extends ICommand {\n\treadonly text: string;\n}\n\nexport interface ISetTextBoxTalkingDefaultMutation extends ICommand {\n\treadonly talkingDefault: ITextBox['talkingDefault'];\n}\n\nexport interface ISetTextBoxTalkingOtherMutation extends ICommand {\n\treadonly talkingOther: string;\n}\n\nexport interface ISetTextBoxStyleMutation extends ICommand {\n\treadonly style: ITextBox['style'];\n}\n\nexport interface ISetTextBoxControlsVisibleMutation extends ICommand {\n\treadonly controls: boolean;\n}\n\nexport interface ISetTextBoxDeriveCustomColorMutation extends ICommand {\n\treadonly deriveCustomColors: boolean;\n}\n\nexport interface ISetTextBoxCustomControlsColorMutation extends ICommand {\n\treadonly customControlsColor: string;\n}\n\nexport interface ISetTextBoxNameboxColorMutation extends ICommand {\n\treadonly customNameboxColor: string;\n}\n\nexport interface ISetTextBoxNameboxStrokeMutation extends ICommand {\n\treadonly customNameboxStroke: string;\n}\n\nexport interface ISetTextBoxNameboxWidthMutation extends ICommand {\n\treadonly customNameboxWidth: number;\n}\n\nexport interface ISetTextBoxControlsSkipMutation extends ICommand {\n\treadonly skip: boolean;\n}\n\nexport interface ISetTextBoxControlsContinueMutation extends ICommand {\n\treadonly continue: boolean;\n}\n\nexport interface ISetTextBoxCustomColorMutation extends ICommand {\n\treadonly color: string;\n}\n\nexport interface ICreateTextBoxAction extends ICommand {}\n\nexport interface ISetTextBoxStyleAction extends ICommand {\n\treadonly style: ITextBox['style'];\n}\n\nexport interface ISplitTextbox extends ICommand {}\n","import { Module } from 'vuex';\nimport { ICommand } from '@/eventbus/command';\nimport { spriteMutations, spriteActions } from './objectTypes/sprite';\nimport {\n\tcharacterActions,\n\tcharacterMutations,\n\tfixContentPackRemovalFromCharacter,\n} from './objectTypes/characters';\nimport { textBoxActions, textBoxMutations } from './objectTypes/textbox';\nimport { IRootState } from '.';\nimport { ContentPack } from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\nimport { IAsset } from './content';\n\nexport interface IObjectsState {\n\tobjects: { [id: string]: IObject };\n\torder: string[];\n\tonTopOrder: string[];\n}\n\nexport interface IObject {\n\ttype: ObjectTypes;\n\tid: string;\n\tx: number;\n\ty: number;\n\twidth: number;\n\theight: number;\n\tpreserveRatio: boolean;\n\tratio: number;\n\topacity: number;\n\tversion: number;\n\tflip: boolean;\n\tonTop: boolean;\n}\n\nexport type ObjectTypes = 'sprite' | 'character' | 'textBox';\n\nexport default {\n\tnamespaced: true,\n\tstate: {\n\t\tobjects: {},\n\t\torder: [],\n\t\tonTopOrder: [],\n\t},\n\tmutations: {\n\t\tcreate(state, command: ICreateObjectMutation) {\n\t\t\tstate.objects[command.object.id] = command.object;\n\t\t\tif (command.object.onTop) {\n\t\t\t\tstate.onTopOrder.push(command.object.id);\n\t\t\t} else {\n\t\t\t\tstate.order.push(command.object.id);\n\t\t\t}\n\t\t},\n\t\tremoveFromList(state, command: IRemoveFromListMutation) {\n\t\t\tconst collection = command.onTop ? state.onTopOrder : state.order;\n\t\t\tconst idx = collection.indexOf(command.id);\n\t\t\tcollection.splice(idx, 1);\n\t\t},\n\t\taddToList(state, command: IAddToListMutation) {\n\t\t\tconst collection = command.onTop ? state.onTopOrder : state.order;\n\t\t\tcollection.splice(command.position, 0, command.id);\n\t\t},\n\t\tsetOnTop(state, command: ISetOnTopMutation) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tobj.onTop = command.onTop;\n\t\t},\n\t\tsetPosition(state, command: ISetObjectPositionMutation) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tobj.x = command.x;\n\t\t\tobj.y = command.y;\n\t\t},\n\t\tsetFlip(state, command: ISetObjectFlipMutation) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tobj.flip = command.flip;\n\t\t},\n\t\tsetOpacity(state, command: ISetObjectOpacityMutation) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tobj.opacity = command.opacity;\n\t\t},\n\t\tsetSize(state, command: ISetSpriteSizeMutation) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tobj.width = command.width;\n\t\t\tobj.height = command.height;\n\t\t},\n\t\tsetRatio(state, command: ISetSpriteRatioMutation) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tobj.preserveRatio = command.preserveRatio;\n\t\t\tobj.ratio = command.ratio;\n\t\t},\n\t\tremoveObject(state, command: IRemoveObjectMutation) {\n\t\t\tdelete state.objects[command.id];\n\t\t},\n\t\t...spriteMutations,\n\t\t...characterMutations,\n\t\t...textBoxMutations,\n\t},\n\tactions: {\n\t\tremoveObject({ state, commit }, command: IRemoveObjectAction) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tcommit('removeFromList', {\n\t\t\t\tid: command.id,\n\t\t\t\tonTop: obj.onTop,\n\t\t\t} as IRemoveFromListMutation);\n\t\t\tcommit('removeObject', {\n\t\t\t\tid: command.id,\n\t\t\t} as IRemoveObjectMutation);\n\t\t},\n\t\tsetPosition({ state, commit, dispatch }, command: ISetPositionAction) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tif (obj.type === 'character') {\n\t\t\t\tdispatch('setCharacterPosition', command as ISetPositionAction);\n\t\t\t} else {\n\t\t\t\tcommit('setPosition', command as ISetObjectPositionMutation);\n\t\t\t}\n\t\t},\n\t\tsetOnTop({ state, commit }, command: IObjectSetOnTopAction) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tif (obj.onTop === command.onTop) return;\n\t\t\tcommit('removeFromList', {\n\t\t\t\tid: command.id,\n\t\t\t\tonTop: obj.onTop,\n\t\t\t} as IRemoveFromListMutation);\n\t\t\tcommit('addToList', {\n\t\t\t\tid: command.id,\n\t\t\t\tposition: (command.onTop ? state.onTopOrder : state.order).length,\n\t\t\t\tonTop: command.onTop,\n\t\t\t} as IRemoveFromListMutation);\n\t\t\tcommit('setOnTop', {\n\t\t\t\tid: command.id,\n\t\t\t\tonTop: command.onTop,\n\t\t\t} as ISetOnTopMutation);\n\t\t},\n\t\tshiftLayer({ state, commit }, command: IObjectShiftLayerAction) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tconst collection = obj.onTop ? state.onTopOrder : state.order;\n\t\t\tconst position = collection.indexOf(obj.id);\n\n\t\t\tlet newPosition = position + command.delta;\n\t\t\tif (newPosition < 0) {\n\t\t\t\tnewPosition = 0;\n\t\t\t}\n\t\t\tif (newPosition > collection.length) {\n\t\t\t\tnewPosition = collection.length;\n\t\t\t}\n\t\t\tcommit('removeFromList', {\n\t\t\t\tid: command.id,\n\t\t\t\tonTop: obj.onTop,\n\t\t\t} as IRemoveFromListMutation);\n\t\t\tcommit('addToList', {\n\t\t\t\tid: command.id,\n\t\t\t\tposition: newPosition,\n\t\t\t\tonTop: obj.onTop,\n\t\t\t} as IAddToListMutation);\n\t\t},\n\t\tsetPreserveRatio({ commit, state }, command: ISetRatioAction) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tconst ratio = command.preserveRatio ? obj.width / obj.height : 0;\n\t\t\tcommit('setRatio', {\n\t\t\t\tid: command.id,\n\t\t\t\tpreserveRatio: command.preserveRatio,\n\t\t\t\tratio,\n\t\t\t} as ISetSpriteRatioMutation);\n\t\t},\n\t\tsetWidth({ commit, state }, command: ISetWidthAction) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tconst height = !obj.preserveRatio\n\t\t\t\t? obj.height\n\t\t\t\t: command.width / obj.ratio;\n\t\t\tcommit('setSize', {\n\t\t\t\tid: command.id,\n\t\t\t\theight,\n\t\t\t\twidth: command.width,\n\t\t\t} as ISetSpriteSizeMutation);\n\t\t},\n\t\tsetHeight({ commit, state }, command: ISetHeightAction) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tconst width = !obj.preserveRatio ? obj.width : command.height * obj.ratio;\n\t\t\tcommit('setSize', {\n\t\t\t\tid: command.id,\n\t\t\t\theight: command.height,\n\t\t\t\twidth,\n\t\t\t} as ISetSpriteSizeMutation);\n\t\t},\n\t\tfixContentPackRemoval(context, oldContent: ContentPack<IAsset>) {\n\t\t\tObject.values(context.state.objects).map(obj => {\n\t\t\t\tswitch (obj.type) {\n\t\t\t\t\tcase 'character':\n\t\t\t\t\t\tfixContentPackRemovalFromCharacter(context, obj.id, oldContent);\n\t\t\t\t\t\treturn;\n\t\t\t\t\tcase 'sprite':\n\t\t\t\t\t\treturn;\n\t\t\t\t\tcase 'textBox':\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t...spriteActions,\n\t\t...characterActions,\n\t\t...textBoxActions,\n\t},\n} as Module<IObjectsState, IRootState>;\n\nexport interface ICreateObjectMutation {\n\treadonly object: IObject;\n}\n\nexport interface IObjectMutation {\n\treadonly id: string;\n}\n\nexport interface ISetSpriteSizeMutation extends ICommand {\n\treadonly width: number;\n\treadonly height: number;\n}\n\nexport interface ISetSpriteRatioMutation extends ICommand {\n\treadonly preserveRatio: boolean;\n\treadonly ratio: number;\n}\n\nexport interface ISetObjectPositionMutation extends IObjectMutation {\n\treadonly x: number;\n\treadonly y: number;\n}\n\nexport interface ISetOnTopMutation extends IObjectMutation {\n\treadonly onTop: boolean;\n}\n\nexport interface ISetObjectFlipMutation extends IObjectMutation {\n\treadonly flip: boolean;\n}\n\nexport interface ISetObjectOpacityMutation extends IObjectMutation {\n\treadonly opacity: number;\n}\n\nexport interface IRemoveFromListMutation extends IObjectMutation {\n\treadonly onTop: boolean;\n}\n\nexport interface IAddToListMutation extends IObjectMutation {\n\treadonly onTop: boolean;\n\treadonly position: number;\n}\n\nexport interface IObjectShiftLayerAction extends ICommand {\n\treadonly delta: number;\n}\n\nexport interface IObjectSetOnTopAction extends ICommand {\n\treadonly onTop: boolean;\n}\n\nexport interface ISetWidthAction extends ICommand {\n\treadonly width: number;\n}\n\nexport interface ISetHeightAction extends ICommand {\n\treadonly height: number;\n}\n\nexport interface ISetRatioAction extends ICommand {\n\treadonly preserveRatio: boolean;\n}\n\nexport interface IRemoveObjectMutation extends ICommand {}\nexport interface IRemoveObjectAction extends ICommand {}\n\nexport interface ISetPositionAction extends ICommand {\n\treadonly x: number;\n\treadonly y: number;\n}\n\nexport interface IObjectContentPackRemovalAction extends ICommand {\n\treadonly oldPack: ContentPack<IAsset>;\n}\n","import { Module } from 'vuex';\nimport { IRootState } from '.';\n\nexport interface IUiState {\n\tvertical: boolean;\n\tnsfw: boolean;\n\tselection: string | null;\n\tlqRendering: boolean;\n\tlastDownload: string | null;\n}\n\nexport default {\n\tnamespaced: true,\n\tstate: {\n\t\tvertical: false,\n\t\tlqRendering: true,\n\t\tnsfw: false,\n\t\tselection: null,\n\t\tlastDownload: null,\n\t},\n\tmutations: {\n\t\tsetVertical(state, vertical: boolean) {\n\t\t\tstate.vertical = vertical;\n\t\t},\n\t\tsetNsfw(state, nsfw: boolean) {\n\t\t\tstate.nsfw = nsfw;\n\t\t},\n\t\tsetLqRendering(state, lqRendering: boolean) {\n\t\t\tstate.lqRendering = lqRendering;\n\t\t},\n\t\tsetSelection(state, selection: string | null) {\n\t\t\tstate.selection = selection;\n\t\t},\n\t\tsetLastDownload(state, download: string) {\n\t\t\tstate.lastDownload = download;\n\t\t},\n\t},\n} as Module<IUiState, IRootState>;\n","import { Module } from 'vuex';\nimport {\n\tBackground,\n\tContentPack,\n} from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\nimport { IAsset } from './content';\nimport { IRootState } from '.';\nimport { arraySeeker } from '@/models/seekers';\n\nexport interface IBackground {\n\tcurrent: string;\n\tcolor: string;\n\tflipped: boolean;\n\tvariant: number;\n}\n\nexport default {\n\tnamespaced: true,\n\tstate: {\n\t\tcurrent: '',\n\t\tcolor: '#000000',\n\t\tflipped: false,\n\t\tvariant: 0,\n\t},\n\tmutations: {\n\t\tsetCurrent(state, { current }: ISetCurrentMutation) {\n\t\t\tstate.current = current;\n\t\t\tstate.variant = 0;\n\t\t},\n\t\tsetColor(state, { color }: ISetColorMutation) {\n\t\t\tstate.color = color;\n\t\t},\n\t\tsetFlipped(state, { flipped }: ISetFlipMutation) {\n\t\t\tstate.flipped = flipped;\n\t\t},\n\t\tsetVariant(state, { variant }: ISetVariantMutation) {\n\t\t\tstate.variant = variant;\n\t\t},\n\t},\n\tactions: {\n\t\tseekVariant({ state, rootGetters, commit }, { delta }: ISeekVariantAction) {\n\t\t\tconst backgrounds = rootGetters['content/getBackgrounds'] as Map<\n\t\t\t\tBackground<IAsset>['label'],\n\t\t\t\tBackground<IAsset>\n\t\t\t>;\n\t\t\tconst background = backgrounds.get(state.current);\n\t\t\tif (!background) return;\n\t\t\tcommit('setVariant', {\n\t\t\t\tvariant: arraySeeker(background.variants, state.variant, delta),\n\t\t\t} as ISetVariantMutation);\n\t\t},\n\t\tasync fixContentPackRemoval(\n\t\t\t{ state, rootGetters, commit, rootState },\n\t\t\toldContent: ContentPack<IAsset>\n\t\t) {\n\t\t\tconst oldBackground = oldContent.backgrounds.find(\n\t\t\t\tx => x.label === state.current\n\t\t\t);\n\t\t\t// Probably build in?\n\t\t\tif (!oldBackground) return;\n\n\t\t\tconst newBackground = (rootGetters['content/getBackgrounds'] as Map<\n\t\t\t\tBackground<IAsset>['label'],\n\t\t\t\tBackground<IAsset>\n\t\t\t>).get(state.current);\n\n\t\t\tif (!newBackground) {\n\t\t\t\tif (rootState.content.current.backgrounds[0]) {\n\t\t\t\t\tcommit('setCurrent', {\n\t\t\t\t\t\tcurrent: rootState.content.current.backgrounds[0].label,\n\t\t\t\t\t} as ISetCurrentMutation);\n\t\t\t\t} else {\n\t\t\t\t\tcommit('setCurrent', {\n\t\t\t\t\t\tcurrent: 'buildin.transparent',\n\t\t\t\t\t} as ISetCurrentMutation);\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst oldVariantJSON = JSON.stringify(\n\t\t\t\toldBackground.variants[state.variant]\n\t\t\t);\n\t\t\tconst newVariantIdx = newBackground.variants.findIndex(\n\t\t\t\tvariant => JSON.stringify(variant) === oldVariantJSON\n\t\t\t);\n\t\t\tif (newVariantIdx !== state.variant) {\n\t\t\t\tcommit('setVariant', newVariantIdx === -1 ? 0 : newVariantIdx);\n\t\t\t}\n\t\t},\n\t},\n} as Module<IBackground, IRootState>;\n\nexport interface ISetCurrentMutation {\n\tcurrent: string;\n}\n\nexport interface ISetColorMutation {\n\tcolor: string;\n}\n\nexport interface ISetFlipMutation {\n\tflipped: boolean;\n}\n\nexport interface ISetVariantMutation {\n\tvariant: number;\n}\n\nexport interface ISeekVariantAction {\n\tdelta: 1 | -1;\n}\n","import {\r\n\tContentPack,\r\n\tBackground,\r\n\tCharacter,\r\n\tHeadCollections,\r\n\tPose,\r\n} from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\r\nimport { IAsset } from '.';\r\n\r\nexport function mergeContentPacks(\r\n\tx: ContentPack<IAsset>,\r\n\ty: ContentPack<IAsset>\r\n): ContentPack<IAsset> {\r\n\treturn {\r\n\t\tbackgrounds: mergeBackgrounds(x.backgrounds, y.backgrounds),\r\n\t\tcharacters: mergeCharacters<IAsset>(x.characters, y.characters),\r\n\t\tfonts: mergeIdArrays(\r\n\t\t\tx.fonts,\r\n\t\t\ty.fonts,\r\n\t\t\tobj => obj.id,\r\n\t\t\t(xObj, yObj) => ({\r\n\t\t\t\t...xObj,\r\n\t\t\t\tfiles: mergeArrayUnique(xObj.files, yObj.files),\r\n\t\t\t})\r\n\t\t),\r\n\t\tpoemStyles: mergeIdArrays(\r\n\t\t\tx.poemStyles,\r\n\t\t\ty.poemStyles,\r\n\t\t\tobj => obj.label,\r\n\t\t\t() => {\r\n\t\t\t\tthrow new Error();\r\n\t\t\t}\r\n\t\t),\r\n\t\tsprites: mergeIdArrays(\r\n\t\t\tx.sprites,\r\n\t\t\ty.sprites,\r\n\t\t\tobj => obj.label,\r\n\t\t\t(xObj, yObj) => ({\r\n\t\t\t\tlabel: xObj.label,\r\n\t\t\t\tvariants: [...xObj.variants, ...yObj.variants],\r\n\t\t\t})\r\n\t\t),\r\n\t};\r\n}\r\n\r\nfunction mergeBackgrounds<A>(\r\n\tx: Array<Background<A>>,\r\n\ty: Array<Background<A>>\r\n): Array<Background<A>> {\r\n\treturn mergeIdArrays(x, y, obj => obj.label, mergeBackground);\r\n}\r\n\r\nfunction mergeBackground<A>(x: Background<A>, y: Background<A>) {\r\n\treturn {\r\n\t\tlabel: y.label,\r\n\t\tvariants: [...x.variants, ...y.variants],\r\n\t};\r\n}\r\n\r\nfunction mergeCharacters<A>(\r\n\tx: Array<Character<A>>,\r\n\ty: Array<Character<A>>\r\n): Array<Character<A>> {\r\n\treturn mergeIdArrays(x, y, obj => obj.id, mergeCharacter);\r\n}\r\n\r\nfunction mergeCharacter<A>(x: Character<A>, y: Character<A>): Character<A> {\r\n\treturn {\r\n\t\tchibi: x.chibi,\r\n\t\tid: x.id,\r\n\t\tlabel: x.label,\r\n\t\tsize: x.size,\r\n\t\tstyleComponents: mergeIdArrays(\r\n\t\t\tx.styleComponents,\r\n\t\t\ty.styleComponents,\r\n\t\t\tobj => obj.name,\r\n\t\t\t(xObj, yObj) => ({\r\n\t\t\t\tlabel: xObj.label,\r\n\t\t\t\tname: xObj.name,\r\n\t\t\t\tvariants: {\r\n\t\t\t\t\t...yObj.variants,\r\n\t\t\t\t\t...xObj.variants,\r\n\t\t\t\t},\r\n\t\t\t})\r\n\t\t),\r\n\t\theads: mergeHeadCollections(x.heads, y.heads),\r\n\t\tposes: mergeIdArrays(x.poses, y.poses, obj => obj.name, mergePose),\r\n\t\tstyles: mergeIdArrays(\r\n\t\t\tx.styles,\r\n\t\t\ty.styles,\r\n\t\t\tobj => obj.name,\r\n\t\t\t(xStyle, yStyle) => {\r\n\t\t\t\tthrow new Error('Colliding style definitions');\r\n\t\t\t}\r\n\t\t),\r\n\t};\r\n}\r\n\r\nfunction mergePose<A>(x: Pose<A>, y: Pose<A>): Pose<A> {\r\n\tif (x.static && x.static.length > 0 && y.static && y.static.length > 0) {\r\n\t\tthrow new Error('Colliding static poses');\r\n\t}\r\n\r\n\treturn {\r\n\t\tcompatibleHeads: mergeArrayUnique(x.compatibleHeads, y.compatibleHeads),\r\n\t\theadAnchor: x.headAnchor,\r\n\t\tleft: [...x.left, ...y.left],\r\n\t\tright: [...x.right, ...y.right],\r\n\t\tname: x.name,\r\n\t\toffset: x.offset,\r\n\t\trenderOrder: x.renderOrder,\r\n\t\tsize: x.size,\r\n\t\tstatic: x.static,\r\n\t\tstyle: x.style,\r\n\t\tvariant: [...x.variant, ...y.variant],\r\n\t};\r\n}\r\n\r\nfunction mergeHeadCollections<A>(\r\n\tx: HeadCollections<A>,\r\n\ty: HeadCollections<A>\r\n): HeadCollections<A> {\r\n\tconst ret = { ...x };\r\n\r\n\tfor (const headGroupKey in y) {\r\n\t\tif (!y.hasOwnProperty(headGroupKey)) continue;\r\n\t\tconst headGroup = y[headGroupKey];\r\n\t\tif (ret[headGroupKey]) {\r\n\t\t\tconst oldHeadGroup = ret[headGroupKey];\r\n\t\t\tret[headGroupKey] = {\r\n\t\t\t\toffset: oldHeadGroup.offset,\r\n\t\t\t\tsize: oldHeadGroup.size,\r\n\t\t\t\tvariants: [...oldHeadGroup.variants, ...headGroup.variants],\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tret[headGroupKey] = headGroup;\r\n\t\t}\r\n\t}\r\n\r\n\treturn ret;\r\n}\r\n\r\nfunction mergeArrayUnique<A>(x: A[], y: A[]): A[] {\r\n\tconst ret = [...x];\r\n\tfor (const yObj of y) {\r\n\t\tif (!ret.includes(yObj)) {\r\n\t\t\tret.push(yObj);\r\n\t\t}\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\nfunction mergeIdArrays<A, B>(\r\n\tx: A[],\r\n\ty: A[],\r\n\tgetId: (obj: A) => B,\r\n\tmerge: (x: A, y: A) => A\r\n): A[] {\r\n\tconst ret = [...x];\r\n\tconst definedIds = new Map<B, number>(\r\n\t\tx.map((xObj, idx) => [getId(xObj), idx])\r\n\t);\r\n\r\n\tfor (const yObj of y) {\r\n\t\tconst yId = getId(yObj);\r\n\t\tif (definedIds.has(yId)) {\r\n\t\t\tconst existingIdx = definedIds.get(yId)!;\r\n\t\t\tconst existing = ret[existingIdx];\r\n\t\t\tret.splice(existingIdx, 1, merge(existing, yObj));\r\n\t\t} else {\r\n\t\t\tdefinedIds.set(yId, ret.length);\r\n\t\t\tret.push(yObj);\r\n\t\t}\r\n\t}\r\n\r\n\treturn ret;\r\n}\r\n","import { Module } from 'vuex';\nimport {\n\tContentPack,\n\tCharacter,\n\tBackground,\n} from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\nimport {\n\tassetWalker,\n\tnormalizePath,\n} from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/util';\nimport { normalizeContentPack } from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/parser';\nimport { convert as convertV1 } from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/convertV1';\n// tslint:disable-next-line: max-line-length\nimport { normalizeCharacter as normalizeCharacterV1 } from '@edave64/doki-doki-dialog-generator-pack-format/dist/v1/parser';\nimport { isWebPSupported } from '@/asset-manager';\nimport { mergeContentPacks } from './merge';\nimport { IRootState } from '..';\n\nexport interface IContentState {\n\tcontentPacks: Array<ContentPack<IAsset>>;\n\tcurrent: ContentPack<IAsset>;\n}\n\nexport interface IAsset {\n\thq: string;\n\tlq: string;\n\tsourcePack: string;\n}\n\nfunction baseDir(url: string): string {\n\treturn (\n\t\turl\n\t\t\t.split('/')\n\t\t\t.slice(0, -1)\n\t\t\t.join('/') + '/'\n\t);\n}\n\n// These types are assumed to always be supported\nconst baseTypes = new Set(['png', 'gif', 'bmp', 'svg']);\n\nexport default {\n\tnamespaced: true,\n\tstate: {\n\t\tcontentPacks: [],\n\t\tcurrent: {\n\t\t\tbackgrounds: [],\n\t\t\tcharacters: [],\n\t\t\tfonts: [],\n\t\t\tpoemStyles: [],\n\t\t\tsprites: [],\n\t\t},\n\t},\n\tmutations: {\n\t\tsetContentPacks(state: IContentState, packs: Array<ContentPack<IAsset>>) {\n\t\t\tstate.contentPacks = packs;\n\t\t},\n\t\tsetCurrentContent(state: IContentState, content: ContentPack<IAsset>) {\n\t\t\tstate.current = content;\n\t\t},\n\t},\n\tactions: {\n\t\tasync contentPack({ commit, state }, contentPack: ContentPack) {\n\t\t\tconst convertedPack = await convertContentPack(contentPack);\n\t\t\tcommit('setContentPacks', [...state.contentPacks, convertedPack]);\n\t\t\tcommit(\n\t\t\t\t'setCurrentContent',\n\t\t\t\tmergeContentPacks(state.current, convertedPack)\n\t\t\t);\n\t\t},\n\n\t\tasync removeContentPacks({ commit, state }, packIds: Set<string>) {\n\t\t\tconst newContentPacks = state.contentPacks.filter(\n\t\t\t\tpack => !packIds.has(pack.packId!)\n\t\t\t);\n\t\t\tcommit('setContentPacks', newContentPacks);\n\t\t\tcommit(\n\t\t\t\t'setCurrentContent',\n\t\t\t\tnewContentPacks.reduce((acc, value) => mergeContentPacks(acc, value))\n\t\t\t);\n\t\t},\n\n\t\tasync replaceContentPack(\n\t\t\t{ commit, state },\n\t\t\t{ contentPack }: IReplaceContentPackAction\n\t\t) {\n\t\t\tconst convertedPack = await convertContentPack(contentPack);\n\t\t\tconst packs = state.contentPacks;\n\t\t\tconst packIdx = packs.findIndex(\n\t\t\t\tpack => pack.packId === contentPack.packId\n\t\t\t);\n\t\t\tif (packIdx === -1) {\n\t\t\t\tpacks.push(convertedPack);\n\t\t\t} else {\n\t\t\t\tpacks.splice(packIdx, 1, convertedPack);\n\t\t\t}\n\t\t\tcommit('setContentPacks', packs);\n\t\t\tcommit(\n\t\t\t\t'setCurrentContent',\n\t\t\t\tpacks.reduce((acc, value) => mergeContentPacks(acc, value))\n\t\t\t);\n\t\t},\n\n\t\tasync loadContentPacks({ dispatch }, urls: string | string[]) {\n\t\t\tif (typeof urls === 'string') {\n\t\t\t\turls = [urls];\n\t\t\t}\n\t\t\tconst contentPacks = await Promise.all(\n\t\t\t\turls.map(async url => {\n\t\t\t\t\tconst response = await fetch(url);\n\t\t\t\t\tif (response.status !== 200) {\n\t\t\t\t\t\terror(\n\t\t\t\t\t\t\t`Could not load content pack. Server responded with: ${response.statusText}`\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tlet json;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tjson = await response.json();\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\terror('Content pack is not valid json!');\n\t\t\t\t\t}\n\t\t\t\t\tconsole.log(url, json);\n\n\t\t\t\t\tlet contentPack: ContentPack;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst paths = {\n\t\t\t\t\t\t\t'./': baseDir(url),\n\t\t\t\t\t\t\t'/': baseDir(location.href) + 'assets/',\n\t\t\t\t\t\t};\n\t\t\t\t\t\tif (json.version === '2.0') {\n\t\t\t\t\t\t\tcontentPack = normalizeContentPack(json, paths);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcontentPack = convertV1(normalizeCharacterV1(json, paths), false);\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\terror('Content pack is not in a valid format!', e);\n\t\t\t\t\t}\n\t\t\t\t\treturn contentPack;\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tfor (const contentPack of contentPacks) {\n\t\t\t\tawait dispatch('contentPack', contentPack);\n\t\t\t}\n\t\t},\n\t},\n\tgetters: {\n\t\tgetCharacters({\n\t\t\tcurrent,\n\t\t}): Map<Character<IAsset>['id'], Character<IAsset>> {\n\t\t\tconst ret = new Map<Character<IAsset>['id'], Character<IAsset>>();\n\t\t\tfor (const character of current.characters) {\n\t\t\t\tret.set(character.id, character);\n\t\t\t}\n\t\t\treturn ret;\n\t\t},\n\t\tgetBackgrounds({\n\t\t\tcurrent,\n\t\t}): Map<Background<IAsset>['label'], Background<IAsset>> {\n\t\t\tconst ret = new Map<Background<IAsset>['label'], Background<IAsset>>();\n\t\t\tfor (const background of current.backgrounds) {\n\t\t\t\tret.set(background.label, background);\n\t\t\t}\n\t\t\treturn ret;\n\t\t},\n\t},\n} as Module<IContentState, IRootState>;\n\nasync function convertContentPack(\n\tpack: ContentPack\n): Promise<ContentPack<IAsset>> {\n\tconst types: ReadonlySet<string> = new Set(\n\t\t(await isWebPSupported()) ? ['webp', ...baseTypes] : baseTypes\n\t);\n\n\treturn assetWalker(\n\t\tpack,\n\t\t(path: string, type: 'image' | 'font'): IAsset => {\n\t\t\tconst replacementMap = new Map([\n\t\t\t\t['ext', '{lq:.lq:}.{format:webp:webp:png:png}'],\n\t\t\t]);\n\t\t\tconst hq = normalizePath(path, replacementMap, types, false);\n\t\t\tconst lq = normalizePath(path, replacementMap, types, true);\n\n\t\t\treturn {\n\t\t\t\thq,\n\t\t\t\tlq,\n\t\t\t\tsourcePack: pack.packId || 'buildIn',\n\t\t\t};\n\t\t}\n\t);\n}\n\nfunction error(msg: string, payload?: any): never {\n\tconsole.error(msg, payload);\n\tthrow new Error(msg);\n}\n\nexport interface IReplaceContentPackAction {\n\tcontentPack: ContentPack;\n}\n","import Vue from 'vue';\nimport Vuex from 'vuex';\nimport objects, { IObjectsState } from './objects';\nimport ui, { IUiState } from './ui';\nimport background, { IBackground } from './background';\nimport content, { IContentState, IAsset } from './content';\nimport { ContentPack } from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\n\nVue.use(Vuex);\n\nexport interface IRootState {\n\tobjects: IObjectsState;\n\tui: IUiState;\n\tbackground: IBackground;\n\tcontent: IContentState;\n\tunsafe: boolean;\n}\n\nexport default new Vuex.Store<IRootState>({\n\tmodules: {\n\t\tobjects,\n\t\tui,\n\t\tbackground,\n\t\tcontent,\n\t},\n\tstate: {\n\t\tunsafe: false,\n\t} as any,\n\tmutations: {\n\t\tsetUnsafe(state, unsafe: boolean) {},\n\t},\n\tactions: {\n\t\tasync removePacks(\n\t\t\t{ dispatch, commit, state },\n\t\t\t{ packs }: IRemovePacksAction\n\t\t) {\n\t\t\tconst oldState: ContentPack<IAsset> = JSON.parse(\n\t\t\t\tJSON.stringify(state.content.current)\n\t\t\t);\n\n\t\t\tcommit('setUnsafe', true);\n\t\t\tawait dispatch('content/removeContentPacks', packs);\n\t\t\tawait dispatch('background/fixContentPackRemoval', oldState);\n\t\t\tawait dispatch('objects/fixContentPackRemoval', oldState);\n\t\t\tcommit('setUnsafe', false);\n\t\t},\n\t},\n});\n\nexport interface IRemovePacksAction {\n\tpacks: Set<string>;\n}\n","import { IHistoryOptions } from '@/plugins/vuex-history';\n\nexport default {\n\tmutations: {},\n} as IHistoryOptions;\n","import { IHistoryOptions } from '@/plugins/vuex-history';\nimport SpriteHistoryOptions from './objectTypes/sprite_history_properties';\n\nexport default {\n\tmutations: {\n\t\t'objects/*': {\n\t\t\tcombinable: (oldMut, newMut) =>\n\t\t\t\toldMut.type === newMut.type && oldMut.payload.id === newMut.payload.id,\n\t\t},\n\t\t'objects/create': {\n\t\t\tcombinable: () => false,\n\t\t},\n\t\t'objects/removeObject': {\n\t\t\tcombinable: () => false,\n\t\t},\n\t\t...SpriteHistoryOptions.mutations,\n\t},\n} as IHistoryOptions;\n","import Vue from 'vue';\r\nimport Vuex from 'vuex';\r\nimport History from './plugins/vuex-history';\r\nimport App from './App.vue';\r\nimport store from '@/store';\r\n// import './registerServiceWorker';\r\nimport ObjectsHistoryProperties from './store/objects_history_properties';\r\n\r\nVue.config.productionTip = false;\r\nVue.use(Vuex);\r\nVue.use(History, {\r\n\tmutations: {\r\n\t\t...ObjectsHistoryProperties.mutations,\r\n\t},\r\n});\r\n\r\nnew Vue({\r\n\tstore: store as any,\r\n\trender: h => h(App),\r\n}).$mount('#app');\r\n","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./add.vue?vue&type=style&index=0&id=4e30e235&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./add.vue?vue&type=style&index=0&id=4e30e235&lang=scss&scoped=true&\"","import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./settings.vue?vue&type=style&index=0&id=264bc145&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./settings.vue?vue&type=style&index=0&id=264bc145&lang=scss&scoped=true&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./character.vue?vue&type=style&index=0&id=8f165bec&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./character.vue?vue&type=style&index=0&id=8f165bec&lang=scss&scoped=true&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./backgrounds.vue?vue&type=style&index=0&id=62b25c75&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./backgrounds.vue?vue&type=style&index=0&id=62b25c75&lang=scss&scoped=true&\""],"sourceRoot":""}