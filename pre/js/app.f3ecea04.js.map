{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/toolbox/subpanels/color/sliderGroup.vue?62a1","webpack:///./src/components/toolbox/panels/content-pack.vue?bd5b","webpack:///./src/components/toolbox/commonsFieldsets/positionAndSize.vue?33fc","webpack:///./src/components/toolbox/panels/backgrounds.vue?12e2","webpack:///./src/components/toolbox/panels/character/parts.vue?51b1","webpack:///./src/components/toolbox/panels/credits.vue?c491","webpack:///./src/components/toolbox/toolbox.vue?ff03","webpack:///./src/components/toolbox/panels/textbox.vue?82cc","webpack:///./src/App.vue?f446","webpack:///./src/components/toolbox/panels/settings.vue?1ef8","webpack:///./src/components/toolbox/subpanels/color/slider.vue?b6db","webpack:///./src/components/toggle.vue?8dcd","webpack:///./src/components/toolbox/panels/add.vue?acca","webpack:///./src/components/message-console.vue?396b","webpack:///./src/components/toolbox/commonsFieldsets/layers.vue?6d52","webpack:///./src/components/toolbox/panels/panels.vue?1f87","webpack:///./src/components/toolbox/panels/background/settings.vue?9308","webpack:///./src/components/toolbox/panels/character/partButton.vue?2f8e","webpack:///./src/components/toolbox/drop-target.vue?e9cd","webpack:///./src/components/toolbox/panels/character.vue?613a","webpack:///./src/components/toolbox/panels/sprite.vue?54f7","webpack:///./src/plugins/vuex-history.js","webpack:///./src/App.vue?f80e","webpack:///./src/components/toolbox/toolbox.vue?6068","webpack:///./src/components/toolbox/panels/settings.vue?b97c","webpack:///./src/components/toggle.vue?aa00","webpack:///./src/components/toggle.vue?c831","webpack:///./src/components/toggle.vue?111d","webpack:///./src/components/toggle.vue","webpack:///./src/components/toolbox/panels/panelMixin.ts","webpack:///./src/components/toolbox/panels/settings.vue?c9e2","webpack:///./src/components/toolbox/panels/settings.vue?b55b","webpack:///./src/components/toolbox/panels/settings.vue","webpack:///./src/components/toolbox/panels/add.vue?874a","webpack:///./src/eventbus/event-bus.ts","webpack:///./src/models/error-asset.ts","webpack:///./src/asset-manager.ts","webpack:///./src/components/toolbox/drop-target.vue?a94a","webpack:///./src/components/toolbox/drop-target.vue?7454","webpack:///./src/components/toolbox/drop-target.vue?6822","webpack:///./src/components/toolbox/drop-target.vue","webpack:///./src/components/toolbox/panels/add.vue?d112","webpack:///./src/components/toolbox/panels/add.vue?6c2e","webpack:///./src/components/toolbox/panels/add.vue","webpack:///./src/components/toolbox/panels/character.vue?001d","webpack:///./src/models/constants.ts","webpack:///./src/models/seekers.ts","webpack:///./src/store/objectTypes/characters.ts","webpack:///./src/components/toolbox/commonsFieldsets/positionAndSize.vue?aa5d","webpack:///./src/components/toolbox/commonsFieldsets/positionAndSize.vue?8e58","webpack:///./src/components/toolbox/commonsFieldsets/positionAndSize.vue?de84","webpack:///./src/components/toolbox/commonsFieldsets/positionAndSize.vue","webpack:///./src/components/toolbox/commonsFieldsets/layers.vue?0d88","webpack:///./src/components/toolbox/commonsFieldsets/layers.vue?dcb7","webpack:///./src/components/toolbox/commonsFieldsets/layers.vue?a903","webpack:///./src/components/toolbox/commonsFieldsets/layers.vue","webpack:///./src/components/toolbox/commonsFieldsets/opacity.vue?2a05","webpack:///./src/components/toolbox/commonsFieldsets/opacity.vue?e6e1","webpack:///./src/components/toolbox/commonsFieldsets/opacity.vue?4d33","webpack:///./src/components/toolbox/commonsFieldsets/opacity.vue","webpack:///./src/components/toolbox/commonsFieldsets/delete.vue?0ed1","webpack:///./src/components/toolbox/commonsFieldsets/delete.vue?c3eb","webpack:///./src/components/toolbox/commonsFieldsets/delete.vue?4121","webpack:///./src/components/toolbox/commonsFieldsets/delete.vue","webpack:///./src/components/toolbox/panels/character/parts.vue?00d4","webpack:///./src/components/toolbox/panels/character/partButton.vue?8ccb","webpack:///./src/environments/browser.ts","webpack:///./src/environments/edge.ts","webpack:///./src/environments/electron.ts","webpack:///./src/environments/environment.ts","webpack:///./src/components/toolbox/panels/character/partButton.vue?9154","webpack:///./src/components/toolbox/panels/character/partButton.vue?b061","webpack:///./src/components/toolbox/panels/character/partButton.vue","webpack:///./src/components/toolbox/panels/character/parts.vue?9c59","webpack:///./src/components/toolbox/panels/character/parts.vue?25dd","webpack:///./src/components/toolbox/panels/character/parts.vue","webpack:///./src/components/toolbox/panels/character.vue?081c","webpack:///./src/components/toolbox/panels/character.vue?283a","webpack:///./src/components/toolbox/panels/character.vue","webpack:///./src/components/toolbox/panels/sprite.vue?e775","webpack:///./src/components/toolbox/panels/sprite.vue?dbdb","webpack:///./src/components/toolbox/panels/sprite.vue?bfdb","webpack:///./src/components/toolbox/panels/sprite.vue","webpack:///./src/components/toolbox/panels/textbox.vue?bd5c","webpack:///./src/components/toolbox/subpanels/color/color.vue?2329","webpack:///./src/components/toolbox/subpanels/color/sliderGroup.vue?a9b8","webpack:///./src/util/colors/hsl.ts","webpack:///./src/util/colors/rgb.ts","webpack:///./src/components/toolbox/subpanels/color/slider.vue?a6e1","webpack:///./src/components/toolbox/subpanels/color/slider.vue?cd13","webpack:///./src/components/toolbox/subpanels/color/slider.vue?f916","webpack:///./src/components/toolbox/subpanels/color/slider.vue","webpack:///./src/components/toolbox/subpanels/color/sliderGroup.vue?67c8","webpack:///./src/components/toolbox/subpanels/color/sliderGroup.vue?c067","webpack:///./src/components/toolbox/subpanels/color/sliderGroup.vue","webpack:///./src/components/toolbox/subpanels/color/color.vue?0222","webpack:///./src/components/toolbox/subpanels/color/color.vue?827a","webpack:///./src/components/toolbox/subpanels/color/color.vue","webpack:///./src/components/toolbox/subpanels/text/text.vue?ce7b","webpack:///./src/renderer/textRenderer/string-walker.ts","webpack:///./src/renderer/textRenderer/tokenizer.ts","webpack:///./src/renderer/textRenderer/textCommands.ts","webpack:///./src/renderer/textRenderer/textRenderer.ts","webpack:///./src/models/textBoxConstants.ts","webpack:///./src/components/toolbox/subpanels/text/text.vue?ba8f","webpack:///./src/components/toolbox/subpanels/text/text.vue?c42a","webpack:///./src/components/toolbox/subpanels/text/text.vue","webpack:///./src/components/toolbox/panels/textbox.vue?ca5f","webpack:///./src/components/toolbox/panels/textbox.vue?500e","webpack:///./src/components/toolbox/panels/textbox.vue","webpack:///./src/components/toolbox/panels/credits.vue?8fa5","webpack:///./src/components/toolbox/panels/credits.vue?05b9","webpack:///./src/components/toolbox/panels/credits.vue?3709","webpack:///./src/components/toolbox/panels/credits.vue","webpack:///./src/components/toolbox/panels/backgrounds.vue?7a46","webpack:///./src/components/toolbox/panels/background/button.vue?8d1a","webpack:///./src/components/toolbox/panels/background/button.vue?92ee","webpack:///./src/components/toolbox/panels/background/button.vue?9649","webpack:///./src/components/toolbox/panels/background/button.vue","webpack:///./src/components/toolbox/panels/background/settings.vue?0063","webpack:///./src/components/toolbox/panels/background/settings.vue?93fe","webpack:///./src/components/toolbox/panels/background/settings.vue?50a9","webpack:///./src/components/toolbox/panels/background/settings.vue","webpack:///./src/components/toolbox/panels/backgrounds.vue?9ca2","webpack:///./src/components/toolbox/panels/backgrounds.vue?18da","webpack:///./src/components/toolbox/panels/backgrounds.vue","webpack:///./src/components/toolbox/panels/content-pack.vue?c883","webpack:///./src/components/toolbox/panels/character-pack-sanitizer.ts","webpack:///./src/components/toolbox/panels/content-pack.vue?566c","webpack:///./src/store/panels.ts","webpack:///./src/components/toolbox/panels/content-pack.vue?7468","webpack:///./src/components/toolbox/panels/content-pack.vue","webpack:///./src/components/toolbox/panels/panels.vue?7a85","webpack:///./src/models/background.ts","webpack:///./src/models/sprite.ts","webpack:///./src/renderer/renderAbortedException.ts","webpack:///./src/renderer/rendererContext.ts","webpack:///./src/renderer/renderer.ts","webpack:///./src/models/character.ts","webpack:///./src/renderer/pathTools.ts","webpack:///./src/models/textbox.ts","webpack:///./src/models/scene-renderer.ts","webpack:///./src/components/toolbox/panels/panels.vue?f669","webpack:///./src/components/toolbox/panels/panels.vue?8e69","webpack:///./src/components/toolbox/panels/panels.vue","webpack:///./src/components/toolbox/toolbox.vue?5a64","webpack:///./src/components/toolbox/toolbox.vue?983b","webpack:///./src/components/toolbox/toolbox.vue","webpack:///./src/components/message-console.vue?1437","webpack:///./src/components/message-console.vue?092b","webpack:///./src/components/message-console.vue?1d97","webpack:///./src/components/message-console.vue","webpack:///./src/components/render.vue?a501","webpack:///./src/components/render.vue?7cec","webpack:///./src/components/render.vue?4d80","webpack:///./src/components/render.vue","webpack:///./src/App.vue?ec60","webpack:///./src/App.vue?640d","webpack:///./src/App.vue","webpack:///./src/store/objectTypes/sprite.ts","webpack:///./src/store/objectTypes/textbox.ts","webpack:///./src/store/objects.ts","webpack:///./src/store/ui.ts","webpack:///./src/store/content/merge.ts","webpack:///./src/store/content/index.ts","webpack:///./src/store/index.ts","webpack:///./src/store/objectTypes/sprite_history_properties.ts","webpack:///./src/store/objects_history_properties.ts","webpack:///./src/main.ts","webpack:///./src/components/toolbox/panels/background/button.vue?0340","webpack:///./src/components/toolbox/commonsFieldsets/opacity.vue?df0d","webpack:///./src/components/toolbox/subpanels/text/text.vue?ab76","webpack:///./src/components/toolbox/subpanels/color/color.vue?6cbf"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","install","Vue","options","_installedPlugins","find","plugin","Store","Error","resetStateMutation","mutations","history","done","undone","newMutation","ignoreMutations","currentTransaction","transactionQueue","initialized","created","historyStuff","this","methods","initialize","store","$store","subscribe","mutation","exec","type","getMutationProperties","ignore","transaction","redo","commit","pop","replayTransaction","undo","replayAll","callback","Promise","resolve","reject","console","log","lastUndo","combinable","combination","combinator","vm","oldTransactions","forEach","replayMutation","payload","baseObj","Array","assign","mixin","computed","vuexHistory","mutationProperiesCache","parts","split","mutationProperties","oldMutation","currentWildcard","part","_vm","_h","$createElement","_c","_self","attrs","ref","canvasWidth","canvasHeight","on","drawLastDownload","$event","$refs","render","download","staticRenderFns","class","vertical","active","panel","setPanel","staticClass","_v","hasPrevRender","$emit","model","$$v","lqRendering","expression","nsfw","_uid","domProps","onChange","_s","label","event","checkbox","checked","String","Boolean","default","components","component","updateVertical","$el","addEventListener","e","currentTarget","target","classList","contains","ev","deltaY","mozInputSource","scrollLeft","passive","add","remove","namespace","nsfwPacks","names","Set","keys","values","state","ui","content","contentPacks","map","pack","packId","filter","has","dispatch","packs","Toggle","undefined","isWebPSupported","showDropTarget","hideDropTarget","addCustomSpriteFile","group","_l","character","id","onChosen","toLowerCase","assetPath","_m","_e","sprite","style","background","assetSpriteBackground","addSpriteToScene","spriteUpload","click","onSpriteFileUpload","uploadFromURL","addTextBox","eventBus","fireCommand","command","subscribeCommand","handler","$on","fire","kind","eventType","unsubscribe","$off","path","error","message","webpSupportPromise","losslessCode","img","document","createElement","width","height","src","assetCache","customAssets","getAAsset","asset","hq","url","lq","Image","crossOrigin","display","body","appendChild","baseUrl","getAsset","replace","registerAsset","file","URL","createObjectURL","registerAssetWithURL","visible","drop","_t","hide","stopPropagation","preventDefault","dataTransfer","items","item","match","getAsFile","uploadedSpritesPack","packCredits","characters","fonts","sprites","poemStyles","backgrounds","colors","customAssetCount","variants","variant","join","chibi","effectAllowed","from","spriteDt","show","uploadInput","files","prompt","lastSegment","addNewCustomSprite","assets","characterType","contentPack","processed","current","DropTarget","panelForParts","hasMultiplePoses","seekStyle","seekPose","seekPart","captialize","closeUp","flip","screenWidth","screenHeight","positions","characterPositions","arraySeeker","array","pos","delta","val","CloseUpYOffset","BaseCharacterYPos","characterMutations","setPose","obj","objects","poseId","version","setCharStyle","styleId","setPosePosition","posePositions","setClose","close","setFreeMove","freeMove","x","closestCharacterSlot","y","getData","getters","getDataG","rootGetters","getPose","poses","getParts","pose","compatibleHeads","left","right","getHeads","headTypeId","headType","heads","sorted","idx","Math","abs","sort","a","b","lastSpriteId","characterActions","createCharacters","rootState","panelId","panels","currentPanel","onTop","opacity","preserveRatio","ratio","head","mutatePoseAndPositions","change","styles","seekHead","currentHeads","headKey","setPart","setCharacterPosition","shiftCharacterSlot","currentSlotNr","newSlotNr","fixContentPackRemovalFromCharacter","context","oldPack","oldCharData","char","newCharData","chr","poseAndPositionChange","buildPoseAndPositionData","oldStyle","newStyleIdx","findIndex","oldPoseInStyle","oldPoseInStyleIndex","indexOf","newPosesInStyle","newStyle","newPoseIdx","oldPose","newPose","oldPart","JSON","stringify","newPartIdx","oldVariant","newVariantIdx","oldLeft","newLeftIdx","oldRigth","newRightIdx","oldHeadGroup","newHeadGroupIdx","oldHead","newHeadIdx","commitPoseAndPositionChanges","poseAndPosition","oldHeadCollection","newHeadCollectionNr","allowSize","allowStepMove","isFirstPos","directives","rawName","modifiers","$$selectedVal","selected","_value","_n","multiple","isLastPos","composing","$forceUpdate","required","shiftLayer","Infinity","setInFront","newValue","onClick","partList","index","choose","styleComponent","button","choose_component","allowLQ","downloadCanvas","filename","format","quality","setAttribute","removeChild","defaultValue","canvas","toBlob","blob","toDataURL","dataURItoBlob","dataURI","binStr","atob","len","arr","Uint8Array","charCodeAt","Blob","navigator","msSaveBlob","electron","promptCache","lastPrompt","ipcRenderer","filePath","filepath","send","arrayBuffer","buffer","chooseEnv","isElectron","msSaveOrOpenBlob","envX","toast","lookups","loaded","all","images","size","floor","scaleX","scaleY","offset","baseStyle","backgroundPosition","backgroundSize","environment","lookup","HTMLImageElement","backgroundImage","Number","styleData","lastBase","charData","styleGroup","updateStyleData","renderOrder","order","toUpperCase","static","concat","selection","subSelect","styleComponents","updatePose","parseInt","headTypeIdx","headIdx","buttons","collection","ret","currentPose","headKeyIdx","headImages","currentStyle","poseIdx","generatePosePreview","dedupedStyleGroups","firstStyle","firstPose","partIdx","PartButton","str","charAt","substring","PositionAndSize","Layers","Opacity","Delete","Parts","colorSelect","colorName","color","textEditor","textEditorName","textEditorText","textBoxStyle","talkingDefaults","talkingOther","showControls","allowSkipping","showContinueArrow","autoQuoting","dialog","textbox","resetPosition","splitTextbox","customColor","staticStyle","customNameboxWidth","deriveCustomColors","customControlsColor","customNameboxColor","customNameboxStroke","title","updateHex","addSwatch","swatch","backgroundColor","label1","maxValue1","stops1","v1","label2","maxValue2","stops2","v2","label3","maxValue3","stops3","v3","stopsAlpha","h","deltas","HSLAColor","g","q","hue2rgb","round","toString","padStart","max","min","validCssRgb","validHex","fromCssRgb","fromHex","rgbEx","test","rgbaEx","rgbHead","parentesisPos","rbgTail","elements","parseFloat","trim","RGBAColor","hexShortEx","hexLongEx","hexTail","slider","enterSlide","moveSlide","exitSlide","gradientStops","pointerPath","maxValue","slideActive","svg","MouseEvent","which","bounding","getBoundingClientRect","scale","clientX","touches","scaledX","lastRGBEmit","initValues","newColor","rgbColor","toRgb","toHex","hslColor","toHSL","gen","stops","relative","eightsStops","stop","toCss","validator","Slider","generatedPackId","hex","swatches","existingPack","newPack","SliderGroup","applyColor","selectedColor","onValueChanged","insertText","insertCommand","selectedFont","selectColor","tokenize","tokens","stringWalker","currentTokenState","tokenStateNormal","tokenStateEnd","contents","walker","tokenStateCommand","tokenStateNewLine","tokenText","nextState","textContent","escape","next","msg","around","closing","commandName","argument","argumentsState","Map","paramlessOp","isItalic","isBold","isUnderlined","isStrikethrough","fontName","strokeColor","strokeWidth","letterSpacing","relativeNumberOp","parameter","fontSize","alpha","op","num","isNaN","renderParts","getRenderParts","ctx","save","applyTextStyleToCanvas","strokeText","fillText","restore","lastChar","quoted","measureWidth","alignment","xStart","xEnd","yStart","lineWidth","currentLine","fixLine","lineHeights","lineHeight","line","lastItem","styleStack","tagStack","currentStyleHeight","measureHeight","currentTag","token","TextRenderer","textCommands","tmpContext","getContext","lastStyle","textStyle","measureText","heightCache","font","lineSpacing","text","innerHTML","fontFamily","div","position","top","offsetHeight","set","textAlign","lineJoin","strokeStyle","globalAlpha","fillStyle","TextBoxWidth","TextBoxCorruptedWidth","TextBoxHeight","TextBoxY","TextBoxTextXOffset","TextBoxTextYOffset","NameboxHeight","NameboxWidth","NameboxXOffset","NameboxTextYOffset","ControlsYBottomOffset","ControlsXHistoryOffset","ControlsXSkipOffset","ControlsXStuffOffset","ArrowXRightOffset","ArrowYBottomOffset","GlowRX","GlowRY","BaseTextStyle","NameboxTextStyle","ControlsTextStyle","align","fill","ControlsTextDisabledStyle","NameboxY","colorSelector","rememberedStart","rememberedEnd","textArea","el","selectionStart","selectionEnd","$nextTick","selStart","selEnd","focus","arg","selectedText","before","after","commandOpen","Color","talkingDefault","controls","skip","continue","TextEditor","dragEnter","dt","addImageFile","bgColor","setBackground","upload","onFileUpload","addByUrl","isActive","backgroundId","bgData","urls","flipped","seekVariant","scaling","currentBackgroundId","uploadedBackgroundsPack","addNewCustomBackground","BackgroundButton","BackgroundSettings","addNew","select","credits","activate","deactivate","uninstall","restart","allowedTags","allowedAttributes","schemaLimitedAttributes","allowedSchemas","enforceAttributes","rel","sanitize","html","retDoc","doc","childNodes","node","sanitizeElement","sanitizedNode","protocolMatcher","nodeType","Node","ELEMENT_NODE","tagName","includes","attributes","allowedAttrs","attr","protocolMatch","removeAttribute","enforce","attrName","createTextNode","subNode","selectedPack","needRestart","installedCharacterPacks","location","reload","installContentPack","queuedUninstall","installed","uninstallContentPack","activateContentPack","deactivateContentPack","startsWith","freshInstall","isPackInstallingSupported","ScalingModes","panel_button","updateCurrentPanel","addNewPanel","canDeletePanel","deletePanel","canMoveAhead","moveAhead","canMoveBehind","moveBehind","ppi","estimateExportSize","transparentId","lastPanelNum","previewManager","panelToUrl","urlToPanel","register","unregister","delete","revokeObjectURL","namespaced","panelOrder","setCurrentPanel","setPanelPreview","lastRender","createPanel","setPanelOrder","setCurrentBackground","setBackgroundColor","setBackgroundFlipped","setBackgroundVariant","setBackgroundScaling","actions","None","duplicatePanel","parse","sourcePanelId","targetPanelId","root","oldIdx","seekBackgroundVariant","newOrderIdx","orderIdx","fixContentPackRemoval","oldContent","oldBackground","newBackground","oldVariantJSON","move","newIdx","rx","image","w","Stretch","Cover","screenRatio","drawImage","drawRect","lockedRatio","shadow","preview","blur","hx","hy","hitX","hitY","fsCtx","aborted","params","outline","shadowColor","shadowBlur","offsetX","shadowOffsetX","offsetY","shadowOffsetY","translate","paintOnto","composition","beginPath","rect","globalCompositeOperation","stroke","repetition","previewCanvas","createPattern","transform","x0","y0","x1","y1","createLinearGradient","runningContext","renderCallback","abort","clearRect","saveToFile","getImageData","localRenderer","lastVersion","hitDetectionFallback","headAssets","renderPart","loadedAssets","loadedHeadAssets","loadedAsset","loadedheadAsset","headAnchor","updateLocalCanvas","scaledY","flippedX","getDataAt","DOMException","zoom","roundedRectangle","moveTo","arcTo","closePath","roundedTopRectangle","lineTo","lastX","lastY","lastH","lastW","w2","x2","y2","fromCss","renderBackdrop","renderNamebox","renderText","bottom","controlsY","controlsCenter","drawText","controlsStyle","controlsDisableStyle","hslOutline","nameboxOutlineColor","customTransform","clip","subRx","gradient","linearGradient","baseBG","nameboxBackgroundColor","targetColor","addColorStop","fixAlignment","dotPattern","dotRx","drawDot","dotX","dotY","drawPath","ellipse","PI","fillDelta","subSubRx","pattern","patternFrom","glowGradient","outlineDelta","outlineColor","baseX","baseY","quote","base","controlColor","col","disColor","renderObjectCache","_currentlyRendering","renderer","date","Date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getRenderObjects","renderObject","hitTest","getBackgroundRenderer","objectsState","onTopOrder","toUncache","webpSupport","heifSupport","moveFocusToActivePanel","sceneRenderer","targetCanvas","distribution","getPanelDistibution","prefix","extension","renderObjects","imageIdx","estimateFactor","sizes","readableSizes","toFixed","filePluralize","itPluralize","sizePluralize","oldQuality","mapper","panelIdx","imageI","sliceStart","sliceEnd","querySelector","scrollIntoView","ele","parent","parentElement","children","scroll","clientHeight","scrollTop","clientWidth","panelButtons","objectOrders","txtBox","objId","panelSelection","onPanelChange","newSelection","lastDownload","SettingsPanel","AddPanel","BackgroundsPanel","CreditsPanel","CharacterPanel","TextBoxPanel","SpritePanel","ContentPacksPanel","PanelsPanel","messages","showLoading","showLoadingTimeout","hideLoadingTimeout","onLoadingChange","loading","setTimeout","clearTimeout","onUiClick","onTouchStart","onDragStart","onSpriteDragMove","onSpriteDrop","onDragOver","onDrop","onMouseEnter","currentlyRendering","queuedRender","showingLast","dropSpriteCount","dropPreventClick","draggedObject","dragXOffset","dragYOffset","dragXOriginal","dragYOriginal","imageUrl","sceneRender","oldUrl","requestAnimationFrame","render_","cancelAnimationFrame","unsafe","invalidateRender","mut","sd","sdCtx","renderLoadingScreen","loadingScreen","rctx","offsetLeft","ry","offsetTop","sx","offsetWidth","sy","selectedObject","toRendererCoordinate","clientY","objectsAt","currentObjectIdx","dropEffect","deltaX","shiftKey","sourcePack","TouchEvent","blendOver","uiSize","last","updateArea","removeEventListener","onKeydown","keyCode","sw","sh","rh","rw","opth","optimum","optv","optimizeWithMenu","documentElement","cw","ch","v","ctrlKey","ToolBox","MessageConsole","Render","spriteMutations","spriteActions","createSprite","textBoxMutations","setText","setTalkingDefault","setTalkingOther","setStyle","setControlsVisible","setControlsColor","setDeriveCustomColors","setNameboxColor","setNameboxStroke","setNameboxWidth","setSkipable","setContinueArrow","setCustomColor","setAutoQuoting","setResetBounds","resetBounds","lastTextBoxId","textBoxActions","createTextBox","resetTextboxBounds","newWidth","lastCopyId","removeFromList","addToList","setOnTop","setPosition","setFlip","setOpacity","setSize","setRatio","removeObject","newPosition","setPreserveRatio","setWidth","setHeight","copyObjects","sourceOrders","oldObject","deleteAllOfPanel","setVertical","setNsfw","setLqRendering","setSelection","setLastDownload","mergeContentPacks","mergeBackgrounds","mergeCharacters","mergeIdArrays","xObj","yObj","mergeArrayUnique","mergeBackground","mergeCharacter","mergeHeadCollections","mergePose","xStyle","yStyle","headGroupKey","headGroup","getId","merge","definedIds","yId","existingIdx","existing","baseDir","baseTypes","setContentPacks","setCurrentContent","convertContentPack","convertedPack","removeContentPacks","packIds","newContentPacks","reduce","acc","replaceContentPack","action","packIdx","loadContentPacks","fetch","response","status","statusText","json","paths","href","convertV1","getCharacters","getBackgrounds","types","replacementMap","use","setUnsafe","removePacks","oldState","oldMut","newMut","config","productionTip","$mount"],"mappings":"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","file":"js/app.f3ecea04.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sliderGroup.vue?vue&type=style&index=0&id=b4264986&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sliderGroup.vue?vue&type=style&index=0&id=b4264986&lang=scss&scoped=true&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./content-pack.vue?vue&type=style&index=0&id=5eff8ae6&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./content-pack.vue?vue&type=style&index=0&id=5eff8ae6&lang=scss&scoped=true&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./positionAndSize.vue?vue&type=style&index=0&id=3f06b3e2&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./positionAndSize.vue?vue&type=style&index=0&id=3f06b3e2&lang=scss&scoped=true&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./backgrounds.vue?vue&type=style&index=0&id=a95f70b6&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./backgrounds.vue?vue&type=style&index=0&id=a95f70b6&lang=scss&scoped=true&\"","import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./parts.vue?vue&type=style&index=0&id=80168160&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./parts.vue?vue&type=style&index=0&id=80168160&lang=scss&scoped=true&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./credits.vue?vue&type=style&index=0&id=f2bd9d50&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./credits.vue?vue&type=style&index=0&id=f2bd9d50&lang=scss&scoped=true&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./toolbox.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./toolbox.vue?vue&type=style&index=0&lang=scss&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./textbox.vue?vue&type=style&index=0&id=3a5e2c97&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./textbox.vue?vue&type=style&index=0&id=3a5e2c97&lang=scss&scoped=true&\"","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./settings.vue?vue&type=style&index=0&id=6b10192a&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./settings.vue?vue&type=style&index=0&id=6b10192a&lang=scss&scoped=true&\"","import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./slider.vue?vue&type=style&index=0&id=e42d3bc8&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./slider.vue?vue&type=style&index=0&id=e42d3bc8&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./toggle.vue?vue&type=style&index=0&id=7bd0fd86&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./toggle.vue?vue&type=style&index=0&id=7bd0fd86&lang=scss&scoped=true&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./add.vue?vue&type=style&index=0&id=269e38c8&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./add.vue?vue&type=style&index=0&id=269e38c8&lang=scss&scoped=true&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./message-console.vue?vue&type=style&index=0&id=10803f16&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./message-console.vue?vue&type=style&index=0&id=10803f16&lang=scss&scoped=true&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./layers.vue?vue&type=style&index=0&id=34f3a848&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./layers.vue?vue&type=style&index=0&id=34f3a848&lang=scss&scoped=true&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./panels.vue?vue&type=style&index=0&id=b815c22a&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./panels.vue?vue&type=style&index=0&id=b815c22a&lang=scss&scoped=true&\"","import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./settings.vue?vue&type=style&index=0&id=645ce448&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./settings.vue?vue&type=style&index=0&id=645ce448&lang=scss&scoped=true&\"","import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./partButton.vue?vue&type=style&index=0&id=64d7c201&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./partButton.vue?vue&type=style&index=0&id=64d7c201&lang=scss&scoped=true&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./drop-target.vue?vue&type=style&index=0&id=2a32b954&lang=css&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./drop-target.vue?vue&type=style&index=0&id=2a32b954&lang=css&scoped=true&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./character.vue?vue&type=style&index=0&id=1fd09bc8&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./character.vue?vue&type=style&index=0&id=1fd09bc8&lang=scss&scoped=true&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sprite.vue?vue&type=style&index=0&id=5a4d8016&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sprite.vue?vue&type=style&index=0&id=5a4d8016&lang=scss&scoped=true&\"","export default {\r\n\t/**\r\n\t *\r\n\t * @param {Vue} Vue\r\n\t * @param {{}} options\r\n\t */\r\n\tinstall(Vue, options = {}) {\r\n\t\tif (!Vue._installedPlugins.find(plugin => plugin.Store)) {\r\n\t\t\tthrow new Error(\r\n\t\t\t\t'VuexUndoRedo plugin must be installed after the Vuex plugin.'\r\n\t\t\t);\r\n\t\t}\r\n\t\tif (!options.resetStateMutation) options.resetStateMutation = 'emptyState';\r\n\t\tif (!options.mutations) options.mutations = {};\r\n\r\n\t\tconst history = new Vue({\r\n\t\t\tdata() {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tdone: [],\r\n\t\t\t\t\tundone: [],\r\n\t\t\t\t\tnewMutation: true,\r\n\t\t\t\t\tignoreMutations: options.ignoreMutations || [],\r\n\t\t\t\t\tcurrentTransaction: null,\r\n\t\t\t\t\ttransactionQueue: [],\r\n\t\t\t\t\tinitialized: false,\r\n\t\t\t\t};\r\n\t\t\t},\r\n\r\n\t\t\tcreated() {\r\n\t\t\t\twindow.historyStuff = this;\r\n\t\t\t},\r\n\r\n\t\t\tmethods: {\r\n\t\t\t\tinitialize(store) {\r\n\t\t\t\t\tif (!this.$store) this.$store = store;\r\n\t\t\t\t\tif (!this.$store) return;\r\n\t\t\t\t\tif (this.initialized) return;\r\n\t\t\t\t\tthis.initialized = true;\r\n\t\t\t\t\tthis.$store.subscribe(mutation => {\r\n\t\t\t\t\t\tconst exec = () => {\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\tmutation.type === options.resetStateMutation ||\r\n\t\t\t\t\t\t\t\tgetMutationProperties(mutation.type).ignore(mutation)\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthis.currentTransaction.push(mutation);\r\n\t\t\t\t\t\t\tif (this.newMutation) {\r\n\t\t\t\t\t\t\t\tthis.undone = [];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tif (this.currentTransaction) {\r\n\t\t\t\t\t\t\texec();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// If a mutation triggers outside of any transaction, it gets it's own transaction\r\n\t\t\t\t\t\t\tthis.transaction(() => {\r\n\t\t\t\t\t\t\t\texec();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tredo() {\r\n\t\t\t\t\tif (this.undone.length <= 0) return;\r\n\t\t\t\t\tlet commit = this.undone.pop();\r\n\t\t\t\t\tthis.newMutation = false;\r\n\t\t\t\t\treplayTransaction(this, commit);\r\n\t\t\t\t\tthis.newMutation = true;\r\n\t\t\t\t},\r\n\t\t\t\tasync undo() {\r\n\t\t\t\t\tif (this.done.length <= 0) return;\r\n\t\t\t\t\tthis.undone.push(this.done.pop());\r\n\t\t\t\t\tthis.newMutation = false;\r\n\t\t\t\t\tawait replayAll(this);\r\n\t\t\t\t\tthis.newMutation = true;\r\n\t\t\t\t},\r\n\t\t\t\t/**\r\n\t\t\t\t * @param {transactionCallback} callback\r\n\t\t\t\t */\r\n\t\t\t\ttransaction(callback) {\r\n\t\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\t\tconst exec = async () => {\r\n\t\t\t\t\t\t\tthis.currentTransaction = [];\r\n\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\tawait callback();\r\n\t\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t\tconsole.log('Error during transaction!: ', e);\r\n\t\t\t\t\t\t\t\treject(e);\r\n\t\t\t\t\t\t\t\tthis.currentTransaction = [];\r\n\t\t\t\t\t\t\t\t// The transaction that just failed is not in the undo history yet.\r\n\t\t\t\t\t\t\t\t// So replaying that is equivalent to undoing the transaction.\r\n\t\t\t\t\t\t\t\treplayAll(this);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconst lastUndo = this.done[this.done.length - 1];\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\tthis.currentTransaction.length === 1 &&\r\n\t\t\t\t\t\t\t\tlastUndo &&\r\n\t\t\t\t\t\t\t\tlastUndo.length === 1\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tconst options = getMutationProperties(\r\n\t\t\t\t\t\t\t\t\tthis.currentTransaction[0].type\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\toptions.combinable(lastUndo[0], this.currentTransaction[0])\r\n\t\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t\tconst combination = options.combinator(\r\n\t\t\t\t\t\t\t\t\t\tlastUndo[0],\r\n\t\t\t\t\t\t\t\t\t\tthis.currentTransaction[0]\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\tthis.done.pop();\r\n\t\t\t\t\t\t\t\t\tif (combination) {\r\n\t\t\t\t\t\t\t\t\t\tthis.currentTransaction = [combination];\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t// Returning a non-truthy value in the combinator simply eliminates both transactions.\r\n\t\t\t\t\t\t\t\t\t\t// So if the user manually undoes an action, you can just pretend it never happened.\r\n\t\t\t\t\t\t\t\t\t\tthis.currentTransaction = [];\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (this.currentTransaction.length > 0) {\r\n\t\t\t\t\t\t\t\tthis.done.push(this.currentTransaction);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tthis.currentTransaction = null;\r\n\t\t\t\t\t\t\tif (this.transactionQueue.length > 0) {\r\n\t\t\t\t\t\t\t\tthis.transactionQueue.pop()();\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tresolve();\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tif (this.currentTransaction) {\r\n\t\t\t\t\t\t\tthis.transactionQueue.push(exec);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\texec();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\tVue.mixin({\r\n\t\t\tcomputed: {\r\n\t\t\t\tvuexHistory() {\r\n\t\t\t\t\treturn history;\r\n\t\t\t\t},\r\n\t\t\t},\r\n\r\n\t\t\tcreated() {\r\n\t\t\t\thistory.initialize(this.$store);\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * @param {Vue} vm\r\n\t\t * @param {*} mutation\r\n\t\t */\r\n\t\tasync function replayAll(vm) {\r\n\t\t\tconst oldTransactions = vm.done.slice(0);\r\n\t\t\tvm.done = [];\r\n\t\t\tvm.$store.commit(options.resetStateMutation);\r\n\t\t\tfor (let i = 0; i < oldTransactions.length; ++i) {\r\n\t\t\t\tawait replayTransaction(vm, oldTransactions[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tasync function replayTransaction(vm, transaction) {\r\n\t\t\treturn await vm.transaction(() => {\r\n\t\t\t\ttransaction.forEach(mutation => {\r\n\t\t\t\t\treplayMutation(vm, mutation);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @param {Vue} vm\r\n\t\t * @param {*} mutation\r\n\t\t */\r\n\t\tfunction replayMutation(vm, mutation) {\r\n\t\t\tswitch (typeof mutation.payload) {\r\n\t\t\t\tcase 'object':\r\n\t\t\t\t\tlet baseObj = {};\r\n\t\t\t\t\tif (mutation.payload instanceof Array) {\r\n\t\t\t\t\t\tbaseObj = [];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvm.$store.commit(\r\n\t\t\t\t\t\t`${mutation.type}`,\r\n\t\t\t\t\t\tObject.assign(baseObj, mutation.payload)\r\n\t\t\t\t\t);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tvm.$store.commit(`${mutation.type}`, mutation.payload);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst mutationProperiesCache = {};\r\n\r\n\t\t/**\r\n\t\t *\r\n\t\t * @param {IHistoryOptions} options\r\n\t\t * @param {*} name\r\n\t\t */\r\n\t\tfunction getMutationProperties(name) {\r\n\t\t\tif (!mutationProperiesCache[name]) {\r\n\t\t\t\tconst parts = name.split('/');\r\n\t\t\t\tconst mutationProperties = {\r\n\t\t\t\t\tignore: mutation => false,\r\n\t\t\t\t\tcombinable: (oldMutation, newMutation) => false,\r\n\t\t\t\t\tcombinator: (oldMutation, newMutation) => newMutation,\r\n\t\t\t\t};\r\n\t\t\t\tlet currentWildcard = '';\r\n\t\t\t\tfor (const part of parts) {\r\n\t\t\t\t\tif (options.mutations[currentWildcard + '*']) {\r\n\t\t\t\t\t\tObject.assign(\r\n\t\t\t\t\t\t\tmutationProperties,\r\n\t\t\t\t\t\t\toptions.mutations[currentWildcard + '*']\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcurrentWildcard += part + '/';\r\n\t\t\t\t}\r\n\t\t\t\tif (options.mutations[name]) {\r\n\t\t\t\t\tObject.assign(mutationProperties, options.mutations[name]);\r\n\t\t\t\t}\r\n\t\t\t\tmutationProperiesCache[name] = mutationProperties;\r\n\t\t\t}\r\n\t\t\treturn mutationProperiesCache[name];\r\n\t\t}\r\n\t},\r\n};\r\n\r\n/**\r\n * @callback transactionCallback\r\n * @async\r\n */\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('div',{attrs:{\"id\":\"container\"}},[_c('render',{ref:\"render\",attrs:{\"canvasWidth\":_vm.canvasWidth,\"canvasHeight\":_vm.canvasHeight}})],1),_c('message-console'),_c('tool-box',{on:{\"show-prev-render\":_vm.drawLastDownload,\"download\":function($event){return _vm.$refs.render.download()}}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{ vertical: _vm.vertical },attrs:{\"id\":\"panels\"}},[_c('div',{attrs:{\"id\":\"toolbar\"}},[_c('button',{class:{ active: _vm.panel === 'add' },attrs:{\"title\":\"Add new objects to the scene\"},on:{\"click\":function($event){return _vm.setPanel('add')}}},[_c('i',{staticClass:\"material-icons\"},[_vm._v(\"add_box\")])]),_c('button',{class:{ active: _vm.panel === 'backgrounds' },attrs:{\"title\":\"Change the current background\"},on:{\"click\":function($event){return _vm.setPanel('backgrounds')}}},[_c('i',{staticClass:\"material-icons\"},[_vm._v(\"panorama\")])]),_c('button',{class:{ active: _vm.panel === 'panels' },attrs:{\"title\":\"Panels\"},on:{\"click\":function($event){return _vm.setPanel('panels')}}},[_c('i',{staticClass:\"material-icons\"},[_vm._v(\"view_module\")])]),_c('button',{class:{ active: _vm.panel === 'settings' },attrs:{\"title\":\"Settings\"},on:{\"click\":function($event){return _vm.setPanel('settings')}}},[_c('i',{staticClass:\"material-icons\"},[_vm._v(\"settings_applications\")])])]),(_vm.panel === 'settings')?_c('settings-panel'):(_vm.panel === 'packs')?_c('content-packs-panel'):(_vm.panel === 'backgrounds')?_c('backgrounds-panel'):(_vm.panel === 'help_credits')?_c('credits-panel'):(_vm.panel === 'character')?_c('character-panel'):(_vm.panel === 'sprite')?_c('sprite-panel'):(_vm.panel === 'textBox')?_c('text-box-panel'):(_vm.panel === 'panels')?_c('panels-panel'):_c('add-panel'),_c('div',{attrs:{\"id\":\"toolbar-end\"}},[_c('button',{class:{ active: _vm.panel === 'help_credits' },attrs:{\"title\":\"Help & Credits\"},on:{\"click\":function($event){return _vm.setPanel('help_credits')}}},[_c('i',{staticClass:\"material-icons\"},[_vm._v(\"help\")])]),_c('button',{class:{ active: _vm.panel === 'packs' },attrs:{\"title\":\"Content packs\"},on:{\"click\":function($event){return _vm.setPanel('packs')}}},[_c('i',{staticClass:\"material-icons\"},[_vm._v(\"extension\")])]),_c('button',{attrs:{\"title\":\"Show last downloaded panel\",\"disabled\":!_vm.hasPrevRender},on:{\"click\":function($event){return _vm.$emit('show-prev-render')}}},[_c('i',{staticClass:\"material-icons\"},[_vm._v(\"flip_to_back\")])]),_c('button',{attrs:{\"title\":\"Take a screenshot of the current scene\"},on:{\"click\":function($event){return _vm.$emit('download')}}},[_c('i',{staticClass:\"material-icons\"},[_vm._v(\"photo_camera\")])])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"panel\"},[_c('h1',[_vm._v(\"Settings\")]),_c('toggle',{attrs:{\"label\":\"Low quality preview?\",\"title\":\"Reduces the quality of the preview images to speed up the user experience and consume less data. Does not effect final render.\"},model:{value:(_vm.lqRendering),callback:function ($$v) {_vm.lqRendering=$$v},expression:\"lqRendering\"}}),_c('toggle',{attrs:{\"label\":\"NSFW Mode?\"},model:{value:(_vm.nsfw),callback:function ($$v) {_vm.nsfw=$$v},expression:\"nsfw\"}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('input',{ref:\"checkbox\",attrs:{\"id\":_vm._uid,\"type\":\"checkbox\"},domProps:{\"checked\":_vm.value},on:{\"change\":_vm.onChange}}),_c('label',{staticClass:\"switch\",attrs:{\"for\":_vm._uid}}),_c('label',{attrs:{\"for\":_vm._uid}},[_vm._v(_vm._s(_vm.label))])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop } from 'vue-property-decorator';\r\n\r\n@Component({\r\n\tcomponents: {},\r\n})\r\nexport default class Toggle extends Vue {\r\n\t@Prop({ type: String }) private label!: string | undefined;\r\n\t@Prop({ type: Boolean, default: false }) private value!: boolean;\r\n\r\n\tprivate onChange(event: Event) {\r\n\t\tthis.$emit('input', !!(this.$refs.checkbox as HTMLInputElement).checked);\r\n\t}\r\n\r\n\tprivate get checkbox(): HTMLInputElement {\r\n\t\treturn this.$refs.checkbox as HTMLInputElement;\r\n\t}\r\n}\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./toggle.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./toggle.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./toggle.vue?vue&type=template&id=7bd0fd86&scoped=true&\"\nimport script from \"./toggle.vue?vue&type=script&lang=ts&\"\nexport * from \"./toggle.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./toggle.vue?vue&type=style&index=0&id=7bd0fd86&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7bd0fd86\",\n  null\n  \n)\n\nexport default component.exports","import { Component, Vue, Watch } from 'vue-property-decorator';\r\nimport { State } from 'vuex-class-decorator';\r\n\r\n@Component({})\r\nexport class PanelMixin extends Vue {\r\n\t@State('vertical', { namespace: 'ui' }) private readonly vertical!: boolean;\r\n\r\n\tpublic mounted() {\r\n\t\tthis.updateVertical();\r\n\t\tthis.$el.addEventListener(\r\n\t\t\t'wheel',\r\n\t\t\te => {\r\n\t\t\t\tif (e.type !== 'wheel') return;\r\n\t\t\t\tif (!e.currentTarget) return;\r\n\t\t\t\tconst target = e.currentTarget as HTMLElement;\r\n\t\t\t\tif (target.classList.contains('vertical')) return;\r\n\r\n\t\t\t\tconst ev = e as WheelEvent;\r\n\t\t\t\tif (ev.deltaY === 0) return;\r\n\t\t\t\tif ((ev as any).mozInputSource) {\r\n\t\t\t\t\t// Firefox sends wierdly low delta values :/\r\n\t\t\t\t\ttarget.scrollLeft += ev.deltaY * 25;\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttarget.scrollLeft += ev.deltaY;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{ passive: true }\r\n\t\t);\r\n\t}\r\n\r\n\t@Watch('vertical')\r\n\tprivate updateVertical() {\r\n\t\tif (!this.$el) return;\r\n\t\tif (this.vertical) {\r\n\t\t\tthis.$el.classList.add('vertical');\r\n\t\t} else {\r\n\t\t\tthis.$el.classList.remove('vertical');\r\n\t\t}\r\n\t}\r\n}\r\n","\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop, Watch, Mixins } from 'vue-property-decorator';\nimport { TextBox } from '@/models/textbox';\nimport Toggle from '@/components/toggle.vue';\nimport { State } from 'vuex-class-decorator';\nimport { PanelMixin } from './panelMixin';\nimport { IHistorySupport } from '@/plugins/vuex-history';\nimport { IRemovePacksAction, IRootState } from '@/store';\nimport { Store } from 'vuex';\n\nconst nsfwPacks = {\n\t'dddg.buildin.backgrounds.nsfw': `${process.env.BASE_URL}packs/buildin.base.backgrounds.nsfw.json`,\n\t'dddg.buildin.sayori.nsfw': `${process.env.BASE_URL}packs/buildin.base.sayori.nsfw.json`,\n\t'dddg.buildin.base.natsuki.nsfw': `${process.env.BASE_URL}packs/buildin.base.natsuki.nsfw.json`,\n\t'dddg.buildin.yuri.nsfw': `${process.env.BASE_URL}packs/buildin.base.yuri.nsfw.json`,\n};\n\nconst names = new Set(Object.keys(nsfwPacks));\nconst paths = Object.values(nsfwPacks);\n\n@Component({\n\tcomponents: {\n\t\tToggle,\n\t},\n})\nexport default class SettingsPanel extends Mixins(PanelMixin) {\n\tpublic $store!: Store<IRootState>;\n\n\tprivate vuexHistory!: IHistorySupport;\n\n\tprivate get lqRendering(): boolean {\n\t\treturn this.$store.state.ui.lqRendering;\n\t}\n\tprivate set lqRendering(lqRendering: boolean) {\n\t\tthis.vuexHistory.transaction(async () => {\n\t\t\tawait this.$store.commit('ui/setLqRendering', lqRendering);\n\t\t});\n\t}\n\n\tprivate get nsfw(): boolean {\n\t\treturn !!this.$store.state.content.contentPacks\n\t\t\t.map(pack => pack.packId)\n\t\t\t.filter(packId => !!packId)\n\t\t\t.find(packId => names.has(packId!));\n\t}\n\n\tprivate set nsfw(value: boolean) {\n\t\tthis.vuexHistory.transaction(async () => {\n\t\t\tif (value) {\n\t\t\t\tawait this.$store.dispatch('content/loadContentPacks', paths);\n\t\t\t} else {\n\t\t\t\tawait this.$store.dispatch('removePacks', {\n\t\t\t\t\tpacks: names,\n\t\t\t\t} as IRemovePacksAction);\n\t\t\t}\n\t\t});\n\t}\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./settings.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./settings.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./settings.vue?vue&type=template&id=6b10192a&scoped=true&\"\nimport script from \"./settings.vue?vue&type=script&lang=ts&\"\nexport * from \"./settings.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./settings.vue?vue&type=style&index=0&id=6b10192a&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6b10192a\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.isWebPSupported !== undefined)?_c('div',{staticClass:\"panel\",on:{\"dragenter\":_vm.showDropTarget,\"mouseleave\":_vm.hideDropTarget}},[_c('drop-target',{ref:\"spriteDt\",staticClass:\"drop-target\",on:{\"drop\":_vm.addCustomSpriteFile}},[_vm._v(\"Drop here to add as a new sprite\")]),_c('h1',[_vm._v(\"Add\")]),_c('div',{class:{ 'group-selector': true, vertical: _vm.vertical }},[_c('button',{class:{ active: _vm.group === 'characters' },on:{\"click\":function($event){_vm.group = 'characters'}}},[_c('i',{staticClass:\"material-icons\"},[_vm._v(\"emoji_people\")]),_vm._v(\" Characters \")]),_c('button',{class:{ active: _vm.group === 'sprites' },on:{\"click\":function($event){_vm.group = 'sprites'}}},[_c('i',{staticClass:\"material-icons\"},[_vm._v(\"change_history\")]),_vm._v(\" Sprites \")]),_c('button',{class:{ active: _vm.group === 'ui' },on:{\"click\":function($event){_vm.group = 'ui'}}},[_c('i',{staticClass:\"material-icons\"},[_vm._v(\"view_quilt\")]),_vm._v(\" UI \")])]),_c('div',{class:{ 'item-grid': true, vertical: _vm.vertical }},[(_vm.group === 'characters')?[_vm._l((_vm.characters),function(character){return _c('div',{key:character.id,staticClass:\"character\",attrs:{\"title\":character.label},on:{\"click\":function($event){_vm.onChosen(character.id.toLowerCase())}}},[_c('img',{attrs:{\"src\":_vm.assetPath(character),\"alt\":character.label}})])}),_vm._m(0)]:_vm._e(),(_vm.group === 'sprites')?[_vm._l((_vm.sprites),function(sprite){return _c('div',{key:sprite.label,staticClass:\"sprite\",style:({ background: _vm.assetSpriteBackground(sprite) }),attrs:{\"title\":sprite.label},on:{\"click\":function($event){return _vm.addSpriteToScene(sprite)}}},[_vm._v(_vm._s(sprite.label))])}),_c('button',{staticClass:\"btn custom-sprite\",on:{\"click\":function($event){return _vm.$refs.spriteUpload.click()}}},[_c('i',{staticClass:\"material-icons\"},[_vm._v(\"publish\")]),_vm._v(\" Upload new sprite \"),_c('input',{ref:\"spriteUpload\",attrs:{\"type\":\"file\"},on:{\"change\":_vm.onSpriteFileUpload}})]),_c('button',{on:{\"click\":_vm.uploadFromURL}},[_c('i',{staticClass:\"material-icons\"},[_vm._v(\"insert_link\")]),_vm._v(\" New sprite from URL \")]),_vm._m(1)]:_vm._e(),(_vm.group === 'ui')?[_c('button',{on:{\"click\":_vm.addTextBox}},[_vm._v(\"Textbox\")]),_c('button',{attrs:{\"disabled\":\"disabled\"}},[_vm._v(\"Poem\")]),_c('button',{attrs:{\"disabled\":\"disabled\"}},[_vm._v(\"Dialog box\")]),_c('button',{attrs:{\"disabled\":\"disabled\"}},[_vm._v(\"Choice\")]),_c('button',{attrs:{\"disabled\":\"disabled\"}},[_vm._v(\"Console\")])]:_vm._e()],2)],1):_vm._e()}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"btn custom-sprite disabled\",attrs:{\"title\":\"Not yet implemented\"}},[_c('i',{staticClass:\"material-icons\"},[_vm._v(\"extension\")]),_vm._v(\" Search in content packs \")])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('button',{attrs:{\"title\":\"Not yet implemented\",\"disabled\":\"disabled\"}},[_c('i',{staticClass:\"material-icons\"},[_vm._v(\"extension\")]),_vm._v(\" Search in content packs \")])}]\n\nexport { render, staticRenderFns }","import Vue from 'vue';\nimport { ICommand } from './command';\n\nconst eventBus = new Vue();\n\nexport default {\n\tfireCommand(command: ICommand) {\n\t\teventBus.$emit('command', command);\n\t},\n\tsubscribeCommand(handler: (ev: ICommand) => void): void {\n\t\teventBus.$on('command', handler);\n\t},\n\n\tfire(event: IEvent) {\n\t\teventBus.$emit(event.kind, event);\n\t},\n\n\tsubscribe<T extends IEvent>(\n\t\teventType: IEventClass<T>,\n\t\thandler: (ev: T) => void\n\t) {\n\t\teventBus.$on(eventType.kind, handler);\n\t},\n\n\tunsubscribe<T extends IEvent>(\n\t\teventType: IEventClass<T>,\n\t\thandler: (ev: T) => void\n\t) {\n\t\teventBus.$off(eventType.kind, handler);\n\t},\n};\n\ninterface IEvent {\n\tkind: string;\n}\n\ninterface IEventClass<T> {\n\tkind: string;\n\tnew (...args: any[]): T;\n}\n\n// tslint:disable: max-classes-per-file\n\nexport class AssetFailureEvent implements IEvent {\n\tpublic static readonly kind = 'AssetFailureEvent';\n\tpublic readonly kind = 'AssetFailureEvent';\n\tpublic constructor(public path: string) {}\n}\n\nexport class CustomAssetFailureEvent implements IEvent {\n\tpublic static readonly kind = 'CustomAssetFailureEvent';\n\tpublic readonly kind = 'CustomAssetFailureEvent';\n\tpublic constructor(public error: ErrorEvent) {}\n}\n\nexport class InvalidateRenderEvent implements IEvent {\n\tpublic static readonly kind = 'InvalidateRenderEvent';\n\tpublic readonly kind = 'InvalidateRenderEvent';\n}\n\nexport class ShowMessageEvent implements IEvent {\n\tpublic static readonly kind = 'ShowMessageEvent';\n\tpublic readonly kind = 'ShowMessageEvent';\n\tpublic constructor(public message: string) {}\n}\n","export class ErrorAsset {}\n","import EventBus, {\n\tAssetFailureEvent,\n\tCustomAssetFailureEvent,\n} from './eventbus/event-bus';\nimport { ErrorAsset } from './models/error-asset';\nimport { IAsset } from './store/content';\n\nlet webpSupportPromise: Promise<boolean>;\n\nexport function isWebPSupported(): Promise<boolean> {\n\tif (!webpSupportPromise) {\n\t\twebpSupportPromise = new Promise((resolve, reject) => {\n\t\t\tconst losslessCode =\n\t\t\t\t'data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=';\n\t\t\tconst img = document.createElement('img');\n\t\t\timg.addEventListener('load', () => {\n\t\t\t\tresolve(img.width === 2 && img.height === 1);\n\t\t\t});\n\t\t\timg.addEventListener('error', () => {\n\t\t\t\tresolve(false);\n\t\t\t});\n\t\t\timg.src = losslessCode;\n\t\t});\n\t}\n\treturn webpSupportPromise;\n}\n\nconst assetCache: {\n\t[url: string]: Promise<HTMLImageElement | ErrorAsset> | undefined;\n} = {};\nconst customAssets: { [id: string]: Promise<HTMLImageElement> } = {};\n\nexport async function getAAsset(\n\tasset: IAsset,\n\thq: boolean = true\n): Promise<HTMLImageElement | ErrorAsset> {\n\tconst url = hq ? asset.hq : asset.lq;\n\n\tif (!assetCache[url]) {\n\t\tassetCache[url] = new Promise((resolve, reject) => {\n\t\t\tconst img = new Image();\n\t\t\timg.addEventListener('load', () => {\n\t\t\t\tresolve(img);\n\t\t\t});\n\t\t\timg.addEventListener('error', () => {\n\t\t\t\tEventBus.fire(new AssetFailureEvent(url));\n\t\t\t\tassetCache[url] = undefined;\n\t\t\t\tresolve(new ErrorAsset());\n\t\t\t});\n\t\t\timg.crossOrigin = 'Anonymous';\n\t\t\timg.src = url;\n\t\t\timg.style.display = 'none';\n\t\t\tdocument.body.appendChild(img);\n\t\t});\n\t}\n\n\treturn assetCache[url]!;\n}\nexport const baseUrl = process.env.BASE_URL === '' ? '.' : process.env.BASE_URL;\n\nexport async function getAsset(\n\tasset: string,\n\thq: boolean = true\n): Promise<HTMLImageElement | ErrorAsset> {\n\tif (customAssets[asset]) {\n\t\treturn customAssets[asset];\n\t}\n\n\tconst url = `${baseUrl}/assets/${asset}${hq ? '' : '.lq'}${\n\t\t(await isWebPSupported()) ? '.webp' : '.png'\n\t}`.replace(/\\/+/, '/');\n\n\tif (!assetCache[url]) {\n\t\tassetCache[url] = new Promise((resolve, reject) => {\n\t\t\tconst img = new Image();\n\t\t\timg.addEventListener('load', () => {\n\t\t\t\tresolve(img);\n\t\t\t});\n\t\t\timg.addEventListener('error', () => {\n\t\t\t\tEventBus.fire(new AssetFailureEvent(url));\n\t\t\t\tassetCache[url] = undefined;\n\t\t\t\tresolve(new ErrorAsset());\n\t\t\t});\n\t\t\timg.crossOrigin = 'Anonymous';\n\t\t\timg.src = url;\n\t\t\timg.style.display = 'none';\n\t\t\tdocument.body.appendChild(img);\n\t\t});\n\t}\n\n\treturn assetCache[url]!;\n}\n\nexport function registerAsset(asset: string, file: File): string {\n\tconst url = URL.createObjectURL(file);\n\tcustomAssets[asset] = new Promise((resolve, reject) => {\n\t\tconst img = new Image();\n\t\timg.addEventListener('load', () => {\n\t\t\tresolve(img);\n\t\t});\n\t\timg.addEventListener('error', error => {\n\t\t\tEventBus.fire(new CustomAssetFailureEvent(error));\n\t\t\treject(`Failed to load \"${url}\"`);\n\t\t});\n\t\timg.crossOrigin = 'Anonymous';\n\t\timg.src = url;\n\t\timg.style.display = 'none';\n\t\tdocument.body.appendChild(img);\n\t});\n\treturn url;\n}\n\nexport function registerAssetWithURL(\n\tasset: string,\n\turl: string\n): Promise<HTMLImageElement> {\n\treturn (customAssets[asset] = new Promise((resolve, reject) => {\n\t\tconst img = new Image();\n\t\timg.addEventListener('load', () => {\n\t\t\tresolve(img);\n\t\t});\n\t\timg.addEventListener('error', error => {\n\t\t\tEventBus.fire(new CustomAssetFailureEvent(error));\n\t\t\treject(`Failed to load \"${url}\"`);\n\t\t});\n\t\timg.crossOrigin = 'Anonymous';\n\t\timg.src = url;\n\t\timg.style.display = 'none';\n\t\tdocument.body.appendChild(img);\n\t}));\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.visible)?_c('div',{class:{ vertical: _vm.vertical },on:{\"dragleave\":function($event){_vm.visible = false},\"drop\":_vm.drop}},[_vm._t(\"default\")],2):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Mixins, Vue, Prop } from 'vue-property-decorator';\r\nimport { Store } from 'vuex';\r\nimport { IRootState } from '@/store';\r\nimport { State } from 'vuex-class-decorator';\r\n\r\n@Component({})\r\nexport default class Drop extends Vue {\r\n\tpublic $store!: Store<IRootState>;\r\n\r\n\t@State('vertical', { namespace: 'ui' }) private readonly vertical!: boolean;\r\n\r\n\tprivate visible = false;\r\n\r\n\tpublic show(): void {\r\n\t\tthis.visible = true;\r\n\t}\r\n\r\n\tpublic hide(): void {\r\n\t\tthis.visible = false;\r\n\t}\r\n\r\n\tprivate drop(e: DragEvent): void {\r\n\t\tthis.hide();\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\r\n\t\tif (!e.dataTransfer) return;\r\n\r\n\t\tfor (const item of e.dataTransfer.items) {\r\n\t\t\tif (item.kind === 'file' && item.type.match(/image.*/)) {\r\n\t\t\t\tthis.$emit('drop', item.getAsFile());\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./drop-target.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./drop-target.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./drop-target.vue?vue&type=template&id=2a32b954&scoped=true&\"\nimport script from \"./drop-target.vue?vue&type=script&lang=ts&\"\nexport * from \"./drop-target.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./drop-target.vue?vue&type=style&index=0&id=2a32b954&lang=css&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2a32b954\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop, Mixins } from 'vue-property-decorator';\nimport {\n\tisWebPSupported,\n\tregisterAsset,\n\tregisterAssetWithURL,\n} from '@/asset-manager';\nimport { ICreateCharacterAction } from '@/store/objectTypes/characters';\nimport { ICreateTextBoxAction } from '@/store/objectTypes/textbox';\nimport { IAsset, ReplaceContentPackAction } from '@/store/content';\nimport {\n\tCharacter,\n\tContentPack,\n\tSprite,\n} from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\nimport { Store } from 'vuex';\nimport { IRootState } from '@/store';\nimport { PanelMixin } from './panelMixin';\nimport { State } from 'vuex-class-decorator';\nimport { IHistorySupport } from '@/plugins/vuex-history';\nimport DropTarget from '../drop-target.vue';\nimport { ICreateSpriteAction } from '@/store/objectTypes/sprite';\n\nconst uploadedSpritesPack: ContentPack<string> = {\n\tpackId: 'dddg.buildin.uploadedSprites',\n\tpackCredits: '',\n\tcharacters: [],\n\tfonts: [],\n\tsprites: [],\n\tpoemStyles: [],\n\tbackgrounds: [],\n\tcolors: [],\n};\n\n@Component({\n\tcomponents: { DropTarget },\n})\nexport default class AddPanel extends Mixins(PanelMixin) {\n\tpublic $store!: Store<IRootState>;\n\tprivate isWebPSupported: boolean | null = null;\n\tprivate customAssetCount = 0;\n\tprivate group: 'characters' | 'sprites' | 'ui' = 'characters';\n\n\tprivate vuexHistory!: IHistorySupport;\n\n\tprivate async created() {\n\t\tthis.isWebPSupported = await isWebPSupported();\n\t}\n\n\tprivate get characters(): Array<Character<IAsset>> {\n\t\treturn this.$store.state.content.current.characters;\n\t}\n\n\tprivate get sprites(): Array<Sprite<IAsset>> {\n\t\treturn this.$store.state.content.current.sprites;\n\t}\n\n\tprivate assetSpriteBackground(sprite: Sprite<IAsset>) {\n\t\treturn sprite.variants[0].map(variant => `url('${variant.lq}')`).join(',');\n\t}\n\n\tprivate assetPath(character: Character<IAsset>) {\n\t\treturn character.chibi ? character.chibi.lq : '';\n\t}\n\n\tprivate showDropTarget(e: DragEvent) {\n\t\tif (!e.dataTransfer) return;\n\t\te.dataTransfer.effectAllowed = 'none';\n\t\tif (\n\t\t\t!Array.from(e.dataTransfer.items).find(item =>\n\t\t\t\titem.type.match(/^image.*$/)\n\t\t\t)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\t\te.dataTransfer.effectAllowed = 'link';\n\t\tif (this.group === 'sprites') {\n\t\t\t(this.$refs.spriteDt as DropTarget).show();\n\t\t}\n\t}\n\n\tprivate hideDropTarget() {\n\t\tif (this.group === 'sprites') {\n\t\t\t(this.$refs.spriteDt as DropTarget).hide();\n\t\t}\n\t}\n\n\tprivate onSpriteFileUpload(e: Event) {\n\t\tconst uploadInput = this.$refs.spriteUpload as HTMLInputElement;\n\t\tif (!uploadInput.files) return;\n\t\tfor (const file of uploadInput.files) {\n\t\t\tthis.addCustomSpriteFile(file);\n\t\t}\n\t}\n\n\tprivate async uploadFromURL() {\n\t\tconst url = prompt('Enter the URL of the image');\n\t\tif (!url) return;\n\t\tconst lastSegment = url.split('/').slice(-1)[0];\n\t\tthis.addNewCustomSprite(lastSegment, url);\n\t}\n\n\tprivate async addSpriteToScene(sprite: Sprite<IAsset>) {\n\t\tthis.vuexHistory.transaction(async () => {\n\t\t\tawait this.$store.dispatch('objects/createSprite', {\n\t\t\t\tassets: sprite.variants[0],\n\t\t\t} as ICreateSpriteAction);\n\t\t});\n\t}\n\n\tprivate addTextBox() {\n\t\tthis.vuexHistory.transaction(async () => {\n\t\t\tthis.$store.dispatch('objects/createTextBox', {} as ICreateTextBoxAction);\n\t\t});\n\t}\n\n\tprivate onChosen(id: string) {\n\t\tthis.vuexHistory.transaction(async () => {\n\t\t\tthis.$store.dispatch('objects/createCharacters', {\n\t\t\t\tcharacterType: id,\n\t\t\t} as ICreateCharacterAction);\n\t\t});\n\t}\n\n\tprivate addCustomSpriteFile(file: File) {\n\t\tconst url = URL.createObjectURL(file);\n\t\tthis.addNewCustomSprite(file.name, url);\n\t}\n\n\tprivate addNewCustomSprite(label: string, url: string) {\n\t\tuploadedSpritesPack.sprites.push({\n\t\t\tlabel,\n\t\t\tvariants: [[url]],\n\t\t});\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.dispatch('content/replaceContentPack', {\n\t\t\t\tcontentPack: uploadedSpritesPack,\n\t\t\t\tprocessed: false,\n\t\t\t} as ReplaceContentPackAction);\n\t\t});\n\t}\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./add.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./add.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./add.vue?vue&type=template&id=269e38c8&scoped=true&\"\nimport script from \"./add.vue?vue&type=script&lang=ts&\"\nexport * from \"./add.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./add.vue?vue&type=style&index=0&id=269e38c8&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"269e38c8\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"panel\"},[_c('h1',[_vm._v(_vm._s(_vm.label))]),(_vm.panelForParts)?_c('parts',{attrs:{\"character\":_vm.character,\"part\":_vm.panelForParts},on:{\"leave\":function($event){_vm.panelForParts = null}}}):[(_vm.hasMultiplePoses || _vm.parts.length > 0)?_c('fieldset',[_c('legend',[_vm._v(\"Pose:\")]),_c('table',[_c('tbody',[(_vm.hasMultipleStyles)?_c('tr',[_c('td',{staticClass:\"arrow-col\"},[_c('button',{on:{\"click\":function($event){return _vm.seekStyle(-1)}}},[_vm._v(\"<\")])]),_c('td',[_c('button',{staticClass:\"middle-button\",on:{\"click\":function($event){_vm.panelForParts = 'style'}}},[_vm._v(\" Style \")])]),_c('td',{staticClass:\"arrow-col\"},[_c('button',{on:{\"click\":function($event){return _vm.seekStyle(1)}}},[_vm._v(\">\")])])]):_vm._e(),(_vm.hasMultiplePoses)?_c('tr',[_c('td',{staticClass:\"arrow-col\"},[_c('button',{on:{\"click\":function($event){return _vm.seekPose(-1)}}},[_vm._v(\"<\")])]),_c('td',[_c('button',{staticClass:\"middle-button\",on:{\"click\":function($event){_vm.panelForParts = 'pose'}}},[_vm._v(\" Pose \")])]),_c('td',{staticClass:\"arrow-col\"},[_c('button',{on:{\"click\":function($event){return _vm.seekPose(1)}}},[_vm._v(\">\")])])]):_vm._e(),_vm._l((_vm.parts),function(part){return _c('tr',{key:part},[_c('td',{staticClass:\"arrow-col\"},[_c('button',{on:{\"click\":function($event){return _vm.seekPart(part, -1)}}},[_vm._v(\"<\")])]),_c('td',[_c('button',{staticClass:\"middle-button\",on:{\"click\":function($event){_vm.panelForParts = part}}},[_vm._v(\" \"+_vm._s(_vm.captialize(part))+\" \")])]),_c('td',{staticClass:\"arrow-col\"},[_c('button',{on:{\"click\":function($event){return _vm.seekPart(part, 1)}}},[_vm._v(\">\")])])])})],2)])]):_vm._e(),_c('position-and-size',{attrs:{\"obj\":_vm.character}}),_c('layers',{attrs:{\"obj\":_vm.character}}),_c('opacity',{attrs:{\"obj\":_vm.character}}),_c('toggle',{attrs:{\"label\":\"Close up?\"},model:{value:(_vm.closeUp),callback:function ($$v) {_vm.closeUp=$$v},expression:\"closeUp\"}}),_c('toggle',{attrs:{\"label\":\"Flip?\"},model:{value:(_vm.flip),callback:function ($$v) {_vm.flip=$$v},expression:\"flip\"}}),_c('delete',{attrs:{\"obj\":_vm.character}})]],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { Background } from './background';\r\n\r\nexport const backgrounds = [] as Background[];\r\n\r\nexport type Part = 'variant' | 'left' | 'right' | 'head';\r\n\r\nexport const screenWidth = 1280;\r\nexport const screenHeight = 720;\r\n\r\nexport type CharacterIds =\r\n\t| 'ddlc.monika'\r\n\t| 'ddlc.natsuki'\r\n\t| 'ddlc.sayori'\r\n\t| 'ddlc.yuri'\r\n\t| 'ddlc.fan.mc_classic'\r\n\t| 'ddlc.fan.femc';\r\n\r\nexport const positions = [\r\n\t'4-1',\r\n\t'3-1',\r\n\t'2-1',\r\n\t'4-2',\r\n\t'center',\r\n\t'4-3',\r\n\t'2-2',\r\n\t'3-3',\r\n\t'4-4',\r\n];\r\n\r\nexport const characterPositions = [\r\n\t200,\r\n\t240,\r\n\t400,\r\n\t493,\r\n\t640,\r\n\t786,\r\n\t880,\r\n\t1040,\r\n\t1080,\r\n];\r\n\r\nexport const poses = {\r\n\tsayori: {\r\n\t\tleft: [] as HTMLImageElement[],\r\n\t\tright: [] as HTMLImageElement[],\r\n\t\thead: [] as HTMLImageElement[],\r\n\t},\r\n\tyuri: {\r\n\t\tleft: [] as HTMLImageElement[],\r\n\t\tright: [] as HTMLImageElement[],\r\n\t\thead: [] as HTMLImageElement[],\r\n\t},\r\n\tnatsuki: {\r\n\t\tleft: [] as HTMLImageElement[],\r\n\t\tright: [] as HTMLImageElement[],\r\n\t\thead: [] as HTMLImageElement[],\r\n\t},\r\n\tmonika: {\r\n\t\tleft: [] as HTMLImageElement[],\r\n\t\tright: [] as HTMLImageElement[],\r\n\t\thead: [] as HTMLImageElement[],\r\n\t},\r\n};\r\n","export function arraySeeker(array: any[], pos: number, delta: number) {\n\tlet val = pos + delta;\n\tconst length = array.length;\n\n\tif (val < 0) {\n\t\tval += length;\n\t}\n\tif (val >= length) {\n\t\tval -= length;\n\t}\n\treturn val;\n}\n\nexport function nsfwArraySeeker(\n\tarray: Array<{ nsfw?: boolean }>,\n\tpos: number,\n\tdelta: number,\n\tnsfw: boolean\n) {\n\tlet val = pos;\n\tconst length = array.length;\n\tdo {\n\t\tval += delta;\n\t\tif (val < 0) {\n\t\t\tval += length;\n\t\t}\n\t\tif (val >= length) {\n\t\t\tval -= length;\n\t\t}\n\t} while (array[val].nsfw && !nsfw);\n\treturn val;\n}\n","import { ICommand } from '@/eventbus/command';\nimport {\n\tIObjectsState,\n\tICreateObjectMutation,\n\tIObject,\n\tISetPositionAction,\n\tISetObjectPositionMutation,\n\tIRemoveObjectAction,\n} from '@/store/objects';\nimport { MutationTree, ActionTree, Store, Commit, ActionContext } from 'vuex';\nimport { Part, characterPositions } from '@/models/constants';\nimport { arraySeeker } from '@/models/seekers';\nimport { IHistoryOptions } from '@/plugins/vuex-history';\nimport {\n\tCharacter,\n\tPose,\n\tHeadCollection,\n\tContentPack,\n} from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\nimport { IAsset } from '../content';\nimport { IRootState } from '..';\nimport { DeepReadonly } from '@/util/readonly';\n\nexport interface ICharacter extends IObject {\n\ttype: 'character';\n\tcharacterType: string;\n\tfreeMove: boolean;\n\tclose: boolean;\n\tstyleId: number;\n\tposeId: number;\n\tposePositions: {\n\t\tvariant: number;\n\t\tleft: number;\n\t\tright: number;\n\t\thead: number;\n\t\theadType: number;\n\t};\n}\n\nexport const CloseUpYOffset = -74;\nexport const BaseCharacterYPos = -26;\n\nexport const characterMutations: MutationTree<IObjectsState> = {\n\tsetPose(state, command: ISetPoseMutation) {\n\t\tconst obj = state.objects[command.id] as ICharacter;\n\t\tobj.poseId = command.poseId;\n\t\t++obj.version;\n\t},\n\tsetCharStyle(state, command: ISetCharStyleMutation) {\n\t\tconsole.log(`Setting style of ${command.id} to ${command.styleId}`);\n\n\t\tconst obj = state.objects[command.id] as ICharacter;\n\t\tobj.styleId = command.styleId;\n\t\t++obj.version;\n\t},\n\tsetPosePosition(state, command: ISetPosePositionMutation) {\n\t\tconst obj = state.objects[command.id] as ICharacter;\n\t\tobj.posePositions = {\n\t\t\t...obj.posePositions,\n\t\t\t...command.posePositions,\n\t\t};\n\t\t++obj.version;\n\t},\n\tsetClose(state, command: ISetCloseMutation) {\n\t\tconst obj = state.objects[command.id] as ICharacter;\n\t\tobj.close = command.close;\n\t\t++obj.version;\n\t},\n\tsetFreeMove(state, command: ISetFreeMoveMutation) {\n\t\tconst obj = state.objects[command.id] as ICharacter;\n\t\tobj.freeMove = command.freeMove;\n\t\tif (!obj.freeMove) {\n\t\t\tobj.x = characterPositions[closestCharacterSlot(obj.x)];\n\t\t\tobj.y = BaseCharacterYPos;\n\t\t}\n\t},\n};\n\nexport function getData(\n\tstore: Store<DeepReadonly<IRootState>>,\n\tstate: DeepReadonly<ICharacter>\n): DeepReadonly<Character<IAsset>> {\n\tconst characters = store.getters['content/getCharacters'] as Map<\n\t\tCharacter<IAsset>['id'],\n\t\tCharacter<IAsset>\n\t>;\n\treturn characters.get(state.characterType)!;\n}\n\nexport function getDataG(\n\trootGetters: any,\n\tstate: Readonly<ICharacter>\n): Readonly<Character<IAsset>> {\n\tconst characters = rootGetters['content/getCharacters'] as Map<\n\t\tCharacter<IAsset>['id'],\n\t\tCharacter<IAsset>\n\t>;\n\treturn characters.get(state.characterType)!;\n}\n\nexport function getPose(\n\tdata: DeepReadonly<Character<IAsset>>,\n\tstate: DeepReadonly<ICharacter>\n): DeepReadonly<Pose<IAsset>> {\n\treturn data.poses[state.poseId];\n}\n\nexport function getParts(\n\tdata: DeepReadonly<Character<IAsset>>,\n\tstate: DeepReadonly<ICharacter>\n): DeepReadonly<Part[]> {\n\tconst pose = getPose(data, state);\n\tconst parts: Part[] = [];\n\n\tif (pose.compatibleHeads.length > 0) parts.push('head');\n\tif (pose.variant.length > 1) parts.push('variant');\n\tif (pose.left.length > 1) parts.push('left');\n\tif (pose.right.length > 1) parts.push('right');\n\treturn parts;\n}\n\nexport function getHeads(\n\tdata: DeepReadonly<Character<IAsset>>,\n\tstate: DeepReadonly<ICharacter>,\n\theadTypeId: number = state.posePositions.headType\n): DeepReadonly<HeadCollection<IAsset>> | null {\n\tconst compatibleHeads = getPose(data, state).compatibleHeads;\n\tif (!compatibleHeads || compatibleHeads.length === 0) {\n\t\treturn null;\n\t}\n\tconst heads = data.heads[compatibleHeads[headTypeId]];\n\treturn heads;\n}\n\nexport function closestCharacterSlot(pos: number): number {\n\tconst sorted = characterPositions\n\t\t.map((x, idx) => ({ pos: Math.abs(pos - x), idx }))\n\t\t.sort((a, b) => a.pos - b.pos);\n\treturn sorted[0].idx;\n}\n\nlet lastSpriteId = 0;\n\nexport const characterActions: ActionTree<IObjectsState, IRootState> = {\n\tcreateCharacters({ rootState, commit }, command: ICreateCharacterAction) {\n\t\tcommit('create', {\n\t\t\tobject: {\n\t\t\t\tflip: false,\n\t\t\t\tid: 'characters_' + ++lastSpriteId,\n\t\t\t\tpanelId: rootState.panels.currentPanel,\n\t\t\t\tonTop: false,\n\t\t\t\topacity: 100,\n\t\t\t\ttype: 'character',\n\t\t\t\tx: 640,\n\t\t\t\ty: BaseCharacterYPos,\n\t\t\t\tpreserveRatio: true,\n\t\t\t\tratio: 1,\n\t\t\t\theight: 768,\n\t\t\t\twidth: 768,\n\t\t\t\tcharacterType: command.characterType,\n\t\t\t\tclose: false,\n\t\t\t\tfreeMove: false,\n\t\t\t\tversion: 0,\n\t\t\t\tposeId: 0,\n\t\t\t\tstyleId: 0,\n\t\t\t\tposePositions: {\n\t\t\t\t\thead: 0,\n\t\t\t\t\theadType: 0,\n\t\t\t\t\tleft: 0,\n\t\t\t\t\tright: 0,\n\t\t\t\t\tvariant: 0,\n\t\t\t\t},\n\t\t\t} as ICharacter,\n\t\t} as ICreateObjectMutation);\n\t},\n\n\tseekPart(\n\t\t{ state, commit, dispatch, rootGetters },\n\t\t{ delta, id, part }: ISeekPosePartAction\n\t) {\n\t\tif (part === 'head') {\n\t\t\tdispatch('seekHead', { id, delta } as ISeekHeadAction);\n\t\t\treturn;\n\t\t}\n\t\tconst obj = state.objects[id] as Readonly<ICharacter>;\n\t\tconst pose = getPose(getDataG(rootGetters, obj), obj);\n\t\tif (!(pose as any)[part]) return;\n\t\tcommit('setPosePosition', {\n\t\t\tid,\n\t\t\tposePositions: {\n\t\t\t\t[part]: arraySeeker(\n\t\t\t\t\t(pose as any)[part],\n\t\t\t\t\tobj.posePositions[part],\n\t\t\t\t\tdelta\n\t\t\t\t),\n\t\t\t},\n\t\t} as ISetPosePositionMutation);\n\t},\n\n\tseekPose({ state, commit, rootGetters }, { id, delta }: ISeekPoseAction) {\n\t\tconst obj = state.objects[id] as Readonly<ICharacter>;\n\t\tconst data = getDataG(rootGetters, obj);\n\t\tmutatePoseAndPositions(commit, obj, data, change => {\n\t\t\tchange.poseId = arraySeeker(data.poses, change.poseId, delta);\n\t\t});\n\t},\n\n\tseekStyle({ state, commit, rootGetters }, { id, delta }: ISeekStyleAction) {\n\t\tconst obj = state.objects[id] as Readonly<ICharacter>;\n\t\tconst data = getDataG(rootGetters, obj);\n\t\tmutatePoseAndPositions(commit, obj, data, change => {\n\t\t\tchange.styleId = arraySeeker(data.styles, change.styleId, delta);\n\t\t});\n\t},\n\n\tseekHead({ state, commit, rootGetters }, { id, delta }: ISeekHeadAction) {\n\t\tconst obj = state.objects[id] as Readonly<ICharacter>;\n\t\tconst data = getDataG(rootGetters, obj);\n\t\tconst pose = getPose(data, obj);\n\t\tlet currentHeads = getHeads(data, obj);\n\t\tif (!currentHeads) return;\n\t\tlet head = obj.posePositions.head + delta;\n\t\tlet headType = obj.posePositions.headType;\n\t\tif (head < 0 || head >= currentHeads.variants.length) {\n\t\t\theadType = arraySeeker(\n\t\t\t\tpose.compatibleHeads.map(headKey => data.heads[headKey]),\n\t\t\t\theadType,\n\t\t\t\tdelta\n\t\t\t);\n\t\t\tcurrentHeads = getHeads(data, obj, headType)!;\n\t\t\thead = delta === 1 ? 0 : currentHeads.variants.length - 1;\n\t\t}\n\t\tcommit('setPosePosition', {\n\t\t\tid,\n\t\t\tposePositions: {\n\t\t\t\thead,\n\t\t\t\theadType,\n\t\t\t},\n\t\t} as ISetPosePositionMutation);\n\t},\n\n\tsetPart(\n\t\t{ state, commit, rootGetters },\n\t\t{ id, part, val }: ISetPartAction\n\t): void {\n\t\tconst obj = state.objects[id] as Readonly<ICharacter>;\n\t\tconst data = getDataG(rootGetters, obj);\n\t\tif (part === 'pose') {\n\t\t\tmutatePoseAndPositions(commit, obj, data, change => {\n\t\t\t\tchange.poseId = val;\n\t\t\t});\n\t\t} else if (part === 'style') {\n\t\t\tmutatePoseAndPositions(commit, obj, data, change => {\n\t\t\t\tchange.styleId = val;\n\t\t\t});\n\t\t} else {\n\t\t\tmutatePoseAndPositions(commit, obj, data, change => {\n\t\t\t\tchange.posePositions[part] = val;\n\t\t\t});\n\t\t}\n\t},\n\n\tsetCharacterPosition(\n\t\t{ state, commit },\n\t\t{ id, x, y }: ISetPositionAction\n\t): void {\n\t\tconst obj = state.objects[id] as ICharacter;\n\t\tif (obj.freeMove) {\n\t\t\tcommit('setPosition', {\n\t\t\t\tid,\n\t\t\t\tx,\n\t\t\t\ty,\n\t\t\t} as ISetObjectPositionMutation);\n\t\t} else {\n\t\t\tcommit('setPosition', {\n\t\t\t\tid,\n\t\t\t\tx: characterPositions[closestCharacterSlot(x)],\n\t\t\t\ty: BaseCharacterYPos + (obj.close ? CloseUpYOffset : 0),\n\t\t\t} as ISetObjectPositionMutation);\n\t\t}\n\t},\n\n\tshiftCharacterSlot(\n\t\t{ state, commit },\n\t\t{ id, delta }: IShiftCharacterSlotAction\n\t): void {\n\t\tconst obj = state.objects[id] as ICharacter;\n\t\tconst currentSlotNr = closestCharacterSlot(obj.x);\n\t\tlet newSlotNr = currentSlotNr + delta;\n\t\tif (newSlotNr < 0) {\n\t\t\tnewSlotNr = 0;\n\t\t}\n\t\tif (newSlotNr >= characterPositions.length) {\n\t\t\tnewSlotNr = characterPositions.length - 1;\n\t\t}\n\t\tcommit('setPosition', {\n\t\t\tid,\n\t\t\tx: characterPositions[newSlotNr],\n\t\t\ty: obj.y,\n\t\t} as ISetObjectPositionMutation);\n\t},\n};\n\nexport async function fixContentPackRemovalFromCharacter(\n\tcontext: ActionContext<IObjectsState, IRootState>,\n\tid: string,\n\toldPack: ContentPack<IAsset>\n) {\n\tconst obj = context.state.objects[id] as ICharacter;\n\tconst oldCharData = oldPack.characters.find(\n\t\tchar => char.id === obj.characterType\n\t);\n\tif (!oldCharData) {\n\t\tconsole.error('Character data is missing. Dropping the character.');\n\t\tcontext.dispatch('removeObject', {\n\t\t\tid,\n\t\t} as IRemoveObjectAction);\n\t\treturn;\n\t}\n\tconst newCharData = context.rootState.content.current.characters.find(\n\t\tchr => chr.id === oldCharData.id\n\t);\n\tif (!newCharData) {\n\t\tconsole.error('Character data is missing. Dropping the character.');\n\t\tcontext.dispatch('removeObject', {\n\t\t\tid,\n\t\t} as IRemoveObjectAction);\n\t\treturn;\n\t}\n\tconst poseAndPositionChange = buildPoseAndPositionData(obj);\n\tconst oldStyle = oldCharData.styles[obj.styleId];\n\tconst newStyleIdx = newCharData.styles.findIndex(\n\t\tstyle => style.name === oldStyle.name\n\t);\n\tif (newStyleIdx === -1) {\n\t\tposeAndPositionChange.styleId = 0;\n\t\tconst oldPoseInStyle = oldCharData.poses[poseAndPositionChange.poseId];\n\t\tconst oldPoseInStyleIndex = oldCharData.poses\n\t\t\t.filter(pose => pose.style === oldStyle.name)\n\t\t\t.indexOf(oldPoseInStyle);\n\t\tconst newPosesInStyle = newCharData.poses.filter(\n\t\t\tpose => pose.style === oldStyle.name\n\t\t);\n\t\tif (newPosesInStyle.length < oldPoseInStyleIndex) {\n\t\t\t// Restore a pose of the same index within its style\n\t\t\tposeAndPositionChange.poseId = newCharData.poses.indexOf(\n\t\t\t\tnewPosesInStyle[oldPoseInStyleIndex]\n\t\t\t);\n\t\t} else {\n\t\t\tposeAndPositionChange.poseId = 0;\n\t\t}\n\t} else {\n\t\tif (newStyleIdx !== obj.styleId) {\n\t\t\tposeAndPositionChange.styleId = newStyleIdx;\n\t\t}\n\t\tconst newStyle = newCharData.styles[poseAndPositionChange.styleId];\n\t\tconst oldPoseInStyle = oldCharData.poses[obj.poseId];\n\t\tconst newPoseIdx = newCharData.poses.findIndex(\n\t\t\tpose => pose.name === oldPoseInStyle.name\n\t\t);\n\t\tif (newPoseIdx === -1) {\n\t\t\tposeAndPositionChange.poseId = newCharData.poses.findIndex(\n\t\t\t\tpose => pose.style === newStyle.name\n\t\t\t);\n\t\t} else if (newPoseIdx !== obj.poseId) {\n\t\t\tposeAndPositionChange.poseId = newPoseIdx;\n\t\t}\n\t}\n\t// Styles and poses have been restored. Proceding with pose parts\n\tconst oldPose = oldCharData.poses[obj.poseId];\n\tconst newPose = newCharData.poses[poseAndPositionChange.poseId];\n\n\tfor (const part of ['variant', 'left', 'right'] as Array<\n\t\t'variant' | 'left' | 'right'\n\t>) {\n\t\tconst oldPart = JSON.stringify(oldPose[part][obj.posePositions[part]]);\n\t\tconst newPartIdx = newPose[part].findIndex(\n\t\t\tvariant => JSON.stringify(variant) === oldPart\n\t\t);\n\t\tif (newPartIdx === -1) {\n\t\t\tposeAndPositionChange.posePositions[part] = 0;\n\t\t} else if (newPartIdx !== obj.posePositions[part]) {\n\t\t\tposeAndPositionChange.posePositions[part] = newPartIdx;\n\t\t}\n\t}\n\n\tconst oldVariant = JSON.stringify(oldPose.variant[obj.posePositions.variant]);\n\tconst newVariantIdx = newPose.variant.findIndex(\n\t\tvariant => JSON.stringify(variant) === oldVariant\n\t);\n\tif (newVariantIdx === -1) {\n\t\tposeAndPositionChange.posePositions.variant = 0;\n\t} else if (newVariantIdx !== obj.posePositions.variant) {\n\t\tposeAndPositionChange.posePositions.variant = newVariantIdx;\n\t}\n\tconst oldLeft = JSON.stringify(oldPose.variant[obj.posePositions.left]);\n\tconst newLeftIdx = newPose.variant.findIndex(\n\t\tleft => JSON.stringify(left) === oldLeft\n\t);\n\tif (newLeftIdx === -1) {\n\t\tposeAndPositionChange.posePositions.left = 0;\n\t} else if (newLeftIdx !== obj.posePositions.left) {\n\t\tposeAndPositionChange.posePositions.left = newLeftIdx;\n\t}\n\tconst oldRigth = JSON.stringify(oldPose.variant[obj.posePositions.right]);\n\tconst newRightIdx = newPose.variant.findIndex(\n\t\tright => JSON.stringify(right) === oldRigth\n\t);\n\tif (newRightIdx === -1) {\n\t\tposeAndPositionChange.posePositions.right = 0;\n\t} else if (newRightIdx !== obj.posePositions.right) {\n\t\tposeAndPositionChange.posePositions.right = newRightIdx;\n\t}\n\n\tconst oldHeadGroup = oldPose.compatibleHeads[obj.posePositions.headType];\n\tconst newHeadGroupIdx = newPose.compatibleHeads.indexOf(oldHeadGroup);\n\n\tif (newHeadGroupIdx === -1) {\n\t\tposeAndPositionChange.posePositions.headType = 0;\n\t\tposeAndPositionChange.posePositions.head = 0;\n\t} else {\n\t\tif (newHeadGroupIdx !== obj.posePositions.headType) {\n\t\t\tposeAndPositionChange.posePositions.headType = newHeadGroupIdx;\n\t\t}\n\t\tconst oldHead = JSON.stringify(\n\t\t\toldCharData.heads[oldHeadGroup].variants[obj.posePositions.head]\n\t\t);\n\t\tconst newHeadIdx = newCharData.heads[oldHeadGroup].variants.findIndex(\n\t\t\tvariant => JSON.stringify(variant) === oldHead\n\t\t);\n\t\tif (newHeadIdx === -1) {\n\t\t\tposeAndPositionChange.posePositions.head = 0;\n\t\t} else {\n\t\t\tposeAndPositionChange.posePositions.head = newHeadIdx;\n\t\t}\n\t}\n\n\tcommitPoseAndPositionChanges(context.commit, obj, poseAndPositionChange);\n}\n\nexport const propertyOptions: IHistoryOptions = {\n\tmutations: {\n\t\tsetPosePosition: {\n\t\t\tcombinable: (oldMut, newMut) => oldMut.payload.id === newMut.payload.id,\n\t\t\tcombinator: (oldMut, newMut) => ({\n\t\t\t\ttype: newMut.type,\n\t\t\t\tpayload: {\n\t\t\t\t\tid: newMut.payload.id,\n\t\t\t\t\tposePositions: {\n\t\t\t\t\t\t...oldMut.payload.posePositions,\n\t\t\t\t\t\t...newMut.payload.posePositions,\n\t\t\t\t\t},\n\t\t\t\t} as ISetPosePositionMutation,\n\t\t\t}),\n\t\t},\n\t},\n};\n\nfunction buildPoseAndPositionData(\n\tcharacter: Readonly<ICharacter>\n): PoseAndPositionChange {\n\treturn {\n\t\tstyleId: character.styleId,\n\t\tposeId: character.poseId,\n\t\tposePositions: { ...character.posePositions },\n\t};\n}\n\nfunction commitPoseAndPositionChanges(\n\tcommit: Commit,\n\tcharacter: Readonly<ICharacter>,\n\tposeAndPosition: PoseAndPositionChange\n) {\n\tif (poseAndPosition.styleId !== character.styleId) {\n\t\tconsole.log(\n\t\t\t`Setting style of ${character.id} to ${poseAndPosition.styleId}`\n\t\t);\n\t\tcommit('setCharStyle', {\n\t\t\tid: character.id,\n\t\t\tstyleId: poseAndPosition.styleId,\n\t\t} as ISetCharStyleMutation);\n\t}\n\tif (poseAndPosition.poseId !== character.poseId) {\n\t\tcommit('setPose', {\n\t\t\tid: character.id,\n\t\t\tposeId: poseAndPosition.poseId,\n\t\t} as ISetPoseMutation);\n\t}\n\tif (\n\t\tJSON.stringify(poseAndPosition.posePositions) !==\n\t\tJSON.stringify(character.posePositions)\n\t) {\n\t\tcommit('setPosePosition', {\n\t\t\tid: character.id,\n\t\t\tposePositions: poseAndPosition.posePositions,\n\t\t} as ISetPosePositionMutation);\n\t}\n}\n\nfunction mutatePoseAndPositions(\n\tcommit: Commit,\n\tcharacter: Readonly<ICharacter>,\n\tdata: Character<IAsset>,\n\tcallback: (change: PoseAndPositionChange) => void\n) {\n\tconst poseAndPosition = buildPoseAndPositionData(character);\n\tcallback(poseAndPosition);\n\n\tif (!data.styles[poseAndPosition.styleId]) {\n\t\tposeAndPosition.styleId = 0;\n\t}\n\tconst style = data.styles[poseAndPosition.styleId];\n\n\t// ensure pose integrity\n\tif (!data.poses[poseAndPosition.poseId]) {\n\t\tposeAndPosition.poseId = 0;\n\t}\n\tif (data.poses[poseAndPosition.poseId].style !== style.name) {\n\t\tposeAndPosition.poseId = data.poses.findIndex(\n\t\t\t(val, idx) => idx > poseAndPosition.poseId && val.style === style.name\n\t\t);\n\t\tposeAndPosition.poseId = data.poses.findIndex(\n\t\t\tval => val.style === style.name\n\t\t);\n\t}\n\tconst pose = data.poses[poseAndPosition.poseId];\n\tif (!pose.left[poseAndPosition.posePositions.left]) {\n\t\tposeAndPosition.posePositions.left = 0;\n\t}\n\tif (!pose.right[poseAndPosition.posePositions.right]) {\n\t\tposeAndPosition.posePositions.right = 0;\n\t}\n\tif (!pose.variant[poseAndPosition.posePositions.variant]) {\n\t\tposeAndPosition.posePositions.variant = 0;\n\t}\n\n\t// restore head group\n\tconst oldPose = data.poses[character.poseId];\n\tconst oldHeadCollection =\n\t\toldPose.compatibleHeads[character.posePositions.headType];\n\tconst newHeadCollectionNr = pose.compatibleHeads.indexOf(oldHeadCollection);\n\tif (newHeadCollectionNr >= 0) {\n\t\tposeAndPosition.posePositions.headType = newHeadCollectionNr;\n\t} else {\n\t\tposeAndPosition.posePositions.headType = 0;\n\t\tposeAndPosition.posePositions.head = 0;\n\t}\n\n\tcommitPoseAndPositionChanges(commit, character, poseAndPosition);\n}\n\ninterface PoseAndPositionChange {\n\tstyleId: ICharacter['styleId'];\n\tposeId: ICharacter['poseId'];\n\tposePositions: ICharacter['posePositions'];\n}\n\nexport interface ISetPoseMutation extends ICommand {\n\treadonly poseId: number;\n}\n\nexport interface ISetCharStyleMutation extends ICommand {\n\treadonly styleId: number;\n}\n\nexport interface ISetPosePositionMutation extends ICommand {\n\treadonly posePositions: {\n\t\tvariant: number;\n\t\tleft: number;\n\t\tright: number;\n\t\thead: number;\n\t\theadType: number;\n\t};\n}\n\nexport interface ISetFreeMoveMutation extends ICommand {\n\treadonly freeMove: boolean;\n}\n\nexport interface ISetCloseMutation extends ICommand {\n\treadonly close: boolean;\n}\n\nexport interface ICreateCharacterAction {\n\treadonly characterType: string;\n}\n\nexport interface ISeekPoseAction extends ICommand {\n\treadonly delta: -1 | 1;\n}\n\nexport interface ISeekStyleAction extends ICommand {\n\treadonly delta: -1 | 1;\n}\n\nexport interface ISeekHeadAction extends ICommand {\n\treadonly delta: -1 | 1;\n}\n\nexport interface ISetPartAction extends ICommand {\n\treadonly part: Part | 'headType' | 'pose' | 'style';\n\treadonly val: number;\n}\n\nexport interface INsfwCheckAction extends ICommand {}\n\nexport interface ISeekPosePartAction extends ICommand {\n\treadonly part: Part;\n\treadonly delta: -1 | 1;\n}\n\nexport interface ISetSpriteSizeMutation extends ICommand {\n\treadonly width: number;\n\treadonly height: number;\n}\n\nexport interface ISetSpriteRatioMutation extends ICommand {\n\treadonly preserveRatio: boolean;\n\treadonly ratio: number;\n}\n\nexport interface ISetSpriteWidthAction extends ICommand {\n\treadonly width: number;\n}\n\nexport interface ISetSpriteHeightAction extends ICommand {\n\treadonly height: number;\n}\n\nexport interface ISetSpriteRatioAction extends ICommand {\n\treadonly preserveRatio: boolean;\n}\n\nexport interface ICreateSpriteAction extends ICommand {\n\treadonly assetName: string;\n}\n\nexport interface IShiftCharacterSlotAction extends ICommand {\n\treadonly delta: -1 | 1;\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('fieldset',[_c('legend',[_vm._v(\"Position\"+_vm._s(_vm.allowSize ? '/Size' : '')+\":\")]),_c('table',[_c('tr',[_c('td',{attrs:{\"colspan\":\"2\"}},[(_vm.allowStepMove)?_c('toggle',{attrs:{\"label\":\"Move freely?\"},model:{value:(_vm.freeMove),callback:function ($$v) {_vm.freeMove=$$v},expression:\"freeMove\"}}):_vm._e()],1)]),(_vm.allowStepMove && !_vm.freeMove)?_c('tr',[_c('td',{attrs:{\"colspan\":\"2\"}},[_c('table',[_c('tr',[_c('td',{staticClass:\"arrow-col\"},[_c('button',{attrs:{\"disabled\":_vm.isFirstPos},on:{\"click\":function($event){--_vm.pos}}},[_vm._v(\"<\")])]),_c('td',[_c('select',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.pos),expression:\"pos\",modifiers:{\"number\":true}}],attrs:{\"id\":\"current_talking\"},on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return _vm._n(val)}); _vm.pos=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},_vm._l((_vm.positionNames),function(val,key){return _c('option',{key:key,domProps:{\"value\":key}},[_vm._v(_vm._s(val))])}),0)]),_c('td',{staticClass:\"arrow-col\"},[_c('button',{attrs:{\"disabled\":_vm.isLastPos},on:{\"click\":function($event){++_vm.pos}}},[_vm._v(\">\")])])])])])]):[_c('tr',[_vm._m(0),_c('td',[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.x),expression:\"x\",modifiers:{\"number\":true}}],attrs:{\"id\":\"sprite_x\",\"type\":\"number\"},domProps:{\"value\":(_vm.x)},on:{\"keydown\":function($event){$event.stopPropagation();},\"input\":function($event){if($event.target.composing){ return; }_vm.x=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}})])]),_c('tr',[_vm._m(1),_c('td',[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.y),expression:\"y\",modifiers:{\"number\":true}}],attrs:{\"id\":\"sprite_y\",\"type\":\"number\"},domProps:{\"value\":(_vm.y)},on:{\"keydown\":function($event){$event.stopPropagation();},\"input\":function($event){if($event.target.composing){ return; }_vm.y=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}})])])],(_vm.allowSize)?[_c('tr',[_vm._m(2),_c('td',[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.width),expression:\"width\",modifiers:{\"number\":true}}],attrs:{\"id\":\"sprite_w\",\"min\":\"0\",\"type\":\"number\"},domProps:{\"value\":(_vm.width)},on:{\"keydown\":function($event){$event.stopPropagation();},\"input\":function($event){if($event.target.composing){ return; }_vm.width=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}})])]),_c('tr',[_vm._m(3),_c('td',[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.height),expression:\"height\",modifiers:{\"number\":true}}],attrs:{\"id\":\"sprite_h\",\"min\":\"0\",\"type\":\"number\"},domProps:{\"value\":(_vm.height)},on:{\"keydown\":function($event){$event.stopPropagation();},\"input\":function($event){if($event.target.composing){ return; }_vm.height=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}})])]),_c('tr',[_c('td',{attrs:{\"colspan\":\"2\"}},[_c('toggle',{attrs:{\"label\":\"Lock ratio?\"},model:{value:(_vm.preserveRatio),callback:function ($$v) {_vm.preserveRatio=$$v},expression:\"preserveRatio\"}})],1)])]:_vm._e()],2)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('td',[_c('label',{attrs:{\"for\":\"sprite_x\"}},[_vm._v(\"X:\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('td',[_c('label',{attrs:{\"for\":\"sprite_y\"}},[_vm._v(\"Y:\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('td',[_c('label',{attrs:{\"for\":\"sprite_w\"}},[_vm._v(\"Width:\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('td',[_c('label',{attrs:{\"for\":\"sprite_h\"}},[_vm._v(\"Height:\")])])}]\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop } from 'vue-property-decorator';\nimport Toggle from '@/components/toggle.vue';\nimport { IRenderable } from '@/models/renderable';\nimport { positions, characterPositions } from '@/models/constants';\nimport {\n\tclosestCharacterSlot,\n\tISetFreeMoveMutation,\n\tICharacter,\n} from '@/store/objectTypes/characters';\nimport { State } from 'vuex-class-decorator';\nimport {\n\tISetPositionAction,\n\tISetObjectPositionMutation,\n\tIObject,\n\tISetHeightAction,\n\tISetWidthAction,\n\tISetRatioAction,\n} from '@/store/objects';\nimport { ISprite } from '@/store/objectTypes/sprite';\nimport { IHistorySupport } from '@/plugins/vuex-history';\nimport { ITextBox } from '@/store/objectTypes/textbox';\n\n@Component({\n\tcomponents: {\n\t\tToggle,\n\t},\n})\nexport default class PositionAndSize extends Vue {\n\t@Prop({ required: true })\n\tprivate readonly obj!: IObject;\n\n\tprivate vuexHistory!: IHistorySupport;\n\n\tprivate get allowSize() {\n\t\tconst obj = this.obj;\n\t\tif (\n\t\t\tthis.obj.type === 'textBox' &&\n\t\t\t(this.obj as ITextBox).style !== 'custom'\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\t\tif (this.obj.type === 'character' && !(this.obj as ICharacter).freeMove) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tprivate get allowStepMove() {\n\t\treturn 'freeMove' in this.obj;\n\t}\n\n\tprivate get freeMove() {\n\t\treturn (this.obj as ICharacter).freeMove;\n\t}\n\n\tprivate set freeMove(val: boolean) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.commit('objects/setFreeMove', {\n\t\t\t\tid: this.obj.id,\n\t\t\t\tfreeMove: val,\n\t\t\t} as ISetFreeMoveMutation);\n\t\t});\n\t}\n\n\tprivate get positionNames(): string[] {\n\t\treturn positions;\n\t}\n\n\tprivate get pos(): number {\n\t\treturn closestCharacterSlot(this.obj.x);\n\t}\n\n\tprivate set pos(value: number) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/setPosition', {\n\t\t\t\tid: this.obj.id,\n\t\t\t\tx: characterPositions[value],\n\t\t\t\ty: this.obj.y,\n\t\t\t} as ISetPositionAction);\n\t\t});\n\t}\n\n\tprivate get isFirstPos(): boolean {\n\t\treturn this.pos === 0;\n\t}\n\n\tprivate get isLastPos(): boolean {\n\t\treturn this.pos === positions.length - 1;\n\t}\n\n\tprivate get x(): number {\n\t\treturn this.obj.x;\n\t}\n\n\tprivate set x(val: number) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/setPosition', {\n\t\t\t\tid: this.obj.id,\n\t\t\t\tx: val,\n\t\t\t\ty: this.y,\n\t\t\t} as ISetObjectPositionMutation);\n\t\t});\n\t}\n\n\tprivate get y(): number {\n\t\treturn this.obj.y;\n\t}\n\n\tprivate set y(val: number) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/setPosition', {\n\t\t\t\tid: this.obj.id,\n\t\t\t\tx: this.x,\n\t\t\t\ty: val,\n\t\t\t} as ISetObjectPositionMutation);\n\t\t});\n\t}\n\n\tprivate get height(): number {\n\t\treturn (this.obj as ISprite).height;\n\t}\n\n\tprivate set height(val: number) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/setHeight', {\n\t\t\t\tid: this.obj.id,\n\t\t\t\theight: val,\n\t\t\t} as ISetHeightAction);\n\t\t});\n\t}\n\n\tprivate get width(): number {\n\t\treturn (this.obj as ISprite).width;\n\t}\n\n\tprivate set width(val: number) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/setWidth', {\n\t\t\t\tid: this.obj.id,\n\t\t\t\twidth: val,\n\t\t\t} as ISetWidthAction);\n\t\t});\n\t}\n\n\tprivate get preserveRatio(): boolean {\n\t\treturn (this.obj as ISprite).preserveRatio;\n\t}\n\n\tprivate set preserveRatio(val: boolean) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/setPreserveRatio', {\n\t\t\t\tid: this.obj.id,\n\t\t\t\tpreserveRatio: val,\n\t\t\t} as ISetRatioAction);\n\t\t});\n\t}\n}\n\nexport interface MoveObject {\n\tobject: IRenderable;\n\tmove: 'Forward' | 'Backward' | 'Back' | 'Front' | 'Delete';\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./positionAndSize.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./positionAndSize.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./positionAndSize.vue?vue&type=template&id=3f06b3e2&scoped=true&\"\nimport script from \"./positionAndSize.vue?vue&type=script&lang=ts&\"\nexport * from \"./positionAndSize.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./positionAndSize.vue?vue&type=style&index=0&id=3f06b3e2&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3f06b3e2\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('fieldset',{attrs:{\"id\":\"layerfs\"}},[_c('legend',[_vm._v(\"Layer:\")]),_c('table',[_c('tbody',[_c('tr',[_c('td',[_c('button',{attrs:{\"title\":\"Move to back\"},on:{\"click\":function($event){return _vm.shiftLayer(-Infinity)}}},[_c('i',{staticClass:\"material-icons\"},[_vm._v(\"vertical_align_bottom\")])])]),_c('td',[_c('button',{attrs:{\"title\":\"Move backwards\"},on:{\"click\":function($event){return _vm.shiftLayer(-1)}}},[_c('i',{staticClass:\"material-icons\"},[_vm._v(\"arrow_downward\")])])]),_c('td',[_c('button',{attrs:{\"title\":\"Move forwards\"},on:{\"click\":function($event){return _vm.shiftLayer(1)}}},[_c('i',{staticClass:\"material-icons\"},[_vm._v(\"arrow_upward\")])])]),_c('td',[_c('button',{attrs:{\"title\":\"Move to front\"},on:{\"click\":function($event){return _vm.shiftLayer(Infinity)}}},[_c('i',{staticClass:\"material-icons\"},[_vm._v(\"vertical_align_top\")])])])])])]),_c('toggle',{attrs:{\"value\":_vm.obj.onTop,\"label\":\"In front?\"},on:{\"input\":_vm.setInFront}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop } from 'vue-property-decorator';\nimport Toggle from '@/components/toggle.vue';\nimport { ICommand } from '@/eventbus/command';\nimport eventBus from '@/eventbus/event-bus';\nimport { IHistorySupport } from '@/plugins/vuex-history';\nimport {\n\tIObjectSetOnTopAction,\n\tIObjectShiftLayerAction,\n\tIObject,\n} from '@/store/objects';\n\n@Component({\n\tcomponents: {\n\t\tToggle,\n\t},\n})\nexport default class Layers extends Vue {\n\t@Prop({ required: true }) private obj!: IObject;\n\n\tprivate vuexHistory!: IHistorySupport;\n\n\tprivate shiftLayer(delta: number) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/shiftLayer', {\n\t\t\t\tid: this.obj.id,\n\t\t\t\tdelta,\n\t\t\t} as IObjectShiftLayerAction);\n\t\t});\n\t}\n\n\tprivate setInFront(newValue: boolean) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/setOnTop', {\n\t\t\t\tid: this.obj.id,\n\t\t\t\tonTop: newValue,\n\t\t\t} as IObjectSetOnTopAction);\n\t\t});\n\t}\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./layers.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./layers.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./layers.vue?vue&type=template&id=34f3a848&scoped=true&\"\nimport script from \"./layers.vue?vue&type=script&lang=ts&\"\nexport * from \"./layers.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./layers.vue?vue&type=style&index=0&id=34f3a848&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"34f3a848\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('table',[_c('tr',[_vm._m(0),_c('td',[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.opacity),expression:\"opacity\",modifiers:{\"number\":true}}],attrs:{\"type\":\"number\",\"max\":\"100\",\"min\":\"0\",\"id\":\"characterOpacity\"},domProps:{\"value\":(_vm.opacity)},on:{\"keydown\":function($event){$event.stopPropagation();},\"input\":function($event){if($event.target.composing){ return; }_vm.opacity=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}})])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('td',[_c('label',{attrs:{\"for\":\"characterOpacity\"}},[_vm._v(\"Opacity:\")])])}]\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop } from 'vue-property-decorator';\nimport { ICommand } from '@/eventbus/command';\nimport eventBus from '@/eventbus/event-bus';\nimport { IHistorySupport } from '@/plugins/vuex-history';\nimport { IObject, ISetObjectOpacityMutation } from '@/store/objects';\n\n@Component({})\nexport default class Opacity extends Vue {\n\t@Prop({ required: true }) private obj!: IObject;\n\n\tprivate vuexHistory!: IHistorySupport;\n\n\tprivate get opacity() {\n\t\treturn this.obj.opacity;\n\t}\n\n\tprivate set opacity(opacity: number) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.commit('objects/setOpacity', {\n\t\t\t\tid: this.obj.id,\n\t\t\t\topacity,\n\t\t\t} as ISetObjectOpacityMutation);\n\t\t});\n\t}\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./opacity.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./opacity.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./opacity.vue?vue&type=template&id=28c7d1e4&scoped=true&\"\nimport script from \"./opacity.vue?vue&type=script&lang=ts&\"\nexport * from \"./opacity.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./opacity.vue?vue&type=style&index=0&id=28c7d1e4&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"28c7d1e4\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('button',{on:{\"click\":_vm.onClick}},[_vm._v(\"Delete\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\nimport { Component, Vue, Prop } from 'vue-property-decorator';\nimport { IHistorySupport } from '@/plugins/vuex-history';\nimport { IObject, IRemoveObjectAction } from '@/store/objects';\n\n@Component({})\nexport default class Delete extends Vue {\n\t@Prop({ required: true }) private obj!: IObject;\n\n\tprivate vuexHistory!: IHistorySupport;\n\n\tprivate onClick() {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/removeObject', {\n\t\t\t\tid: this.obj.id,\n\t\t\t} as IRemoveObjectAction);\n\t\t});\n\t}\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./delete.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./delete.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./delete.vue?vue&type=template&id=5b33f32e&\"\nimport script from \"./delete.vue?vue&type=script&lang=ts&\"\nexport * from \"./delete.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{ partList: true, vertical: _vm.vertical }},[_c('button',{on:{\"click\":function($event){return _vm.$emit('leave')}}},[_vm._v(\"Back\")]),_vm._l((_vm.parts),function(part,index){return _c('part-button',{key:index,attrs:{\"value\":index,\"part\":part},on:{\"click\":function($event){_vm.choose(index);\n\t\t\t_vm.$emit('leave');}}})}),_vm._l((_vm.styleComponents),function(styleComponent){return _c('fieldset',{key:styleComponent.name},[_c('legend',[_vm._v(_vm._s(styleComponent.label))]),_vm._l((styleComponent.buttons),function(button,index){return _c('part-button',{key:index,attrs:{\"size\":130,\"value\":index,\"part\":button},on:{\"click\":function($event){return _vm.choose_component(styleComponent.name, index)}}})})],2)})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{part: true, active: false/*background === value*/},style:(_vm.style),on:{\"click\":function($event){return _vm.$emit('click')}}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { IEnvironment, IPack } from './environment';\r\nimport { IBackground } from '@/models/background';\r\n\r\nexport class Browser implements IEnvironment {\r\n\tpublic readonly allowLQ = true;\r\n\r\n\tpublic async saveToFile(\r\n\t\tdownloadCanvas: HTMLCanvasElement,\r\n\t\tfilename: string,\r\n\t\tformat: string = 'image/png',\r\n\t\tquality: number = 1\r\n\t): Promise<string> {\r\n\t\tconst a = document.createElement('a');\r\n\t\ta.setAttribute('download', filename);\r\n\t\tconst url = await this.createObjectURL(downloadCanvas, format, quality);\r\n\t\ta.setAttribute('href', url);\r\n\t\tdocument.body.appendChild(a);\r\n\t\ta.click();\r\n\t\tdocument.body.removeChild(a);\r\n\t\treturn url;\r\n\t}\r\n\r\n\tpublic get installedCharacterPacks(): Readonly<Array<Readonly<IPack>>> {\r\n\t\treturn [];\r\n\t}\r\n\r\n\tpublic get isBackgroundInstallingSupported(): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tpublic get isPackInstallingSupported(): boolean {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tpublic installBackground(background: IBackground): boolean {\r\n\t\tthrow new Error('This environment does not support installing backgrounds');\r\n\t}\r\n\r\n\tpublic installContentPack(url: string): boolean {\r\n\t\tthrow new Error(\r\n\t\t\t'This environment does not support installing content packs'\r\n\t\t);\r\n\t}\r\n\r\n\tpublic uninstallBackground(background: IBackground): boolean {\r\n\t\tthrow new Error(\r\n\t\t\t'This environment does not support uninstalling backgrounds'\r\n\t\t);\r\n\t}\r\n\r\n\tpublic uninstallContentPack(url: string): boolean {\r\n\t\tthrow new Error(\r\n\t\t\t'This environment does not support uninstalling content packs'\r\n\t\t);\r\n\t}\r\n\tpublic activateContentPack(url: string): boolean {\r\n\t\tthrow new Error(\r\n\t\t\t'This environment does not support installing content packs'\r\n\t\t);\r\n\t}\r\n\r\n\tpublic deactivateContentPack(url: string): boolean {\r\n\t\tthrow new Error(\r\n\t\t\t'This environment does not support uninstalling content packs'\r\n\t\t);\r\n\t}\r\n\r\n\tpublic prompt(\r\n\t\tmessage: string,\r\n\t\tdefaultValue?: string\r\n\t): Promise<string | null> {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tresolve(prompt(message, defaultValue));\r\n\t\t});\r\n\t}\r\n\r\n\tpublic onPanelChange(handler: (panel: string) => void): void {\r\n\t\treturn;\r\n\t}\r\n\r\n\tprotected createObjectURL(\r\n\t\tcanvas: HTMLCanvasElement,\r\n\t\tformat: string,\r\n\t\tquality: number\r\n\t): Promise<string> {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tif (canvas.toBlob && window.URL && window.URL.createObjectURL) {\r\n\t\t\t\tcanvas.toBlob(\r\n\t\t\t\t\tblob => {\r\n\t\t\t\t\t\tif (!blob) {\r\n\t\t\t\t\t\t\treject();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tresolve(URL.createObjectURL(blob));\r\n\t\t\t\t\t},\r\n\t\t\t\t\tformat,\r\n\t\t\t\t\tquality\r\n\t\t\t\t);\r\n\t\t\t} else if (window.URL && window.URL.createObjectURL) {\r\n\t\t\t\tconst url = canvas.toDataURL();\r\n\t\t\t\tconst blob = this.dataURItoBlob(url, format);\r\n\t\t\t\tresolve(URL.createObjectURL(blob));\r\n\t\t\t} else {\r\n\t\t\t\tresolve(canvas.toDataURL());\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprotected dataURItoBlob(dataURI: string, type: string) {\r\n\t\tconst binStr = atob(dataURI.split(',')[1]);\r\n\t\tconst len = binStr.length;\r\n\t\tconst arr = new Uint8Array(len);\r\n\r\n\t\tfor (let i = 0; i < len; i++) {\r\n\t\t\tarr[i] = binStr.charCodeAt(i);\r\n\t\t}\r\n\r\n\t\treturn new Blob([arr], { type });\r\n\t}\r\n}\r\n","import { Browser } from './browser';\r\n\r\nexport class Edge extends Browser {\r\n\tpublic async saveToFile(\r\n\t\tdownloadCanvas: HTMLCanvasElement,\r\n\t\tfilename: string,\r\n\t\tformat: string = 'image/png',\r\n\t\tquality: number = 1\r\n\t): Promise<string> {\r\n\t\tlet url = downloadCanvas.toDataURL(format, quality);\r\n\t\tconst blob = this.dataURItoBlob(url, format);\r\n\r\n\t\tif (window.URL && window.URL.createObjectURL) {\r\n\t\t\turl = URL.createObjectURL(blob);\r\n\t\t}\r\n\r\n\t\t// IE-specific code\r\n\t\twindow.navigator.msSaveBlob(blob, filename);\r\n\t\treturn url;\r\n\t}\r\n}\r\n","import { IEnvironment, IPack } from './environment';\r\nimport { registerAssetWithURL, getAsset } from '@/asset-manager';\r\nimport { Background } from '@/models/background';\r\nimport eventBus from '@/eventbus/event-bus';\r\n\r\nconst packs: IPack[] = [];\r\n\r\nexport class Electron implements IEnvironment {\r\n\tpublic readonly allowLQ = false;\r\n\tprivate electron = (window as any) as IElectronWindow;\r\n\tprivate promptCache: {\r\n\t\t[promptId: number]: (resolved: string | null) => void;\r\n\t} = {};\r\n\tprivate lastPrompt: number = 0;\r\n\r\n\tconstructor() {\r\n\t\tthis.electron.ipcRenderer.on(\r\n\t\t\t'add-persistent-character',\r\n\t\t\tasync (e, filePath: string, active: boolean = true) => {\r\n\t\t\t\t/*\r\n\t\t\t\tconst json = await loadCharacterPack(filePath, active);\r\n\t\t\t\tif (!json) return;\r\n\t\t\t\tpacks.push({\r\n\t\t\t\t\turl: filePath,\r\n\t\t\t\t\tqueuedUninstall: false,\r\n\t\t\t\t\tid: json.packId,\r\n\t\t\t\t\tcredits: json.packCredits,\r\n\t\t\t\t\tactive,\r\n\t\t\t\t});\r\n\t\t\t\t*/\r\n\t\t\t}\r\n\t\t);\r\n\t\tthis.electron.ipcRenderer.on(\r\n\t\t\t'add-persistent-background',\r\n\t\t\tasync (e, filepath: string) => {\r\n\t\t\t\tconst name = 'persistentBg-' + filepath;\r\n\t\t\t\tconst parts = filepath.split('/');\r\n\t\t\t\tregisterAssetWithURL(name, filepath);\r\n\t\t\t\tconsole.log(filepath);\r\n\t\t\t\t/*\r\n\t\t\t\tbackgrounds.push(\r\n\t\t\t\t\tnew Background(name, parts[parts.length - 1], true, '', true)\r\n\t\t\t\t);\r\n\t\t\t\t*/\r\n\t\t\t}\r\n\t\t);\r\n\t\tthis.electron.ipcRenderer.on('push-message', async (e, message: string) => {\r\n\t\t\t/*\r\n\t\t\teventBus.fire(new ShowMessageEvent(message));\r\n\t\t\t*/\r\n\t\t});\r\n\t\tthis.electron.ipcRenderer.on(\r\n\t\t\t'prompt-answered',\r\n\t\t\t(e, id: number, value: string | null) => {\r\n\t\t\t\tthis.promptCache[id](value);\r\n\t\t\t}\r\n\t\t);\r\n\t\tthis.electron.ipcRenderer.send('find-customs');\r\n\t}\r\n\r\n\tpublic saveToFile(\r\n\t\tdownloadCanvas: HTMLCanvasElement,\r\n\t\tfilename: string,\r\n\t\tformat: string = 'image/png',\r\n\t\tquality: number = 1\r\n\t): Promise<string> {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tdownloadCanvas.toBlob(\r\n\t\t\t\tasync blob => {\r\n\t\t\t\t\tif (!blob) {\r\n\t\t\t\t\t\treject();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst buffer = await (blob as any).arrayBuffer();\r\n\t\t\t\t\tthis.electron.ipcRenderer.send(\r\n\t\t\t\t\t\t'save-file',\r\n\t\t\t\t\t\tfilename,\r\n\t\t\t\t\t\tnew Uint8Array(buffer)\r\n\t\t\t\t\t);\r\n\t\t\t\t\tresolve(URL.createObjectURL(blob));\r\n\t\t\t\t},\r\n\t\t\t\tformat,\r\n\t\t\t\tquality\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic get installedCharacterPacks(): Readonly<Array<Readonly<IPack>>> {\r\n\t\treturn packs;\r\n\t}\r\n\r\n\tpublic get isBackgroundInstallingSupported(): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tpublic get isPackInstallingSupported(): boolean {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tpublic async installBackground(background: Background): Promise<void> {\r\n\t\t/*\r\n\t\tconst asset = await getAsset(background.path, true);\r\n\t\tif (!(asset instanceof HTMLImageElement)) return;\r\n\t\tconst img = await fetch(asset.src);\r\n\t\tconst array = new Uint8Array(await img.arrayBuffer());\r\n\t\tthis.electron.ipcRenderer.send('install-background', array);\r\n\t\t*/\r\n\t}\r\n\r\n\tpublic async uninstallBackground(background: Background): Promise<void> {\r\n\t\t/*\r\n\t\tconst asset = await getAsset(background.path, true);\r\n\t\tif (!(asset instanceof HTMLImageElement)) return;\r\n\t\tif (!asset.src.startsWith('blob:')) {\r\n\t\t\tconst img = await fetch(asset.src);\r\n\t\t\tconst blob = await img.blob();\r\n\t\t\tconst newUrl = URL.createObjectURL(blob);\r\n\t\t\tregisterAssetWithURL(background.path, newUrl);\r\n\t\t}\r\n\t\tthis.electron.ipcRenderer.send('uninstall-background', background.name);\r\n\t\tbackground.installed = false;\r\n\t\t*/\r\n\t}\r\n\r\n\tpublic installContentPack(url: string): void {\r\n\t\tconsole.log('installContentPack', url);\r\n\t\tthis.electron.ipcRenderer.send('install-content-pack', url);\r\n\t}\r\n\r\n\tpublic uninstallContentPack(url: string): void {\r\n\t\tconsole.log('uninstallContentPack', url);\r\n\t\tthis.electron.ipcRenderer.send('uninstall-content-pack', url);\r\n\t}\r\n\r\n\tpublic activateContentPack(url: string): void {\r\n\t\tconsole.log('activateContentPack', url);\r\n\t\tthis.electron.ipcRenderer.send('activate-content-pack', url);\r\n\t}\r\n\r\n\tpublic deactivateContentPack(url: string): void {\r\n\t\tconsole.log('deactivateContentPack', url);\r\n\t\tthis.electron.ipcRenderer.send('deactivate-content-pack', url);\r\n\t}\r\n\r\n\tpublic prompt(\r\n\t\tmessage: string,\r\n\t\tdefaultValue?: string\r\n\t): Promise<string | null> {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis.promptCache[++this.lastPrompt] = resolve;\r\n\t\t\tthis.electron.ipcRenderer.send(\r\n\t\t\t\t'show-prompt',\r\n\t\t\t\tthis.lastPrompt,\r\n\t\t\t\tmessage,\r\n\t\t\t\tdefaultValue\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic onPanelChange(handler: (panel: string) => void): void {\r\n\t\tthis.electron.ipcRenderer.on('open-panel', (e, panel: string) => {\r\n\t\t\thandler(panel);\r\n\t\t});\r\n\t}\r\n}\r\n\r\ninterface IElectronWindow {\r\n\tisElectron: boolean;\r\n\tipcRenderer: IpcRenderer;\r\n}\r\n\r\ninterface IpcRenderer {\r\n\ton(\r\n\t\tchannel: string,\r\n\t\tlistener: (event: IpcRendererEvent, ...args: any[]) => void\r\n\t): void;\r\n\tsend(channel: string, ...args: any[]): void;\r\n}\r\n\r\ninterface IpcRendererEvent extends Event {\r\n\tsender: IpcRenderer;\r\n\tsenderId: number;\r\n}\r\n","import { Edge } from './edge';\r\nimport { Browser } from './browser';\r\nimport { Electron } from './electron';\r\nimport { Background } from '@/models/background';\r\n\r\nexport interface IPack {\r\n\turl: string;\r\n\tid: string;\r\n\tcredits: string;\r\n\tqueuedUninstall: boolean;\r\n\tactive: boolean;\r\n}\r\n\r\nexport interface IEnvironment {\r\n\treadonly allowLQ: boolean;\r\n\treadonly isBackgroundInstallingSupported: boolean;\r\n\treadonly isPackInstallingSupported: boolean;\r\n\treadonly installedCharacterPacks: Readonly<Array<Readonly<IPack>>>;\r\n\tsaveToFile(\r\n\t\tcanvas: HTMLCanvasElement,\r\n\t\tfilename: string,\r\n\t\tformat?: string,\r\n\t\tquality?: number\r\n\t): Promise<string>;\r\n\tinstallBackground(background: Background): void;\r\n\tuninstallBackground(background: Background): void;\r\n\tactivateContentPack(url: string): void;\r\n\tdeactivateContentPack(url: string): void;\r\n\tinstallContentPack(url: string): void;\r\n\tuninstallContentPack(url: string): void;\r\n\tprompt(message: string, defaultValue?: string): Promise<string | null>;\r\n\tonPanelChange(handler: (panel: string) => void): void;\r\n}\r\n\r\nfunction chooseEnv(): IEnvironment {\r\n\tif ((window as any).isElectron) {\r\n\t\treturn new Electron();\r\n\t}\r\n\tif (window.navigator.msSaveOrOpenBlob !== undefined) {\r\n\t\treturn new Edge();\r\n\t}\r\n\treturn new Browser();\r\n}\r\n\r\nconst envX = chooseEnv();\r\n\r\n(window as any).toast = envX;\r\nexport default envX;\r\n","\n\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop } from 'vue-property-decorator';\r\nimport { getAAsset, getAsset } from '@/asset-manager';\r\nimport environment from '@/environments/environment';\r\nimport { ErrorAsset } from '@/models/error-asset';\r\nimport { IAsset } from '@/store/content';\r\n\r\nexport interface IPartButtonImage {\r\n\timages: Array<IAsset | string>;\r\n\tsize: [number, number];\r\n\toffset: [number, number];\r\n}\r\n\r\n@Component({\r\n\tcomponents: {},\r\n})\r\nexport default class PartButton extends Vue {\r\n\t@Prop({ required: true }) private readonly part!: IPartButtonImage;\r\n\t@Prop({ required: true }) private readonly value!: number;\r\n\t@Prop({ default: 150, type: Number })\r\n\tprivate readonly size!: number;\r\n\r\n\tprivate lookups: Array<HTMLImageElement | ErrorAsset | null> = [];\r\n\tprivate loaded = false;\r\n\r\n\tprivate async created() {\r\n\t\tthis.lookups = await Promise.all(\r\n\t\t\tthis.part.images.map(asset => {\r\n\t\t\t\tif (typeof asset === 'string') {\r\n\t\t\t\t\treturn getAsset(asset, false);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn getAAsset(asset, false);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tprivate get scaleX(): number {\r\n\t\treturn this.size / this.part.size[0];\r\n\t}\r\n\r\n\tprivate get scaleY(): number {\r\n\t\treturn this.size / this.part.size[1];\r\n\t}\r\n\r\n\tprivate get backgroundSize(): string {\r\n\t\treturn `${Math.floor(960 * this.scaleX)}px ${Math.floor(\r\n\t\t\t960 * this.scaleY\r\n\t\t)}px`;\r\n\t}\r\n\r\n\tprivate get backgroundPosition(): string {\r\n\t\treturn (\r\n\t\t\t`${Math.floor(this.part.offset[0] * -this.scaleX)}px ` +\r\n\t\t\t`${Math.floor(this.part.offset[1] * -this.scaleY)}px`\r\n\t\t);\r\n\t}\r\n\r\n\tprivate get style(): { [id: string]: string } {\r\n\t\tconst baseStyle = {\r\n\t\t\theight: this.size + 'px',\r\n\t\t\twidth: this.size + 'px',\r\n\t\t\tbackgroundPosition: this.backgroundPosition,\r\n\t\t\tbackgroundSize: this.backgroundSize,\r\n\t\t};\r\n\t\tconst lq = environment.allowLQ ? '.lq' : '';\r\n\t\tconst images = (this.lookups.filter(\r\n\t\t\tlookup => lookup instanceof HTMLImageElement\r\n\t\t) as HTMLImageElement[]).map(\r\n\t\t\tlookup => `url('${lookup.src.replace(\"'\", \"\\\\'\")}')`\r\n\t\t);\r\n\t\treturn {\r\n\t\t\tbackgroundImage: images.join(','),\r\n\t\t\t...baseStyle,\r\n\t\t};\r\n\t}\r\n}\r\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./partButton.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./partButton.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./partButton.vue?vue&type=template&id=64d7c201&scoped=true&\"\nimport script from \"./partButton.vue?vue&type=script&lang=ts&\"\nexport * from \"./partButton.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./partButton.vue?vue&type=style&index=0&id=64d7c201&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"64d7c201\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop, Watch } from 'vue-property-decorator';\r\nimport {\r\n\tisWebPSupported,\r\n\tregisterAsset,\r\n\tregisterAssetWithURL,\r\n} from '@/asset-manager';\r\nimport environment from '@/environments/environment';\r\nimport PartButton, { IPartButtonImage } from './partButton.vue';\r\nimport { Part } from '@/models/constants';\r\nimport {\r\n\tStyleComponent,\r\n\tPose,\r\n\tCharacter,\r\n} from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\r\nimport { IAsset } from '@/store/content';\r\nimport {\r\n\tgetPose,\r\n\tgetDataG,\r\n\tISeekPoseAction,\r\n\tISetPosePositionMutation,\r\n\tISetPartAction,\r\n\tgetData,\r\n\tICharacter,\r\n} from '@/store/objectTypes/characters';\r\nimport { IHistorySupport } from '@/plugins/vuex-history';\r\nimport { State } from 'vuex-class-decorator';\r\nimport { DeepReadonly } from '../../../../util/readonly';\r\n\r\ninterface IPartStyleGroup {\r\n\tlabel: string;\r\n\tname: string;\r\n\tbuttons: { [id: string]: IPartButtonImage };\r\n}\r\n\r\n@Component({\r\n\tcomponents: {\r\n\t\tPartButton,\r\n\t},\r\n})\r\nexport default class PartsPanel extends Vue {\r\n\t@State('vertical', { namespace: 'ui' }) private readonly vertical!: boolean;\r\n\r\n\t@Prop({ required: true }) private character!: ICharacter;\r\n\t@Prop({ required: true, type: String }) private readonly part!:\r\n\t\t| Part\r\n\t\t| 'pose'\r\n\t\t| 'style';\r\n\r\n\tprivate isWebPSupported: boolean | null = null;\r\n\tprivate styleData: {\r\n\t\tlastBase: string;\r\n\t\tcomponents: {\r\n\t\t\t[s: string]: string;\r\n\t\t};\r\n\t} = {\r\n\t\tlastBase: '',\r\n\t\tcomponents: {},\r\n\t};\r\n\r\n\tprivate vuexHistory!: IHistorySupport;\r\n\r\n\tprivate get charData(): DeepReadonly<Character<IAsset>> {\r\n\t\treturn getData(this.$store, this.character);\r\n\t}\r\n\r\n\t@Watch('character')\r\n\tprivate updateStyleData(): void {\r\n\t\tconst pose = getPose(this.charData, this.character);\r\n\t\tconst baseStyle = this.charData.styles.find(\r\n\t\t\tstyle => style.name === pose.style\r\n\t\t);\r\n\t\tif (!baseStyle) return;\r\n\t\tthis.styleData.lastBase = baseStyle.styleGroup;\r\n\t\tthis.styleData.components = { ...baseStyle.components };\r\n\t}\r\n\r\n\tprivate async created() {\r\n\t\tthis.updateStyleData();\r\n\t\tthis.isWebPSupported = await isWebPSupported();\r\n\t}\r\n\r\n\tprivate get styleComponents(): IPartStyleGroup[] {\r\n\t\tif (this.part !== 'style') return [];\r\n\t\treturn this.charData.styleComponents.map(component => {\r\n\t\t\tconst buttons: IPartStyleGroup['buttons'] = {};\r\n\t\t\tfor (const key in component.variants) {\r\n\t\t\t\tif (!component.variants.hasOwnProperty(key)) continue;\r\n\t\t\t\tconst variant = component.variants[key];\r\n\t\t\t\tbuttons[key] = {\r\n\t\t\t\t\tsize: [960, 960],\r\n\t\t\t\t\toffset: [0, 0],\r\n\t\t\t\t\timages: [variant],\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\treturn { label: component.label, name: component.name, buttons };\r\n\t\t});\r\n\t}\r\n\r\n\tprivate get parts(): { [id: number]: DeepReadonly<IPartButtonImage> } {\r\n\t\tconst ret: { [id: string]: DeepReadonly<IPartButtonImage> } = {};\r\n\t\tlet collection: DeepReadonly<IAsset[][]>;\r\n\t\tlet offset: DeepReadonly<IPartButtonImage['offset']>;\r\n\t\tlet size: DeepReadonly<IPartButtonImage['size']>;\r\n\t\tconst data = this.charData;\r\n\t\tconst currentPose = getPose(data, this.character);\r\n\t\tswitch (this.part) {\r\n\t\t\tcase 'head':\r\n\t\t\t\tfor (\r\n\t\t\t\t\tlet headKeyIdx = 0;\r\n\t\t\t\t\theadKeyIdx < currentPose.compatibleHeads.length;\r\n\t\t\t\t\t++headKeyIdx\r\n\t\t\t\t) {\r\n\t\t\t\t\tconst headKey = currentPose.compatibleHeads[headKeyIdx];\r\n\t\t\t\t\tconst heads = data.heads[headKey];\r\n\t\t\t\t\tfor (let headIdx = 0; headIdx < heads.variants.length; ++headIdx) {\r\n\t\t\t\t\t\tconst headImages = heads.variants[headIdx];\r\n\t\t\t\t\t\tret[`${headKeyIdx}_${headIdx}`] = {\r\n\t\t\t\t\t\t\timages: headImages,\r\n\t\t\t\t\t\t\tsize: heads.size,\r\n\t\t\t\t\t\t\toffset: heads.offset,\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn ret;\r\n\t\t\tcase 'variant':\r\n\t\t\t\tcollection = currentPose.variant;\r\n\t\t\t\tsize = currentPose.size;\r\n\t\t\t\toffset = currentPose.offset;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'left':\r\n\t\t\t\tcollection = currentPose.left;\r\n\t\t\t\tsize = currentPose.size;\r\n\t\t\t\toffset = currentPose.offset;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'right':\r\n\t\t\t\tcollection = currentPose.right;\r\n\t\t\t\tsize = currentPose.size;\r\n\t\t\t\toffset = currentPose.offset;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'pose':\r\n\t\t\t\tconst currentStyle = data.styles[this.character.styleId];\r\n\t\t\t\tfor (let poseIdx = 0; poseIdx < data.poses.length; ++poseIdx) {\r\n\t\t\t\t\tconst pose = data.poses[poseIdx];\r\n\t\t\t\t\tif (pose.style !== currentStyle.name) continue;\r\n\t\t\t\t\tret[poseIdx] = this.generatePosePreview(pose);\r\n\t\t\t\t}\r\n\t\t\t\treturn ret;\r\n\t\t\tcase 'style':\r\n\t\t\t\tconst styles = data.styles;\r\n\t\t\t\tconst dedupedStyleGroups = styles\r\n\t\t\t\t\t.map(style => style.styleGroup)\r\n\t\t\t\t\t.filter((style, idx, all) => {\r\n\t\t\t\t\t\tif (all.indexOf(style) !== idx) return false;\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\tfor (const styleGroup of dedupedStyleGroups) {\r\n\t\t\t\t\tconst firstStyle = styles.find(\r\n\t\t\t\t\t\tstyle => style.styleGroup === styleGroup\r\n\t\t\t\t\t)!;\r\n\t\t\t\t\tconst firstPose = data.poses.find(\r\n\t\t\t\t\t\tpose => pose.style === firstStyle.name\r\n\t\t\t\t\t)!;\r\n\t\t\t\t\tret[styleGroup] = this.generatePosePreview(firstPose);\r\n\t\t\t\t}\r\n\t\t\t\treturn ret;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error('Unrecognised pose part: ' + this.part);\r\n\t\t}\r\n\t\tfor (let partIdx = 0; partIdx < collection.length; ++partIdx) {\r\n\t\t\tconst part = collection[partIdx];\r\n\t\t\tret[partIdx] = {\r\n\t\t\t\timages: part,\r\n\t\t\t\tsize,\r\n\t\t\t\toffset,\r\n\t\t\t};\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprivate generatePosePreview(\r\n\t\tpose: DeepReadonly<Pose<IAsset>>\r\n\t): DeepReadonly<IPartButtonImage> {\r\n\t\tconst data = this.charData;\r\n\t\tconst heads = data.heads[pose.compatibleHeads[0]];\r\n\t\tconst head = heads ? heads.variants[0] : null;\r\n\t\tlet images: IAsset[] = [];\r\n\r\n\t\tfor (const order of pose.renderOrder) {\r\n\t\t\tswitch (order.toUpperCase()) {\r\n\t\t\t\tcase 'S':\r\n\t\t\t\t\tif (pose.static) images = images.concat(pose.static);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'V':\r\n\t\t\t\t\tif (pose.variant.length > 0) images = images.concat(pose.variant[0]);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'L':\r\n\t\t\t\t\tif (pose.left.length > 0) images = images.concat(pose.left[0]);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'R':\r\n\t\t\t\t\tif (pose.right.length > 0) images = images.concat(pose.right[0]);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'H':\r\n\t\t\t\t\tif (head) images = images.concat(head);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\timages,\r\n\t\t\tsize: pose.size,\r\n\t\t\toffset: pose.offset,\r\n\t\t};\r\n\t}\r\n\r\n\tprivate updatePose() {\r\n\t\tconst data = this.charData;\r\n\t\tlet selection = data.styles.filter(\r\n\t\t\tstyle => style.styleGroup === this.styleData.lastBase\r\n\t\t);\r\n\t\tfor (const component of data.styleComponents) {\r\n\t\t\tconst subSelect = selection.filter(styleComponent => {\r\n\t\t\t\treturn (\r\n\t\t\t\t\tstyleComponent.components[component.name] ===\r\n\t\t\t\t\tthis.styleData.components[component.name]\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t\t\tif (subSelect.length > 0) selection = subSelect;\r\n\t\t}\r\n\t\tthis.setPart('style', data.styles.indexOf(selection[0]));\r\n\t}\r\n\r\n\tprivate choose(index: string) {\r\n\t\tif (this.part === 'style') {\r\n\t\t\tthis.styleData.lastBase = index;\r\n\t\t\tthis.updatePose();\r\n\t\t} else if (this.part === 'head') {\r\n\t\t\tconst [headTypeIdx, headIdx] = index\r\n\t\t\t\t.split('_', 2)\r\n\t\t\t\t.map(part => parseInt(part, 10));\r\n\t\t\tthis.setPart('headType', headTypeIdx);\r\n\t\t\tthis.setPart('head', headIdx);\r\n\t\t} else {\r\n\t\t\tthis.setPart(this.part, parseInt(index, 10));\r\n\t\t}\r\n\t}\r\n\r\n\tprivate choose_component(component: string, index: string) {\r\n\t\tthis.styleData.components[component] = index;\r\n\t\tthis.updatePose();\r\n\t}\r\n\r\n\tprivate setPart(part: ISetPartAction['part'], index: number): void {\r\n\t\tthis.vuexHistory.transaction(() => {\r\n\t\t\tthis.$store.dispatch('objects/setPart', {\r\n\t\t\t\tid: this.character.id,\r\n\t\t\t\tpart,\r\n\t\t\t\tval: index,\r\n\t\t\t} as ISetPartAction);\r\n\t\t});\r\n\t}\r\n}\r\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./parts.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./parts.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./parts.vue?vue&type=template&id=80168160&scoped=true&\"\nimport script from \"./parts.vue?vue&type=script&lang=ts&\"\nexport * from \"./parts.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./parts.vue?vue&type=style&index=0&id=80168160&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"80168160\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop, Mixins } from 'vue-property-decorator';\nimport { State } from 'vuex-class-decorator';\nimport { IHistorySupport } from '@/plugins/vuex-history';\nimport { Part } from '@/models/constants';\nimport {\n\tgetData,\n\tgetParts,\n\tISeekPoseAction,\n\tISetCloseMutation,\n\tISeekPosePartAction,\n\tICharacter,\n\tISeekStyleAction,\n} from '@/store/objectTypes/characters';\nimport { ISetObjectFlipMutation } from '@/store/objects';\nimport Toggle from '@/components/toggle.vue';\nimport PositionAndSize from '@/components/toolbox/commonsFieldsets/positionAndSize.vue';\nimport Layers from '@/components/toolbox/commonsFieldsets/layers.vue';\nimport Opacity from '@/components/toolbox/commonsFieldsets/opacity.vue';\nimport Delete from '@/components/toolbox/commonsFieldsets/delete.vue';\nimport Parts from './character/parts.vue';\nimport { Character } from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\nimport { IAsset } from '@/store/content';\nimport { PanelMixin } from './panelMixin';\nimport { Store } from 'vuex';\nimport { IRootState } from '@/store';\nimport { DeepReadonly } from '../../../util/readonly';\n\n@Component({\n\tcomponents: {\n\t\tToggle,\n\t\tPositionAndSize,\n\t\tLayers,\n\t\tOpacity,\n\t\tDelete,\n\t\tParts,\n\t},\n})\nexport default class CharacterPanel extends Mixins(PanelMixin) {\n\tpublic $store!: Store<DeepReadonly<IRootState>>;\n\n\tprivate get character(): DeepReadonly<ICharacter> {\n\t\tconst obj = this.$store.state.objects.objects[\n\t\t\tthis.$store.state.ui.selection!\n\t\t];\n\t\tif (obj.type !== 'character') return undefined!;\n\t\treturn obj as ICharacter;\n\t}\n\n\tprivate panelForParts: Part | null = null;\n\n\tprivate vuexHistory!: IHistorySupport;\n\n\tprivate get charData(): DeepReadonly<Character<IAsset>> {\n\t\treturn getData(this.$store, this.character);\n\t}\n\n\tprivate get label(): string {\n\t\treturn this.charData.label || '';\n\t}\n\n\tprivate get parts(): DeepReadonly<string[]> {\n\t\treturn getParts(this.charData, this.character);\n\t}\n\n\tprivate get hasMultipleStyles(): boolean {\n\t\treturn this.charData.styles.length > 1;\n\t}\n\n\tprivate get hasMultiplePoses(): boolean {\n\t\tconst style = this.charData.styles[this.character.styleId];\n\t\treturn this.charData.poses.filter(x => x.style === style.name).length > 1;\n\t}\n\n\tprivate seekPose(delta: number): void {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/seekPose', {\n\t\t\t\tid: this.character.id,\n\t\t\t\tdelta,\n\t\t\t} as ISeekPoseAction);\n\t\t});\n\t}\n\n\tprivate seekStyle(delta: number): void {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/seekStyle', {\n\t\t\t\tid: this.character.id,\n\t\t\t\tdelta,\n\t\t\t} as ISeekStyleAction);\n\t\t});\n\t}\n\n\tprivate seekPart(part: Part, delta: number): void {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/seekPart', {\n\t\t\t\tid: this.character.id,\n\t\t\t\tdelta,\n\t\t\t\tpart,\n\t\t\t} as ISeekPosePartAction);\n\t\t});\n\t}\n\n\tprivate captialize(str: string) {\n\t\treturn str.charAt(0).toUpperCase() + str.substring(1);\n\t}\n\n\tprivate get flip() {\n\t\treturn this.character.flip;\n\t}\n\n\tprivate set flip(newValue: boolean) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.commit('objects/setFlip', {\n\t\t\t\tid: this.character.id,\n\t\t\t\tflip: newValue,\n\t\t\t} as ISetObjectFlipMutation);\n\t\t});\n\t}\n\n\tprivate get closeUp() {\n\t\treturn this.character.close;\n\t}\n\n\tprivate set closeUp(newValue: boolean) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.commit('objects/setClose', {\n\t\t\t\tid: this.character.id,\n\t\t\t\tclose: newValue,\n\t\t\t} as ISetCloseMutation);\n\t\t});\n\t}\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./character.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./character.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./character.vue?vue&type=template&id=1fd09bc8&scoped=true&\"\nimport script from \"./character.vue?vue&type=script&lang=ts&\"\nexport * from \"./character.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./character.vue?vue&type=style&index=0&id=1fd09bc8&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1fd09bc8\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"panel\"},[_c('h1',[_vm._v(\"Custom Sprite\")]),_c('position-and-size',{attrs:{\"obj\":_vm.sprite}}),_c('layers',{attrs:{\"obj\":_vm.sprite}}),_c('opacity',{attrs:{\"obj\":_vm.sprite}}),_c('toggle',{attrs:{\"label\":\"Flip?\"},model:{value:(_vm.flip),callback:function ($$v) {_vm.flip=$$v},expression:\"flip\"}}),_c('delete',{attrs:{\"obj\":_vm.sprite}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop, Mixins } from 'vue-property-decorator';\nimport { isWebPSupported } from '@/asset-manager';\nimport { Character } from '@/models/character';\nimport Toggle from '@/components/toggle.vue';\nimport PositionAndSize from '@/components/toolbox/commonsFieldsets/positionAndSize.vue';\nimport Layers from '@/components/toolbox/commonsFieldsets/layers.vue';\nimport Opacity from '@/components/toolbox/commonsFieldsets/opacity.vue';\nimport Delete from '@/components/toolbox/commonsFieldsets/delete.vue';\nimport { IRenderable } from '@/models/renderable';\nimport { Sprite } from '@/models/sprite';\nimport { ISprite } from '@/store/objectTypes/sprite';\nimport { ICommand } from '@/eventbus/command';\nimport eventBus from '@/eventbus/event-bus';\nimport { IHistorySupport } from '@/plugins/vuex-history';\nimport {\n\tIObjectSetOnTopAction,\n\tISetObjectFlipMutation,\n\tISetObjectPositionMutation,\n\tISetObjectOpacityMutation,\n\tIObjectShiftLayerAction,\n} from '@/store/objects';\nimport { PanelMixin } from './panelMixin';\nimport { Store } from 'vuex';\nimport { IRootState } from '@/store';\n\n@Component({\n\tcomponents: {\n\t\tToggle,\n\t\tPositionAndSize,\n\t\tLayers,\n\t\tOpacity,\n\t\tDelete,\n\t},\n})\nexport default class SpritePanel extends Mixins(PanelMixin) {\n\tpublic $store!: Store<IRootState>;\n\n\tprivate vuexHistory!: IHistorySupport;\n\n\tprivate get sprite(): ISprite {\n\t\tconst obj = this.$store.state.objects.objects[\n\t\t\tthis.$store.state.ui.selection!\n\t\t];\n\t\tif (obj.type !== 'sprite') return undefined!;\n\t\treturn obj as ISprite;\n\t}\n\n\tprivate get flip() {\n\t\treturn this.sprite.flip;\n\t}\n\n\tprivate set flip(newValue: boolean) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.commit('objects/setFlip', {\n\t\t\t\tid: this.sprite.id,\n\t\t\t\tflip: newValue,\n\t\t\t} as ISetObjectFlipMutation);\n\t\t});\n\t}\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sprite.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sprite.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./sprite.vue?vue&type=template&id=5a4d8016&scoped=true&\"\nimport script from \"./sprite.vue?vue&type=script&lang=ts&\"\nexport * from \"./sprite.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./sprite.vue?vue&type=style&index=0&id=5a4d8016&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5a4d8016\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"panel\"},[_c('h1',[_vm._v(\"Textbox\")]),(_vm.colorSelect !== '')?_c('color',{attrs:{\"title\":_vm.colorName},on:{\"leave\":function($event){_vm.colorSelect = ''}},model:{value:(_vm.color),callback:function ($$v) {_vm.color=$$v},expression:\"color\"}}):(_vm.textEditor !== '')?_c('text-editor',{attrs:{\"title\":_vm.textEditorName},on:{\"leave\":function($event){_vm.textEditor = ''}},model:{value:(_vm.textEditorText),callback:function ($$v) {_vm.textEditorText=$$v},expression:\"textEditorText\"}}):[_c('table',{staticClass:\"upper-combos\"},[_c('tr',[_c('td',[_c('label',{attrs:{\"for\":\"text_style\"}},[_vm._v(\"Style:\")])]),_c('td',[_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.textBoxStyle),expression:\"textBoxStyle\"}],attrs:{\"id\":\"text_style\"},on:{\"keydown\":function($event){$event.stopPropagation();},\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.textBoxStyle=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},[_c('option',{attrs:{\"value\":\"normal\"}},[_vm._v(\"Normal\")]),_c('option',{attrs:{\"value\":\"corrupt\"}},[_vm._v(\"Corrupt\")]),_c('option',{attrs:{\"value\":\"custom\"}},[_vm._v(\"Custom\")])])])]),_c('tr',[_c('td',[_c('label',{attrs:{\"for\":\"current_talking\"}},[_vm._v(\"Person talking:\")])]),_c('td',[_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.talkingDefaults),expression:\"talkingDefaults\"}],attrs:{\"id\":\"current_talking\"},on:{\"keydown\":function($event){$event.stopPropagation();},\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.talkingDefaults=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},[_c('option',{attrs:{\"value\":\"No-one\"}},[_vm._v(\"No-one\")]),_c('option',{attrs:{\"value\":\"Sayori\"}},[_vm._v(\"Sayori\")]),_c('option',{attrs:{\"value\":\"Yuri\"}},[_vm._v(\"Yuri\")]),_c('option',{attrs:{\"value\":\"Natsuki\"}},[_vm._v(\"Natsuki\")]),_c('option',{attrs:{\"value\":\"Monika\"}},[_vm._v(\"Monika\")]),_c('option',{attrs:{\"value\":\"FeMC\"}},[_vm._v(\"FeMC\")]),_c('option',{attrs:{\"value\":\"MC\"}},[_vm._v(\"MC\")]),_c('option',{attrs:{\"value\":\"Chad\"}},[_vm._v(\"Chad\")]),_c('option',{attrs:{\"value\":\"Amy\"}},[_vm._v(\"Amy\")]),_c('option',{attrs:{\"value\":\"Other\"}},[_vm._v(\"Other\")])])])]),_c('tr',[_c('td',[_c('label',{attrs:{\"for\":\"custom_name\"}},[_vm._v(\"Other name:\")])]),_c('td',[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.talkingOther),expression:\"talkingOther\"}],attrs:{\"id\":\"custom_name\"},domProps:{\"value\":(_vm.talkingOther)},on:{\"keydown\":function($event){$event.stopPropagation();},\"input\":function($event){if($event.target.composing){ return; }_vm.talkingOther=$event.target.value}}}),_c('button',{on:{\"click\":function($event){_vm.textEditor = 'name'}}},[_vm._v(\"...\")])])])]),_c('toggle',{attrs:{\"label\":\"Controls visible?\"},model:{value:(_vm.showControls),callback:function ($$v) {_vm.showControls=$$v},expression:\"showControls\"}}),_c('toggle',{attrs:{\"label\":\"Able to skip?\"},model:{value:(_vm.allowSkipping),callback:function ($$v) {_vm.allowSkipping=$$v},expression:\"allowSkipping\"}}),_c('toggle',{attrs:{\"label\":\"Continue arrow?\"},model:{value:(_vm.showContinueArrow),callback:function ($$v) {_vm.showContinueArrow=$$v},expression:\"showContinueArrow\"}}),_c('toggle',{attrs:{\"label\":\"Auto quoting?\"},model:{value:(_vm.autoQuoting),callback:function ($$v) {_vm.autoQuoting=$$v},expression:\"autoQuoting\"}}),_c('div',{attrs:{\"id\":\"dialog_text_wrapper\"}},[_c('label',{attrs:{\"for\":\"dialog_text\"}},[_vm._v(\"Dialog:\")]),_c('textarea',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.dialog),expression:\"dialog\"}],attrs:{\"id\":\"dialog_text\"},domProps:{\"value\":(_vm.dialog)},on:{\"keydown\":function($event){$event.stopPropagation();},\"input\":function($event){if($event.target.composing){ return; }_vm.dialog=$event.target.value}}}),_vm._v(\" \"),_c('button',{on:{\"click\":function($event){_vm.textEditor = 'body'}}},[_vm._v(\"Formatting\")])]),_c('position-and-size',{attrs:{\"obj\":_vm.textbox}}),_c('button',{on:{\"click\":_vm.resetPosition}},[_vm._v(\"Reset position\")]),_c('button',{on:{\"click\":_vm.splitTextbox}},[_vm._v(\"Split textbox\")]),_c('layers',{attrs:{\"obj\":_vm.textbox}}),_c('opacity',{attrs:{\"obj\":_vm.textbox}}),_c('toggle',{attrs:{\"label\":\"Flip?\"},model:{value:(_vm.flip),callback:function ($$v) {_vm.flip=$$v},expression:\"flip\"}}),(_vm.textBoxStyle === 'custom')?_c('fieldset',[_c('legend',[_vm._v(\"Customization:\")]),_c('table',[_c('tr',[_c('td',[_c('label',{attrs:{\"for\":\"textbox_color\"}},[_vm._v(\"Color:\")])]),_c('td',[_c('button',{staticClass:\"color-button\",style:({background: _vm.textbox.customColor}),attrs:{\"id\":\"textbox_color\"},on:{\"click\":function($event){_vm.colorSelect = 'base'}}})])]),_c('tr',[_c('td',[_c('label',{attrs:{\"for\":\"custom_namebox_width\"}},[_vm._v(\"Namebox width:\")])]),_c('td',[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.customNameboxWidth),expression:\"customNameboxWidth\",modifiers:{\"number\":true}}],staticStyle:{\"width\":\"48px\"},attrs:{\"id\":\"custom_namebox_width\",\"type\":\"number\"},domProps:{\"value\":(_vm.customNameboxWidth)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.customNameboxWidth=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}})])]),_c('tr',[_c('td',{attrs:{\"colspan\":\"2\"}},[_c('toggle',{attrs:{\"id\":\"derive_custom_colors\",\"label\":\"Derive other colors\"},model:{value:(_vm.deriveCustomColors),callback:function ($$v) {_vm.deriveCustomColors=$$v},expression:\"deriveCustomColors\"}})],1)]),(!_vm.deriveCustomColors)?[_c('tr',[_c('td',[_c('label',{attrs:{\"for\":\"custom_controls_color\"}},[_vm._v(\"Controls Color:\")])]),_c('td',[_c('button',{staticClass:\"color-button\",style:({background: _vm.textbox.customControlsColor}),attrs:{\"id\":\"custom_controls_color\"},on:{\"click\":function($event){_vm.colorSelect = 'controls'}}})])]),_c('tr',[_c('td',[_c('label',{attrs:{\"for\":\"custom_namebox_color\"}},[_vm._v(\"Namebox Color:\")])]),_c('td',[_c('button',{staticClass:\"color-button\",style:({background: _vm.textbox.customNameboxColor}),attrs:{\"id\":\"custom_namebox_color\"},on:{\"click\":function($event){_vm.colorSelect = 'namebox'}}})])]),_c('tr',[_c('td',[_c('label',{attrs:{\"for\":\"custom_namebox_stroke\"}},[_vm._v(\"Namebox text stroke:\")])]),_c('td',[_c('button',{staticClass:\"color-button\",style:({background: _vm.textbox.customNameboxStroke}),attrs:{\"id\":\"custom_namebox_stroke\"},on:{\"click\":function($event){_vm.colorSelect = 'nameboxStroke'}}})])])]:_vm._e()],2)]):_vm._e(),_c('delete',{attrs:{\"obj\":_vm.textbox}})]],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{ color: true, vertical: _vm.vertical }},[_c('h2',[_vm._v(_vm._s(_vm.title))]),_c('button',{on:{\"click\":function($event){return _vm.$emit('leave')}}},[_vm._v(\"OK\")]),_c('table',[_c('tr',[_c('td',[_c('button',{on:{\"click\":function($event){_vm.mode = 'hsla'}}},[_vm._v(\"HSLA\")])]),_c('td',[_c('button',{on:{\"click\":function($event){_vm.mode = 'rgba'}}},[_vm._v(\"RGBA\")])])])]),_c('div',{staticClass:\"column\"},[_c('slider-group',{attrs:{\"mode\":_vm.mode,\"relative\":true},model:{value:(_vm.color),callback:function ($$v) {_vm.color=$$v},expression:\"color\"}}),_c('div',{staticClass:\"hex-selector\"},[_c('label',{staticClass:\"hex-label\",attrs:{\"for\":(\"hex_\" + _vm._uid)}},[_vm._v(\"Hex\")]),_c('input',{attrs:{\"id\":(\"hex_\" + _vm._uid)},domProps:{\"value\":_vm.color},on:{\"input\":_vm.updateHex}})]),_c('button',{on:{\"click\":_vm.addSwatch}},[_vm._v(\"Add as swatch\")])],1),_c('div',{class:{ vertical: _vm.vertical },attrs:{\"id\":\"color-swatches\"}},_vm._l((_vm.swatches),function(swatch){return _c('button',{key:swatch.color,staticClass:\"swatch\",style:({backgroundColor: swatch.color}),attrs:{\"title\":swatch.label},on:{\"click\":function($event){_vm.color = swatch.color; _vm.$emit('leave')}}})}),0)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('slider',{attrs:{\"label\":_vm.label1,\"max-value\":_vm.maxValue1,\"gradient-stops\":_vm.stops1},model:{value:(_vm.v1),callback:function ($$v) {_vm.v1=$$v},expression:\"v1\"}}),_c('slider',{attrs:{\"label\":_vm.label2,\"max-value\":_vm.maxValue2,\"gradient-stops\":_vm.stops2},model:{value:(_vm.v2),callback:function ($$v) {_vm.v2=$$v},expression:\"v2\"}}),_c('slider',{attrs:{\"label\":_vm.label3,\"max-value\":_vm.maxValue3,\"gradient-stops\":_vm.stops3},model:{value:(_vm.v3),callback:function ($$v) {_vm.v3=$$v},expression:\"v3\"}}),_c('slider',{attrs:{\"label\":\"Alpha\",\"max-value\":255,\"gradient-stops\":_vm.stopsAlpha},model:{value:(_vm.a),callback:function ($$v) {_vm.a=$$v},expression:\"a\"}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { IColor } from './color';\nimport { RGBAColor } from './rgb';\n\nexport class HSLAColor implements IColor {\n\tpublic constructor(\n\t\tpublic readonly h: number,\n\t\tpublic readonly s: number,\n\t\tpublic readonly l: number,\n\t\tpublic readonly a: number\n\t) {}\n\n\tpublic toCss(): string {\n\t\tif (this.a >= 1) {\n\t\t\treturn `hsl(${this.h}, ${this.s}, ${this.l})`;\n\t\t}\n\t\treturn `hsla(${this.h}, ${this.s}, ${this.l}, ${this.a})`;\n\t}\n\n\tpublic shift(deltas: HSLAColor): HSLAColor {\n\t\tlet { h, s, l, a } = this;\n\t\th += deltas.h;\n\t\tif (h >= 1) {\n\t\t\th -= 1;\n\t\t} else if (h < 0) {\n\t\t\th += 1;\n\t\t}\n\t\tif (s + deltas.s > 1) {\n\t\t\ts -= deltas.s;\n\t\t} else {\n\t\t\ts += deltas.s;\n\t\t\tif (s < 0) {\n\t\t\t\ts = 0;\n\t\t\t}\n\t\t}\n\t\tif (l + deltas.l > 1 || l + deltas.l < 0) {\n\t\t\tl -= deltas.l;\n\t\t} else {\n\t\t\tl += deltas.l;\n\t\t}\n\t\tif (a + deltas.a > 1 || a + deltas.a < 0) {\n\t\t\ta -= deltas.a;\n\t\t} else {\n\t\t\ta += deltas.a;\n\t\t}\n\t\treturn new HSLAColor(h, s, l, a);\n\t}\n\n\tpublic toRgb(): RGBAColor {\n\t\tconst { h, s, l, a } = this;\n\t\tlet r: number;\n\t\tlet g: number;\n\t\tlet b: number;\n\n\t\tif (s === 0) {\n\t\t\tr = g = b = l; // achromatic\n\t\t} else {\n\t\t\tconst q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n\t\t\tconst p = 2 * l - q;\n\t\t\tr = this.hue2rgb(p, q, h + 1 / 3);\n\t\t\tg = this.hue2rgb(p, q, h);\n\t\t\tb = this.hue2rgb(p, q, h - 1 / 3);\n\t\t}\n\n\t\treturn new RGBAColor(\n\t\t\tMath.round(r * 255),\n\t\t\tMath.round(g * 255),\n\t\t\tMath.round(b * 255),\n\t\t\ta\n\t\t);\n\t}\n\n\tpublic toHSL(): HSLAColor {\n\t\treturn this;\n\t}\n\n\tprivate hue2rgb(p: number, q: number, t: number) {\n\t\tif (t < 0) t += 1;\n\t\tif (t > 1) t -= 1;\n\t\tif (t < 1 / 6) return p + (q - p) * 6 * t;\n\t\tif (t < 1 / 2) return q;\n\t\tif (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\n\t\treturn p;\n\t}\n}\n","import { HSLAColor } from './hsl';\n\nexport class RGBAColor {\n\tpublic static validCss(str: string): boolean {\n\t\treturn this.validCssRgb(str) || this.validHex(str);\n\t}\n\n\tpublic static fromCss(str: string): RGBAColor {\n\t\tif (this.validCssRgb(str)) {\n\t\t\treturn this.fromCssRgb(str);\n\t\t}\n\t\tif (this.validHex(str)) {\n\t\t\treturn this.fromHex(str);\n\t\t}\n\t\tthrow new Error('Invalid RGB color format');\n\t}\n\n\tpublic static validCssRgb(str: string): boolean {\n\t\treturn this.rgbEx.test(str) || this.rgbaEx.test(str);\n\t}\n\n\tpublic static fromCssRgb(str: string): RGBAColor {\n\t\tif (!this.validCssRgb(str)) throw new Error('Invalid RGB color format');\n\t\tconst rgbHead = str.slice(0, -1);\n\t\tconst parentesisPos = rgbHead.indexOf('(');\n\t\tconst rbgTail = rgbHead.slice(parentesisPos + 1);\n\t\tconst elements = rbgTail.split(',').map(x => parseFloat(x.trim()));\n\t\treturn new RGBAColor(\n\t\t\telements[0],\n\t\t\telements[1],\n\t\t\telements[2],\n\t\t\telements.length === 4 ? elements[3] : 1\n\t\t);\n\t}\n\n\tpublic static validHex(str: string): boolean {\n\t\treturn this.hexShortEx.test(str) || this.hexLongEx.test(str);\n\t}\n\n\tpublic static fromHex(str: string): RGBAColor {\n\t\tif (!this.validHex(str)) throw new Error('Invalid Hex color format');\n\t\tconst hexTail = str.slice(1);\n\t\tif (hexTail.length === 3) {\n\t\t\treturn new RGBAColor(\n\t\t\t\tparseInt(hexTail[0] + hexTail[0], 16),\n\t\t\t\tparseInt(hexTail[1] + hexTail[1], 16),\n\t\t\t\tparseInt(hexTail[2] + hexTail[2], 16),\n\t\t\t\t1\n\t\t\t);\n\t\t}\n\t\tif (hexTail.length === 4) {\n\t\t\treturn new RGBAColor(\n\t\t\t\tparseInt(hexTail[0] + hexTail[0], 16),\n\t\t\t\tparseInt(hexTail[1] + hexTail[1], 16),\n\t\t\t\tparseInt(hexTail[2] + hexTail[2], 16),\n\t\t\t\tparseInt(hexTail[3] + hexTail[3], 16) / 255\n\t\t\t);\n\t\t}\n\t\tif (hexTail.length === 6) {\n\t\t\treturn new RGBAColor(\n\t\t\t\tparseInt(hexTail[0] + hexTail[1], 16),\n\t\t\t\tparseInt(hexTail[2] + hexTail[3], 16),\n\t\t\t\tparseInt(hexTail[4] + hexTail[5], 16),\n\t\t\t\t1\n\t\t\t);\n\t\t}\n\t\tif (hexTail.length === 8) {\n\t\t\treturn new RGBAColor(\n\t\t\t\tparseInt(hexTail[0] + hexTail[1], 16),\n\t\t\t\tparseInt(hexTail[2] + hexTail[3], 16),\n\t\t\t\tparseInt(hexTail[4] + hexTail[5], 16),\n\t\t\t\tparseInt(hexTail[6] + hexTail[7], 16) / 255\n\t\t\t);\n\t\t}\n\t\tthrow new Error('Invalid Hex color format length');\n\t}\n\n\tprivate static rgbEx = /^rgb\\((\\d*?)\\,(\\d*?)\\,(\\d*?)\\)$/i;\n\tprivate static rgbaEx = /^rgba\\((\\d{1,3})\\,(\\d{1,3})\\,(\\d{1,3})\\,([\\d\\.]+)\\)$/i;\n\tprivate static hexShortEx = /^\\#[0-9A-Z]{3,4}$/i;\n\tprivate static hexLongEx = /^\\#[0-9A-Z]{6,8}$/i;\n\n\tpublic constructor(\n\t\tpublic readonly r: number,\n\t\tpublic readonly g: number,\n\t\tpublic readonly b: number,\n\t\tpublic readonly a: number\n\t) {}\n\n\tpublic toCss(): string {\n\t\tif (this.a > 1) {\n\t\t\treturn `rgb(${this.r},${this.g},${this.b})`;\n\t\t}\n\t\treturn `rgba(${this.r},${this.g},${this.b},${this.a})`;\n\t}\n\n\tpublic toHex(): string {\n\t\treturn `#${Math.round(this.r)\n\t\t\t.toString(16)\n\t\t\t.padStart(2, '0')}${Math.round(this.g)\n\t\t\t.toString(16)\n\t\t\t.padStart(2, '0')}${Math.round(this.b)\n\t\t\t.toString(16)\n\t\t\t.padStart(2, '0')}${Math.round(this.a * 255)\n\t\t\t.toString(16)\n\t\t\t.padStart(2, '0')}`;\n\t}\n\n\tpublic toRgb(): RGBAColor {\n\t\treturn this;\n\t}\n\n\tpublic toHSL(): HSLAColor {\n\t\tlet { r, g, b } = this;\n\t\tconst { a } = this;\n\t\t(r /= 255), (g /= 255), (b /= 255);\n\t\tconst max = Math.max(r, g, b);\n\t\tconst min = Math.min(r, g, b);\n\t\tlet h: number;\n\t\tlet s: number;\n\t\tconst l: number = (max + min) / 2;\n\n\t\tif (max === min) {\n\t\t\th = s = 0; // achromatic\n\t\t} else {\n\t\t\tconst d = max - min;\n\t\t\ts = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n\t\t\tswitch (max) {\n\t\t\t\tcase r:\n\t\t\t\t\th = (g - b) / d + (g < b ? 6 : 0);\n\t\t\t\t\tbreak;\n\t\t\t\tcase g:\n\t\t\t\t\th = (b - r) / d + 2;\n\t\t\t\t\tbreak;\n\t\t\t\tcase b:\n\t\t\t\t\th = (r - g) / d + 4;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\th! /= 6;\n\t\t}\n\n\t\treturn new HSLAColor(h!, s, l, a);\n\t}\n}\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{ slider: true, vertical: _vm.vertical },on:{\"keydown\":function($event){$event.stopPropagation();}}},[_c('label',{attrs:{\"for\":_vm._uid}},[_vm._v(_vm._s(_vm.label))]),_c('div',[_c('svg',{ref:\"svg\",attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 271 24\"},on:{\"mousedown\":_vm.enterSlide,\"touchstart\":_vm.enterSlide,\"mousemove\":_vm.moveSlide,\"touchmove\":_vm.moveSlide,\"mouseup\":_vm.exitSlide,\"touchend\":_vm.exitSlide}},[_c('defs',[_c('linearGradient',{attrs:{\"id\":(\"gradient\" + _vm._uid),\"x1\":\"0%\",\"y1\":\"0%\",\"x2\":\"100%\",\"y2\":\"0%\"}},_vm._l((_vm.gradientStops),function(color,idx){return _c('stop',{key:idx,style:('stop-color:' + color),attrs:{\"offset\":idx / (_vm.gradientStops.length - 1) * 100 + '%'}})}),1)],1),_c('g',{attrs:{\"stroke\":\"#ffbde1\"}},[_c('path',{attrs:{\"d\":\"M7 0H262V24H7z\",\"stroke-width\":\"2\",\"paint-order\":\"fill stroke markers\",\"fill\":(\"url(#gradient\" + _vm._uid + \")\")}}),_c('path',{attrs:{\"d\":_vm.pointerPath,\"stroke-width\":\"2\",\"fill\":\"#000000\"}})])])]),_c('input',{staticClass:\"sliderInput\",attrs:{\"id\":_vm._uid,\"min\":\"0\",\"max\":_vm.maxValue,\"type\":\"number\"},domProps:{\"value\":_vm.value},on:{\"input\":function($event){_vm.$emit('input', parseFloat($event.target.value))}}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop, Watch } from 'vue-property-decorator';\r\nimport { State } from 'vuex-class-decorator';\r\nimport { RGBAColor } from '../../../../util/colors/rgb';\r\nimport { IColor } from '../../../../util/colors/color';\r\nimport { HSLAColor } from '../../../../util/colors/hsl';\r\n\r\n@Component({\r\n\tcomponents: {},\r\n})\r\nexport default class Slider extends Vue {\r\n\t@Prop({ type: String }) private label!: string | undefined;\r\n\t@Prop({}) private gradientStops!: string[];\r\n\t@Prop({ type: Number }) private value!: number;\r\n\t@Prop({ type: Number }) private maxValue!: number;\r\n\t@State('vertical', { namespace: 'ui' }) private readonly vertical!: boolean;\r\n\r\n\tprivate slideActive = false;\r\n\r\n\tprivate get pointerPath(): string {\r\n\t\tconst val = (this.value / this.maxValue) * 255;\r\n\t\treturn `M${val} 0L${val + 14} 0L${val + 7} 12Z`;\r\n\t}\r\n\r\n\tprivate enterSlide(event: MouseEvent | TouchEvent) {\r\n\t\tthis.slideActive = true;\r\n\t\tthis.moveSlide(event);\r\n\t}\r\n\r\n\tprivate moveSlide(event: MouseEvent | TouchEvent) {\r\n\t\tif (!this.slideActive) return;\r\n\t\tconst svg = this.$refs.svg as HTMLElement;\r\n\t\tif (!svg.contains(event.target as Node) && event.target !== svg) return;\r\n\t\tif (event instanceof MouseEvent && event.which !== 1) {\r\n\t\t\tthis.slideActive = false;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst bounding = svg.getBoundingClientRect();\r\n\t\tconst scale = bounding.width / 271;\r\n\t\tconst x =\r\n\t\t\t(event instanceof MouseEvent ? event.clientX : event.touches[0].clientX) -\r\n\t\t\tbounding.x;\r\n\t\tconst scaledX = x / scale;\r\n\t\tevent.preventDefault();\r\n\t\tconst value =\r\n\t\t\t(Math.max(Math.min(scaledX - 8, 255), 0) / 255) * this.maxValue;\r\n\t\tthis.$emit('input', value);\r\n\t}\r\n\r\n\tprivate exitSlide() {\r\n\t\tthis.slideActive = false;\r\n\t}\r\n}\r\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./slider.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./slider.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./slider.vue?vue&type=template&id=e42d3bc8&scoped=true&\"\nimport script from \"./slider.vue?vue&type=script&lang=ts&\"\nexport * from \"./slider.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./slider.vue?vue&type=style&index=0&id=e42d3bc8&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e42d3bc8\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop, Watch } from 'vue-property-decorator';\r\nimport { State } from 'vuex-class-decorator';\r\nimport { IColor } from '@/util/colors/color';\r\nimport { RGBAColor } from '@/util/colors/rgb';\r\nimport { HSLAColor } from '@/util/colors/hsl';\r\nimport Slider from './slider.vue';\r\n\r\n@Component({\r\n\tcomponents: { Slider },\r\n})\r\nexport default class SliderGroup extends Vue {\r\n\t@Prop({ type: String, validator: val => val.match(/^#[0-9a-f]{6,8}$/i) })\r\n\tprivate value!: string;\r\n\t@Prop({}) private mode!: 'hsla' | 'rgba';\r\n\t@Prop({ type: Boolean }) private relative!: boolean;\r\n\r\n\t@State('vertical', { namespace: 'ui' }) private readonly vertical!: boolean;\r\n\r\n\tprivate lastRGBEmit: string | null = null;\r\n\tprivate v1: number = 0;\r\n\tprivate v2: number = 0;\r\n\tprivate v3: number = 0;\r\n\tprivate a: number = 0;\r\n\r\n\tprivate created() {\r\n\t\tthis.initValues();\r\n\t}\r\n\r\n\t@Watch('value')\r\n\tprivate valueChanged() {\r\n\t\tif (this.value === this.lastRGBEmit) return;\r\n\t\tthis.initValues();\r\n\t}\r\n\r\n\t@Watch('v1')\r\n\t@Watch('v2')\r\n\t@Watch('v3')\r\n\t@Watch('a')\r\n\tprivate updateValue() {\r\n\t\tlet newColor: IColor;\r\n\t\tif (this.mode === 'rgba') {\r\n\t\t\tnewColor = new RGBAColor(this.v1, this.v2, this.v3, this.a / 255);\r\n\t\t} else {\r\n\t\t\tnewColor = new HSLAColor(\r\n\t\t\t\tthis.v1 / 360,\r\n\t\t\t\tthis.v2 / 100,\r\n\t\t\t\tthis.v3 / 100,\r\n\t\t\t\tthis.a / 255\r\n\t\t\t);\r\n\t\t}\r\n\t\tconst rgbColor = newColor.toRgb().toHex();\r\n\t\tif (this.lastRGBEmit === rgbColor) return;\r\n\t\tif (rgbColor.length !== 9) {\r\n\t\t\tthrow new Error(`Invalid color code: ${rgbColor}`);\r\n\t\t}\r\n\t\tthis.lastRGBEmit = rgbColor;\r\n\t\tconsole.log('setting rgb', rgbColor);\r\n\t\tthis.$emit('input', rgbColor);\r\n\t}\r\n\r\n\t@Watch('mode')\r\n\tprivate initValues() {\r\n\t\tconst color = RGBAColor.fromHex(this.value);\r\n\t\tthis.lastRGBEmit = color.toHex();\r\n\t\tthis.a = color.a * 255;\r\n\t\tif (this.mode === 'hsla') {\r\n\t\t\tconst hslColor = color.toHSL();\r\n\t\t\tthis.v1 = hslColor.h * 360;\r\n\t\t\tthis.v2 = hslColor.s * 100;\r\n\t\t\tthis.v3 = hslColor.l * 100;\r\n\t\t} else {\r\n\t\t\tthis.v1 = color.r;\r\n\t\t\tthis.v2 = color.g;\r\n\t\t\tthis.v3 = color.b;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate get maxValue1(): number {\r\n\t\tif (this.mode === 'rgba') return 255;\r\n\t\treturn 360;\r\n\t}\r\n\r\n\tprivate get label1(): string {\r\n\t\tif (this.mode === 'rgba') return 'Red';\r\n\t\treturn 'Hue';\r\n\t}\r\n\r\n\tprivate get stops1(): string[] {\r\n\t\tconst color = RGBAColor.fromHex(this.value);\r\n\t\tlet stops: IColor[] = [];\r\n\t\tif (this.mode === 'rgba') {\r\n\t\t\tconst g = this.relative ? this.v2 : 0;\r\n\t\t\tconst b = this.relative ? this.v3 : 0;\r\n\t\t\tstops = [new RGBAColor(0, g, b, 1), new RGBAColor(255, g, b, 1)];\r\n\t\t} else {\r\n\t\t\tconst s = this.relative ? this.v2 / 100 : 1;\r\n\t\t\tconst l = this.relative ? this.v3 / 100 : 0.5;\r\n\t\t\tstops = this.eightsStops(i => new HSLAColor(i, s, l, 1));\r\n\t\t}\r\n\t\treturn stops.map(stop => stop.toRgb().toCss());\r\n\t}\r\n\r\n\tprivate get maxValue2(): number {\r\n\t\tif (this.mode === 'rgba') return 255;\r\n\t\treturn 100;\r\n\t}\r\n\r\n\tprivate get label2(): string {\r\n\t\tif (this.mode === 'rgba') return 'Green';\r\n\t\treturn 'Saturation';\r\n\t}\r\n\r\n\tprivate get stops2(): string[] {\r\n\t\tconst color = RGBAColor.fromHex(this.value);\r\n\t\tlet stops: IColor[] = [];\r\n\t\tif (this.mode === 'rgba') {\r\n\t\t\tconst r = this.relative ? this.v1 : 0;\r\n\t\t\tconst b = this.relative ? this.v3 : 0;\r\n\t\t\tstops = [new RGBAColor(r, 0, b, 1), new RGBAColor(r, 255, b, 1)];\r\n\t\t} else {\r\n\t\t\tconst h = this.relative ? this.v1 / 360 : 0;\r\n\t\t\tconst l = this.relative ? this.v3 / 100 : 0.5;\r\n\t\t\tstops = this.eightsStops(i => new HSLAColor(h, i, l, 1));\r\n\t\t}\r\n\t\treturn stops.map(stop => stop.toRgb().toCss());\r\n\t}\r\n\r\n\tprivate get maxValue3(): number {\r\n\t\tif (this.mode === 'rgba') return 255;\r\n\t\treturn 100;\r\n\t}\r\n\r\n\tprivate get label3(): string {\r\n\t\tif (this.mode === 'rgba') return 'Blue';\r\n\t\treturn 'Luminosity';\r\n\t}\r\n\r\n\tprivate get stops3(): string[] {\r\n\t\tconst color = RGBAColor.fromHex(this.value);\r\n\t\tlet stops: IColor[] = [];\r\n\t\tif (this.mode === 'rgba') {\r\n\t\t\tconst r = this.relative ? this.v1 : 0;\r\n\t\t\tconst g = this.relative ? this.v2 : 0;\r\n\t\t\tstops = [new RGBAColor(r, g, 0, 1), new RGBAColor(r, g, 255, 1)];\r\n\t\t} else {\r\n\t\t\tconst h = this.relative ? this.v1 / 360 : 0;\r\n\t\t\tconst s = this.relative ? this.v2 / 100 : 0.5;\r\n\t\t\tstops = this.eightsStops(i => new HSLAColor(h, s, i, 1));\r\n\t\t}\r\n\t\treturn stops.map(stop => stop.toRgb().toCss());\r\n\t}\r\n\r\n\tprivate get stopsAlpha(): string[] {\r\n\t\tconst color = RGBAColor.fromHex(this.value);\r\n\t\treturn [\r\n\t\t\tnew RGBAColor(color.r, color.g, color.b, 0).toCss(),\r\n\t\t\tnew RGBAColor(color.r, color.g, color.b, 1).toCss(),\r\n\t\t];\r\n\t}\r\n\r\n\tprivate eightsStops(gen: (i: number) => IColor): IColor[] {\r\n\t\tconst stops: IColor[] = [];\r\n\t\tfor (let i = 0; i <= 8; ++i) {\r\n\t\t\tstops.push(gen(i / 8));\r\n\t\t}\r\n\t\treturn stops;\r\n\t}\r\n}\r\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sliderGroup.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sliderGroup.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./sliderGroup.vue?vue&type=template&id=b4264986&scoped=true&\"\nimport script from \"./sliderGroup.vue?vue&type=script&lang=ts&\"\nexport * from \"./sliderGroup.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./sliderGroup.vue?vue&type=style&index=0&id=b4264986&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"b4264986\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop, Watch } from 'vue-property-decorator';\r\nimport {\r\n\tisWebPSupported,\r\n\tregisterAsset,\r\n\tregisterAssetWithURL,\r\n} from '@/asset-manager';\r\nimport environment from '@/environments/environment';\r\nimport { Part } from '@/models/constants';\r\nimport {\r\n\tStyleComponent,\r\n\tPose,\r\n\tCharacter,\r\n\tColor,\r\n\tContentPack,\r\n} from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\r\nimport { IAsset, ReplaceContentPackAction } from '@/store/content';\r\nimport {\r\n\tgetPose,\r\n\tgetDataG,\r\n\tISeekPoseAction,\r\n\tISetPosePositionMutation,\r\n\tISetPartAction,\r\n\tgetData,\r\n\tICharacter,\r\n} from '@/store/objectTypes/characters';\r\nimport { IHistorySupport } from '@/plugins/vuex-history';\r\nimport { State } from 'vuex-class-decorator';\r\nimport SliderGroup from './sliderGroup.vue';\r\nimport { Store } from 'vuex';\r\nimport { IRootState } from '@/store';\r\nimport { RGBAColor } from '@/util/colors/rgb';\r\n\r\nconst generatedPackId = 'dddg.generated.colors';\r\n\r\n@Component({\r\n\tcomponents: {\r\n\t\tSliderGroup,\r\n\t},\r\n})\r\nexport default class PartsPanel extends Vue {\r\n\tpublic $store!: Store<IRootState>;\r\n\r\n\t@State('vertical', { namespace: 'ui' }) private readonly vertical!: boolean;\r\n\r\n\t@Prop({ required: true, type: String }) private readonly value!: string;\r\n\t@Prop({ type: String, default: '' }) private readonly title!: string;\r\n\r\n\tprivate vuexHistory!: IHistorySupport;\r\n\r\n\tprivate mode: string = 'hsla';\r\n\tprivate relative: boolean = true;\r\n\r\n\tprivate get swatches(): Color[] {\r\n\t\treturn this.$store.state.content.current.colors;\r\n\t}\r\n\r\n\tprivate get color(): string {\r\n\t\treturn this.value;\r\n\t}\r\n\r\n\tprivate set color(newColor: string) {\r\n\t\tthis.$emit('input', newColor);\r\n\t}\r\n\r\n\tprivate updateHex(event: Event) {\r\n\t\tconst hex = (event.target as HTMLInputElement).value;\r\n\t\tif (RGBAColor.validHex(hex) && (hex.length === 7 || hex.length === 9)) {\r\n\t\t\tconsole.log('setting updateHex', hex);\r\n\t\t\tthis.$emit('input', hex);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate addSwatch() {\r\n\t\tif (this.swatches.find(swatch => swatch.color === this.color)) return;\r\n\r\n\t\tconst existingPack = this.$store.state.content.contentPacks.find(\r\n\t\t\tpack => pack.packId === 'generatedPackId'\r\n\t\t) || {\r\n\t\t\tpackId: generatedPackId,\r\n\t\t\tpackCredits: '',\r\n\t\t\tcharacters: [],\r\n\t\t\tfonts: [],\r\n\t\t\tbackgrounds: [],\r\n\t\t\tsprites: [],\r\n\t\t\tpoemStyles: [],\r\n\t\t\tcolors: [],\r\n\t\t};\r\n\r\n\t\tconst newPack: ContentPack<IAsset> = {\r\n\t\t\t...existingPack,\r\n\t\t\tcolors: [\r\n\t\t\t\t...existingPack.colors,\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: this.color,\r\n\t\t\t\t\tcolor: this.color,\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t};\r\n\r\n\t\tthis.vuexHistory.transaction(() => {\r\n\t\t\tthis.$store.dispatch('content/replaceContentPack', {\r\n\t\t\t\tcontentPack: newPack,\r\n\t\t\t\tprocessed: true,\r\n\t\t\t} as ReplaceContentPackAction);\r\n\t\t});\r\n\t}\r\n}\r\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./color.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./color.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./color.vue?vue&type=template&id=6d18bc19&scoped=true&\"\nimport script from \"./color.vue?vue&type=script&lang=ts&\"\nexport * from \"./color.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./color.vue?vue&type=style&index=0&id=6d18bc19&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6d18bc19\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.colorSelector)?_c('color',{on:{\"leave\":_vm.applyColor},model:{value:(_vm.selectedColor),callback:function ($$v) {_vm.selectedColor=$$v},expression:\"selectedColor\"}}):_c('div',{class:{ 'text-subpanel': true, vertical: _vm.vertical }},[_c('h2',[_vm._v(_vm._s(_vm.title))]),_c('div',{staticClass:\"column ok-col\"},[_c('button',{on:{\"click\":function($event){return _vm.$emit('leave')}}},[_vm._v(\"OK\")])]),_c('div',{staticClass:\"column\"},[_c('textarea',{ref:\"textArea\",domProps:{\"value\":_vm.value},on:{\"input\":_vm.onValueChanged,\"keydown\":function($event){$event.stopPropagation();},\"keypress\":function($event){$event.stopPropagation();}}})]),(_vm.error)?_c('div',{staticClass:\"column error-col\"},[_vm._v(_vm._s(_vm.error))]):_vm._e(),_c('div',{staticClass:\"column\"},[_c('button',{staticClass:\"style-button\",on:{\"click\":function($event){return _vm.insertText('\\\\\\\\')}}},[_vm._v(\"Insert \\\\\")]),_c('button',{staticClass:\"style-button\",on:{\"click\":function($event){return _vm.insertText('\\\\{')}}},[_vm._v(\"Insert {\")]),_c('button',{staticClass:\"style-button\",on:{\"click\":function($event){return _vm.insertText('\\\\}')}}},[_vm._v(\"Insert }\")])]),_c('p',{staticClass:\"hint-col\"},[_vm._v(\"Apply style to selected text:\")]),_c('div',{staticClass:\"column\"},[_c('button',{staticClass:\"style-button\",staticStyle:{\"font-weight\":\"bold\"},on:{\"click\":function($event){return _vm.insertCommand('b')}}},[_vm._v(\"Bold\")]),_c('button',{staticClass:\"style-button\",staticStyle:{\"font-style\":\"italic\"},on:{\"click\":function($event){return _vm.insertCommand('i')}}},[_vm._v(\"Italics\")]),_c('button',{staticClass:\"style-button\",on:{\"click\":function($event){return _vm.insertCommand('plain')}}},[_vm._v(\"Plain\")]),_c('button',{staticClass:\"style-button edited-style\",on:{\"click\":function($event){return _vm.insertCommand('edited')}}},[_vm._v(\"Edited\")]),_c('button',{staticClass:\"style-button\",staticStyle:{\"letter-spacing\":\"5px\"},on:{\"click\":function($event){return _vm.insertCommand('k', 2)}}},[_vm._v(\"Kerning\")])]),_c('div',{staticClass:\"column\"},[_c('button',{staticClass:\"style-button\",on:{\"click\":function($event){return _vm.insertCommand('alpha', 0.5)}}},[_vm._v(\"Alpha\")])]),_c('div',{staticClass:\"column\"},[_c('button',{staticClass:\"style-button\",staticStyle:{\"font-size\":\"20px\"},on:{\"click\":function($event){return _vm.insertCommand('size', 12)}}},[_vm._v(\"Font size\")]),_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.selectedFont),expression:\"selectedFont\"}],staticClass:\"style-button\",on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.selectedFont=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},[_c('option',{attrs:{\"value\":\"\"}},[_vm._v(\"Font\")]),_c('option',{staticStyle:{\"font-family\":\"aller\"},attrs:{\"value\":\"aller\"}},[_vm._v(\"Aller (Textbox)\")]),_c('option',{staticStyle:{\"font-family\":\"riffic\"},attrs:{\"value\":\"riffic\"}},[_vm._v(\"Riffic (Bold text)\")])]),_c('button',{staticClass:\"style-button\",on:{\"click\":function($event){return _vm.selectColor('text')}}},[_vm._v(\"Text color\")]),_c('button',{staticClass:\"style-button\",on:{\"click\":function($event){return _vm.selectColor('outline')}}},[_vm._v(\"Outline color\")])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export class StringWalker {\r\n\tprivate i: number = 0;\r\n\tpublic constructor(private readonly str: string) {}\r\n\r\n\tpublic get pos(): number {\r\n\t\treturn this.i;\r\n\t}\r\n\r\n\tpublic current(): string {\r\n\t\treturn this.str[this.i];\r\n\t}\r\n\r\n\tpublic get around(): string {\r\n\t\treturn this.str.slice(Math.max(0, this.i - 5), this.i + 5);\r\n\t}\r\n\r\n\tpublic get ahead(): string {\r\n\t\treturn this.str[this.i + 1];\r\n\t}\r\n\r\n\tpublic get behind(): string {\r\n\t\treturn this.str[this.i + 1];\r\n\t}\r\n\r\n\tpublic next(): string {\r\n\t\t++this.i;\r\n\t\treturn this.current();\r\n\t}\r\n}\r\n","import { StringWalker } from './string-walker';\r\n\r\ninterface ITextToken {\r\n\tcontent: string;\r\n\tpos: number;\r\n\ttype: 'text';\r\n}\r\nexport interface ICommandToken {\r\n\tcommandName: string;\r\n\targument: string;\r\n\tpos: number;\r\n\ttype: 'command';\r\n}\r\ninterface ICommandCloseToken {\r\n\tcommandName: string;\r\n\tpos: number;\r\n\ttype: 'commandClose';\r\n}\r\ninterface INewlineToken {\r\n\ttype: 'newline';\r\n\tpos: number;\r\n}\r\n\r\nexport type Token =\r\n\t| ITextToken\r\n\t| ICommandToken\r\n\t| ICommandCloseToken\r\n\t| INewlineToken;\r\n\r\nexport function tokenize(str: string): Token[] {\r\n\tconst tokens: Token[] = [];\r\n\tconst stringWalker = new StringWalker(str);\r\n\tlet currentTokenState: TokenizerState = tokenStateNormal;\r\n\twhile (currentTokenState !== tokenStateEnd) {\r\n\t\tcurrentTokenState = currentTokenState(tokens, stringWalker);\r\n\t}\r\n\treturn tokens;\r\n}\r\n\r\ntype TokenizerState = (\r\n\tcontents: Token[],\r\n\twalker: StringWalker\r\n) => TokenizerState;\r\n\r\nfunction tokenStateNormal(\r\n\tcontents: Token[],\r\n\twalker: StringWalker\r\n): TokenizerState {\r\n\tif (walker.current() === undefined) return tokenStateEnd;\r\n\tif (walker.current() === '{') return tokenStateCommand;\r\n\tif (walker.current() === '\\n') return tokenStateNewLine;\r\n\treturn tokenText;\r\n}\r\n\r\nfunction tokenStateEnd(): TokenizerState {\r\n\treturn tokenStateEnd;\r\n}\r\n\r\nfunction tokenText(contents: Token[], walker: StringWalker): TokenizerState {\r\n\tconst { pos } = walker;\r\n\tlet textContent = '';\r\n\tlet escape = false;\r\n\tlet nextState: TokenizerState;\r\n\twhile (true) {\r\n\t\tif (walker.current() === undefined) {\r\n\t\t\tnextState = tokenStateEnd;\r\n\t\t\tbreak;\r\n\t\t} else if (escape) {\r\n\t\t\ttextContent += walker.current();\r\n\t\t\tescape = false;\r\n\t\t} else if (walker.current() === '\\\\') {\r\n\t\t\tescape = true;\r\n\t\t} else if (walker.current() === '{' || walker.current() === '\\n') {\r\n\t\t\tnextState = tokenStateNormal;\r\n\t\t\tbreak;\r\n\t\t} else {\r\n\t\t\ttextContent += walker.current();\r\n\t\t}\r\n\t\twalker.next();\r\n\t}\r\n\tcontents.push({\r\n\t\ttype: 'text',\r\n\t\tpos,\r\n\t\tcontent: textContent,\r\n\t});\r\n\treturn nextState;\r\n}\r\n\r\nfunction error(walker: StringWalker, msg: string): never {\r\n\tthrow new Error(\r\n\t\t`Error at position ${walker.pos}: (around: ${walker.around}) ${msg}`\r\n\t);\r\n}\r\n\r\nfunction tokenStateCommand(\r\n\tcontents: Token[],\r\n\twalker: StringWalker\r\n): TokenizerState {\r\n\tconst { pos } = walker;\r\n\tif (walker.current() !== '{') {\r\n\t\tthrow new Error('Parser error: Command does not start with {');\r\n\t}\r\n\tconst closing = walker.next() === '/';\r\n\tif (closing) {\r\n\t\twalker.next();\r\n\t}\r\n\tlet commandName = '';\r\n\tlet argument = '';\r\n\tlet argumentsState = false;\r\n\r\n\twhile (true) {\r\n\t\tif (walker.current() === undefined) {\r\n\t\t\terror(walker, 'Unexpected end of text inside a command');\r\n\t\t}\r\n\t\tif (walker.current() === '}') {\r\n\t\t\tbreak;\r\n\t\t} else if (!argumentsState) {\r\n\t\t\tif (walker.current().match(/[a-z]/i)) {\r\n\t\t\t\tcommandName += walker.current();\r\n\t\t\t} else if (walker.current() === '=') {\r\n\t\t\t\tif (closing) {\r\n\t\t\t\t\terror(walker, 'Closing commands may not contain arguments');\r\n\t\t\t\t}\r\n\t\t\t\targumentsState = true;\r\n\t\t\t} else {\r\n\t\t\t\terror(walker, 'Unexpected character in command name.');\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\targument += walker.current();\r\n\t\t}\r\n\t\twalker.next();\r\n\t}\r\n\twalker.next();\r\n\tif (closing) {\r\n\t\tcontents.push({\r\n\t\t\ttype: 'commandClose',\r\n\t\t\tcommandName,\r\n\t\t\tpos,\r\n\t\t});\r\n\t} else {\r\n\t\tcontents.push({\r\n\t\t\ttype: 'command',\r\n\t\t\tpos,\r\n\t\t\targument,\r\n\t\t\tcommandName,\r\n\t\t});\r\n\t}\r\n\treturn tokenStateNormal;\r\n}\r\n\r\nfunction tokenStateNewLine(\r\n\tcontents: Token[],\r\n\twalker: StringWalker\r\n): TokenizerState {\r\n\tcontents.push({ type: 'newline', pos: walker.pos });\r\n\twalker.next();\r\n\treturn tokenStateNormal;\r\n}\r\n","import { ITextStyle } from './textRenderer';\r\n\r\ntype Command = (style: ITextStyle, parameter?: string) => ITextStyle;\r\n\r\nexport default new Map<string, Command>([\r\n\tparamlessOp('i', style => ({ ...style, isItalic: true })),\r\n\tparamlessOp('b', style => ({ ...style, isBold: true })),\r\n\tparamlessOp('u', style => ({ ...style, isUnderlined: true })),\r\n\tparamlessOp('s', style => ({\r\n\t\t...style,\r\n\t\tisStrikethrough: true,\r\n\t})),\r\n\tparamlessOp('plain', style => ({\r\n\t\t...style,\r\n\t\tisStrikethrough: false,\r\n\t\tisUnderlined: false,\r\n\t\tisBold: false,\r\n\t\tisItalic: false,\r\n\t})),\r\n\tparamlessOp('edited', style => ({\r\n\t\t...style,\r\n\t\tfontName: 'verily',\r\n\t\tstrokeColor: '#000000',\r\n\t\tstrokeWidth: 20,\r\n\t\tletterSpacing: 8,\r\n\t})),\r\n\trelativeNumberOp('k', (style, relative, parameter) => ({\r\n\t\t...style,\r\n\t\tletterSpacing: relative ? style.letterSpacing + parameter : parameter,\r\n\t})),\r\n\trelativeNumberOp('size', (style, relative, parameter) => ({\r\n\t\t...style,\r\n\t\tfontSize: relative ? style.fontSize + parameter : parameter,\r\n\t})),\r\n\trelativeNumberOp('alpha', (style, relative, parameter) => ({\r\n\t\t...style,\r\n\t\talpha: relative ? style.alpha + parameter : parameter,\r\n\t})),\r\n\t[\r\n\t\t'font',\r\n\t\t(style, parameter?) => {\r\n\t\t\treturn { ...style, fontName: parameter! };\r\n\t\t},\r\n\t],\r\n\t[\r\n\t\t'color',\r\n\t\t(style, parameter?) => {\r\n\t\t\treturn { ...style, color: parameter! };\r\n\t\t},\r\n\t],\r\n\t[\r\n\t\t'outlinecolor',\r\n\t\t(style, parameter?) => {\r\n\t\t\treturn { ...style, strokeColor: parameter! };\r\n\t\t},\r\n\t],\r\n]);\r\n\r\nfunction paramlessOp(\r\n\tname: string,\r\n\top: (style: ITextStyle) => ITextStyle\r\n): [string, Command] {\r\n\treturn [\r\n\t\tname,\r\n\t\t(style: ITextStyle, parameter?: string) => {\r\n\t\t\tif (parameter) {\r\n\t\t\t\tthrow new Error(`Operator '${name}' does not take any arguments.`);\r\n\t\t\t}\r\n\t\t\treturn op(style);\r\n\t\t},\r\n\t];\r\n}\r\n\r\nfunction numberOp(\r\n\tname: string,\r\n\top: (style: ITextStyle, param: number) => ITextStyle\r\n): [string, Command] {\r\n\treturn [\r\n\t\tname,\r\n\t\t(style: ITextStyle, parameter?: string) => {\r\n\t\t\tif (!parameter) throw new Error(`Operator '${name}' needs an argument.`);\r\n\t\t\tconst num = Number(parameter);\r\n\t\t\tif (isNaN(num)) {\r\n\t\t\t\tthrow new Error(`Operator '${name}' needs a numeric argument.`);\r\n\t\t\t}\r\n\t\t\treturn op(style, num);\r\n\t\t},\r\n\t];\r\n}\r\n\r\nfunction relativeNumberOp(\r\n\tname: string,\r\n\top: (style: ITextStyle, relative: boolean, param: number) => ITextStyle\r\n): [string, Command] {\r\n\treturn [\r\n\t\tname,\r\n\t\t(style: ITextStyle, parameter?: string) => {\r\n\t\t\tif (!parameter) throw new Error(`Operator '${name}' needs an argument.`);\r\n\t\t\tconst relative = parameter[0] === '+' || parameter[0] === '-';\r\n\t\t\tconst num = Number(parameter);\r\n\t\t\tif (isNaN(num)) {\r\n\t\t\t\tthrow new Error(`Operator '${name}' needs a numeric argument.`);\r\n\t\t\t}\r\n\t\t\treturn op(style, relative, num);\r\n\t\t},\r\n\t];\r\n}\r\n","import { tokenize, Token, ICommandToken } from './tokenizer';\r\n\r\nimport textCommands from './textCommands';\r\n\r\nexport interface ITextStyle {\r\n\tfontName: string;\r\n\tfontSize: number;\r\n\tisBold: boolean;\r\n\tisUnderlined: boolean;\r\n\tisStrikethrough: boolean;\r\n\tisItalic: boolean;\r\n\tcolor: string;\r\n\tstrokeWidth: number;\r\n\tstrokeColor: string;\r\n\tletterSpacing: number;\r\n\tlineSpacing: number;\r\n\talpha: number;\r\n}\r\n\r\ninterface ITextRenderItem {\r\n\tx: number;\r\n\ty: number;\r\n\theight: number;\r\n\twidth: number;\r\n}\r\n\r\ninterface IDrawCharacterItem extends ITextRenderItem {\r\n\ttype: 'character';\r\n\tcharacter: string;\r\n\tstyle: ITextStyle;\r\n}\r\n\r\ninterface INewlineItem extends ITextRenderItem {\r\n\ttype: 'newline';\r\n}\r\n\r\ntype RenderItem = IDrawCharacterItem | INewlineItem;\r\n\r\n// const widthCache = new Map<ITextStyle, Map<string, number>>();\r\n// const heightCache = new Map<ITextStyle, number>();\r\n\r\nexport class TextRenderer {\r\n\tpublic static textCommands = textCommands;\r\n\tprivate readonly renderParts: RenderItem[];\r\n\r\n\tpublic constructor(str: string, baseStyle: ITextStyle) {\r\n\t\tconst tokens = tokenize(str);\r\n\t\tthis.renderParts = this.getRenderParts(tokens, baseStyle);\r\n\t}\r\n\r\n\tpublic render(ctx: CanvasRenderingContext2D) {\r\n\t\tctx.save();\r\n\t\tlet currentStyle: ITextStyle | null = null;\r\n\t\tfor (const part of this.renderParts) {\r\n\t\t\tif (part.type === 'newline') continue;\r\n\t\t\tif (part.style !== currentStyle) {\r\n\t\t\t\tcurrentStyle = part.style;\r\n\t\t\t\tapplyTextStyleToCanvas(currentStyle, ctx);\r\n\t\t\t}\r\n\t\t\tif (currentStyle.strokeWidth > 0 && currentStyle.strokeColor > '') {\r\n\t\t\t\tctx.strokeText(part.character, part.x, part.y);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (const part of this.renderParts) {\r\n\t\t\tif (part.type === 'newline') continue;\r\n\t\t\tif (part.style !== currentStyle) {\r\n\t\t\t\tcurrentStyle = part.style;\r\n\t\t\t\tapplyTextStyleToCanvas(currentStyle, ctx);\r\n\t\t\t}\r\n\t\t\tctx.fillText(part.character, part.x, part.y);\r\n\t\t}\r\n\t\tctx.restore();\r\n\t}\r\n\r\n\tpublic quote() {\r\n\t\tlet lastChar = -1;\r\n\t\tlet quoted = false;\r\n\r\n\t\tfor (let i = 0; i < this.renderParts.length; ++i) {\r\n\t\t\tconst part = this.renderParts[i];\r\n\t\t\tif (part.type !== 'character') continue;\r\n\t\t\tif (part.character.match(/\\s/)) continue;\r\n\t\t\tlastChar = i;\r\n\t\t\tif (!quoted) {\r\n\t\t\t\tthis.renderParts.splice(i, 0, {\r\n\t\t\t\t\ttype: 'character',\r\n\t\t\t\t\tx: 0,\r\n\t\t\t\t\ty: 0,\r\n\t\t\t\t\tstyle: part.style,\r\n\t\t\t\t\tcharacter: '\"',\r\n\t\t\t\t\theight: part.height,\r\n\t\t\t\t\twidth: measureWidth(part.style, '\"'),\r\n\t\t\t\t});\r\n\t\t\t\tquoted = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (quoted && lastChar >= 0) {\r\n\t\t\tconst part = this.renderParts[lastChar] as IDrawCharacterItem;\r\n\t\t\tthis.renderParts.splice(lastChar + 1, 0, {\r\n\t\t\t\ttype: 'character',\r\n\t\t\t\tx: 0,\r\n\t\t\t\ty: 0,\r\n\t\t\t\tstyle: part.style,\r\n\t\t\t\tcharacter: '\"',\r\n\t\t\t\theight: part.height,\r\n\t\t\t\twidth: measureWidth(part.style, '\"'),\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tpublic fixAlignment(\r\n\t\talignment: 'left' | 'center' | 'right',\r\n\t\txStart: number,\r\n\t\txEnd: number,\r\n\t\tyStart: number\r\n\t) {\r\n\t\tlet lineWidth = 0;\r\n\t\tlet currentLine: RenderItem[] = [];\r\n\r\n\t\tfunction fixLine() {\r\n\t\t\tlet x = xStart;\r\n\t\t\tif (alignment === 'center') {\r\n\t\t\t\tx = xStart + (xEnd - xStart) / 2 - lineWidth / 2;\r\n\t\t\t} else if (alignment === 'right') {\r\n\t\t\t\tx = xEnd - lineWidth;\r\n\t\t\t}\r\n\t\t\tfor (const item of currentLine) {\r\n\t\t\t\titem.x = x;\r\n\t\t\t\tx += item.width;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet y = yStart;\r\n\t\tconst lineHeights = [];\r\n\t\tlet lineHeight = 0;\r\n\r\n\t\tfor (const item of this.renderParts) {\r\n\t\t\tlineHeight = Math.max(lineHeight, item.height);\r\n\r\n\t\t\tif (item.type === 'newline') {\r\n\t\t\t\tlineHeights.push(lineHeight);\r\n\t\t\t}\r\n\t\t}\r\n\t\tlineHeights.push(lineHeight);\r\n\r\n\t\tlet line = 0;\r\n\r\n\t\tfor (const item of this.renderParts) {\r\n\t\t\tlineHeight = Math.max(lineHeight, item.height);\r\n\t\t\titem.y = y;\r\n\t\t\tcurrentLine.push(item);\r\n\t\t\tlineWidth += item.width;\r\n\r\n\t\t\tif (item.type === 'newline') {\r\n\t\t\t\tfixLine();\r\n\t\t\t\ty += lineHeights[++line] || 0;\r\n\t\t\t\tlineWidth = 0;\r\n\t\t\t\tlineHeight = 0;\r\n\t\t\t\tcurrentLine = [];\r\n\t\t\t} else if (item.type === 'character') {\r\n\t\t\t\tconst lastItem = currentLine[currentLine.length - 1];\r\n\t\t\t\tif (lastItem.type === 'character') {\r\n\t\t\t\t\tlineWidth += lastItem.style.letterSpacing;\r\n\t\t\t\t\tlastItem.width += lastItem.style.letterSpacing;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tfixLine();\r\n\t}\r\n\r\n\tprivate getRenderParts(tokens: Token[], baseStyle: ITextStyle): RenderItem[] {\r\n\t\tconst renderParts: RenderItem[] = [];\r\n\t\tconst styleStack: ITextStyle[] = [];\r\n\t\tconst tagStack: Array<ICommandToken | null> = [];\r\n\t\tlet currentStyleHeight: number = measureHeight(baseStyle);\r\n\t\tlet currentStyle = baseStyle;\r\n\t\tlet currentTag: ICommandToken | null = null;\r\n\t\tfor (const token of tokens) {\r\n\t\t\tswitch (token.type) {\r\n\t\t\t\tcase 'command':\r\n\t\t\t\t\tif (TextRenderer.textCommands.has(token.commandName)) {\r\n\t\t\t\t\t\tstyleStack.push(currentStyle);\r\n\t\t\t\t\t\ttagStack.push(currentTag);\r\n\t\t\t\t\t\tcurrentStyle = TextRenderer.textCommands.get(token.commandName)!(\r\n\t\t\t\t\t\t\tcurrentStyle,\r\n\t\t\t\t\t\t\ttoken.argument\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tcurrentStyleHeight = measureHeight(currentStyle);\r\n\t\t\t\t\t\tcurrentTag = token;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\t\t`There is no text command called '${token.commandName}' at position ${token.pos}.`\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'commandClose':\r\n\t\t\t\t\tif (!currentTag) {\r\n\t\t\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\t\t`Unmatched closing command at position ${token.pos}. Closed '${token.commandName}', but no commands are currently open.`\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (token.commandName !== currentTag.commandName) {\r\n\t\t\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\t\t`Unmatched closing command at position ${token.pos}. Closed '${token.commandName}', expected to close '${currentTag}' first. (Opened at position ${currentTag.pos})`\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcurrentTag = tagStack.pop()!;\r\n\t\t\t\t\tcurrentStyle = styleStack.pop()!;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'newline':\r\n\t\t\t\t\trenderParts.push({\r\n\t\t\t\t\t\theight: currentStyleHeight,\r\n\t\t\t\t\t\twidth: 0,\r\n\t\t\t\t\t\tx: 0,\r\n\t\t\t\t\t\ty: 0,\r\n\t\t\t\t\t\ttype: 'newline',\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'text':\r\n\t\t\t\t\tfor (const character of token.content) {\r\n\t\t\t\t\t\trenderParts.push({\r\n\t\t\t\t\t\t\ttype: 'character',\r\n\t\t\t\t\t\t\tcharacter,\r\n\t\t\t\t\t\t\theight: currentStyleHeight,\r\n\t\t\t\t\t\t\twidth: measureWidth(currentStyle, character),\r\n\t\t\t\t\t\t\tstyle: currentStyle,\r\n\t\t\t\t\t\t\tx: 0,\r\n\t\t\t\t\t\t\ty: 0,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn renderParts;\r\n\t}\r\n}\r\n\r\nconst tmpContext = document.createElement('canvas').getContext('2d')!;\r\nlet lastStyle: ITextStyle | null = null;\r\n\r\nfunction measureWidth(textStyle: ITextStyle, character: string): number {\r\n\tif (textStyle !== lastStyle) {\r\n\t\tapplyTextStyleToCanvas(textStyle, tmpContext);\r\n\t\tlastStyle = textStyle;\r\n\t}\r\n\treturn tmpContext.measureText(character).width;\r\n}\r\n\r\nconst heightCache = new Map<string, number>();\r\n\r\nfunction measureHeight(textStyle: ITextStyle): number {\r\n\tconst font = textStyle.fontSize + ' ' + textStyle.fontName;\r\n\tif (heightCache.has(font)) {\r\n\t\treturn heightCache.get(font)! * textStyle.lineSpacing;\r\n\t}\r\n\r\n\tconst text = document.createElement('span');\r\n\ttext.innerHTML = 'Hg';\r\n\ttext.style.fontFamily = textStyle.fontName;\r\n\ttext.style.fontSize = `${textStyle.fontSize}px`;\r\n\ttext.style.lineHeight = '1';\r\n\r\n\tconst div = document.createElement('div');\r\n\tdiv.style.opacity = '0';\r\n\tdiv.style.fontFamily = textStyle.fontName;\r\n\tdiv.style.fontSize = `${textStyle.fontSize}px`;\r\n\tdiv.style.lineHeight = '1';\r\n\tdiv.style.position = 'absolute';\r\n\tdiv.style.top = '0';\r\n\tdiv.style.left = '0';\r\n\tdiv.appendChild(text);\r\n\r\n\tdocument.body.appendChild(div);\r\n\r\n\ttry {\r\n\t\tconst height = div.offsetHeight;\r\n\t\theightCache.set(font, height);\r\n\t\treturn height * textStyle.lineSpacing;\r\n\t} finally {\r\n\t\tdiv.remove();\r\n\t}\r\n}\r\n\r\nfunction applyTextStyleToCanvas(\r\n\tstyle: ITextStyle,\r\n\tctx: CanvasRenderingContext2D\r\n) {\r\n\tctx.textAlign = 'left';\r\n\tctx.font =\r\n\t\t(style.isItalic ? 'italic ' : '') +\r\n\t\t(style.isBold ? 'bold ' : '') +\r\n\t\tstyle.fontSize +\r\n\t\t'px ' +\r\n\t\tstyle.fontName;\r\n\tctx.lineJoin = 'round';\r\n\r\n\tif (style.strokeWidth > 0 && style.strokeColor > '') {\r\n\t\tctx.strokeStyle = style.strokeColor;\r\n\t\tctx.lineWidth = style.strokeWidth;\r\n\t} else {\r\n\t\tctx.strokeStyle = '';\r\n\t\tctx.lineWidth = 0;\r\n\t}\r\n\r\n\tctx.globalAlpha = style.alpha || 0;\r\n\tctx.fillStyle = style.color;\r\n}\r\n","import { ITextStyle } from '@/renderer/textRenderer/textRenderer';\n\nexport const ScreenWidth = 1280;\n\nexport const TextBoxWidth = 816;\nexport const TextBoxCorruptedWidth = 900;\nexport const TextBoxHeight = 146;\nexport const TextBoxY = 568;\nexport const TextBoxKerning = 0;\nexport const TextBoxLineHeight = 29;\nexport const TextBoxCorruptedKerning = 8;\nexport const TextBoxTextXOffset = 38;\nexport const TextBoxTextYOffset = 50;\n\nexport const TextBoxTextCorruptedXOffset = 9;\nexport const TextBoxTextCorruptedYOffset = 9;\n\nexport const NameboxHeight = 39;\nexport const NameboxWidth = 168;\nexport const NameboxXOffset = 34;\nexport const NameboxTextYOffset = 29;\n\nexport const ControlsYBottomOffset = 12;\nexport const ControlsXHistoryOffset = -126;\nexport const ControlsXSkipOffset = -72;\nexport const ControlsXStuffOffset = -38;\n\nexport const ArrowXRightOffset = 30.75;\nexport const ArrowYBottomOffset = 26;\n\nexport const GlowRX = 426;\nexport const GlowRY = 58;\n\nexport const BaseTextStyle: ITextStyle = {\n\talpha: 1,\n\tcolor: 'black',\n\tfontName: 'aller',\n\tfontSize: 24,\n\tisBold: false,\n\tisItalic: false,\n\tisStrikethrough: false,\n\tisUnderlined: false,\n\tletterSpacing: 0,\n\tlineSpacing: 1,\n\tstrokeColor: '',\n\tstrokeWidth: 0,\n};\n\nexport const NameboxTextStyle: ITextStyle = {\n\t...BaseTextStyle,\n\tfontName: 'riffic',\n\tfontSize: 24,\n\tstrokeColor: '#bb5599',\n\tstrokeWidth: 6,\n\tcolor: 'white',\n};\n\nexport const ControlsTextStyle = {\n\talign: 'left' as CanvasTextAlign,\n\tfont: '13px aller',\n\tfill: {\n\t\tstyle: '#522',\n\t},\n};\n\nexport const ControlsTextDisabledStyle = {\n\t...ControlsTextStyle,\n\tfill: {\n\t\tstyle: '#a66',\n\t},\n};\n\nexport const TextBoxStyle = {\n\talign: 'left' as CanvasTextAlign,\n\tfont: '24px aller',\n\toutline: {\n\t\tstyle: '#523140',\n\t\twidth: 4,\n\t},\n\tfill: {\n\t\tstyle: '#fff',\n\t},\n};\n\nexport const TextBoxCorruptedStyle = {\n\talign: 'left' as CanvasTextAlign,\n\tfont: '24px verily',\n\toutline: {\n\t\tstyle: '#000',\n\t\twidth: 20,\n\t},\n\tfill: {\n\t\tstyle: '#fff',\n\t},\n};\n\nexport const TextBoxX = ScreenWidth / 2 - TextBoxWidth / 2; // 232\nexport const TextBoxCorruptedX = ScreenWidth / 2 - TextBoxCorruptedWidth / 2;\nexport const TextBoxTextX = TextBoxX + TextBoxTextXOffset;\nexport const TextBoxTextY = TextBoxY + TextBoxTextYOffset;\n\nexport const NameboxY = TextBoxY - NameboxHeight;\nexport const NameboxX = TextBoxX + NameboxXOffset;\nexport const NameboxTextX = NameboxX + NameboxWidth / 2;\nexport const NameboxTextY = NameboxY + NameboxTextYOffset;\n\nexport const ControlsXHistory = TextBoxX + ControlsXHistoryOffset;\nexport const ControlsXSkip = TextBoxX + ControlsXSkipOffset;\nexport const ControlsXStuff = TextBoxX + ControlsXStuffOffset;\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop, Watch } from 'vue-property-decorator';\r\nimport environment from '@/environments/environment';\r\nimport { Part } from '@/models/constants';\r\nimport { IHistorySupport } from '@/plugins/vuex-history';\r\nimport { State } from 'vuex-class-decorator';\r\nimport { Store } from 'vuex';\r\nimport { IRootState } from '@/store';\r\nimport { RGBAColor } from '@/util/colors/rgb';\r\nimport Color from '../color/color.vue';\r\nimport { TextRenderer } from '../../../../renderer/textRenderer/textRenderer';\r\nimport { NameboxTextStyle } from '../../../../models/textBoxConstants';\r\n\r\n@Component({\r\n\tcomponents: { Color },\r\n})\r\nexport default class TextPanel extends Vue {\r\n\tpublic $store!: Store<IRootState>;\r\n\r\n\t@State('vertical', { namespace: 'ui' }) private readonly vertical!: boolean;\r\n\r\n\t@Prop({ required: true, type: String }) private readonly value!: string;\r\n\t@Prop({ type: String, default: '' }) private readonly title!: string;\r\n\r\n\tprivate colorSelector: '' | 'text' | 'outline' = '';\r\n\tprivate selectedFont: string = '';\r\n\tprivate selectedColor: string = '#000000';\r\n\tprivate rememberedStart: number = 0;\r\n\tprivate rememberedEnd: number = 0;\r\n\tprivate error: string = '';\r\n\r\n\t@Watch('selectedFont')\r\n\tprivate onSelectedFontChange() {\r\n\t\tif (this.selectedFont === '') return;\r\n\t\tconsole.log(this.selectedFont);\r\n\t\tthis.insertCommand('font', this.selectedFont);\r\n\t\tthis.selectedFont = '';\r\n\t}\r\n\r\n\tprivate onValueChanged() {\r\n\t\tconst val = (this.$refs.textArea as HTMLTextAreaElement).value;\r\n\t\ttry {\r\n\t\t\tnew TextRenderer(val, NameboxTextStyle);\r\n\t\t\tthis.error = '';\r\n\t\t} catch (e) {\r\n\t\t\tthis.error = (e as Error).message;\r\n\t\t\tconsole.error(e);\r\n\t\t}\r\n\t\tthis.$emit('input', val);\r\n\t}\r\n\r\n\tprivate selectColor(colorSelector: '' | 'text' | 'outline') {\r\n\t\tconst el = this.$refs.textArea as HTMLTextAreaElement;\r\n\t\tthis.colorSelector = colorSelector;\r\n\t\tthis.rememberedStart = el.selectionStart;\r\n\t\tthis.rememberedEnd = el.selectionEnd;\r\n\t}\r\n\r\n\tprivate applyColor() {\r\n\t\tconst color = this.selectedColor;\r\n\t\tconst colorSelector = this.colorSelector;\r\n\t\tconst apply = () => {\r\n\t\t\tconst el = this.$refs.textArea as HTMLTextAreaElement;\r\n\t\t\tif (!el) {\r\n\t\t\t\tthis.$nextTick(apply);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tel.selectionStart = this.rememberedStart;\r\n\t\t\tel.selectionEnd = this.rememberedEnd;\r\n\t\t\tthis.insertCommand(\r\n\t\t\t\tcolorSelector === 'text' ? 'color' : 'outlinecolor',\r\n\t\t\t\tcolor\r\n\t\t\t);\r\n\t\t};\r\n\t\tthis.$nextTick(apply);\r\n\t\tthis.selectedColor = '#000000';\r\n\t\tthis.colorSelector = '';\r\n\t}\r\n\r\n\tprivate insertText(text: string) {\r\n\t\tconst el = this.$refs.textArea as HTMLTextAreaElement;\r\n\t\tconst val = el.value;\r\n\t\tconst selStart = el.selectionStart;\r\n\t\tconst selEnd = el.selectionEnd;\r\n\t\tel.value = val.slice(0, selStart) + text + val.slice(selEnd);\r\n\t\tel.selectionStart = el.selectionEnd = selStart + text.length;\r\n\t\tel.focus();\r\n\t\tthis.onValueChanged();\r\n\t}\r\n\r\n\tprivate insertCommand(command: string, arg?: any) {\r\n\t\tconst el = this.$refs.textArea as HTMLTextAreaElement;\r\n\t\tconst val = el.value;\r\n\t\tconst selStart = el.selectionStart;\r\n\t\tconst selEnd = el.selectionEnd;\r\n\t\tconst selectedText = val.slice(selStart, selEnd);\r\n\t\tconst before = val.slice(0, selStart);\r\n\t\tconst after = val.slice(selEnd);\r\n\t\tlet commandOpen = command;\r\n\t\tif (arg) {\r\n\t\t\tcommandOpen += '=' + arg;\r\n\t\t}\r\n\t\tel.value = `${before}{${commandOpen}}${selectedText}{/${command}}${after}`;\r\n\t\tel.selectionStart = selStart + commandOpen.length + 2;\r\n\t\tel.selectionEnd = el.selectionStart + selectedText.length;\r\n\t\tel.focus();\r\n\t\tthis.onValueChanged();\r\n\t}\r\n}\r\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./text.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./text.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./text.vue?vue&type=template&id=3077e0d8&scoped=true&\"\nimport script from \"./text.vue?vue&type=script&lang=ts&\"\nexport * from \"./text.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./text.vue?vue&type=style&index=0&id=3077e0d8&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3077e0d8\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop, Watch, Mixins } from 'vue-property-decorator';\nimport {\n\tITextBox,\n\tISetTextBoxControlsVisibleMutation,\n\tISetTextBoxControlsSkipMutation,\n\tISetTextBoxControlsContinueMutation,\n\tISetTextBoxTextMutation,\n\tISetTextBoxStyleAction,\n\tISetTextBoxCustomColorMutation,\n\tISetTextBoxTalkingDefaultMutation,\n\tISetTextBoxTalkingOtherMutation,\n\tISetTextBoxCustomControlsColorMutation,\n\tISetTextBoxNameboxColorMutation,\n\tISetTextBoxNameboxWidthMutation,\n\tISetTextBoxNameboxStrokeMutation,\n\tISetTextBoxDeriveCustomColorMutation,\n\tISplitTextbox,\n\tISetTextBoxAutoQuotingMutation,\n\tIResetTextboxBounds,\n} from '@/store/objectTypes/textbox';\nimport Toggle from '@/components/toggle.vue';\nimport { State } from 'vuex-class-decorator';\nimport { IHistorySupport } from '@/plugins/vuex-history';\nimport PositionAndSize from '@/components/toolbox/commonsFieldsets/positionAndSize.vue';\nimport Layers from '@/components/toolbox/commonsFieldsets/layers.vue';\nimport Opacity from '@/components/toolbox/commonsFieldsets/opacity.vue';\nimport Delete from '@/components/toolbox/commonsFieldsets/delete.vue';\nimport { ISetObjectFlipMutation } from '@/store/objects';\nimport { PanelMixin } from './panelMixin';\nimport { Store } from 'vuex';\nimport { IRootState } from '@/store';\nimport Color from '../subpanels/color/color.vue';\nimport TextEditor from '../subpanels/text/text.vue';\n\n@Component({\n\tcomponents: {\n\t\tToggle,\n\t\tPositionAndSize,\n\t\tLayers,\n\t\tOpacity,\n\t\tDelete,\n\t\tColor,\n\t\tTextEditor,\n\t},\n})\nexport default class TextPanel extends Mixins(PanelMixin) {\n\tpublic $store!: Store<IRootState>;\n\n\tprivate vuexHistory!: IHistorySupport;\n\n\tprivate readonly textEditor: '' | 'name' | 'body' = '';\n\n\tprivate readonly colorSelect:\n\t\t| ''\n\t\t| 'base'\n\t\t| 'controls'\n\t\t| 'namebox'\n\t\t| 'nameboxStroke' = '';\n\n\tprivate get textbox(): ITextBox {\n\t\tconst obj = this.$store.state.objects.objects[\n\t\t\tthis.$store.state.ui.selection!\n\t\t];\n\t\tif (obj.type !== 'textBox') return undefined!;\n\t\treturn obj as ITextBox;\n\t}\n\n\tprivate get textEditorName(): string {\n\t\tif (this.textEditor === 'name') return 'Name';\n\t\tif (this.textEditor === 'body') return 'Dialog';\n\t\treturn '';\n\t}\n\n\tprivate get textEditorText(): string {\n\t\tif (this.textEditor === 'name') return this.textbox.talkingOther;\n\t\tif (this.textEditor === 'body') return this.dialog;\n\t\treturn '';\n\t}\n\n\tprivate set textEditorText(value: string) {\n\t\tif (this.textEditor === 'name') this.talkingOther = value;\n\t\telse if (this.textEditor === 'body') this.dialog = value;\n\t}\n\n\tprivate splitTextbox(): void {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/splitTextbox', {\n\t\t\t\tid: this.textbox.id,\n\t\t\t} as ISplitTextbox);\n\t\t});\n\t}\n\n\tprivate resetPosition(): void {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.dispatch('objects/resetTextboxBounds', {\n\t\t\t\tid: this.textbox.id,\n\t\t\t} as IResetTextboxBounds);\n\t\t});\n\t}\n\n\tprivate get talkingDefaults(): ISetTextBoxTalkingDefaultMutation['talkingDefault'] {\n\t\treturn this.textbox.talkingDefault;\n\t}\n\n\tprivate set talkingDefaults(\n\t\ttalkingDefault: ISetTextBoxTalkingDefaultMutation['talkingDefault']\n\t) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.commit('objects/setTalkingDefault', {\n\t\t\t\tid: this.textbox.id,\n\t\t\t\ttalkingDefault,\n\t\t\t} as ISetTextBoxTalkingDefaultMutation);\n\t\t});\n\t}\n\n\tprivate get talkingOther(): string {\n\t\treturn this.textbox.talkingOther;\n\t}\n\n\tprivate set talkingOther(talkingOther: string) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.commit('objects/setTalkingOther', {\n\t\t\t\tid: this.textbox.id,\n\t\t\t\ttalkingOther,\n\t\t\t} as ISetTextBoxTalkingOtherMutation);\n\t\t});\n\t}\n\n\tprivate get showControls(): boolean {\n\t\treturn this.textbox.controls;\n\t}\n\n\tprivate set showControls(controls: boolean) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.commit('objects/setControlsVisible', {\n\t\t\t\tid: this.textbox.id,\n\t\t\t\tcontrols,\n\t\t\t} as ISetTextBoxControlsVisibleMutation);\n\t\t});\n\t}\n\n\tprivate get allowSkipping(): boolean {\n\t\treturn this.textbox.controls;\n\t}\n\n\tprivate set allowSkipping(skip: boolean) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.commit('objects/setSkipable', {\n\t\t\t\tid: this.textbox.id,\n\t\t\t\tskip,\n\t\t\t} as ISetTextBoxControlsSkipMutation);\n\t\t});\n\t}\n\n\tprivate get autoQuoting(): boolean {\n\t\treturn this.textbox.autoQuoting;\n\t}\n\n\tprivate set autoQuoting(autoQuoting: boolean) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.commit('objects/setAutoQuoting', {\n\t\t\t\tid: this.textbox.id,\n\t\t\t\tautoQuoting,\n\t\t\t} as ISetTextBoxAutoQuotingMutation);\n\t\t});\n\t}\n\n\tprivate get showContinueArrow(): boolean {\n\t\treturn this.textbox.continue;\n\t}\n\n\tprivate set showContinueArrow(value: boolean) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.commit('objects/setContinueArrow', {\n\t\t\t\tid: this.textbox.id,\n\t\t\t\tcontinue: value,\n\t\t\t} as ISetTextBoxControlsContinueMutation);\n\t\t});\n\t}\n\n\tprivate get dialog(): string {\n\t\treturn this.textbox.text;\n\t}\n\n\tprivate set dialog(text: string) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.commit('objects/setText', {\n\t\t\t\tid: this.textbox.id,\n\t\t\t\ttext,\n\t\t\t} as ISetTextBoxTextMutation);\n\t\t});\n\t}\n\n\tprivate get flip(): boolean {\n\t\treturn this.textbox.flip;\n\t}\n\n\tprivate set flip(flip: boolean) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.commit('objects/setFlip', {\n\t\t\t\tid: this.textbox.id,\n\t\t\t\tflip,\n\t\t\t} as ISetObjectFlipMutation);\n\t\t});\n\t}\n\n\tprivate get textBoxStyle(): ITextBox['style'] {\n\t\treturn this.textbox.style;\n\t}\n\n\tprivate set textBoxStyle(style: ITextBox['style']) {\n\t\tthis.$store.dispatch('objects/setStyle', {\n\t\t\tid: this.textbox.id,\n\t\t\tstyle,\n\t\t} as ISetTextBoxStyleAction);\n\t}\n\n\tprivate get deriveCustomColors(): boolean {\n\t\treturn this.textbox.deriveCustomColors;\n\t}\n\n\tprivate set deriveCustomColors(deriveCustomColors: boolean) {\n\t\tthis.$store.commit('objects/setDeriveCustomColors', {\n\t\t\tid: this.textbox.id,\n\t\t\tderiveCustomColors,\n\t\t} as ISetTextBoxDeriveCustomColorMutation);\n\t}\n\n\tprivate get customControlsColor(): string {\n\t\treturn this.textbox.customControlsColor;\n\t}\n\n\tprivate get customNameboxWidth(): number {\n\t\treturn this.textbox.customNameboxWidth;\n\t}\n\n\tprivate set customNameboxWidth(customNameboxWidth: number) {\n\t\tthis.$store.commit('objects/setNameboxWidth', {\n\t\t\tid: this.textbox.id,\n\t\t\tcustomNameboxWidth,\n\t\t} as ISetTextBoxNameboxWidthMutation);\n\t}\n\n\tprivate get colorName(): string {\n\t\tswitch (this.colorSelect) {\n\t\t\tcase '':\n\t\t\t\treturn '';\n\t\t\tcase 'base':\n\t\t\t\treturn 'Base color';\n\t\t\tcase 'controls':\n\t\t\t\treturn 'Controls color';\n\t\t\tcase 'namebox':\n\t\t\t\treturn 'Namebox color';\n\t\t\tcase 'nameboxStroke':\n\t\t\t\treturn 'Namebox text stroke';\n\t\t}\n\t}\n\n\tprivate get color(): string {\n\t\tswitch (this.colorSelect) {\n\t\t\tcase '':\n\t\t\t\treturn '#000000';\n\t\t\tcase 'base':\n\t\t\t\treturn this.textbox.customColor;\n\t\t\tcase 'controls':\n\t\t\t\treturn this.textbox.customControlsColor;\n\t\t\tcase 'namebox':\n\t\t\t\treturn this.textbox.customNameboxColor;\n\t\t\tcase 'nameboxStroke':\n\t\t\t\treturn this.textbox.customNameboxStroke;\n\t\t}\n\t}\n\n\tprivate set color(color: string) {\n\t\tswitch (this.colorSelect) {\n\t\t\tcase '':\n\t\t\t\treturn;\n\t\t\tcase 'base':\n\t\t\t\tthis.$store.commit('objects/setCustomColor', {\n\t\t\t\t\tid: this.textbox.id,\n\t\t\t\t\tcolor,\n\t\t\t\t} as ISetTextBoxCustomColorMutation);\n\t\t\tcase 'controls':\n\t\t\t\tthis.$store.commit('objects/setControlsColor', {\n\t\t\t\t\tid: this.textbox.id,\n\t\t\t\t\tcustomControlsColor: color,\n\t\t\t\t} as ISetTextBoxCustomControlsColorMutation);\n\t\t\tcase 'namebox':\n\t\t\t\tthis.$store.commit('objects/setNameboxColor', {\n\t\t\t\t\tid: this.textbox.id,\n\t\t\t\t\tcustomNameboxColor: color,\n\t\t\t\t} as ISetTextBoxNameboxColorMutation);\n\t\t\tcase 'nameboxStroke':\n\t\t\t\tthis.$store.commit('objects/setNameboxStroke', {\n\t\t\t\t\tid: this.textbox.id,\n\t\t\t\t\tcustomNameboxStroke: color,\n\t\t\t\t} as ISetTextBoxNameboxStrokeMutation);\n\t\t}\n\t}\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./textbox.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./textbox.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./textbox.vue?vue&type=template&id=3a5e2c97&scoped=true&\"\nimport script from \"./textbox.vue?vue&type=script&lang=ts&\"\nexport * from \"./textbox.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./textbox.vue?vue&type=style&index=0&id=3a5e2c97&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3a5e2c97\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"panel\"},[_c('h1',[_vm._v(\"Help and Credits\")]),_c('a',{staticClass:\"btn\",attrs:{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/edave64/Doki-Doki-Dialog-Generator/blob/v1/docs/index.md\"}},[_vm._v(\"Help\")]),_c('a',{staticClass:\"btn\",attrs:{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://github.com/edave64/Doki-Doki-Dialog-Generator/\"}},[_vm._v(\"Fork me on GitHub\")]),_c('p',[_vm._v(\" All assets used are IP of Team Salvato and created by them, unless noted otherwise. \")]),_c('p',[_vm._v(\" Unused House Background by \"),_c('a',{attrs:{\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.deviantart.com/fatelogic/art/VN-Background-Practice-295671161\"}},[_vm._v(\"Fatelogic\")])]),_c('p',[_vm._v(\" Doki Doki Dialog Generator developed by EDave64 \"),_c('br'),_vm._v(\"Based on gemdude46's DDLC Shitpost generator \")]),_c('p',[_vm._v(\" MC Classic Sprite by Childish-N \"),_c('br'),_vm._v(\"MC Classic Chibi by GyleToTheRescue \")]),_c('p',[_vm._v(\" MC Sprite by Childish-N \"),_c('br'),_vm._v(\"MC Casual Sprite by SlightlySimple \"),_c('br'),_vm._v(\"MC Chibi by SlightlySimple \")]),_c('p',[_vm._v(\" MC Chad Sprite by Cylent-Nite \"),_c('br'),_vm._v(\"MC Chad Poses and expressions by SlightlySimple \"),_c('br'),_vm._v(\"MC Chad Poses and chibi by Meddy-sin \")]),_c('p',[_vm._v(\" FeMC Sprite by Meddy-sin \"),_c('br'),_vm._v(\"FeMC Casual Sprite by SlightlySimple \")]),_c('p',[_vm._v(\"Classic Amy Sprite by Meddy-sin\")]),_c('p',[_vm._v(\"Amy Sprite by Meddy-sin and SlightlySimple\")]),_c('p',[_vm._v(\"Special thanks to SlightlySimple for testing and technical help\")]),_c('p',[_vm._v(\"Atlas421 for suggestions and testing\")]),_c('p',[_vm._v(\"T-Rex Harris for suggestions and testing\")])])}]\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop, Mixins } from 'vue-property-decorator';\nimport { PanelMixin } from './panelMixin';\n\n@Component({\n\tcomponents: {},\n})\nexport default class AddPanel extends Mixins(PanelMixin) {}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./credits.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./credits.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./credits.vue?vue&type=template&id=f2bd9d50&scoped=true&\"\nimport script from \"./credits.vue?vue&type=script&lang=ts&\"\nexport * from \"./credits.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./credits.vue?vue&type=style&index=0&id=f2bd9d50&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f2bd9d50\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"panel\",on:{\"dragenter\":_vm.dragEnter,\"mouseleave\":function($event){return _vm.$refs.dt.hide()}}},[_c('drop-target',{ref:\"dt\",staticClass:\"drop-target\",on:{\"drop\":_vm.addImageFile}},[_vm._v(\"Drop here to add as a new background\")]),_c('h1',[_vm._v(\"Background\")]),(_vm.colorSelect)?_c('color',{on:{\"leave\":function($event){_vm.colorSelect = false}},model:{value:(_vm.bgColor),callback:function ($$v) {_vm.bgColor=$$v},expression:\"bgColor\"}}):[_c('background-settings',{on:{\"change-color\":function($event){_vm.colorSelect = true}}}),_vm._l((_vm.backgrounds),function(background){return _c('background-button',{key:background,attrs:{\"backgroundId\":background},on:{\"input\":function($event){return _vm.setBackground(background)}}})}),_c('div',{staticClass:\"btn upload-background\",on:{\"click\":function($event){return _vm.$refs.upload.click()}}},[_vm._v(\" Upload \"),_c('input',{ref:\"upload\",attrs:{\"type\":\"file\"},on:{\"change\":_vm.onFileUpload}})]),_c('button',{staticClass:\"upload-background\",on:{\"click\":_vm.addByUrl}},[_vm._v(\"Add by URL\")]),_c('button',{staticClass:\"upload-background\",attrs:{\"title\":\"Not yet implemented\",\"disabled\":\"disabled\"}},[_c('i',{staticClass:\"material-icons\"},[_vm._v(\"extension\")]),_vm._v(\" Search in content packs \")])]],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{ background: true, active: _vm.isActive },style:(_vm.style),attrs:{\"title\":_vm.title},on:{\"click\":function($event){return _vm.$emit('input', _vm.backgroundId)}}},[_vm._v(_vm._s(_vm.title))])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop, Watch } from 'vue-property-decorator';\nimport { color } from '@/models/background';\nimport { isWebPSupported, getAAsset } from '@/asset-manager';\nimport { Background } from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\nimport { IAsset, BackgroundLookup } from '@/store/content';\nimport { ErrorAsset } from '@/models/error-asset';\nimport { Store } from 'vuex';\nimport { IRootState } from '@/store';\nimport { IPanel } from '@/store/panels';\n\n@Component({\n\tcomponents: {},\n})\nexport default class BackgroundButton extends Vue {\n\tpublic $store!: Store<IRootState>;\n\t@Prop({ required: true }) private readonly backgroundId!: string;\n\n\tprivate isWebPSupported: boolean | null = null;\n\tprivate assets: Array<HTMLImageElement | ErrorAsset> = [];\n\n\tprivate get background(): Readonly<IPanel['background']> {\n\t\tconst currentPanel = this.$store.state.panels.currentPanel;\n\t\treturn this.$store.state.panels.panels[currentPanel].background;\n\t}\n\n\tprivate get bgData(): Background<IAsset> | null {\n\t\tconst backgrounds: BackgroundLookup = this.$store.getters[\n\t\t\t'content/getBackgrounds'\n\t\t];\n\t\treturn backgrounds.get(this.backgroundId) || null;\n\t}\n\n\tprivate get isActive(): boolean {\n\t\treturn this.backgroundId === this.background.current;\n\t}\n\n\tprivate async created() {\n\t\tif (this.bgData) {\n\t\t\tthis.assets = await Promise.all(\n\t\t\t\tthis.bgData.variants[0].map(asset => getAAsset(asset, false))\n\t\t\t);\n\t\t}\n\t}\n\n\tprivate get title(): string {\n\t\tswitch (this.backgroundId) {\n\t\t\tcase 'buildin.static-color':\n\t\t\t\treturn 'Static color';\n\t\t\tcase 'buildin.transparent':\n\t\t\t\treturn 'Transparent';\n\t\t}\n\t\treturn this.bgData!.label || '';\n\t}\n\n\tprivate get style(): { [id: string]: string } {\n\t\tswitch (this.backgroundId) {\n\t\t\tcase 'buildin.static-color':\n\t\t\t\treturn {\n\t\t\t\t\t'background-color': this.background.color,\n\t\t\t\t};\n\t\t\tcase 'buildin.transparent':\n\t\t\t\treturn {};\n\t\t}\n\t\tconst variant = this.bgData!.variants[0];\n\t\tconst urls = (this.assets.filter(\n\t\t\timg => img instanceof HTMLImageElement\n\t\t) as HTMLImageElement[])\n\t\t\t.map(img => `url('${img.src}')`)\n\t\t\t.join(',');\n\t\treturn {\n\t\t\tbackgroundImage: urls,\n\t\t};\n\t}\n}\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./button.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./button.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./button.vue?vue&type=template&id=73a85b48&scoped=true&\"\nimport script from \"./button.vue?vue&type=script&lang=ts&\"\nexport * from \"./button.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./button.vue?vue&type=style&index=0&id=73a85b48&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"73a85b48\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('fieldset',[_c('legend',[_vm._v(\"Settings:\")]),(_vm.isColor)?[_c('label',{attrs:{\"for\":\"bg_color\"}},[_vm._v(\"Color:\")]),_c('button',{staticClass:\"color-button\",style:({background: _vm.color}),attrs:{\"id\":\"bg_color\"},on:{\"click\":function($event){return _vm.$emit('change-color')}}})]:_vm._e(),(_vm.isVariant)?_c('table',[_c('tr',[_c('td',{attrs:{\"colspan\":\"3\"}},[_c('toggle',{attrs:{\"label\":\"Flipped?\"},model:{value:(_vm.flipped),callback:function ($$v) {_vm.flipped=$$v},expression:\"flipped\"}})],1)]),(_vm.hasVariants)?_c('tr',[_c('td',{staticClass:\"arrow-col\"},[_c('button',{on:{\"click\":function($event){return _vm.seekVariant(-1)}}},[_vm._v(\"<\")])]),_c('td',{staticStyle:{\"text-align\":\"center\"}},[_vm._v(\"Variant\")]),_c('td',{staticClass:\"arrow-col\"},[_c('button',{on:{\"click\":function($event){return _vm.seekVariant(1)}}},[_vm._v(\">\")])])]):_vm._e(),_c('tr',[_c('td',{attrs:{\"colspan\":\"3\"}},[_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.scaling),expression:\"scaling\"}],on:{\"keydown\":function($event){$event.stopPropagation();},\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.scaling=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},[_c('option',{attrs:{\"value\":\"0\"}},[_vm._v(\"None\")]),_c('option',{attrs:{\"value\":\"1\"}},[_vm._v(\"Stretch\")]),_c('option',{attrs:{\"value\":\"2\"}},[_vm._v(\"Cover\")])])])])]):_vm._e()],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Prop, Watch } from 'vue-property-decorator';\nimport { isWebPSupported } from '@/asset-manager';\nimport Toggle from '@/components/toggle.vue';\nimport { State } from 'vuex-class-decorator';\nimport { Background } from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\nimport { Store } from 'vuex';\nimport { IRootState } from '@/store';\nimport { IAsset } from '@/store/content';\nimport { IHistorySupport } from '@/plugins/vuex-history';\nimport {\n\tISetColorMutation,\n\tISetFlipMutation,\n\tISeekVariantAction,\n\tScalingModes,\n\tISetScalingMutation,\n\tIPanel,\n} from '@/store/panels';\n\n@Component({\n\tcomponents: { Toggle },\n})\nexport default class BackgroundSettings extends Vue {\n\tpublic $store!: Store<IRootState>;\n\tprivate get currentBackgroundId(): string {\n\t\treturn this.background.current;\n\t}\n\n\tprivate vuexHistory!: IHistorySupport;\n\n\tprivate get background(): Readonly<IPanel['background']> {\n\t\tconst currentPanel = this.$store.state.panels.currentPanel;\n\t\treturn this.$store.state.panels.panels[currentPanel].background;\n\t}\n\n\tprivate get bgData(): Background<IAsset> | null {\n\t\treturn (\n\t\t\tthis.$store.state.content.current.backgrounds.find(\n\t\t\t\tbackground => background.id === this.currentBackgroundId\n\t\t\t) || null\n\t\t);\n\t}\n\n\tprivate get isColor(): boolean {\n\t\treturn this.currentBackgroundId === 'buildin.static-color';\n\t}\n\n\tprivate get color(): string {\n\t\treturn this.background.color;\n\t}\n\n\tprivate set color(color: string) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.commit('panels/setBackgroundColor', {\n\t\t\t\tcolor,\n\t\t\t\tpanelId: this.$store.state.panels.currentPanel,\n\t\t\t} as ISetColorMutation);\n\t\t});\n\t}\n\n\tprivate get flipped(): boolean {\n\t\treturn this.background.flipped;\n\t}\n\n\tprivate set flipped(flipped: boolean) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.commit('panels/setBackgroundFlipped', {\n\t\t\t\tflipped,\n\t\t\t\tpanelId: this.$store.state.panels.currentPanel,\n\t\t\t} as ISetFlipMutation);\n\t\t});\n\t}\n\n\tprivate get scaling(): string {\n\t\treturn this.background.scaling.toString();\n\t}\n\n\tprivate set scaling(scaling: string) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.commit('panels/setBackgroundScaling', {\n\t\t\t\tscaling: parseInt(scaling, 10),\n\t\t\t\tpanelId: this.$store.state.panels.currentPanel,\n\t\t\t} as ISetScalingMutation);\n\t\t});\n\t}\n\n\tprivate get isVariant() {\n\t\treturn !!this.bgData;\n\t}\n\n\tprivate get hasVariants() {\n\t\treturn this.bgData ? this.bgData.variants.length > 1 : false;\n\t}\n\n\tprivate seekVariant(delta: 1 | -1) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tthis.$store.dispatch('panels/seekBackgroundVariant', {\n\t\t\t\tdelta,\n\t\t\t\tpanelId: this.$store.state.panels.currentPanel,\n\t\t\t} as ISeekVariantAction);\n\t\t});\n\t}\n}\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./settings.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./settings.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./settings.vue?vue&type=template&id=645ce448&scoped=true&\"\nimport script from \"./settings.vue?vue&type=script&lang=ts&\"\nexport * from \"./settings.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./settings.vue?vue&type=style&index=0&id=645ce448&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"645ce448\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop, Mixins } from 'vue-property-decorator';\r\nimport { registerAsset, getAsset } from '@/asset-manager';\r\nimport { IBackground } from '@/models/background';\r\nimport BackgroundButton from './background/button.vue';\r\nimport BackgroundSettings from './background/settings.vue';\r\nimport DropTarget from '../drop-target.vue';\r\nimport { State } from 'vuex-class-decorator';\r\nimport { Store } from 'vuex';\r\nimport { IRootState } from '@/store';\r\nimport { IAsset, ReplaceContentPackAction } from '@/store/content';\r\nimport {\r\n\tBackground,\r\n\tContentPack,\r\n} from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\r\nimport { ISetCurrentMutation, ISetColorMutation } from '@/store/panels';\r\nimport { PanelMixin } from './panelMixin';\r\nimport { IHistorySupport } from '@/plugins/vuex-history';\r\nimport Color from '../subpanels/color/color.vue';\r\n\r\nconst uploadedBackgroundsPack: ContentPack<string> = {\r\n\tpackId: 'dddg.buildin.uploadedBackgrounds',\r\n\tpackCredits: '',\r\n\tcharacters: [],\r\n\tfonts: [],\r\n\tsprites: [],\r\n\tpoemStyles: [],\r\n\tbackgrounds: [],\r\n\tcolors: [],\r\n};\r\n\r\n@Component({\r\n\tcomponents: {\r\n\t\tBackgroundButton,\r\n\t\tBackgroundSettings,\r\n\t\tDropTarget,\r\n\t\tColor,\r\n\t},\r\n})\r\nexport default class BackgroundsPanel extends Mixins(PanelMixin) {\r\n\tpublic $store!: Store<IRootState>;\r\n\r\n\tprivate colorSelect: boolean = false;\r\n\r\n\tprivate vuexHistory!: IHistorySupport;\r\n\r\n\tprivate get backgrounds(): Array<Background<IAsset>['id']> {\r\n\t\treturn [\r\n\t\t\t...this.$store.state.content.current.backgrounds.map(\r\n\t\t\t\tbackground => background.id\r\n\t\t\t),\r\n\t\t\t'buildin.static-color',\r\n\t\t\t'buildin.transparent',\r\n\t\t];\r\n\t}\r\n\r\n\tprivate setBackground(id: Background<IAsset>['id']) {\r\n\t\tthis.$store.commit('panels/setCurrentBackground', {\r\n\t\t\tcurrent: id,\r\n\t\t\tpanelId: this.$store.state.panels.currentPanel,\r\n\t\t} as ISetCurrentMutation);\r\n\t}\r\n\r\n\tprivate get bgColor(): string {\r\n\t\treturn this.$store.state.panels.panels[\r\n\t\t\tthis.$store.state.panels.currentPanel\r\n\t\t].background.color;\r\n\t}\r\n\r\n\tprivate set bgColor(color: string) {\r\n\t\tthis.vuexHistory.transaction(() => {\r\n\t\t\tthis.$store.commit('panels/setBackgroundColor', {\r\n\t\t\t\tcolor,\r\n\t\t\t} as ISetColorMutation);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate onFileUpload(e: Event) {\r\n\t\tconst uploadInput = this.$refs.upload as HTMLInputElement;\r\n\t\tif (!uploadInput.files) return;\r\n\t\tfor (const file of uploadInput.files) {\r\n\t\t\tthis.addImageFile(file);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate addImageFile(file: File) {\r\n\t\tconst url = URL.createObjectURL(file);\r\n\t\tthis.addNewCustomBackground(file.name, file.name, url);\r\n\t}\r\n\r\n\tprivate addByUrl() {\r\n\t\tconst url = prompt('Enter the URL of the image');\r\n\t\tif (!url) return;\r\n\t\tconst lastSegment = url.split('/').slice(-1)[0];\r\n\t\tthis.addNewCustomBackground(lastSegment, lastSegment, url);\r\n\t}\r\n\r\n\tprivate addNewCustomBackground(\r\n\t\tid: Background<IAsset>['id'],\r\n\t\tlabel: string,\r\n\t\turl: string\r\n\t) {\r\n\t\tuploadedBackgroundsPack.backgrounds.push({\r\n\t\t\tid,\r\n\t\t\tlabel,\r\n\t\t\tvariants: [[url]],\r\n\t\t});\r\n\t\tthis.vuexHistory.transaction(() => {\r\n\t\t\tthis.$store.dispatch('content/replaceContentPack', {\r\n\t\t\t\tcontentPack: uploadedBackgroundsPack,\r\n\t\t\t} as ReplaceContentPackAction);\r\n\t\t\tthis.setBackground(id);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate dragEnter(e: DragEvent) {\r\n\t\tif (!e.dataTransfer) return;\r\n\t\te.dataTransfer.effectAllowed = 'none';\r\n\t\tif (\r\n\t\t\t!Array.from(e.dataTransfer.items).find(item =>\r\n\t\t\t\titem.type.match(/^image.*$/)\r\n\t\t\t)\r\n\t\t) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\te.dataTransfer.effectAllowed = 'link';\r\n\t\t(this.$refs.dt as DropTarget).show();\r\n\t}\r\n}\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./backgrounds.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./backgrounds.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./backgrounds.vue?vue&type=template&id=a95f70b6&scoped=true&\"\nimport script from \"./backgrounds.vue?vue&type=script&lang=ts&\"\nexport * from \"./backgrounds.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./backgrounds.vue?vue&type=style&index=0&id=a95f70b6&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a95f70b6\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"panel\"},[_c('h1',[_vm._v(\"Content Packs\")]),_c('button',{on:{\"click\":_vm.addNew}},[_vm._v(\"Add new Pack\")]),_c('fieldset',[_c('legend',[_vm._v(\"Installed Packs:\")]),_c('div',{staticClass:\"list\"},_vm._l((_vm.packs),function(pack){return _c('div',{key:pack.name,class:{ active: pack.name === _vm.name },on:{\"click\":function($event){return _vm.select(pack.name)}}},[_vm._v(_vm._s(pack.name))])}),0)]),_c('label',{attrs:{\"for\":\"pack_name\"}},[_vm._v(\"Name:\")]),_c('input',{attrs:{\"id\":\"pack_name\",\"readonly\":\"\"},domProps:{\"value\":_vm.name}}),_c('label',{attrs:{\"for\":\"pack_credits\"}},[_vm._v(\"Credits:\")]),_c('div',{attrs:{\"id\":\"pack_credits\"},domProps:{\"innerHTML\":_vm._s(_vm.credits)}}),(_vm.activatable)?_c('button',{on:{\"click\":_vm.activate}},[_vm._v(\"Activate\")]):_vm._e(),(_vm.deactivatable)?_c('button',{on:{\"click\":_vm.deactivate}},[_vm._v(\"Deactivate\")]):_vm._e(),(_vm.installable)?_c('button',{on:{\"click\":_vm.install}},[_vm._v(\"Install\")]):_vm._e(),(_vm.uninstallable)?_c('button',{on:{\"click\":_vm.uninstall}},[_vm._v(\"Uninstall\")]):_vm._e(),(_vm.needRestart)?_c('div',[_vm._v(\" The tool need restart for changes to take effect. \"),_c('button',{on:{\"click\":_vm.restart}},[_vm._v(\"Restart Now\")])]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","const allowedTags = [\r\n\t'h3',\r\n\t'h4',\r\n\t'h5',\r\n\t'h6',\r\n\t'blockquote',\r\n\t'p',\r\n\t'a',\r\n\t'ul',\r\n\t'ol',\r\n\t'nl',\r\n\t'li',\r\n\t'b',\r\n\t'i',\r\n\t'strong',\r\n\t'em',\r\n\t'strike',\r\n\t'code',\r\n\t'hr',\r\n\t'br',\r\n\t'div',\r\n\t'table',\r\n\t'thead',\r\n\t'caption',\r\n\t'tbody',\r\n\t'tr',\r\n\t'th',\r\n\t'td',\r\n\t'pre',\r\n];\r\nconst allowedAttributes: { [tagName: string]: string[] | undefined } = {\r\n\ta: ['href'],\r\n\timg: ['src'],\r\n};\r\nconst schemaLimitedAttributes = ['href', 'src'];\r\nconst allowedSchemas = ['http', 'https'];\r\nconst enforceAttributes: {\r\n\t[tagName: string]: { [attr: string]: string } | undefined;\r\n} = {\r\n\ta: {\r\n\t\ttarget: '_blank',\r\n\t\trel: 'noopener noreferrer',\r\n\t},\r\n};\r\n\r\nexport function sanitize(html: string) {\r\n\tconst retDoc = document.createElement('div');\r\n\tconst doc = document.createElement('div');\r\n\tdoc.innerHTML = html;\r\n\r\n\tfor (const node of Array.from(doc.childNodes)) {\r\n\t\tfor (const sanitizedNode of sanitizeElement(node as Element)) {\r\n\t\t\tretDoc.appendChild(sanitizedNode);\r\n\t\t}\r\n\t}\r\n\r\n\treturn retDoc.innerHTML;\r\n}\r\n\r\nconst protocolMatcher = /^(\\w+):/;\r\n\r\nfunction sanitizeElement(node: Node): Node[] {\r\n\tif (node.nodeType !== Node.ELEMENT_NODE) return [node];\r\n\tconst el = node as Element;\r\n\tlet ret: Node[] = [];\r\n\tconst tagName = el.tagName.toLowerCase();\r\n\tif (allowedTags.includes(tagName)) {\r\n\t\tret.push(el);\r\n\t\tconst attrs: Attr[] = Array.prototype.slice.call(el.attributes);\r\n\t\tconst allowedAttrs = allowedAttributes[tagName] || [];\r\n\t\tfor (const attr of attrs) {\r\n\t\t\tif (!allowedAttrs.includes(attr.name)) {\r\n\t\t\t\tel.removeAttribute(attr.name);\r\n\t\t\t} else if (schemaLimitedAttributes.includes(attr.name)) {\r\n\t\t\t\tconst protocolMatch = attr.value.match(protocolMatcher);\r\n\t\t\t\tif (protocolMatch && !allowedSchemas.includes(protocolMatch[1])) {\r\n\t\t\t\t\tel.removeAttribute(attr.name);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst enforce = enforceAttributes[tagName];\r\n\t\tif (enforce) {\r\n\t\t\tfor (const attrName in enforce) {\r\n\t\t\t\tif (!enforce.hasOwnProperty(attrName)) continue;\r\n\t\t\t\tel.setAttribute(attrName, enforce[attrName]);\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\tret.push(document.createTextNode(`<${tagName}>`));\r\n\t\tfor (const subNode of el.childNodes) {\r\n\t\t\tret = ret.concat(sanitizeElement(subNode));\r\n\t\t}\r\n\t\tret.push(document.createTextNode(`</${tagName}>`));\r\n\t}\r\n\treturn ret;\r\n}\r\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue, Prop, Mixins } from 'vue-property-decorator';\r\nimport { PanelMixin } from './panelMixin';\r\nimport environment from '@/environments/environment';\r\nimport { ContentPack } from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\r\nimport { sanitize } from './character-pack-sanitizer';\r\nimport { Store } from 'vuex';\r\nimport { IRootState } from '@/store';\r\n\r\ninterface IPack {\r\n\tname: string;\r\n\tcredits: string;\r\n\tinstalled: boolean;\r\n\tqueuedUninstall: boolean;\r\n\tactive: boolean;\r\n\tfreshInstall: boolean;\r\n\turl: string;\r\n}\r\n\r\n@Component({\r\n\tcomponents: {},\r\n})\r\nexport default class CharacterPackPanel extends Mixins(PanelMixin) {\r\n\tpublic $store!: Store<IRootState>;\r\n\tprivate selectedPack: IPack | null = null;\r\n\tprivate needRestart = false;\r\n\r\n\tprivate created() {\r\n\t\tconst packs = environment.installedCharacterPacks;\r\n\t\tconsole.log('packs:', packs);\r\n\t}\r\n\r\n\tprivate get packs(): IPack[] {\r\n\t\tconst packs = this.$store.state.content.contentPacks;\r\n\t\treturn packs\r\n\t\t\t.filter(pack => pack.packId && !pack.packId.startsWith('dddg.buildin.'))\r\n\t\t\t.map(\r\n\t\t\t\tpack =>\r\n\t\t\t\t\t({\r\n\t\t\t\t\t\tname: pack.packId,\r\n\t\t\t\t\t\tcredits: pack.packCredits,\r\n\t\t\t\t\t\tinstalled: true,\r\n\t\t\t\t\t\tactive: true,\r\n\t\t\t\t\t\tqueuedUninstall: false,\r\n\t\t\t\t\t\tfreshInstall: false,\r\n\t\t\t\t\t\turl: '',\r\n\t\t\t\t\t} as IPack)\r\n\t\t\t);\r\n\t}\r\n\r\n\tprivate select(name: string) {\r\n\t\tthis.selectedPack = this.packs.find(pack => pack.name === name) || null;\r\n\t}\r\n\r\n\tprivate async addNew() {\r\n\t\tconst url = await environment.prompt(\r\n\t\t\t'Enter the URL of the character pack:'\r\n\t\t);\r\n\t\tif (!url) return;\r\n\t\tawait this.$store.dispatch('content/loadContentPacks', url);\r\n\t}\r\n\r\n\tprivate restart() {\r\n\t\tlocation.reload(true);\r\n\t}\r\n\r\n\tprivate get name(): string {\r\n\t\tif (!this.selectedPack) return '';\r\n\t\treturn this.selectedPack.name;\r\n\t}\r\n\tprivate get credits(): string {\r\n\t\tif (!this.selectedPack) return '';\r\n\t\treturn sanitize(this.selectedPack.credits || '');\r\n\t}\r\n\tprivate get activatable(): boolean {\r\n\t\tif (!environment.isPackInstallingSupported) return false;\r\n\t\tif (!this.selectedPack) return false;\r\n\t\tif (!this.selectedPack.installed) return false;\r\n\t\tif (this.selectedPack.queuedUninstall) return false;\r\n\t\tif (this.selectedPack.freshInstall) return false;\r\n\t\treturn !this.selectedPack.active;\r\n\t}\r\n\tprivate get deactivatable(): boolean {\r\n\t\tif (!environment.isPackInstallingSupported) return false;\r\n\t\tif (!this.selectedPack) return false;\r\n\t\tif (!this.selectedPack.installed) return false;\r\n\t\tif (this.selectedPack.queuedUninstall) return false;\r\n\t\tif (this.selectedPack.freshInstall) return false;\r\n\t\treturn this.selectedPack.active;\r\n\t}\r\n\tprivate get installable(): boolean {\r\n\t\tif (!environment.isPackInstallingSupported) return false;\r\n\t\tif (!this.selectedPack) return false;\r\n\t\treturn this.selectedPack.queuedUninstall || !this.selectedPack.installed;\r\n\t}\r\n\tprivate get uninstallable(): boolean {\r\n\t\tif (!environment.isPackInstallingSupported) return false;\r\n\t\tif (!this.selectedPack) return false;\r\n\t\tif (this.selectedPack.freshInstall) return false;\r\n\t\treturn !(this.selectedPack.queuedUninstall || !this.selectedPack.installed);\r\n\t}\r\n\r\n\tprivate install(): void {\r\n\t\tif (!this.selectedPack) return;\r\n\t\tenvironment.installContentPack(this.selectedPack.url);\r\n\t\tif (this.selectedPack.queuedUninstall) {\r\n\t\t\tthis.selectedPack.queuedUninstall = false;\r\n\t\t} else {\r\n\t\t\tthis.selectedPack.installed = true;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate uninstall(): void {\r\n\t\tif (!this.selectedPack) return;\r\n\t\tenvironment.uninstallContentPack(this.selectedPack.url);\r\n\t\tthis.selectedPack.queuedUninstall = true;\r\n\t\tthis.needRestart = true;\r\n\t}\r\n\r\n\tprivate activate(): void {\r\n\t\tif (!this.selectedPack) return;\r\n\t\tenvironment.activateContentPack(this.selectedPack.url);\r\n\t\tthis.selectedPack.active = true;\r\n\t\tthis.needRestart = true;\r\n\t}\r\n\r\n\tprivate deactivate(): void {\r\n\t\tif (!this.selectedPack) return;\r\n\t\tenvironment.deactivateContentPack(this.selectedPack.url);\r\n\t\tthis.selectedPack.active = false;\r\n\t\tthis.needRestart = true;\r\n\t}\r\n}\r\n","import { Module } from 'vuex';\nimport { ContentPack } from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\nimport { IAsset, BackgroundLookup } from './content';\nimport { IRootState } from '.';\nimport { arraySeeker } from '@/models/seekers';\nimport { ICopyObjectsAction, IDeleteAllOfPanel } from './objects';\nimport Vue from 'vue';\n\nexport enum ScalingModes {\n\tNone = 0,\n\tStretch = 1,\n\tCover = 2,\n}\n\nexport interface IPanel {\n\tid: string;\n\tbackground: {\n\t\tcurrent: string;\n\t\tcolor: string;\n\t\tflipped: boolean;\n\t\tvariant: number;\n\t\tscaling: ScalingModes;\n\t};\n\tlastRender: string;\n}\n\nexport interface IPanels {\n\tpanels: { [id: string]: IPanel };\n\tpanelOrder: string[];\n\tcurrentPanel: string;\n}\n\nexport const transparentId = 'buildin.transparent';\nexport const staticColorId = 'buildin.static-color';\n\nlet lastPanelNum = 0;\n\nconst previewManager = {\n\tpanelToUrl: new Map<string, string>(),\n\turlToPanel: new Map<string, string[]>(),\n\tregister(panelId: string, url: string) {\n\t\tif (this.panelToUrl.has(panelId)) {\n\t\t\tif (this.panelToUrl.get(panelId) === url) return;\n\t\t\tthis.unregister(panelId, this.panelToUrl.get(panelId)!);\n\t\t}\n\t\tthis.panelToUrl.set(panelId, url);\n\t\tif (this.urlToPanel.has(url)) {\n\t\t\tthis.urlToPanel.get(url)!.push(panelId);\n\t\t} else {\n\t\t\tthis.urlToPanel.set(url, [panelId]);\n\t\t}\n\t},\n\tunregister(panelId: string, url: string) {\n\t\tif (this.urlToPanel.has(url)) {\n\t\t\tconst panels = this.urlToPanel.get(url)!;\n\t\t\tpanels.splice(panels.indexOf(panelId), 1);\n\t\t\tif (panels.length === 0) {\n\t\t\t\tthis.urlToPanel.delete(url);\n\t\t\t\tURL.revokeObjectURL(url);\n\t\t\t}\n\t\t}\n\t\tthis.panelToUrl.delete(panelId);\n\t},\n};\n\nexport default {\n\tnamespaced: true,\n\tstate: {\n\t\tpanels: {},\n\t\tpanelOrder: [],\n\t\tcurrentPanel: null!,\n\t},\n\tmutations: {\n\t\tsetCurrentPanel(state, { panelId }: ISetCurrentPanelMutation) {\n\t\t\tstate.currentPanel = panelId;\n\t\t},\n\t\tsetPanelPreview(state, { panelId, url }: ISetPanelPreviewMutation) {\n\t\t\tstate.panels[panelId].lastRender = url;\n\t\t\tpreviewManager.register(panelId, url);\n\t\t},\n\t\tcreatePanel(state, { panel }: ICreatePanel) {\n\t\t\tVue.set(state.panels, panel.id, panel);\n\t\t},\n\t\tsetPanelOrder(state, { panelOrder }: ISetPanelOrder) {\n\t\t\tstate.panelOrder = [...panelOrder];\n\t\t},\n\t\tsetCurrentBackground(state, { current, panelId }: ISetCurrentMutation) {\n\t\t\tconst panel = state.panels[panelId];\n\t\t\tpanel.background.current = current;\n\t\t\tpanel.background.variant = 0;\n\t\t},\n\t\tsetBackgroundColor(state, { color, panelId }: ISetColorMutation) {\n\t\t\tconst panel = state.panels[panelId];\n\t\t\tpanel.background.color = color;\n\t\t},\n\t\tsetBackgroundFlipped(state, { flipped, panelId }: ISetFlipMutation) {\n\t\t\tconst panel = state.panels[panelId];\n\t\t\tpanel.background.flipped = flipped;\n\t\t},\n\t\tsetBackgroundVariant(state, { variant, panelId }: ISetVariantMutation) {\n\t\t\tconst panel = state.panels[panelId];\n\t\t\tpanel.background.variant = variant;\n\t\t},\n\t\tsetBackgroundScaling(state, { scaling, panelId }: ISetScalingMutation) {\n\t\t\tconst panel = state.panels[panelId];\n\t\t\tpanel.background.scaling = scaling;\n\t\t},\n\t\tdeletePanel(state, { panelId }: IDeletePanelMutation) {\n\t\t\tpreviewManager.unregister(\n\t\t\t\tpanelId,\n\t\t\t\tpreviewManager.panelToUrl.get(panelId)!\n\t\t\t);\n\t\t\tdelete state.panels[panelId];\n\t\t},\n\t},\n\tactions: {\n\t\tcreatePanel({ state, commit }) {\n\t\t\tconst id = 'panel' + ++lastPanelNum;\n\t\t\tcommit('createPanel', {\n\t\t\t\tpanel: {\n\t\t\t\t\tid,\n\t\t\t\t\tbackground: {\n\t\t\t\t\t\tcolor: '#000000',\n\t\t\t\t\t\tcurrent: transparentId,\n\t\t\t\t\t\tflipped: false,\n\t\t\t\t\t\tscaling: ScalingModes.None,\n\t\t\t\t\t\tvariant: 0,\n\t\t\t\t\t},\n\t\t\t\t\tlastRender: '',\n\t\t\t\t},\n\t\t\t} as ICreatePanel);\n\t\t\tif (!state.panelOrder) {\n\t\t\t\tcommit('setPanelOrder', {\n\t\t\t\t\tpanelOrder: [id],\n\t\t\t\t} as ISetPanelOrder);\n\t\t\t} else {\n\t\t\t\tcommit('setPanelOrder', {\n\t\t\t\t\tpanelOrder: [...state.panelOrder, id],\n\t\t\t\t} as ISetPanelOrder);\n\t\t\t}\n\t\t\tcommit('setCurrentPanel', {\n\t\t\t\tpanelId: id,\n\t\t\t} as ISetCurrentPanelMutation);\n\t\t},\n\t\tduplicatePanel(\n\t\t\t{ state, commit, dispatch },\n\t\t\t{ panelId }: IDuplicatePanelAction\n\t\t) {\n\t\t\tconst panel = state.panels[panelId];\n\t\t\tconst id = 'panel' + ++lastPanelNum;\n\t\t\tpreviewManager.register(id, panel.lastRender);\n\t\t\tcommit('createPanel', {\n\t\t\t\tpanel: {\n\t\t\t\t\tid,\n\t\t\t\t\tbackground: JSON.parse(JSON.stringify(panel.background)),\n\t\t\t\t\tlastRender: panel.lastRender,\n\t\t\t\t},\n\t\t\t} as ICreatePanel);\n\t\t\tdispatch(\n\t\t\t\t'objects/copyObjects',\n\t\t\t\t{\n\t\t\t\t\tsourcePanelId: panelId,\n\t\t\t\t\ttargetPanelId: id,\n\t\t\t\t} as ICopyObjectsAction,\n\t\t\t\t{ root: true }\n\t\t\t);\n\t\t\tconst oldIdx = state.panelOrder.indexOf(panelId);\n\t\t\tcommit('setPanelOrder', {\n\t\t\t\tpanelOrder: [\n\t\t\t\t\t...state.panelOrder.slice(0, oldIdx + 1),\n\t\t\t\t\tid,\n\t\t\t\t\t...state.panelOrder.slice(oldIdx + 1),\n\t\t\t\t],\n\t\t\t} as ISetPanelOrder);\n\t\t\tcommit('setCurrentPanel', {\n\t\t\t\tpanelId: id,\n\t\t\t} as ISetCurrentPanelMutation);\n\t\t},\n\t\tseekBackgroundVariant(\n\t\t\t{ state, rootGetters, commit },\n\t\t\t{ delta }: ISeekVariantAction\n\t\t) {\n\t\t\tconst panel = state.panels[state.currentPanel];\n\t\t\tconst backgrounds = rootGetters[\n\t\t\t\t'content/getBackgrounds'\n\t\t\t] as BackgroundLookup;\n\t\t\tconst background = backgrounds.get(panel.background.current);\n\t\t\tif (!background) return;\n\t\t\tcommit('setBackgroundVariant', {\n\t\t\t\tpanelId: state.currentPanel,\n\t\t\t\tvariant: arraySeeker(\n\t\t\t\t\tbackground.variants,\n\t\t\t\t\tpanel.background.variant,\n\t\t\t\t\tdelta\n\t\t\t\t),\n\t\t\t} as ISetVariantMutation);\n\t\t},\n\t\tdelete({ state, dispatch, commit }, { panelId }: IDeletePanelAction) {\n\t\t\tif (state.panelOrder.length <= 1) return;\n\t\t\tconst orderIdx = state.panelOrder.indexOf(panelId);\n\t\t\tlet newOrderIdx;\n\t\t\tif (orderIdx === state.panelOrder.length - 1) {\n\t\t\t\tnewOrderIdx = orderIdx - 1;\n\t\t\t} else {\n\t\t\t\tnewOrderIdx = orderIdx + 1;\n\t\t\t}\n\t\t\tcommit('setCurrentPanel', {\n\t\t\t\tpanelId: state.panelOrder[newOrderIdx],\n\t\t\t} as ISetCurrentPanelMutation);\n\t\t\tcommit('setPanelOrder', {\n\t\t\t\tpanelOrder: [\n\t\t\t\t\t...state.panelOrder.slice(0, orderIdx),\n\t\t\t\t\t...state.panelOrder.slice(orderIdx + 1),\n\t\t\t\t],\n\t\t\t} as ISetPanelOrder);\n\t\t\tdispatch(\n\t\t\t\t'objects/deleteAllOfPanel',\n\t\t\t\t{\n\t\t\t\t\tpanelId,\n\t\t\t\t} as IDeleteAllOfPanel,\n\t\t\t\t{ root: true }\n\t\t\t);\n\t\t\tcommit('deletePanel', {\n\t\t\t\tpanelId,\n\t\t\t} as IDeletePanelMutation);\n\t\t},\n\t\tasync fixContentPackRemoval(\n\t\t\t{ state, rootGetters, commit, rootState },\n\t\t\toldContent: ContentPack<IAsset>\n\t\t) {\n\t\t\tfor (const panel of Object.values(state.panels)) {\n\t\t\t\tconst oldBackground = oldContent.backgrounds.find(\n\t\t\t\t\tx => x.id === panel.background.current\n\t\t\t\t);\n\t\t\t\t// Probably build in?\n\t\t\t\tif (!oldBackground) return;\n\n\t\t\t\tconst newBackground = (rootGetters[\n\t\t\t\t\t'content/getBackgrounds'\n\t\t\t\t] as BackgroundLookup).get(panel.background.current);\n\n\t\t\t\tif (!newBackground) {\n\t\t\t\t\tif (rootState.content.current.backgrounds[0]) {\n\t\t\t\t\t\tcommit('setCurrentBackground', {\n\t\t\t\t\t\t\tcurrent: rootState.content.current.backgrounds[0].id,\n\t\t\t\t\t\t\tpanelId: panel.id,\n\t\t\t\t\t\t} as ISetCurrentMutation);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcommit('setCurrentBackground', {\n\t\t\t\t\t\t\tcurrent: 'buildin.transparent',\n\t\t\t\t\t\t\tpanelId: panel.id,\n\t\t\t\t\t\t} as ISetCurrentMutation);\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst oldVariantJSON = JSON.stringify(\n\t\t\t\t\toldBackground.variants[panel.background.variant]\n\t\t\t\t);\n\t\t\t\tconst newVariantIdx = newBackground.variants.findIndex(\n\t\t\t\t\tvariant => JSON.stringify(variant) === oldVariantJSON\n\t\t\t\t);\n\t\t\t\tif (newVariantIdx !== panel.background.variant) {\n\t\t\t\t\tcommit('setBackgroundVariant', {\n\t\t\t\t\t\tvariant: newVariantIdx === -1 ? 0 : newVariantIdx,\n\t\t\t\t\t\tpanelId: panel.id,\n\t\t\t\t\t} as ISetVariantMutation);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tmove({ state, commit }, { panelId, delta }: IMovePanelAction) {\n\t\t\tconst collection = [...state.panelOrder];\n\t\t\tconst oldIdx = collection.indexOf(panelId);\n\t\t\tcollection.splice(oldIdx, 1);\n\t\t\tconst newIdx = Math.max(oldIdx + delta, 0);\n\t\t\tcollection.splice(newIdx, 0, panelId);\n\t\t\tcommit('setPanelOrder', { panelOrder: collection } as ISetPanelOrder);\n\t\t},\n\t},\n} as Module<IPanels, IRootState>;\n\nexport interface ISetCurrentPanelMutation {\n\treadonly panelId: string;\n}\n\nexport interface IDeletePanelMutation {\n\treadonly panelId: string;\n}\n\nexport interface ISetPanelPreviewMutation {\n\treadonly panelId: string;\n\treadonly url: string;\n}\n\nexport interface IDuplicatePanelAction {\n\treadonly panelId: string;\n}\n\nexport interface IDeletePanelAction {\n\treadonly panelId: string;\n}\n\nexport interface ICreatePanel {\n\treadonly panel: IPanel;\n}\n\nexport interface ISetPanelOrder {\n\treadonly panelOrder: string[];\n}\n\nexport interface ISetCurrentMutation {\n\treadonly panelId: string;\n\treadonly current: string;\n}\n\nexport interface ISetColorMutation {\n\treadonly panelId: string;\n\treadonly color: string;\n}\n\nexport interface ISetFlipMutation {\n\treadonly panelId: string;\n\treadonly flipped: boolean;\n}\n\nexport interface ISetVariantMutation {\n\treadonly panelId: string;\n\treadonly variant: number;\n}\n\nexport interface ISetScalingMutation {\n\treadonly panelId: string;\n\treadonly scaling: ScalingModes;\n}\n\nexport interface ISeekVariantAction {\n\treadonly delta: 1 | -1;\n}\n\nexport interface IMovePanelAction {\n\treadonly panelId: string;\n\treadonly delta: number;\n}\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./content-pack.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./content-pack.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./content-pack.vue?vue&type=template&id=5eff8ae6&scoped=true&\"\nimport script from \"./content-pack.vue?vue&type=script&lang=ts&\"\nexport * from \"./content-pack.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./content-pack.vue?vue&type=style&index=0&id=5eff8ae6&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5eff8ae6\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"panel\"},[_c('h1',[_vm._v(\"Panels\")]),_c('fieldset',{staticClass:\"existing_panels_fieldset\"},[_c('legend',[_vm._v(\"Existing Panels\")]),_c('div',{staticClass:\"existing_panels\"},_vm._l((_vm.panelButtons),function(panel,idx){return _c('div',{key:panel.id,class:{ panel_button: true, active: panel.id === _vm.currentPanel },style:((\"background-image: url('\" + (panel.image) + \"')\")),on:{\"click\":function($event){return _vm.updateCurrentPanel(panel.id)}}},[_c('div',{staticClass:\"panel_text\"},[_c('p',[_vm._v(_vm._s(panel.text))])]),_c('div',{staticClass:\"panel_nr\"},[_vm._v(_vm._s(idx + 1))])])}),0)]),_c('div',{staticClass:\"column\"},[_c('button',{on:{\"click\":_vm.addNewPanel}},[_vm._v(\"Add new\")]),_c('button',{attrs:{\"disabled\":!_vm.canDeletePanel},on:{\"click\":_vm.deletePanel}},[_vm._v(\"Delete panel\")]),_c('button',{attrs:{\"disabled\":!_vm.canMoveAhead},on:{\"click\":_vm.moveAhead}},[_vm._v(\"Move ahead\")]),_c('button',{attrs:{\"disabled\":!_vm.canMoveBehind},on:{\"click\":_vm.moveBehind}},[_vm._v(\"Move behind\")])]),_c('fieldset',[_c('legend',[_vm._v(\"Export\")]),_c('table',[_c('tr',[_vm._m(0),_c('td',[_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.format),expression:\"format\"}],attrs:{\"id\":\"export_format\"},on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.format=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},[_c('option',{attrs:{\"value\":\"image/png\"}},[_vm._v(\"PNG (lossless)\")]),(_vm.webpSupport)?_c('option',{attrs:{\"value\":\"image/webp\"}},[_vm._v(\"WebP (lossy)\")]):_vm._e(),(_vm.heifSupport)?_c('option',{attrs:{\"value\":\"image/heif\"}},[_vm._v(\"HEIF (lossy)\")]):_vm._e(),_c('option',{attrs:{\"value\":\"image/jpeg\"}},[_vm._v(\"JPEG (lossy)\")])])])]),(_vm.isLossy)?_c('tr',[_vm._m(1),_c('td',[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.quality),expression:\"quality\",modifiers:{\"number\":true}}],attrs:{\"id\":\"export_quality\",\"type\":\"number\",\"min\":\"0\",\"max\":\"100\"},domProps:{\"value\":(_vm.quality)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.quality=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}})])]):_vm._e(),_c('tr',[_vm._m(2),_c('td',[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.ppi),expression:\"ppi\",modifiers:{\"number\":true}}],attrs:{\"id\":\"export_ppi\",\"type\":\"number\",\"min\":\"0\"},domProps:{\"value\":(_vm.ppi)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.ppi=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}})])]),_c('tr',[_c('td',{attrs:{\"colspan\":\"2\"}},[_c('button',{on:{\"click\":_vm.download}},[_vm._v(\"Download\")])])]),_c('tr',[_c('td',{attrs:{\"colspan\":\"2\"}},[_c('button',{on:{\"click\":_vm.estimateExportSize}},[_vm._v(\"Estimate filesizes\")])])])])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('td',[_c('label',{attrs:{\"for\":\"export_format\"}},[_vm._v(\"Format\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('td',[_c('label',{attrs:{\"for\":\"export_quality\"}},[_vm._v(\"Quality:\")])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('td',[_c('label',{attrs:{\"for\":\"export_ppi\"}},[_vm._v(\" Panels per image: \"),_c('br'),_vm._v(\"(0 for one single image) \")])])}]\n\nexport { render, staticRenderFns }","import { RenderContext } from '@/renderer/rendererContext';\r\nimport { getAAsset } from '@/asset-manager';\r\nimport { screenWidth, screenHeight } from './constants';\r\nimport { IAsset } from '@/store/content';\r\nimport { ScalingModes } from '@/store/panels';\r\nimport { DeepReadonly } from '@/util/readonly';\r\n\r\nexport interface IBackground {\r\n\trender(rx: RenderContext): Promise<void>;\r\n}\r\n\r\nexport class Background implements IBackground {\r\n\tpublic constructor(\r\n\t\tpublic readonly assets: DeepReadonly<IAsset[]>,\r\n\t\tpublic readonly flip: boolean,\r\n\t\tpublic readonly scale: ScalingModes\r\n\t) {}\r\n\r\n\tpublic async render(rx: RenderContext): Promise<void> {\r\n\t\tconst images = await Promise.all(\r\n\t\t\tthis.assets.map(asset => getAAsset(asset, rx.hq))\r\n\t\t);\r\n\t\tfor (const image of images) {\r\n\t\t\tif (!(image instanceof HTMLImageElement)) return;\r\n\t\t\tlet x = 0;\r\n\t\t\tlet y = 0;\r\n\t\t\tlet w = image.width;\r\n\t\t\tlet h = image.height;\r\n\r\n\t\t\tswitch (this.scale) {\r\n\t\t\t\tcase ScalingModes.None:\r\n\t\t\t\t\tx = screenWidth / 2 - w / 2;\r\n\t\t\t\t\ty = screenHeight / 2 - h / 2;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ScalingModes.Stretch:\r\n\t\t\t\t\tw = screenWidth;\r\n\t\t\t\t\th = screenHeight;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase ScalingModes.Cover:\r\n\t\t\t\t\tconst ratio = w / h;\r\n\t\t\t\t\tconst screenRatio = screenWidth / screenHeight;\r\n\r\n\t\t\t\t\tif (ratio > screenRatio) {\r\n\t\t\t\t\t\th = screenHeight;\r\n\t\t\t\t\t\tw = h * ratio;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tw = screenWidth;\r\n\t\t\t\t\t\th = w / ratio;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tx = screenWidth / 2 - w / 2;\r\n\t\t\t\t\ty = screenHeight / 2 - h / 2;\r\n\t\t\t}\r\n\r\n\t\t\trx.drawImage({\r\n\t\t\t\timage,\r\n\t\t\t\tx,\r\n\t\t\t\ty,\r\n\t\t\t\tw,\r\n\t\t\t\th,\r\n\t\t\t\tflip: this.flip,\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport const color = {\r\n\tname: 'Static color',\r\n\tcolor: '#000000',\r\n\r\n\tasync render(rx: RenderContext): Promise<void> {\r\n\t\trx.drawRect({ x: 0, y: 0, w: 1280, h: 720, fill: { style: this.color } });\r\n\t},\r\n};\r\n\r\nexport const transparent = {\r\n\tname: 'Transparent',\r\n\t// tslint:disable-next-line: no-empty\r\n\tasync render(rx: RenderContext): Promise<void> {},\r\n};\r\n","import { RenderContext } from '@/renderer/rendererContext';\nimport { getAAsset } from '@/asset-manager';\nimport { IRenderable } from './renderable';\nimport { IDragable } from './dragable';\nimport { ErrorAsset } from './error-asset';\nimport { ISprite } from '@/store/objectTypes/sprite';\nimport eventBus, { InvalidateRenderEvent } from '@/eventbus/event-bus';\nimport { DeepReadonly } from '@/util/readonly';\n\nconst BaseXPosition = 640;\n\nexport class Sprite implements IRenderable, IDragable {\n\tpublic ratio: number = 0;\n\tpublic lockedRatio: boolean = true;\n\tprivate asset: HTMLImageElement | null = null;\n\n\tpublic get id(): string {\n\t\treturn this.obj.id;\n\t}\n\tpublic get infront(): boolean {\n\t\treturn this.obj.onTop;\n\t}\n\n\tpublic constructor(public readonly obj: DeepReadonly<ISprite>) {}\n\n\tpublic async render(selected: boolean, rx: RenderContext) {\n\t\tconst assets = await Promise.all(\n\t\t\tthis.obj.assets.map(asset => getAAsset(asset))\n\t\t);\n\t\tconst x = this.obj.x - this.obj.width / 2;\n\t\tfor (const asset of assets) {\n\t\t\trx.drawImage({\n\t\t\t\timage: asset,\n\t\t\t\tx,\n\t\t\t\ty: this.obj.y,\n\t\t\t\tw: this.obj.width,\n\t\t\t\th: this.obj.height,\n\t\t\t\tshadow: selected && rx.preview ? { blur: 20, color: 'red' } : undefined,\n\t\t\t\tflip: this.obj.flip,\n\t\t\t\topacity: this.obj.opacity,\n\t\t\t});\n\t\t}\n\t}\n\n\tpublic hitTest(hx: number, hy: number): boolean {\n\t\tconst hitX = hx - this.obj.x + this.obj.width / 2;\n\t\tconst hitY = hy - this.obj.y;\n\t\treturn (\n\t\t\thitX >= 0 &&\n\t\t\thitX <= this.obj.width &&\n\t\t\thitY >= 0 &&\n\t\t\thitY <= this.obj.height\n\t\t);\n\t}\n}\n","export class RenderAbortedException {}\n","import { RenderAbortedException } from './renderAbortedException';\nimport { Renderer } from './renderer';\nimport { ErrorAsset } from '@/models/error-asset';\n\nexport class RenderContext {\n\tprivate aborted: boolean = false;\n\n\tpublic constructor(\n\t\tpublic fsCtx: CanvasRenderingContext2D,\n\t\tpublic readonly hq: boolean,\n\t\tpublic readonly preview: boolean\n\t) {}\n\n\tpublic drawText(\n\t\tparams: { text: string; align?: CanvasTextAlign; font?: string } & IRPos &\n\t\t\tIOOutline &\n\t\t\tIOFill\n\t) {\n\t\tif (this.aborted) throw new RenderAbortedException();\n\t\tthis.fsCtx.save();\n\n\t\tconst { font, align, x = 0, y = 0, text = '' } = {\n\t\t\t...{\n\t\t\t\tfont: '20px aller',\n\t\t\t\talign: 'left' as CanvasTextAlign,\n\t\t\t},\n\t\t\t...params,\n\t\t};\n\n\t\tthis.fsCtx.lineJoin = 'round';\n\t\tthis.fsCtx.textAlign = align;\n\t\tthis.fsCtx.font = font;\n\n\t\tif (params.outline) {\n\t\t\tthis.fsCtx.strokeStyle = params.outline.style;\n\t\t\tthis.fsCtx.lineWidth = params.outline.width;\n\t\t\tthis.fsCtx.strokeText(text, x, y);\n\t\t}\n\n\t\tif (params.fill) {\n\t\t\tthis.fsCtx.fillStyle = params.fill.style;\n\t\t\tthis.fsCtx.fillText(text, x, y);\n\t\t}\n\n\t\tthis.fsCtx.restore();\n\t}\n\n\tpublic measureText(\n\t\tparams: {\n\t\t\ttext: string;\n\t\t\talign?: CanvasTextAlign;\n\t\t\tfont?: string;\n\t\t} & IOOutline &\n\t\t\tIOFill\n\t): TextMetrics {\n\t\tif (this.aborted) throw new RenderAbortedException();\n\t\tthis.fsCtx.save();\n\n\t\tconst { font, align, text = '' } = {\n\t\t\t...{\n\t\t\t\tfont: '20px aller',\n\t\t\t\talign: 'left' as CanvasTextAlign,\n\t\t\t},\n\t\t\t...params,\n\t\t};\n\n\t\tthis.fsCtx.lineJoin = 'round';\n\t\tthis.fsCtx.textAlign = align;\n\t\tthis.fsCtx.font = font;\n\n\t\tif (params.outline) {\n\t\t\tthis.fsCtx.strokeStyle = params.outline.style;\n\t\t\tthis.fsCtx.lineWidth = params.outline.width;\n\t\t}\n\n\t\tif (params.fill) {\n\t\t\tthis.fsCtx.fillStyle = params.fill.style;\n\t\t}\n\t\tconst ret = this.fsCtx.measureText(text);\n\t\tthis.fsCtx.restore();\n\t\treturn ret;\n\t}\n\n\tpublic drawImage(\n\t\tparams: {\n\t\t\timage: HTMLImageElement | ErrorAsset | Renderer;\n\t\t\tflip?: boolean;\n\t\t} & IRPos &\n\t\t\tIOSize &\n\t\t\tIOShadow &\n\t\t\tIOOpacity\n\t): void {\n\t\tif (this.aborted) throw new RenderAbortedException();\n\t\tif (params.image instanceof ErrorAsset) return;\n\t\tconst { image, flip, x, y, w, h, opacity } = {\n\t\t\tflip: false,\n\t\t\tw: params.image.width,\n\t\t\th: params.image.height,\n\t\t\topacity: 100,\n\t\t\t...params,\n\t\t};\n\n\t\tthis.fsCtx.save();\n\n\t\tif (opacity < 100) {\n\t\t\tthis.fsCtx.globalAlpha = opacity / 100;\n\t\t}\n\n\t\tif (params.shadow) {\n\t\t\tconst shadow = params.shadow;\n\t\t\tif (shadow.color) {\n\t\t\t\tthis.fsCtx.shadowColor = shadow.color;\n\t\t\t}\n\t\t\tif (shadow.blur) {\n\t\t\t\tthis.fsCtx.shadowBlur = shadow.blur;\n\t\t\t}\n\t\t\tif (shadow.offsetX) {\n\t\t\t\tthis.fsCtx.shadowOffsetX = shadow.offsetX;\n\t\t\t}\n\t\t\tif (shadow.offsetY) {\n\t\t\t\tthis.fsCtx.shadowOffsetY = shadow.offsetY;\n\t\t\t}\n\t\t}\n\n\t\tthis.fsCtx.translate(x + w / 2, y + h / 2);\n\t\tthis.fsCtx.scale(flip ? -1 : 1, 1);\n\n\t\tif (image instanceof Renderer) {\n\t\t\timage.paintOnto(this.fsCtx, -w / 2, -h / 2, w, h);\n\t\t} else {\n\t\t\tthis.fsCtx.drawImage(image as HTMLImageElement, -w / 2, -h / 2, w, h);\n\t\t}\n\n\t\tthis.fsCtx.restore();\n\t}\n\n\tpublic drawRect({\n\t\tx,\n\t\ty,\n\t\tw,\n\t\th,\n\t\toutline,\n\t\tfill,\n\t\tcomposition,\n\t}: IRPos & IRSize & IOOutline & IOFill & IOComposition) {\n\t\tif (this.aborted) throw new RenderAbortedException();\n\t\tthis.fsCtx.save();\n\t\tthis.fsCtx.beginPath();\n\t\tthis.fsCtx.rect(x, y, w, h);\n\n\t\tif (composition) {\n\t\t\tthis.fsCtx.globalCompositeOperation = composition;\n\t\t}\n\n\t\tif (fill) {\n\t\t\tthis.fsCtx.fillStyle = fill.style;\n\t\t\tthis.fsCtx.fill();\n\t\t}\n\t\tif (outline) {\n\t\t\tthis.fsCtx.strokeStyle = outline.style;\n\t\t\tthis.fsCtx.lineWidth = outline.width;\n\t\t\tthis.fsCtx.stroke();\n\t\t}\n\t\tthis.fsCtx.restore();\n\t}\n\n\tpublic drawPath({\n\t\toutline,\n\t\tfill,\n\t\tpath,\n\t}: { path: (ctx: CanvasPath) => void } & IOOutline & IOFill) {\n\t\tif (this.aborted) throw new RenderAbortedException();\n\t\tthis.fsCtx.save();\n\t\tthis.fsCtx.beginPath();\n\t\tpath(this.fsCtx);\n\n\t\tif (fill) {\n\t\t\tthis.fsCtx.fillStyle = fill.style;\n\t\t\tthis.fsCtx.fill();\n\t\t}\n\t\tif (outline) {\n\t\t\tthis.fsCtx.strokeStyle = outline.style;\n\t\t\tthis.fsCtx.lineWidth = outline.width;\n\t\t\tthis.fsCtx.stroke();\n\t\t}\n\t\tthis.fsCtx.restore();\n\t}\n\n\tpublic patternFrom(\n\t\timage: HTMLImageElement | Renderer,\n\t\trepetition: 'repeat' | 'repeat-x' | 'repeat-y' | 'no-repeat' = 'repeat'\n\t): CanvasPattern {\n\t\tif (image instanceof Renderer) {\n\t\t\timage = (image as any).previewCanvas;\n\t\t}\n\t\treturn this.fsCtx.createPattern(\n\t\t\t(image as any) as CanvasImageSource,\n\t\t\trepetition\n\t\t)!;\n\t}\n\n\tpublic customTransform(\n\t\ttransform: (transformContext: CanvasRenderingContext2D) => void,\n\t\trender: (rx: RenderContext) => void\n\t) {\n\t\tthis.fsCtx.save();\n\t\ttransform(this.fsCtx);\n\t\trender(this);\n\t\tthis.fsCtx.restore();\n\t}\n\n\tpublic linearGradient(\n\t\tx0: number,\n\t\ty0: number,\n\t\tx1: number,\n\t\ty1: number\n\t): CanvasGradient {\n\t\treturn this.fsCtx.createLinearGradient(x0, y0, x1, y1);\n\t}\n\n\tpublic abort(): void {\n\t\tthis.aborted = true;\n\t}\n}\n\nconst optSize = { w: 0, h: 0 };\nconst optShadow = {\n\tblur: 0,\n\tcolor: 'none',\n\toffsetX: 0,\n\toffsetY: 0,\n};\n\nexport interface IShadow {\n\tblur?: number;\n\tcolor?: string;\n\toffsetX?: number;\n\toffsetY?: number;\n}\n\nexport interface IOutline {\n\tstyle: string;\n\twidth: number;\n}\n\nexport interface IFill {\n\tstyle: string | CanvasGradient | CanvasPattern;\n}\n\ninterface IOShadow {\n\tshadow?: IShadow;\n}\n\ninterface IOComposition {\n\tcomposition?: CanvasRenderingContext2D['globalCompositeOperation'];\n}\n\ninterface IRPos {\n\tx: number;\n\ty: number;\n}\n\ninterface IRSize {\n\tw: number;\n\th: number;\n}\n\ninterface IOSize {\n\tw?: number;\n\th?: number;\n}\n\ninterface IOOutline {\n\toutline?: IOutline;\n}\ninterface IOOpacity {\n\topacity?: number;\n}\n\ninterface IOFill {\n\tfill?: IFill;\n}\n","import { RenderContext } from './rendererContext';\nimport { RenderAbortedException } from './renderAbortedException';\nimport environment from '../environments/environment';\n\nexport class Renderer {\n\tprivate previewCanvas: HTMLCanvasElement;\n\tprivate runningContext: RenderContext | null = null;\n\n\tpublic constructor(w: number = 1280, h: number = 720) {\n\t\tthis.previewCanvas = document.createElement('canvas');\n\t\tthis.previewCanvas.width = w;\n\t\tthis.previewCanvas.height = h;\n\t}\n\n\tpublic async render(\n\t\trenderCallback: (rc: RenderContext) => Promise<void>,\n\t\thq: boolean = true\n\t): Promise<boolean> {\n\t\tif (this.runningContext) {\n\t\t\tthis.runningContext.abort();\n\t\t}\n\n\t\tconst ctx = this.previewCanvas.getContext('2d')!;\n\t\tctx.clearRect(0, 0, this.previewCanvas.width, this.previewCanvas.height);\n\t\tconst context = (this.runningContext = new RenderContext(ctx, hq, true));\n\t\ttry {\n\t\t\tawait renderCallback(this.runningContext);\n\t\t} catch (e) {\n\t\t\tif (e instanceof RenderAbortedException) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthrow e;\n\t\t} finally {\n\t\t\tif (context === this.runningContext) {\n\t\t\t\tthis.runningContext = null;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tpublic get width(): number {\n\t\treturn this.previewCanvas.width;\n\t}\n\n\tpublic get height(): number {\n\t\treturn this.previewCanvas.height;\n\t}\n\n\tpublic paintOnto(\n\t\tc: CanvasRenderingContext2D,\n\t\tx: number,\n\t\ty: number,\n\t\tw?: number,\n\t\th?: number\n\t) {\n\t\tif (w && h) {\n\t\t\tc.drawImage(this.previewCanvas, x, y, w, h);\n\t\t} else {\n\t\t\tc.drawImage(this.previewCanvas, x, y);\n\t\t}\n\t}\n\n\tpublic async download(\n\t\trenderCallback: (rc: RenderContext) => Promise<void>,\n\t\tfilename: string\n\t): Promise<string> {\n\t\tconst downloadCanvas = document.createElement('canvas');\n\t\tdownloadCanvas.width = this.previewCanvas.width;\n\t\tdownloadCanvas.height = this.previewCanvas.height;\n\n\t\tconst ctx = downloadCanvas.getContext('2d')!;\n\t\tctx.clearRect(0, 0, this.previewCanvas.width, this.previewCanvas.height);\n\t\tawait renderCallback(new RenderContext(ctx, true, false));\n\n\t\treturn environment.saveToFile(downloadCanvas, filename);\n\t}\n\n\tpublic getDataAt(x: number, y: number): Uint8ClampedArray {\n\t\tconst ctx = this.previewCanvas.getContext('2d');\n\n\t\treturn ctx!.getImageData(x, y, 1, 1).data;\n\t}\n}\n","import { RenderContext } from '@/renderer/rendererContext';\r\nimport { getAsset, getAAsset } from '@/asset-manager';\r\nimport { Renderer } from '@/renderer/renderer';\r\nimport { IRenderable } from './renderable';\r\nimport { IDragable } from './dragable';\r\nimport {\r\n\tICharacter,\r\n\tgetPose,\r\n\tgetParts,\r\n\tgetHeads,\r\n\tCloseUpYOffset,\r\n\tgetDataG,\r\n} from '@/store/objectTypes/characters';\r\nimport {\r\n\tPose,\r\n\tCharacter as CharacterModel,\r\n} from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\r\nimport { IAsset } from '@/store/content';\r\nimport { ErrorAsset } from './error-asset';\r\nimport { DeepReadonly } from '@/util/readonly';\r\n\r\nexport class Character implements IRenderable, IDragable {\r\n\tpublic styleData = {\r\n\t\tlastBase: '',\r\n\t\tcomponents: {} as { [component: string]: string },\r\n\t};\r\n\tprivate lq: boolean = true;\r\n\tprivate localRenderer = new Renderer(960, 960);\r\n\tprivate lastVersion = -1;\r\n\tprivate hitDetectionFallback = false;\r\n\r\n\tpublic get id(): string {\r\n\t\treturn this.obj.id;\r\n\t}\r\n\r\n\tpublic constructor(\r\n\t\tpublic readonly obj: ICharacter,\r\n\t\tprivate readonly data: DeepReadonly<CharacterModel<IAsset>>\r\n\t) {}\r\n\r\n\tpublic async updateLocalCanvas() {\r\n\t\tawait this.localRenderer.render(async rx => {\r\n\t\t\tconst pose = getPose(this.data, this.obj) as Pose<IAsset>;\r\n\t\t\tlet assets: Array<IAsset | 'head'> = [];\r\n\t\t\tlet headAssets: DeepReadonly<IAsset[]> = [];\r\n\t\t\tconst partKeys = getParts(this.data, this.obj);\r\n\t\t\tconst currentHeads = getHeads(this.data, this.obj);\r\n\r\n\t\t\tconsole.log(pose.renderOrder);\r\n\t\t\tfor (const renderPart of pose.renderOrder.toLowerCase()) {\r\n\t\t\t\tswitch (renderPart) {\r\n\t\t\t\t\tcase 'l':\r\n\t\t\t\t\t\tassets = ([] as Array<IAsset | 'head'>).concat(\r\n\t\t\t\t\t\t\tassets,\r\n\t\t\t\t\t\t\tpose.left[this.obj.posePositions.left]\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'r':\r\n\t\t\t\t\t\tassets = ([] as Array<IAsset | 'head'>).concat(\r\n\t\t\t\t\t\t\tassets,\r\n\t\t\t\t\t\t\tpose.right[this.obj.posePositions.right]\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 's':\r\n\t\t\t\t\t\tassets = ([] as Array<IAsset | 'head'>).concat(assets, pose.static);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'v':\r\n\t\t\t\t\t\tassets = ([] as Array<IAsset | 'head'>).concat(\r\n\t\t\t\t\t\t\tassets,\r\n\t\t\t\t\t\t\tpose.variant[this.obj.posePositions.variant]\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'h':\r\n\t\t\t\t\t\theadAssets = currentHeads\r\n\t\t\t\t\t\t\t? currentHeads.variants[this.obj.posePositions.head]\r\n\t\t\t\t\t\t\t: [];\r\n\t\t\t\t\t\tassets.push('head');\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tassets = assets.filter(asset => asset);\r\n\t\t\tconst [loadedAssets, loadedHeadAssets]: [\r\n\t\t\t\tArray<HTMLImageElement | ErrorAsset | string>,\r\n\t\t\t\tArray<HTMLImageElement | ErrorAsset>\r\n\t\t\t] = await Promise.all([\r\n\t\t\t\tPromise.all(\r\n\t\t\t\t\tassets.map(asset =>\r\n\t\t\t\t\t\ttypeof asset === 'string'\r\n\t\t\t\t\t\t\t? Promise.resolve(asset)\r\n\t\t\t\t\t\t\t: getAAsset(asset, rx.hq)\r\n\t\t\t\t\t)\r\n\t\t\t\t),\r\n\t\t\t\tPromise.all(headAssets.map(asset => getAAsset(asset, rx.hq))),\r\n\t\t\t]);\r\n\r\n\t\t\tfor (const loadedAsset of loadedAssets) {\r\n\t\t\t\tif (loadedAsset === 'head') {\r\n\t\t\t\t\tfor (const loadedheadAsset of loadedHeadAssets) {\r\n\t\t\t\t\t\trx.drawImage({\r\n\t\t\t\t\t\t\timage: loadedheadAsset,\r\n\t\t\t\t\t\t\tx: pose.headAnchor[0],\r\n\t\t\t\t\t\t\ty: pose.headAnchor[1],\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\trx.drawImage({ image: loadedAsset, x: 0, y: 0 });\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.lastVersion = this.obj.version;\r\n\t\t});\r\n\t}\r\n\r\n\tpublic get width() {\r\n\t\tconst zoom = this.obj.close ? 2 : 1;\r\n\t\treturn this.obj.width * zoom;\r\n\t}\r\n\r\n\tpublic get height() {\r\n\t\tconst zoom = this.obj.close ? 2 : 1;\r\n\t\treturn this.obj.height * zoom;\r\n\t}\r\n\r\n\tpublic get x() {\r\n\t\treturn this.obj.x;\r\n\t}\r\n\r\n\tpublic get y() {\r\n\t\treturn (this.obj.close ? CloseUpYOffset : 0) + this.obj.y;\r\n\t}\r\n\r\n\tpublic async render(selected: boolean, rx: RenderContext) {\r\n\t\tif (this.lastVersion !== this.obj.version || this.lq !== !rx.hq) {\r\n\t\t\tawait this.updateLocalCanvas();\r\n\t\t}\r\n\r\n\t\tconst w = this.width;\r\n\t\tconst h = this.height;\r\n\t\tconst x = this.x - w / 2;\r\n\t\tconst y = this.y;\r\n\r\n\t\trx.drawImage({\r\n\t\t\timage: this.localRenderer,\r\n\t\t\tx,\r\n\t\t\ty,\r\n\t\t\tw,\r\n\t\t\th,\r\n\t\t\tflip: this.obj.flip,\r\n\t\t\tshadow: selected && rx.preview ? { blur: 20, color: 'red' } : undefined,\r\n\t\t\topacity: this.obj.opacity,\r\n\t\t});\r\n\t}\r\n\r\n\tpublic hitTest(hx: number, hy: number): boolean {\r\n\t\tconst scaledX = hx - (this.x - this.width / 2);\r\n\t\tconst scaledY = hy - this.y;\r\n\r\n\t\tif (scaledX < 0 || scaledX > this.width) return false;\r\n\t\tif (scaledY < 0 || scaledY > this.height) return false;\r\n\r\n\t\tif (!this.hitDetectionFallback) {\r\n\t\t\ttry {\r\n\t\t\t\tconst flippedX = this.obj.flip ? this.width - scaledX : scaledX;\r\n\t\t\t\tconst scaleX = 960 / this.width;\r\n\t\t\t\tconst scaleY = 960 / this.height;\r\n\t\t\t\tconst data = this.localRenderer.getDataAt(\r\n\t\t\t\t\tMath.round(flippedX * scaleX),\r\n\t\t\t\t\tMath.round(scaledY * scaleY)\r\n\t\t\t\t);\r\n\t\t\t\treturn data[3] !== 0;\r\n\t\t\t} catch (e) {\r\n\t\t\t\t// On chrome for android, the hit test tends to fail because of cross-origin shenanigans, even though\r\n\t\t\t\t// we only ever load from one origin. ¯\\_(ツ)_/¯\r\n\t\t\t\t// So we have a fallback that doesn't read the contents of the canvas. This looses accuracy, but at\r\n\t\t\t\t// least works always.\r\n\t\t\t\tif (e instanceof DOMException && e.message.includes('cross-origin')) {\r\n\t\t\t\t\tthis.hitDetectionFallback = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow e;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t}\r\n}\r\n","export function roundedRectangle(\n\tctx: CanvasPath,\n\tx: number,\n\ty: number,\n\tw: number,\n\th: number,\n\tr: number\n) {\n\tif (w < 0) w = 0;\n\tif (h < 0) h = 0;\n\tif (w < 2 * r) r = w / 2;\n\tif (h < 2 * r) r = h / 2;\n\tctx.moveTo(x + r, y);\n\tctx.arcTo(x + w, y, x + w, y + h, r);\n\tctx.arcTo(x + w, y + h, x, y + h, r);\n\tctx.arcTo(x, y + h, x, y, r);\n\tctx.arcTo(x, y, x + w, y, r);\n\tctx.closePath();\n}\n\nexport function roundedTopRectangle(\n\tctx: CanvasPath,\n\tx: number,\n\ty: number,\n\tw: number,\n\th: number,\n\tr: number\n) {\n\tif (w < 0) w = 0;\n\tif (h < 0) h = 0;\n\tif (w < 2 * r) r = w / 2;\n\tif (h < 2 * r) r = h / 2;\n\tctx.moveTo(x + r, y);\n\tctx.arcTo(x + w, y, x + w, y + h, r);\n\tctx.lineTo(x + w, y + h);\n\tctx.lineTo(x, y + h);\n\tctx.arcTo(x, y, x + w, y, r);\n\tctx.closePath();\n}\n","import { RenderContext } from '@/renderer/rendererContext';\nimport { getAsset } from '@/asset-manager';\nimport { ITextBox } from '@/store/objectTypes/textbox';\nimport { IRenderable } from './renderable';\nimport {\n\tNameboxTextStyle,\n\tControlsTextStyle,\n\tControlsTextDisabledStyle,\n\tTextBoxWidth,\n\tNameboxHeight,\n\tTextBoxHeight,\n\tTextBoxCorruptedWidth,\n\tNameboxXOffset,\n\tNameboxWidth,\n\tNameboxTextYOffset,\n\tControlsXHistoryOffset,\n\tControlsXSkipOffset,\n\tControlsXStuffOffset,\n\tArrowXRightOffset,\n\tArrowYBottomOffset,\n\tTextBoxTextYOffset,\n\tTextBoxTextXOffset,\n\tControlsYBottomOffset,\n\tGlowRY,\n\tGlowRX,\n} from './textBoxConstants';\nimport { Renderer } from '@/renderer/renderer';\nimport { roundedRectangle, roundedTopRectangle } from '@/renderer/pathTools';\nimport { RGBAColor } from '@/util/colors/rgb';\nimport { HSLAColor } from '@/util/colors/hsl';\nimport { TextRenderer, ITextStyle } from '@/renderer/textRenderer/textRenderer';\n\nexport class TextBox implements IRenderable {\n\tpublic display: boolean = true;\n\tprivate lastVersion = -1;\n\tprivate lastX = 0;\n\tprivate lastY = 0;\n\tprivate lastH = 0;\n\tprivate lastW = 0;\n\tprivate localRenderer = new Renderer(1280, 720);\n\n\tpublic constructor(public obj: ITextBox) {}\n\n\tpublic get id() {\n\t\treturn this.obj.id;\n\t}\n\n\tpublic get width(): number {\n\t\treturn this.obj.style === 'custom' ? this.obj.width : TextBoxWidth;\n\t}\n\n\tpublic get height(): number {\n\t\treturn (\n\t\t\t(this.obj.style === 'custom' ? this.obj.height : TextBoxHeight) +\n\t\t\tNameboxHeight\n\t\t);\n\t}\n\n\tpublic hitTest(hx: number, hy: number): boolean {\n\t\tconst w = this.width;\n\t\tconst h = this.height;\n\n\t\tconst w2 = w / 2;\n\t\tconst x1 = this.obj.x - w2;\n\t\tconst x2 = x1 + w;\n\t\tconst y1 = this.obj.y;\n\t\tconst y2 = y1 + h;\n\t\treturn x1 <= hx && x2 >= hx && y1 <= hy && y2 >= hy;\n\t}\n\n\tpublic async render(selected: boolean, rx: RenderContext) {\n\t\tif (\n\t\t\tthis.lastVersion !== this.obj.version ||\n\t\t\tthis.lastX !== this.obj.x ||\n\t\t\tthis.lastY !== this.obj.y ||\n\t\t\tthis.lastH !== this.obj.height ||\n\t\t\tthis.lastW !== this.obj.width\n\t\t) {\n\t\t\tawait this.updateLocalCanvas();\n\t\t\tthis.lastVersion = this.obj.version;\n\t\t\tthis.lastX = this.obj.x;\n\t\t\tthis.lastY = this.obj.y;\n\t\t}\n\n\t\trx.drawImage({\n\t\t\timage: this.localRenderer,\n\t\t\tx: 0,\n\t\t\ty: 0,\n\t\t\tflip: this.obj.flip,\n\t\t\tshadow: selected && rx.preview ? { blur: 20, color: 'red' } : undefined,\n\t\t\topacity: this.obj.opacity,\n\t\t});\n\t}\n\n\tpublic get controlColor(): string {\n\t\tif (this.obj.deriveCustomColors) {\n\t\t\tconst base = RGBAColor.fromCss(this.obj.customColor).toHSL();\n\t\t\tconst delta = new HSLAColor(\n\t\t\t\t0.08045977011494243,\n\t\t\t\t-0.5714285714285714,\n\t\t\t\t-0.5960784313725489,\n\t\t\t\t0\n\t\t\t);\n\t\t\treturn base\n\t\t\t\t.shift(delta)\n\t\t\t\t.toRgb()\n\t\t\t\t.toCss();\n\t\t}\n\t\treturn this.obj.customControlsColor;\n\t}\n\n\tpublic get controlsStyle() {\n\t\tif (this.obj.style !== 'custom') return ControlsTextStyle;\n\t\treturn {\n\t\t\t...ControlsTextStyle,\n\t\t\tfill: {\n\t\t\t\tstyle: this.controlColor,\n\t\t\t},\n\t\t};\n\t}\n\n\tpublic get controlsDisableStyle() {\n\t\tif (this.obj.style !== 'custom') return ControlsTextDisabledStyle;\n\n\t\tconst col = RGBAColor.fromCss(this.controlColor).toHSL();\n\t\tconst delta = new HSLAColor(0, -0.14285714285714296, 0.3, 0);\n\t\tconst disColor = col\n\t\t\t.shift(delta)\n\t\t\t.toRgb()\n\t\t\t.toCss();\n\n\t\treturn {\n\t\t\t...ControlsTextStyle,\n\n\t\t\tfill: {\n\t\t\t\tstyle: disColor,\n\t\t\t},\n\t\t};\n\t}\n\n\tpublic async updateLocalCanvas() {\n\t\tconst base = RGBAColor.fromCss(this.obj.customColor).toHSL();\n\t\tconst target = RGBAColor.fromCss('#552222').toHSL();\n\n\t\tawait this.localRenderer.render(async rx => {\n\t\t\tconst w = this.width;\n\t\t\tconst h = this.height;\n\t\t\tconst w2 = w / 2;\n\t\t\tconst x = this.obj.x - w2;\n\t\t\tconst y = this.obj.y;\n\n\t\t\tawait this.renderBackdrop(rx, x, y + NameboxHeight);\n\n\t\t\tif (this.obj.talkingDefault !== 'No-one') {\n\t\t\t\tconst name =\n\t\t\t\t\tthis.obj.talkingDefault === 'Other'\n\t\t\t\t\t\t? this.obj.talkingOther\n\t\t\t\t\t\t: this.obj.talkingDefault;\n\t\t\t\tawait this.renderNamebox(rx, x + NameboxXOffset, y, name);\n\t\t\t}\n\n\t\t\tthis.renderText(rx, x, y);\n\n\t\t\tconst bottom = y + h;\n\t\t\tconst controlsY = bottom - ControlsYBottomOffset;\n\t\t\tconst controlsCenter = x + w / 2;\n\n\t\t\tif (this.obj.controls) {\n\t\t\t\trx.drawText({\n\t\t\t\t\ttext: 'History',\n\t\t\t\t\tx: controlsCenter + ControlsXHistoryOffset,\n\t\t\t\t\ty: controlsY,\n\t\t\t\t\t...this.controlsStyle,\n\t\t\t\t});\n\t\t\t\trx.drawText({\n\t\t\t\t\ttext: 'Skip',\n\t\t\t\t\tx: controlsCenter + ControlsXSkipOffset,\n\t\t\t\t\ty: controlsY,\n\t\t\t\t\t...(this.obj.skip ? this.controlsStyle : this.controlsDisableStyle),\n\t\t\t\t});\n\t\t\t\trx.drawText({\n\t\t\t\t\ttext: 'Auto   Save   Load   Settings',\n\t\t\t\t\tx: controlsCenter + ControlsXStuffOffset,\n\t\t\t\t\ty: controlsY,\n\t\t\t\t\t...this.controlsStyle,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (this.obj.continue) {\n\t\t\t\trx.drawImage({\n\t\t\t\t\timage: await getAsset('next'),\n\t\t\t\t\tx: x + w - ArrowXRightOffset,\n\t\t\t\t\ty: bottom - ArrowYBottomOffset,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate get nameboxOutlineColor(): string {\n\t\tif (this.obj.deriveCustomColors) {\n\t\t\tconst base = RGBAColor.fromCss(this.obj.customColor).toHSL();\n\t\t\tconst delta = new HSLAColor(\n\t\t\t\t-0.03065134099616873,\n\t\t\t\t-0.5714285714285714,\n\t\t\t\t-0.29607843137254896,\n\t\t\t\t0\n\t\t\t);\n\t\t\treturn base\n\t\t\t\t.shift(delta)\n\t\t\t\t.toRgb()\n\t\t\t\t.toCss();\n\t\t}\n\t\treturn this.obj.customNameboxStroke;\n\t}\n\n\tprivate get nameboxBackgroundColor(): string {\n\t\tif (this.obj.deriveCustomColors) {\n\t\t\tconst base = RGBAColor.fromCss(this.obj.customColor).toHSL();\n\t\t\tconst delta = new HSLAColor(\n\t\t\t\t0.002028397565922768,\n\t\t\t\t0,\n\t\t\t\t0.13725490196078438,\n\t\t\t\t0\n\t\t\t);\n\t\t\treturn base\n\t\t\t\t.shift(delta)\n\t\t\t\t.toRgb()\n\t\t\t\t.toCss();\n\t\t}\n\t\treturn this.obj.customNameboxColor;\n\t}\n\n\tprivate async renderNamebox(\n\t\trx: RenderContext,\n\t\tx: number,\n\t\ty: number,\n\t\tname: string\n\t): Promise<void> {\n\t\tlet w: number;\n\t\tconst h = NameboxHeight;\n\t\tlet style: ITextStyle = NameboxTextStyle;\n\t\tif (this.obj.style === 'custom') {\n\t\t\tconst hslOutline = RGBAColor.fromCss(this.nameboxOutlineColor).toHSL();\n\t\t\tstyle = {\n\t\t\t\t...style,\n\t\t\t\tstrokeColor: this.nameboxOutlineColor,\n\t\t\t\tstrokeWidth: 6,\n\t\t\t\tcolor: hslOutline.l > 0.6 ? '#000000' : '#FFFFFF',\n\t\t\t};\n\t\t\tw = this.obj.customNameboxWidth;\n\t\t\trx.customTransform(\n\t\t\t\tctx => {\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\troundedTopRectangle(ctx, x, y, w, h, 12);\n\t\t\t\t\tctx.clip();\n\t\t\t\t},\n\t\t\t\tsubRx => {\n\t\t\t\t\tconst gradient = subRx.linearGradient(x, y, x, y + NameboxHeight);\n\t\t\t\t\tconst baseBG = RGBAColor.fromCss(this.nameboxBackgroundColor);\n\t\t\t\t\tconst color = new RGBAColor(baseBG.r, baseBG.g, baseBG.b, 244);\n\t\t\t\t\tconst delta = new HSLAColor(\n\t\t\t\t\t\t-0.004901960784313708,\n\t\t\t\t\t\t-0.8599999999999999,\n\t\t\t\t\t\t-0.16274509803921566,\n\t\t\t\t\t\t0\n\t\t\t\t\t);\n\t\t\t\t\tconst targetColor = color\n\t\t\t\t\t\t.toHSL()\n\t\t\t\t\t\t.shift(delta)\n\t\t\t\t\t\t.toRgb();\n\t\t\t\t\tgradient.addColorStop(0, color.toCss());\n\t\t\t\t\tgradient.addColorStop(0.82, color.toCss());\n\t\t\t\t\tgradient.addColorStop(1, targetColor.toCss());\n\t\t\t\t\tsubRx.drawRect({\n\t\t\t\t\t\tx,\n\t\t\t\t\t\ty,\n\t\t\t\t\t\tw: this.obj.width,\n\t\t\t\t\t\th,\n\t\t\t\t\t\tfill: {\n\t\t\t\t\t\t\tstyle: gradient,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t);\n\t\t} else {\n\t\t\tw = NameboxWidth;\n\t\t\trx.drawImage({\n\t\t\t\timage: await getAsset('namebox'),\n\t\t\t\tx,\n\t\t\t\ty,\n\t\t\t});\n\t\t}\n\n\t\tconst render = new TextRenderer(name, style);\n\n\t\trender.fixAlignment('center', x, x + w, y + NameboxTextYOffset);\n\n\t\trender.render(rx.fsCtx);\n\t}\n\n\tprivate async renderBackdrop(\n\t\trx: RenderContext,\n\t\tx: number,\n\t\ty: number\n\t): Promise<void> {\n\t\tif (this.obj.style === 'custom') {\n\t\t\tconst hslColor = RGBAColor.fromCss(this.obj.customColor).toHSL();\n\t\t\tconst dotPattern = new Renderer(47, 47);\n\t\t\tdotPattern.render(async (dotRx: RenderContext) => {\n\t\t\t\tconst fillDelta = new HSLAColor(\n\t\t\t\t\t0.004269293924466178,\n\t\t\t\t\t-0.01869158878504662,\n\t\t\t\t\t-0.039215686274509665,\n\t\t\t\t\t0\n\t\t\t\t);\n\t\t\t\tconst fill = {\n\t\t\t\t\tstyle: hslColor\n\t\t\t\t\t\t.shift(fillDelta)\n\t\t\t\t\t\t.toRgb()\n\t\t\t\t\t\t.toCss(),\n\t\t\t\t};\n\n\t\t\t\tfunction drawDot(dotX: number, dotY: number) {\n\t\t\t\t\tdotRx.drawPath({\n\t\t\t\t\t\tpath: ctx => {\n\t\t\t\t\t\t\tctx.ellipse(dotX, dotY, 9.5, 9.5, 0, 0, 2 * Math.PI);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfill,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tdrawDot(0, 0);\n\t\t\t\tdrawDot(47, 0);\n\t\t\t\tdrawDot(0, 47);\n\t\t\t\tdrawDot(47, 47);\n\t\t\t\tdrawDot(23.5, 24.5);\n\t\t\t}, true);\n\t\t\trx.customTransform(\n\t\t\t\tctx => {\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\troundedRectangle(\n\t\t\t\t\t\tctx,\n\t\t\t\t\t\tx + 1.5,\n\t\t\t\t\t\ty + 1.5,\n\t\t\t\t\t\tthis.obj.width - 3,\n\t\t\t\t\t\tthis.obj.height - 3,\n\t\t\t\t\t\t12\n\t\t\t\t\t);\n\t\t\t\t\tctx.clip();\n\t\t\t\t},\n\t\t\t\tsubRx => {\n\t\t\t\t\tconst h = this.obj.height;\n\t\t\t\t\tconst w = this.obj.width;\n\t\t\t\t\tconst gradient = subRx.linearGradient(x, y, x, y + h);\n\t\t\t\t\tconst color = RGBAColor.fromHex(this.obj.customColor);\n\t\t\t\t\tgradient.addColorStop(0, color.toCss());\n\t\t\t\t\tgradient.addColorStop(\n\t\t\t\t\t\t1,\n\t\t\t\t\t\t`rgba(${color.r},${color.g},${color.b},0.6667)`\n\t\t\t\t\t);\n\t\t\t\t\tsubRx.drawRect({\n\t\t\t\t\t\tx,\n\t\t\t\t\t\ty,\n\t\t\t\t\t\tw,\n\t\t\t\t\t\th,\n\t\t\t\t\t\tfill: {\n\t\t\t\t\t\t\tstyle: gradient,\n\t\t\t\t\t\t},\n\t\t\t\t\t\toutline: {\n\t\t\t\t\t\t\tstyle: '#ffdfee',\n\t\t\t\t\t\t\twidth: 6,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\tsubRx.customTransform(\n\t\t\t\t\t\tctx => {\n\t\t\t\t\t\t\tctx.translate(x, y);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsubSubRx => {\n\t\t\t\t\t\t\tconst pattern = subRx.patternFrom(dotPattern);\n\t\t\t\t\t\t\tsubRx.drawRect({\n\t\t\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\t\t\ty: 0,\n\t\t\t\t\t\t\t\tw,\n\t\t\t\t\t\t\t\th,\n\t\t\t\t\t\t\t\tfill: {\n\t\t\t\t\t\t\t\t\tstyle: pattern,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcomposition: 'source-atop',\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tconst glowGradient = subRx.linearGradient(\n\t\t\t\t\t\tx,\n\t\t\t\t\t\ty + h - GlowRY,\n\t\t\t\t\t\tx,\n\t\t\t\t\t\ty + h\n\t\t\t\t\t);\n\t\t\t\t\tglowGradient.addColorStop(0, 'rgba(255,255,255,0.3137)');\n\t\t\t\t\tglowGradient.addColorStop(0.5, 'rgba(255,255,255,0.0627)');\n\t\t\t\t\tglowGradient.addColorStop(1, 'rgba(255,255,255,0)');\n\t\t\t\t\tsubRx.drawPath({\n\t\t\t\t\t\tpath: ctx => {\n\t\t\t\t\t\t\tctx.ellipse(x + w / 2, y + h, GlowRX, GlowRY, 0, 0, 2 * Math.PI);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfill: {\n\t\t\t\t\t\t\tstyle: glowGradient,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t);\n\t\t\tconst outlineDelta = new HSLAColor(\n\t\t\t\t0.0023347701149424305,\n\t\t\t\t0,\n\t\t\t\t0.10784313725490202,\n\t\t\t\t0\n\t\t\t);\n\t\t\tconst outlineColor = hslColor\n\t\t\t\t.shift(outlineDelta)\n\t\t\t\t.toRgb()\n\t\t\t\t.toCss();\n\t\t\trx.drawPath({\n\t\t\t\tpath: path => {\n\t\t\t\t\troundedRectangle(\n\t\t\t\t\t\tpath,\n\t\t\t\t\t\tx + 1.5,\n\t\t\t\t\t\ty + 1.5,\n\t\t\t\t\t\tthis.obj.width - 3,\n\t\t\t\t\t\tthis.obj.height - 3,\n\t\t\t\t\t\t12\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\toutline: {\n\t\t\t\t\tstyle: outlineColor,\n\t\t\t\t\twidth: 3,\n\t\t\t\t},\n\t\t\t});\n\t\t} else {\n\t\t\tif (this.obj.style === 'corrupt') {\n\t\t\t\tx += (TextBoxWidth - TextBoxCorruptedWidth) / 2;\n\t\t\t}\n\t\t\tconst image = await getAsset(\n\t\t\t\tthis.obj.style === 'corrupt' ? 'textbox_monika' : 'textbox'\n\t\t\t);\n\t\t\trx.drawImage({ image, x, y });\n\t\t}\n\t}\n\n\tprivate renderText(rx: RenderContext, baseX: number, baseY: number): void {\n\t\tconst render = new TextRenderer(this.obj.text, {\n\t\t\talpha: 1,\n\t\t\tcolor: '#ffffff',\n\t\t\tfontName: 'aller',\n\t\t\tfontSize: 24,\n\t\t\tisBold: false,\n\t\t\tisItalic: false,\n\t\t\tisStrikethrough: false,\n\t\t\tisUnderlined: false,\n\t\t\tletterSpacing: 0,\n\t\t\tstrokeColor: '#523140',\n\t\t\tstrokeWidth: 4,\n\t\t\tlineSpacing: 1.2,\n\t\t});\n\t\tif (this.obj.autoQuoting) {\n\t\t\trender.quote();\n\t\t}\n\n\t\trender.fixAlignment(\n\t\t\t'left',\n\t\t\tbaseX + TextBoxTextXOffset,\n\t\t\t0,\n\t\t\tbaseY + NameboxHeight + TextBoxTextYOffset\n\t\t);\n\n\t\trender.render(rx.fsCtx);\n\t}\n}\n\ninterface DialogLetter {\n\tl: string;\n\tb: boolean;\n}\n","import { Store } from 'vuex';\r\nimport { IRootState } from '@/store';\r\nimport { IRenderable } from './renderable';\r\nimport { IBackground, color, Background } from './background';\r\nimport { IPanel } from '@/store/panels';\r\nimport { DeepReadonly } from '@/util/readonly';\r\nimport { ISprite } from '@/store/objectTypes/sprite';\r\nimport { Sprite } from './sprite';\r\nimport { Character } from './character';\r\nimport { ICharacter, getData } from '@/store/objectTypes/characters';\r\nimport { ITextBox } from '@/store/objectTypes/textbox';\r\nimport { TextBox } from './textbox';\r\nimport { RenderContext } from '@/renderer/rendererContext';\r\nimport { getAsset } from '@/asset-manager';\r\nimport { Renderer } from '@/renderer/renderer';\r\nimport leftPad from 'left-pad';\r\n\r\nexport class SceneRenderer {\r\n\tprivate renderObjectCache = new Map<string, IRenderable>();\r\n\tprivate state: DeepReadonly<IRootState>;\r\n\tprivate _currentlyRendering = false;\r\n\tprivate renderer: Renderer;\r\n\r\n\tpublic constructor(\r\n\t\tprivate store: Store<DeepReadonly<IRootState>>,\r\n\t\tprivate panelId: string,\r\n\t\treadonly canvasWidth: number,\r\n\t\treadonly canvasHeight: number\r\n\t) {\r\n\t\tthis.state = store.state;\r\n\t\tthis.renderer = new Renderer(canvasWidth, canvasHeight);\r\n\t}\r\n\r\n\tpublic render(hq: boolean): Promise<boolean> {\r\n\t\treturn this.renderer.render(this.renderCallback.bind(this), hq);\r\n\t}\r\n\r\n\tpublic download(): Promise<string> {\r\n\t\tconst date = new Date();\r\n\t\tconst filename = `panel-${date.getFullYear()}-${leftPad(\r\n\t\t\tdate.getMonth() + 1,\r\n\t\t\t2,\r\n\t\t\t'0'\r\n\t\t)}-${leftPad(date.getDate(), 2, '0')}-${leftPad(\r\n\t\t\tdate.getHours(),\r\n\t\t\t2,\r\n\t\t\t'0'\r\n\t\t)}-${leftPad(date.getMinutes(), 2, '0')}-${leftPad(\r\n\t\t\tdate.getSeconds(),\r\n\t\t\t2,\r\n\t\t\t'0'\r\n\t\t)}.png`;\r\n\t\treturn this.renderer.download(this.renderCallback.bind(this), filename);\r\n\t}\r\n\r\n\tpublic get currentlyRendering() {\r\n\t\treturn this._currentlyRendering;\r\n\t}\r\n\r\n\tpublic paintOnto(\r\n\t\tc: CanvasRenderingContext2D,\r\n\t\tx: number,\r\n\t\ty: number,\r\n\t\tw?: number,\r\n\t\th?: number\r\n\t) {\r\n\t\tthis.renderer.paintOnto(c, x, y, w, h);\r\n\t}\r\n\r\n\tpublic objectsAt(x: number, y: number): string[] {\r\n\t\treturn this.getRenderObjects()\r\n\t\t\t.filter(renderObject => renderObject.hitTest(x, y))\r\n\t\t\t.map(renderObject => renderObject.id);\r\n\t}\r\n\r\n\tprivate async renderCallback(rx: RenderContext): Promise<void> {\r\n\t\tthis._currentlyRendering = true;\r\n\t\ttry {\r\n\t\t\tif (rx.preview) {\r\n\t\t\t\trx.drawImage({\r\n\t\t\t\t\tx: 0,\r\n\t\t\t\t\ty: 0,\r\n\t\t\t\t\timage: await getAsset('backgrounds/transparent'),\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tawait this.getBackgroundRenderer()?.render(rx);\r\n\t\t\t/*\r\n\t\t\t\tawait this.currentBackground.render(rx);\r\n\t\t\t}*/\r\n\r\n\t\t\tconst selection = this.state.ui.selection;\r\n\t\t\tfor (const object of this.getRenderObjects()) {\r\n\t\t\t\tawait object.render(selection === object.id, rx);\r\n\t\t\t}\r\n\t\t} finally {\r\n\t\t\tthis._currentlyRendering = false;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate getRenderObjects() {\r\n\t\tconst objectsState = this.state.objects.panels[this.panelId];\r\n\t\tconst order = [...objectsState.order, ...objectsState.onTopOrder];\r\n\t\tconst objects = this.state.objects.objects;\r\n\t\tconst toUncache = Object.keys(this.renderObjectCache).filter(\r\n\t\t\tid => !order.includes(id)\r\n\t\t);\r\n\r\n\t\tfor (const id of toUncache) {\r\n\t\t\tthis.renderObjectCache.delete(id);\r\n\t\t}\r\n\r\n\t\treturn order.map(id => {\r\n\t\t\tif (!this.renderObjectCache.has(id)) {\r\n\t\t\t\tconst obj = objects[id];\r\n\t\t\t\tswitch (obj.type) {\r\n\t\t\t\t\tcase 'sprite':\r\n\t\t\t\t\t\tthis.renderObjectCache.set(\r\n\t\t\t\t\t\t\tid,\r\n\t\t\t\t\t\t\tnew Sprite(obj as DeepReadonly<ISprite>)\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'character':\r\n\t\t\t\t\t\tconst char = obj as DeepReadonly<ICharacter>;\r\n\t\t\t\t\t\tthis.renderObjectCache.set(\r\n\t\t\t\t\t\t\tid,\r\n\t\t\t\t\t\t\tnew Character(char, getData(this.store, char))\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'textBox':\r\n\t\t\t\t\t\tthis.renderObjectCache.set(\r\n\t\t\t\t\t\t\tid,\r\n\t\t\t\t\t\t\tnew TextBox(obj as DeepReadonly<ITextBox>)\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst renderObject = this.renderObjectCache.get(id)!;\r\n\t\t\trenderObject.obj = objects[id];\r\n\t\t\treturn renderObject;\r\n\t\t});\r\n\t}\r\n\r\n\tprivate get panel(): DeepReadonly<IPanel> {\r\n\t\treturn this.state.panels.panels[this.panelId];\r\n\t}\r\n\r\n\tprivate getBackgroundRenderer(): IBackground | null {\r\n\t\tconst panel = this.panel;\r\n\t\tswitch (panel.background.current) {\r\n\t\t\tcase 'buildin.static-color':\r\n\t\t\t\tcolor.color = panel.background.color;\r\n\t\t\t\treturn color;\r\n\t\t\tdefault:\r\n\t\t\t\tconst current = this.state.content.current.backgrounds.find(\r\n\t\t\t\t\tbackground => background.id === panel.background.current\r\n\t\t\t\t)!;\r\n\t\t\t\tif (!current) return null;\r\n\t\t\t\tconst variant = current.variants[panel.background.variant];\r\n\t\t\t\tif (!variant) return null;\r\n\t\t\t\treturn new Background(\r\n\t\t\t\t\tvariant,\r\n\t\t\t\t\tpanel.background.flipped,\r\n\t\t\t\t\tpanel.background.scaling\r\n\t\t\t\t);\r\n\t\t}\r\n\t}\r\n}\r\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Mixins, Watch } from 'vue-property-decorator';\r\nimport { Store } from 'vuex';\r\nimport { IRootState } from '@/store';\r\nimport { PanelMixin } from './panelMixin';\r\nimport panels, {\r\n\tIPanel,\r\n\tIDuplicatePanelAction,\r\n\tISetCurrentPanelMutation,\r\n\tIDeletePanelAction,\r\n\tISetPanelPreviewMutation,\r\n\tIMovePanelAction,\r\n} from '@/store/panels';\r\nimport { State } from 'vuex-class-decorator';\r\nimport { getAAsset, isWebPSupported } from '@/asset-manager';\r\nimport { ITextBox } from '@/store/objectTypes/textbox';\r\nimport { IHistorySupport } from '@/plugins/vuex-history';\r\nimport { SceneRenderer } from '@/models/scene-renderer';\r\nimport { DeepReadonly } from '@/util/readonly';\r\nimport environment from '@/environments/environment';\r\nimport leftPad from 'left-pad';\r\nimport eventBus, { ShowMessageEvent } from '../../../eventbus/event-bus';\r\n\r\ninterface IPanelButton {\r\n\tid: string;\r\n\timage: string;\r\n\ttext: string;\r\n}\r\n\r\n@Component({})\r\nexport default class PanelsPanel extends Mixins(PanelMixin) {\r\n\tpublic $store!: Store<DeepReadonly<IRootState>>;\r\n\tprivate vuexHistory!: IHistorySupport;\r\n\r\n\t@State('currentPanel', { namespace: 'panels' })\r\n\tprivate currentPanel!: string;\r\n\r\n\tprivate webpSupport = false;\r\n\tprivate heifSupport = false;\r\n\tprivate ppi = 0;\r\n\tprivate format = 'image/png';\r\n\tprivate quality = 90;\r\n\r\n\tpublic async created() {\r\n\t\tthis.webpSupport = await isWebPSupported();\r\n\t}\r\n\r\n\tpublic async mounted() {\r\n\t\tthis.moveFocusToActivePanel();\r\n\r\n\t\tconst sceneRenderer = new SceneRenderer(\r\n\t\t\tthis.$store,\r\n\t\t\tthis.currentPanel,\r\n\t\t\t1280,\r\n\t\t\t720\r\n\t\t);\r\n\r\n\t\tawait sceneRenderer.render(false);\r\n\r\n\t\tconst targetCanvas = document.createElement('canvas');\r\n\t\ttargetCanvas.width = 1280 / 4;\r\n\t\ttargetCanvas.height = 720 / 4;\r\n\r\n\t\tsceneRenderer.paintOnto(\r\n\t\t\ttargetCanvas.getContext('2d')!,\r\n\t\t\t0,\r\n\t\t\t0,\r\n\t\t\ttargetCanvas.width,\r\n\t\t\ttargetCanvas.height\r\n\t\t);\r\n\t\ttargetCanvas.toBlob(\r\n\t\t\tblob => {\r\n\t\t\t\tif (!blob) return;\r\n\t\t\t\tconst url = URL.createObjectURL(blob);\r\n\t\t\t\tthis.vuexHistory.transaction(() => {\r\n\t\t\t\t\tthis.$store.commit('panels/setPanelPreview', {\r\n\t\t\t\t\t\tpanelId: this.$store.state.panels.currentPanel,\r\n\t\t\t\t\t\turl,\r\n\t\t\t\t\t} as ISetPanelPreviewMutation);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t(await isWebPSupported()) ? 'image/webp' : 'image/jpeg',\r\n\t\t\t0.5\r\n\t\t);\r\n\t}\r\n\r\n\tprivate get isLossy(): boolean {\r\n\t\treturn this.format !== 'image/png';\r\n\t}\r\n\r\n\tprivate async download() {\r\n\t\tconst distribution = this.getPanelDistibution();\r\n\t\tconst date = new Date();\r\n\t\tconst prefix = `cd-${date.getFullYear()}-${leftPad(\r\n\t\t\tdate.getMonth() + 1,\r\n\t\t\t2,\r\n\t\t\t'0'\r\n\t\t)}-${leftPad(date.getDate(), 2, '0')}-${leftPad(\r\n\t\t\tdate.getHours(),\r\n\t\t\t2,\r\n\t\t\t'0'\r\n\t\t)}-${leftPad(date.getMinutes(), 2, '0')}-${leftPad(\r\n\t\t\tdate.getSeconds(),\r\n\t\t\t2,\r\n\t\t\t'0'\r\n\t\t)}`;\r\n\t\tconst extension = this.format.split('/')[1];\r\n\t\tconst format = this.format;\r\n\t\tconst quality = this.quality;\r\n\t\tawait this.renderObjects(\r\n\t\t\tdistribution,\r\n\t\t\ttrue,\r\n\t\t\tasync (imageIdx: number, canvas: HTMLCanvasElement) => {\r\n\t\t\t\tenvironment.saveToFile(\r\n\t\t\t\t\tcanvas,\r\n\t\t\t\t\t`${prefix}_${imageIdx}.${extension}`,\r\n\t\t\t\t\tformat,\r\n\t\t\t\t\tquality / 100\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tprivate async estimateExportSize() {\r\n\t\tconst distribution = this.getPanelDistibution();\r\n\t\tconst format = this.format || 'image/png';\r\n\t\tconst quality = this.quality || 0.9;\r\n\t\tconst estimateFactor = 1.5;\r\n\t\tconst sizes = await this.renderObjects(\r\n\t\t\tdistribution,\r\n\t\t\tfalse,\r\n\t\t\tasync (imageIdx: number, canvas: HTMLCanvasElement) => {\r\n\t\t\t\treturn new Promise<number>((resolve, reject) => {\r\n\t\t\t\t\tcanvas.toBlob(\r\n\t\t\t\t\t\tblob => {\r\n\t\t\t\t\t\t\tif (!blob) {\r\n\t\t\t\t\t\t\t\treject(`Image ${imageIdx + 1} could not be rendered.`);\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tresolve(blob.size);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tformat,\r\n\t\t\t\t\t\tquality\r\n\t\t\t\t\t);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t);\r\n\t\tconst readableSizes = sizes.map(\r\n\t\t\tsize => ((size * estimateFactor) / 1024 / 1024).toFixed(2) + 'MiB'\r\n\t\t);\r\n\t\tconst filePluralize = readableSizes.length > 1 ? 'files' : 'file';\r\n\t\tconst itPluralize = readableSizes.length > 1 ? 'These' : 'It';\r\n\t\tconst sizePluralize = readableSizes.length > 1 ? 'sizes' : 'size';\r\n\t\teventBus.fire(\r\n\t\t\tnew ShowMessageEvent(\r\n\t\t\t\t`This would export ${\r\n\t\t\t\t\treadableSizes.length\r\n\t\t\t\t} ${filePluralize}. ${itPluralize} would have the following (aproximate) ${sizePluralize}: ${readableSizes.join(\r\n\t\t\t\t\t','\r\n\t\t\t\t)}`\r\n\t\t\t)\r\n\t\t);\r\n\t}\r\n\r\n\t@Watch('quality')\r\n\tprivate warnImageQuality(quality: number, oldQuality: number) {\r\n\t\tif (quality === 100) {\r\n\t\t\teventBus.fire(\r\n\t\t\t\tnew ShowMessageEvent(\r\n\t\t\t\t\t`Note: 100% quality on a lossy format is still not lossless! Select PNG if you want lossless compression.`\r\n\t\t\t\t)\r\n\t\t\t);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (oldQuality > 70 && quality <= 70) {\r\n\t\t\teventBus.fire(\r\n\t\t\t\tnew ShowMessageEvent(\r\n\t\t\t\t\t`Note: A quality level below 70% might be very noticable and impair legibility of text.`\r\n\t\t\t\t)\r\n\t\t\t);\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate async renderObjects<T>(\r\n\t\tdistribution: DeepReadonly<string[][]>,\r\n\t\thq: boolean,\r\n\t\tmapper: (imageIdx: number, canvas: HTMLCanvasElement) => Promise<T>\r\n\t): Promise<T[]> {\r\n\t\treturn await Promise.all(\r\n\t\t\tdistribution.map(async (image, imageIdx) => {\r\n\t\t\t\tconst targetCanvas = document.createElement('canvas');\r\n\t\t\t\ttargetCanvas.width = 1280;\r\n\t\t\t\ttargetCanvas.height = 720 * image.length;\r\n\t\t\t\tconst context = targetCanvas.getContext('2d')!;\r\n\r\n\t\t\t\tawait Promise.all(\r\n\t\t\t\t\timage.map(async (panelId, panelIdx) => {\r\n\t\t\t\t\t\tconst sceneRenderer = new SceneRenderer(\r\n\t\t\t\t\t\t\tthis.$store,\r\n\t\t\t\t\t\t\timage[panelIdx],\r\n\t\t\t\t\t\t\t1280,\r\n\t\t\t\t\t\t\t720\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tawait sceneRenderer.render(hq);\r\n\r\n\t\t\t\t\t\tsceneRenderer.paintOnto(context, 0, 720 * panelIdx, 1280, 720);\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\r\n\t\t\t\treturn await mapper(imageIdx, targetCanvas);\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tprivate get canDeletePanel(): boolean {\r\n\t\treturn this.panelButtons.length > 1;\r\n\t}\r\n\r\n\tprivate getPanelDistibution(): DeepReadonly<string[][]> {\r\n\t\tconst panelOrder = this.$store.state.panels.panelOrder;\r\n\t\tif (this.ppi === 0) return [panelOrder];\r\n\t\tconst images: string[][] = [];\r\n\t\tfor (let imageI = 0; imageI < panelOrder.length / this.ppi; ++imageI) {\r\n\t\t\tconst sliceStart = imageI * this.ppi;\r\n\t\t\tconst sliceEnd = sliceStart + this.ppi;\r\n\t\t\timages.push([...panelOrder.slice(sliceStart, sliceEnd)]);\r\n\t\t}\r\n\t\treturn images;\r\n\t}\r\n\r\n\tprivate moveFocusToActivePanel() {\r\n\t\tconst active = this.$el.querySelector('.panel_button.active');\r\n\t\tif (active) {\r\n\t\t\tthis.scrollIntoView(active);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate scrollIntoView(ele: Element) {\r\n\t\tconst parent = ele.parentElement!;\r\n\t\tconst idx = Array.from(parent.children).indexOf(ele);\r\n\t\tif (this.$store.state.ui.vertical) {\r\n\t\t\tlet scroll =\r\n\t\t\t\tidx * ele.clientHeight - parent.clientHeight / 2 + ele.clientHeight / 2;\r\n\t\t\tparent.scrollTop = scroll;\r\n\t\t\tparent.scrollLeft = 0;\r\n\t\t} else {\r\n\t\t\tlet scroll =\r\n\t\t\t\tidx * ele.clientWidth - parent.clientWidth / 2 + ele.clientWidth / 2;\r\n\t\t\tparent.scrollLeft = scroll;\r\n\t\t\tparent.scrollTop = 0;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate get panelButtons(): IPanelButton[] {\r\n\t\tconst panelButtons: IPanelButton[] = [];\r\n\t\tconst panelOrder = this.$store.state.panels.panelOrder;\r\n\t\treturn panelOrder.map(id => {\r\n\t\t\tconst panel = this.$store.state.panels.panels[id];\r\n\t\t\tconst objectOrders = this.$store.state.objects.panels[id];\r\n\t\t\tconst txtBox = ([] as string[])\r\n\t\t\t\t.concat(objectOrders.order, objectOrders.onTopOrder)\r\n\t\t\t\t.map(objId => this.$store.state.objects.objects[objId])\r\n\t\t\t\t.find(obj => obj.type === 'textBox') as ITextBox | undefined;\r\n\t\t\treturn {\r\n\t\t\t\tid,\r\n\t\t\t\timage: panel.lastRender,\r\n\t\t\t\ttext: txtBox ? txtBox.text : '',\r\n\t\t\t} as IPanelButton;\r\n\t\t});\r\n\t}\r\n\r\n\tprivate async addNewPanel() {\r\n\t\tawait this.vuexHistory.transaction(async () => {\r\n\t\t\tthis.$store.dispatch('panels/duplicatePanel', {\r\n\t\t\t\tpanelId: this.$store.state.panels.currentPanel,\r\n\t\t\t} as IDuplicatePanelAction);\r\n\t\t});\r\n\t\tthis.$nextTick(() => {\r\n\t\t\tthis.moveFocusToActivePanel();\r\n\t\t});\r\n\t}\r\n\r\n\tprivate updateCurrentPanel(panelId: string) {\r\n\t\tthis.vuexHistory.transaction(async () => {\r\n\t\t\tthis.$store.commit('panels/setCurrentPanel', {\r\n\t\t\t\tpanelId,\r\n\t\t\t} as ISetCurrentPanelMutation);\r\n\t\t});\r\n\t\tthis.$nextTick(() => {\r\n\t\t\tthis.moveFocusToActivePanel();\r\n\t\t});\r\n\t}\r\n\r\n\tprivate deletePanel() {\r\n\t\tthis.vuexHistory.transaction(async () => {\r\n\t\t\tthis.$store.dispatch('panels/delete', {\r\n\t\t\t\tpanelId: this.$store.state.panels.currentPanel,\r\n\t\t\t} as IDeletePanelAction);\r\n\t\t});\r\n\t\tthis.$nextTick(() => {\r\n\t\t\tthis.moveFocusToActivePanel();\r\n\t\t});\r\n\t}\r\n\r\n\tprivate moveAhead() {\r\n\t\tthis.vuexHistory.transaction(() => {\r\n\t\t\tthis.$store.dispatch('panels/move', {\r\n\t\t\t\tpanelId: this.currentPanel,\r\n\t\t\t\tdelta: -1,\r\n\t\t\t} as IMovePanelAction);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate get canMoveAhead(): boolean {\r\n\t\tconst panelOrder = this.$store.state.panels.panelOrder;\r\n\t\tconst idx = panelOrder.indexOf(this.currentPanel);\r\n\t\treturn idx > 0;\r\n\t}\r\n\r\n\tprivate moveBehind() {\r\n\t\tthis.vuexHistory.transaction(() => {\r\n\t\t\tthis.$store.dispatch('panels/move', {\r\n\t\t\t\tpanelId: this.currentPanel,\r\n\t\t\t\tdelta: 1,\r\n\t\t\t} as IMovePanelAction);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate get canMoveBehind(): boolean {\r\n\t\tconst panelOrder = this.$store.state.panels.panelOrder;\r\n\t\tconst idx = panelOrder.indexOf(this.currentPanel);\r\n\t\treturn idx < panelOrder.length - 1;\r\n\t}\r\n}\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./panels.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/ts-loader/index.js??ref--13-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./panels.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./panels.vue?vue&type=template&id=b815c22a&scoped=true&\"\nimport script from \"./panels.vue?vue&type=script&lang=ts&\"\nexport * from \"./panels.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./panels.vue?vue&type=style&index=0&id=b815c22a&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"b815c22a\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// App.vue has currently so many responsiblities that it's best to break it into chunks\n// tslint:disable:member-ordering\nimport { Component, Vue, Watch, Prop } from 'vue-property-decorator';\nimport { State } from 'vuex-class-decorator';\n\nimport SettingsPanel from './panels/settings.vue';\nimport AddPanel from './panels/add.vue';\nimport CharacterPanel from './panels/character.vue';\nimport SpritePanel from './panels/sprite.vue';\nimport TextBoxPanel from './panels/textbox.vue';\nimport CreditsPanel from './panels/credits.vue';\nimport BackgroundsPanel from './panels/backgrounds.vue';\nimport ContentPacksPanel from './panels/content-pack.vue';\nimport PanelsPanel from './panels/panels.vue';\nimport { IObject } from '@/store/objects';\nimport { IBackground } from '@/models/background';\nimport { Store } from 'vuex';\nimport { IRootState } from '@/store';\nimport environment from '@/environments/environment';\n\ntype PanelNames =\n\t| 'add'\n\t| 'backgrounds'\n\t| 'help_credits'\n\t| 'selection'\n\t| 'packs'\n\t| 'settings'\n\t| 'panels';\n\n@Component({\n\tcomponents: {\n\t\tSettingsPanel,\n\t\tAddPanel,\n\t\tBackgroundsPanel,\n\t\tCreditsPanel,\n\t\tCharacterPanel,\n\t\tTextBoxPanel,\n\t\tSpritePanel,\n\t\tContentPacksPanel,\n\t\tPanelsPanel,\n\t},\n})\nexport default class ToolBox extends Vue {\n\tpublic $store!: Store<IRootState>;\n\n\t@State('vertical', { namespace: 'ui' }) private readonly vertical!: boolean;\n\n\tprivate create() {\n\t\tenvironment.onPanelChange((panel: string) => {\n\t\t\tthis.panelSelection = panel as PanelNames;\n\t\t});\n\t}\n\n\tprivate get selection(): string | null {\n\t\treturn this.$store.state.ui.selection;\n\t}\n\n\tprivate panelSelection: PanelNames = 'add';\n\n\tprivate get panel() {\n\t\tif (this.panelSelection === 'selection') {\n\t\t\tif (this.selection === null) {\n\t\t\t\tthis.panelSelection = 'add';\n\t\t\t} else {\n\t\t\t\tconst obj = this.$store.state.objects.objects[this.selection];\n\t\t\t\treturn obj.type;\n\t\t\t}\n\t\t}\n\t\treturn this.panelSelection;\n\t}\n\n\tprivate get hasPrevRender(): boolean {\n\t\treturn this.$store.state.ui.lastDownload !== null;\n\t}\n\n\tprivate setPanel(name: PanelNames) {\n\t\tif (name === this.panelSelection) name = 'add';\n\t\tthis.panelSelection = name;\n\t\tif (this.selection) {\n\t\t\tthis.$store.commit('ui/setSelection', null);\n\t\t}\n\t}\n\n\t@Watch('selection')\n\tprivate onSelectionChange(newSelection: IObject | null) {\n\t\tif (newSelection) {\n\t\t\tthis.panelSelection = 'selection';\n\t\t\treturn;\n\t\t}\n\t\tif (this.panelSelection === 'selection') {\n\t\t\tthis.panelSelection = 'add';\n\t\t}\n\t}\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./toolbox.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./toolbox.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./toolbox.vue?vue&type=template&id=e72be81a&\"\nimport script from \"./toolbox.vue?vue&type=script&lang=ts&\"\nexport * from \"./toolbox.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./toolbox.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:{ vertical: _vm.vertical },attrs:{\"id\":\"messageConsole\"}},[(_vm.showLoading)?_c('p',[_vm._v(\"Loading...\")]):_vm._e(),_vm._l((_vm.messages),function(message,i){return _c('p',{key:message + '_' + i},[_vm._v(_vm._s(message))])})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\nimport { Component, Vue, Prop, Watch } from 'vue-property-decorator';\nimport { State } from 'vuex-class-decorator';\nimport EventBus, {\n\tAssetFailureEvent,\n\tCustomAssetFailureEvent,\n\tShowMessageEvent,\n} from '@/eventbus/event-bus';\n\n@Component({\n\tcomponents: {},\n})\nexport default class MessageConsole extends Vue {\n\t@Prop({ default: false, type: Boolean }) private readonly loading!: boolean;\n\n\t@State('vertical', { namespace: 'ui' }) private readonly vertical!: boolean;\n\tprivate messages: string[] = [];\n\tprivate showLoading: boolean = false;\n\tprivate showLoadingTimeout: number = 0;\n\tprivate hideLoadingTimeout: number = 0;\n\n\tprivate created() {\n\t\tthis.onLoadingChange(this.loading);\n\t\tEventBus.subscribe(AssetFailureEvent, ev => {\n\t\t\tthis.messages.push(`Failed to load asset '${ev.path}'`);\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.messages.shift();\n\t\t\t}, 5000);\n\t\t});\n\n\t\tEventBus.subscribe(CustomAssetFailureEvent, ev => {\n\t\t\tthis.messages.push(\n\t\t\t\t'Failed to load custom asset. Try to download it manually and then upload it.'\n\t\t\t);\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.messages.shift();\n\t\t\t}, 20000);\n\t\t});\n\n\t\tEventBus.subscribe(ShowMessageEvent, ev => {\n\t\t\tdebugger;\n\t\t\tthis.messages.push(ev.message);\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.messages.shift();\n\t\t\t}, 20000);\n\t\t});\n\t}\n\n\t@Watch('loading')\n\tprivate onLoadingChange(newValue: boolean) {\n\t\tif (newValue) {\n\t\t\tif (this.hideLoadingTimeout) {\n\t\t\t\tclearTimeout(this.hideLoadingTimeout);\n\t\t\t\tthis.hideLoadingTimeout = 0;\n\t\t\t}\n\t\t\tif (!this.showLoading && !this.showLoadingTimeout) {\n\t\t\t\tthis.showLoadingTimeout = setTimeout(() => {\n\t\t\t\t\tthis.showLoading = true;\n\t\t\t\t\tthis.showLoadingTimeout = 0;\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.showLoadingTimeout) {\n\t\t\t\tclearTimeout(this.showLoadingTimeout);\n\t\t\t\tthis.showLoadingTimeout = 0;\n\t\t\t}\n\t\t\tif (this.showLoading && !this.hideLoadingTimeout) {\n\t\t\t\tthis.hideLoadingTimeout = setTimeout(() => {\n\t\t\t\t\tthis.showLoading = false;\n\t\t\t\t\tthis.hideLoadingTimeout = 0;\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t}\n\t}\n}\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./message-console.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./message-console.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./message-console.vue?vue&type=template&id=10803f16&scoped=true&\"\nimport script from \"./message-console.vue?vue&type=script&lang=ts&\"\nexport * from \"./message-console.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./message-console.vue?vue&type=style&index=0&id=10803f16&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"10803f16\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('canvas',{ref:\"sd\",style:({ width: _vm.canvasWidth + 'px', height: _vm.canvasHeight + 'px' }),attrs:{\"id\":\"scaled_display\",\"height\":\"720\",\"width\":\"1280\",\"draggable\":\"\"},on:{\"click\":_vm.onUiClick,\"touchstart\":_vm.onTouchStart,\"dragstart\":_vm.onDragStart,\"touchmove\":_vm.onSpriteDragMove,\"mousemove\":_vm.onSpriteDragMove,\"touchend\":_vm.onSpriteDrop,\"mouseup\":_vm.onSpriteDrop,\"dragover\":_vm.onDragOver,\"drop\":_vm.onDrop,\"mouseenter\":_vm.onMouseEnter}},[_vm._v(\"HTML5 is required to use the Doki Doki Dialog Generator.\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n// App.vue has currently so many responsiblities that it's best to break it into chunks\r\n// tslint:disable:member-ordering\r\nimport { Component, Vue, Watch, Prop } from 'vue-property-decorator';\r\nimport { State } from 'vuex-class-decorator';\r\nimport { Store, MutationPayload } from 'vuex';\r\nimport { IRootState } from '@/store';\r\nimport { Renderer } from '@/renderer/renderer';\r\nimport { IRenderable } from '@/models/renderable';\r\nimport { IBackground, color, Background } from '@/models/background';\r\nimport { IHistorySupport } from '@/plugins/vuex-history';\r\nimport { RenderContext } from '@/renderer/rendererContext';\r\nimport { getAsset, registerAsset } from '@/asset-manager';\r\nimport eventBus, { InvalidateRenderEvent } from '@/eventbus/event-bus';\r\nimport { ICreateTextBoxAction, ITextBox } from '@/store/objectTypes/textbox';\r\nimport {\r\n\tIObject,\r\n\tISetObjectPositionMutation,\r\n\tIRemoveObjectAction,\r\n\tIObjectsState,\r\n} from '@/store/objects';\r\nimport { ICreateSpriteAction, ISprite } from '@/store/objectTypes/sprite';\r\nimport { Character } from '@/models/character';\r\nimport {\r\n\tIShiftCharacterSlotAction,\r\n\tICharacter,\r\n} from '@/store/objectTypes/characters';\r\nimport { Sprite } from '@/models/sprite';\r\nimport { TextBox } from '@/models/textbox';\r\nimport { ISetCurrentMutation, IPanel } from '@/store/panels';\r\nimport content from '@/store/content';\r\nimport { SceneRenderer } from '../models/scene-renderer';\r\nimport { DeepReadonly } from '../util/readonly';\r\n\r\n@Component({})\r\nexport default class Render extends Vue {\r\n\tpublic $store!: Store<DeepReadonly<IRootState>>;\r\n\r\n\tprivate sdCtx: CanvasRenderingContext2D | undefined;\r\n\r\n\tprivate get selection(): string | null {\r\n\t\treturn this.$store.state.ui.selection;\r\n\t}\r\n\r\n\tprivate currentlyRendering: boolean = false;\r\n\r\n\tprivate queuedRender: number | null = null;\r\n\tprivate showingLast: boolean = false;\r\n\r\n\tprivate dropSpriteCount = 0;\r\n\tprivate dropPreventClick = false;\r\n\r\n\t@Prop({ type: Number, default: 0 }) private readonly canvasWidth!: number;\r\n\t@Prop({ type: Number, default: 0 }) private readonly canvasHeight!: number;\r\n\r\n\t@State('lqRendering', { namespace: 'ui' })\r\n\tprivate readonly lqRendering!: boolean;\r\n\r\n\tprivate vuexHistory!: IHistorySupport;\r\n\r\n\tprivate get sceneRender() {\r\n\t\treturn new SceneRenderer(\r\n\t\t\tthis.$store,\r\n\t\t\tthis.$store.state.panels.currentPanel,\r\n\t\t\t1280,\r\n\t\t\t720\r\n\t\t);\r\n\t}\r\n\r\n\tpublic async blendOver(imageUrl: string): Promise<void> {}\r\n\r\n\tpublic async download(): Promise<void> {\r\n\t\tconst url = await this.sceneRender.download();\r\n\r\n\t\tthis.vuexHistory.transaction(async () => {\r\n\t\t\tconst oldUrl = this.$store.state.ui.lastDownload;\r\n\r\n\t\t\tthis.$store.commit('ui/setLastDownload', url);\r\n\t\t\tif (oldUrl) {\r\n\t\t\t\tURL.revokeObjectURL(oldUrl);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate invalidateRender() {\r\n\t\tif (this.queuedRender) return;\r\n\t\tthis.queuedRender = requestAnimationFrame(() => this.render_());\r\n\t}\r\n\r\n\tprivate async render_(): Promise<void> {\r\n\t\tif (this.queuedRender) {\r\n\t\t\tcancelAnimationFrame(this.queuedRender);\r\n\t\t\tthis.queuedRender = null;\r\n\t\t}\r\n\r\n\t\tif (this.$store.state.unsafe) return;\r\n\r\n\t\tawait this.sceneRender.render(!this.lqRendering);\r\n\t\tthis.display();\r\n\t}\r\n\r\n\tprivate async created(): Promise<void> {\r\n\t\teventBus.subscribe(InvalidateRenderEvent, command => this.invalidateRender);\r\n\t\tthis.$store.subscribe((mut: MutationPayload) => {\r\n\t\t\tif (mut.type === 'panels/setPanelPreview') return;\r\n\t\t\tif (mut.type === 'panels/currentPanel') return;\r\n\t\t\tthis.invalidateRender();\r\n\t\t});\r\n\t}\r\n\r\n\tprivate mounted(): void {\r\n\t\tconst sd = this.$refs.sd as HTMLCanvasElement;\r\n\t\tthis.sdCtx = sd.getContext('2d') || undefined;\r\n\r\n\t\tthis.renderLoadingScreen();\r\n\t\tthis.invalidateRender();\r\n\t}\r\n\r\n\tprivate renderLoadingScreen() {\r\n\t\tif (!this.sdCtx) return;\r\n\t\tconst loadingScreen = document.createElement('canvas');\r\n\t\tloadingScreen.height = 1280;\r\n\t\tloadingScreen.width = 720;\r\n\t\tconst rctx = new RenderContext(\r\n\t\t\tloadingScreen.getContext('2d')!,\r\n\t\t\ttrue,\r\n\t\t\tfalse\r\n\t\t);\r\n\t\trctx.drawText({\r\n\t\t\ttext: 'Starting...',\r\n\t\t\tx: loadingScreen.width / 2,\r\n\t\t\ty: loadingScreen.height / 2,\r\n\t\t\talign: 'center',\r\n\t\t\toutline: {\r\n\t\t\t\twidth: 5,\r\n\t\t\t\tstyle: '#b59',\r\n\t\t\t},\r\n\t\t\tfont: '32px riffic',\r\n\t\t\tfill: {\r\n\t\t\t\tstyle: 'white',\r\n\t\t\t},\r\n\t\t});\r\n\t\tthis.sdCtx!.drawImage(loadingScreen, this.canvasWidth, this.canvasHeight);\r\n\t}\r\n\r\n\t@Watch('canvasWidth')\r\n\t@Watch('canvasHeight')\r\n\tprivate display(): void {\r\n\t\tif (!this.sdCtx) return;\r\n\t\tthis.showingLast = false;\r\n\t\tthis.sceneRender.paintOnto(this.sdCtx, 0, 0, 1280, 720);\r\n\t}\r\n\r\n\tprivate toRendererCoordinate(x: number, y: number): [number, number] {\r\n\t\tconst sd = this.$refs.sd as HTMLCanvasElement;\r\n\t\tconst rx = x - sd.offsetLeft;\r\n\t\tconst ry = y - sd.offsetTop;\r\n\t\tconst sx = (rx / sd.offsetWidth) * sd.width;\r\n\t\tconst sy = (ry / sd.offsetWidth) * sd.width;\r\n\t\treturn [sx, sy];\r\n\t}\r\n\r\n\tprivate onUiClick(e: MouseEvent): void {\r\n\t\tif (this.dropPreventClick) {\r\n\t\t\tthis.dropPreventClick = false;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst [sx, sy] = this.toRendererCoordinate(e.clientX, e.clientY);\r\n\r\n\t\tconst objects = this.sceneRender.objectsAt(sx, sy);\r\n\r\n\t\tconst currentObjectIdx = objects.findIndex(id => id === this.selection);\r\n\t\tlet selectedObject: string | null;\r\n\r\n\t\tif (currentObjectIdx === 0) {\r\n\t\t\tselectedObject = null;\r\n\t\t} else if (currentObjectIdx !== -1) {\r\n\t\t\t// Select the next lower character\r\n\t\t\tselectedObject = objects[currentObjectIdx - 1];\r\n\t\t} else {\r\n\t\t\tselectedObject = objects[objects.length - 1] || null;\r\n\t\t}\r\n\r\n\t\tthis.$store.commit('ui/setSelection', selectedObject);\r\n\t}\r\n\r\n\tprivate draggedObject: IObject | null = null;\r\n\tprivate dragXOffset: number = 0;\r\n\tprivate dragYOffset: number = 0;\r\n\tprivate dragXOriginal: number = 0;\r\n\tprivate dragYOriginal: number = 0;\r\n\r\n\tprivate onDragStart(e: DragEvent) {\r\n\t\te.preventDefault();\r\n\t\tif (!this.selection) return;\r\n\t\tthis.draggedObject = this.$store.state.objects.objects[this.selection];\r\n\t\tconst [x, y] = this.toRendererCoordinate(e.clientX, e.clientY);\r\n\t\tthis.dragXOffset = x - this.draggedObject.x;\r\n\t\tthis.dragYOffset = y - this.draggedObject.y;\r\n\t\tthis.dragXOriginal = this.draggedObject.x;\r\n\t\tthis.dragYOriginal = this.draggedObject.y;\r\n\t}\r\n\r\n\tprivate onTouchStart(e: TouchEvent) {\r\n\t\tif (!this.selection) return;\r\n\t\tthis.draggedObject = this.$store.state.objects.objects[this.selection];\r\n\t\tconst [x, y] = this.toRendererCoordinate(\r\n\t\t\te.touches[0].clientX,\r\n\t\t\te.touches[0].clientY\r\n\t\t);\r\n\t\tthis.dragXOffset = x - this.draggedObject.x;\r\n\t\tthis.dragYOffset = y - this.draggedObject.y;\r\n\t\tthis.dragXOriginal = this.draggedObject.x;\r\n\t\tthis.dragYOriginal = this.draggedObject.y;\r\n\t}\r\n\r\n\tprivate onDragOver(e: DragEvent) {\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\t\te.dataTransfer!.dropEffect = 'copy';\r\n\t}\r\n\r\n\tprivate onSpriteDragMove(e: MouseEvent | TouchEvent) {\r\n\t\tif (this.draggedObject) {\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\t// Formatter quirk\r\n\t\t\t// tslint:disable:indent\r\n\t\t\tlet [x, y] =\r\n\t\t\t\te instanceof MouseEvent\r\n\t\t\t\t\t? this.toRendererCoordinate(e.clientX, e.clientY)\r\n\t\t\t\t\t: this.toRendererCoordinate(\r\n\t\t\t\t\t\t\te.touches[0].clientX,\r\n\t\t\t\t\t\t\te.touches[0].clientY\r\n\t\t\t\t\t  );\r\n\t\t\t// tslint:enable:indent\r\n\t\t\tx -= this.dragXOffset;\r\n\t\t\ty -= this.dragYOffset;\r\n\r\n\t\t\tconst deltaX = Math.abs(x - this.dragXOriginal);\r\n\t\t\tconst deltaY = Math.abs(y - this.dragYOriginal);\r\n\r\n\t\t\tif (deltaX + deltaY > 1) this.dropPreventClick = true;\r\n\r\n\t\t\tif (e.shiftKey) {\r\n\t\t\t\tif (deltaX > deltaY) {\r\n\t\t\t\t\ty = this.dragYOriginal;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tx = this.dragXOriginal;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.vuexHistory.transaction(() => {\r\n\t\t\t\tthis.$store.dispatch('objects/setPosition', {\r\n\t\t\t\t\tid: this.draggedObject!.id,\r\n\t\t\t\t\tx,\r\n\t\t\t\t\ty,\r\n\t\t\t\t} as ISetObjectPositionMutation);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate async onDrop(e: DragEvent) {\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\r\n\t\tif (!e.dataTransfer) return;\r\n\r\n\t\tfor (const item of e.dataTransfer.items) {\r\n\t\t\tif (item.kind === 'file' && item.type.match(/image.*/)) {\r\n\t\t\t\tconst name = 'dropCustomAsset' + ++this.dropSpriteCount;\r\n\t\t\t\tconst url = registerAsset(name, item.getAsFile()!);\r\n\r\n\t\t\t\tthis.vuexHistory.transaction(async () => {\r\n\t\t\t\t\tawait this.$store.dispatch('objects/createSprite', {\r\n\t\t\t\t\t\tassets: [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\thq: url,\r\n\t\t\t\t\t\t\t\tlq: url,\r\n\t\t\t\t\t\t\t\tsourcePack: 'dddg.generated.uploaded-sprites',\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t} as ICreateSpriteAction);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprivate onSpriteDrop(e: MouseEvent | TouchEvent) {\r\n\t\tif (this.draggedObject) {\r\n\t\t\tif ('TouchEvent' in window && e instanceof TouchEvent) {\r\n\t\t\t\tthis.dropPreventClick = false;\r\n\t\t\t}\r\n\t\t\tthis.draggedObject = null;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate onMouseEnter(e: MouseEvent) {\r\n\t\tif (e.buttons !== 1) {\r\n\t\t\tthis.draggedObject = null;\r\n\t\t}\r\n\t}\r\n}\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./render.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--13-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./render.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./render.vue?vue&type=template&id=f2f72938&\"\nimport script from \"./render.vue?vue&type=script&lang=ts&\"\nexport * from \"./render.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n// App.vue has currently so many responsiblities that it's best to break it into chunks\n// tslint:disable:member-ordering\nimport { Component, Vue } from 'vue-property-decorator';\nimport { State } from 'vuex-class-decorator';\nimport { Store } from 'vuex';\nimport { IRootState } from '@/store';\nimport { IRenderable } from '@/models/renderable';\nimport { IHistorySupport } from '@/plugins/vuex-history';\nimport { ICreateTextBoxAction } from '@/store/objectTypes/textbox';\nimport {\n\tIObject,\n\tISetObjectPositionMutation,\n\tIRemoveObjectAction,\n} from '@/store/objects';\nimport { Character } from '@/models/character';\nimport {\n\tIShiftCharacterSlotAction,\n\tICharacter,\n} from '@/store/objectTypes/characters';\nimport ToolBox from '@/components/toolbox/toolbox.vue';\nimport MessageConsole from '@/components/message-console.vue';\nimport Render from '@/components/render.vue';\nimport { ISetCurrentMutation } from '@/store/panels';\n\n@Component({\n\tcomponents: {\n\t\tToolBox,\n\t\tMessageConsole,\n\t\tRender,\n\t},\n})\nexport default class App extends Vue {\n\tpublic canvasWidth: number = 0;\n\tpublic canvasHeight: number = 0;\n\tpublic $store!: Store<IRootState>;\n\tprivate vuexHistory!: IHistorySupport;\n\tprivate blendOver: string | null = null;\n\n\tprivate uiSize: number = 192;\n\tprivate currentlyRendering: boolean = false;\n\n\tprivate panel: string = '';\n\n\tprivate drawLastDownload(): void {\n\t\tconst last = this.$store.state.ui.lastDownload;\n\t\tif (!last) return;\n\t\t(this.$refs.render as Render).blendOver(last);\n\t}\n\n\tprivate setBlendOver(): void {\n\t\tthis.blendOver = this.$store.state.ui.lastDownload;\n\t}\n\n\tprivate async created(): Promise<void> {\n\t\t// Moving this to the \"mounted\"-handler crashes safari over version 12.\n\t\t// My best guess is because it runs in a microtask, which have been added in that Version.\n\t\tthis.updateArea();\n\t\twindow.addEventListener('resize', this.updateArea);\n\t\twindow.removeEventListener('keydown', this.onKeydown);\n\t\twindow.addEventListener('keydown', this.onKeydown);\n\t\tdocument.body.addEventListener(\n\t\t\t'drop',\n\t\t\t(event: Event) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\t\tdocument.body.addEventListener(\n\t\t\t'dragover',\n\t\t\t(event: Event) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t},\n\t\t\ttrue\n\t\t);\n\n\t\tthis.vuexHistory.transaction(async () => {\n\t\t\tawait this.$store.dispatch('content/loadContentPacks', [\n\t\t\t\t`${process.env.BASE_URL}packs/buildin.base.backgrounds.json`,\n\t\t\t\t`${process.env.BASE_URL}packs/buildin.base.monika.json`,\n\t\t\t\t`${process.env.BASE_URL}packs/buildin.base.sayori.json`,\n\t\t\t\t`${process.env.BASE_URL}packs/buildin.base.natsuki.json`,\n\t\t\t\t`${process.env.BASE_URL}packs/buildin.base.yuri.json`,\n\t\t\t\t`${process.env.BASE_URL}packs/buildin.extra.mc.json`,\n\t\t\t\t`${process.env.BASE_URL}packs/buildin.extra.mc_chad.json`,\n\t\t\t\t`${process.env.BASE_URL}packs/buildin.extra.mc_classic.json`,\n\t\t\t\t`${process.env.BASE_URL}packs/buildin.extra.femc.json`,\n\t\t\t\t`${process.env.BASE_URL}packs/buildin.extra.classic_amy.json`,\n\t\t\t\t`${process.env.BASE_URL}packs/buildin.extra.amy.json`,\n\t\t\t]);\n\n\t\t\tawait this.$store.dispatch('panels/createPanel');\n\t\t\tif (Object.keys(this.$store.state.objects.objects).length === 0) {\n\t\t\t\tthis.$store.dispatch(\n\t\t\t\t\t'objects/createTextBox',\n\t\t\t\t\t{} as ICreateTextBoxAction\n\t\t\t\t);\n\t\t\t}\n\t\t\tawait this.$store.commit('panels/setCurrentBackground', {\n\t\t\t\tcurrent: 'ddlc.clubroom',\n\t\t\t\tpanelId: this.$store.state.panels.currentPanel,\n\t\t\t} as ISetCurrentMutation);\n\t\t});\n\t}\n\n\tprivate destroyed(): void {\n\t\twindow.removeEventListener('keydown', this.onKeydown);\n\t}\n\n\tprivate mounted(): void {\n\t\twindow.addEventListener('keypress', e => {\n\t\t\tif (e.keyCode === 27) {\n\t\t\t\tthis.vuexHistory.transaction(() => {\n\t\t\t\t\tthis.$store.commit('ui/setSelection', null);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate optimum(sw: number, sh: number): [number, number] {\n\t\tlet rh = sw / (16 / 9);\n\t\tlet rw = sh * (16 / 9);\n\n\t\tif (rh > sh) {\n\t\t\trh = sh;\n\t\t} else {\n\t\t\trw = sw;\n\t\t}\n\n\t\treturn [rw, rh];\n\t}\n\n\tprivate optimizeWithMenu(sw: number, sh: number): [number, number, boolean] {\n\t\tconst opth = this.optimum(sw, sh - this.uiSize);\n\t\tconst optv = this.optimum(sw - this.uiSize, sh);\n\n\t\tif (opth[0] * opth[1] > optv[0] * optv[1]) {\n\t\t\treturn [opth[0], opth[1], false];\n\t\t} else {\n\t\t\treturn [optv[0], optv[1], true];\n\t\t}\n\t}\n\n\tprivate updateArea(): void {\n\t\tconst [cw, ch, v] = this.optimizeWithMenu(\n\t\t\tdocument.documentElement.clientWidth,\n\t\t\tdocument.documentElement.clientHeight\n\t\t);\n\n\t\tthis.canvasWidth = cw;\n\t\tthis.canvasHeight = ch;\n\t\tthis.$store.commit('ui/setVertical', v);\n\t}\n\n\tprivate onKeydown(e: KeyboardEvent) {\n\t\tthis.vuexHistory.transaction(() => {\n\t\t\tconst selection = this.$store.state.objects.objects[\n\t\t\t\tthis.$store.state.ui.selection!\n\t\t\t];\n\t\t\tif (!selection) return;\n\t\t\tif (e.key === 'Delete') {\n\t\t\t\tthis.$store.dispatch('objects/removeObject', {\n\t\t\t\t\tid: selection.id,\n\t\t\t\t} as IRemoveObjectAction);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (e.key === 'z' && e.ctrlKey) {\n\t\t\t\tthis.$store.commit('history/undo');\n\t\t\t\treturn;\n\t\t\t} else if (e.key === 'y' && e.ctrlKey) {\n\t\t\t\tthis.$store.commit('history/redo');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (selection.type === 'character') {\n\t\t\t\tconst character = selection as ICharacter;\n\t\t\t\tif (character.freeMove) {\n\t\t\t\t\tif (e.key === 'ArrowLeft') {\n\t\t\t\t\t\tthis.$store.dispatch('objects/shiftCharacterSlot', {\n\t\t\t\t\t\t\tid: character.id,\n\t\t\t\t\t\t\tdelta: -1,\n\t\t\t\t\t\t} as IShiftCharacterSlotAction);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (e.key === 'ArrowRight') {\n\t\t\t\t\t\tthis.$store.dispatch('objects/shiftCharacterSlot', {\n\t\t\t\t\t\t\tid: character.id,\n\t\t\t\t\t\t\tdelta: 1,\n\t\t\t\t\t\t} as IShiftCharacterSlotAction);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet { x, y } = selection;\n\t\t\tif (e.key === 'ArrowLeft') {\n\t\t\t\tx -= e.shiftKey ? 1 : 20;\n\t\t\t} else if (selection && e.key === 'ArrowRight') {\n\t\t\t\tx += e.shiftKey ? 1 : 20;\n\t\t\t} else if (selection && e.key === 'ArrowUp') {\n\t\t\t\ty -= e.shiftKey ? 1 : 20;\n\t\t\t} else if (selection && e.key === 'ArrowDown') {\n\t\t\t\ty += e.shiftKey ? 1 : 20;\n\t\t\t} else {\n\t\t\t\tconsole.log(e);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.$store.dispatch('objects/setPosition', {\n\t\t\t\tid: selection.id,\n\t\t\t\tx,\n\t\t\t\ty,\n\t\t\t} as ISetObjectPositionMutation);\n\t\t\tconsole.log(e);\n\t\t\treturn;\n\t\t});\n\t}\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=28860813&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import { ICommand } from '@/eventbus/command';\nimport { getAAsset } from '@/asset-manager';\nimport { IObjectsState, ICreateObjectMutation, IObject } from '@/store/objects';\nimport { MutationTree, ActionTree } from 'vuex';\nimport { IRootState } from '..';\nimport { IAsset } from '../content';\n\nexport interface ISprite extends IObject {\n\ttype: 'sprite';\n\tassets: IAsset[];\n}\n\nexport const spriteMutations: MutationTree<IObjectsState> = {};\n\nlet lastSpriteId = 0;\n\nexport const spriteActions: ActionTree<IObjectsState, IRootState> = {\n\tasync createSprite(\n\t\t{ state, commit, rootState },\n\t\tcommand: ICreateSpriteAction\n\t) {\n\t\tconst asset = await getAAsset(command.assets[0], false);\n\t\tif (!(asset instanceof HTMLImageElement)) return;\n\t\tcommit('create', {\n\t\t\tobject: {\n\t\t\t\tassets: command.assets,\n\t\t\t\tflip: false,\n\t\t\t\theight: asset.height,\n\t\t\t\twidth: asset.width,\n\t\t\t\tid: 'sprite_' + ++lastSpriteId,\n\t\t\t\tpanelId: rootState.panels.currentPanel,\n\t\t\t\tonTop: false,\n\t\t\t\topacity: 100,\n\t\t\t\tpreserveRatio: true,\n\t\t\t\tratio: asset.width / asset.height,\n\t\t\t\ttype: 'sprite',\n\t\t\t\tversion: 0,\n\t\t\t\tx: 640,\n\t\t\t\ty: 0,\n\t\t\t} as ISprite,\n\t\t} as ICreateObjectMutation);\n\t},\n};\n\nexport interface ICreateSpriteAction extends ICommand {\n\treadonly assets: IAsset[];\n}\n","import { ICommand } from '@/eventbus/command';\nimport {\n\tIObjectsState,\n\tICreateObjectMutation,\n\tIObject,\n\tISetObjectPositionMutation,\n\tISetObjectFlipMutation,\n} from '@/store/objects';\nimport { MutationTree, ActionTree } from 'vuex';\nimport {\n\tNameboxY,\n\tTextBoxWidth,\n\tTextBoxHeight,\n} from '@/models/textBoxConstants';\nimport { ISetSpriteSizeMutation } from './characters';\nimport { IRootState } from '..';\n\nexport interface ITextBox extends IObject {\n\ttype: 'textBox';\n\ttext: string;\n\ttalkingDefault:\n\t\t| 'No-one'\n\t\t| 'Sayori'\n\t\t| 'Monika'\n\t\t| 'Natsuki'\n\t\t| 'Yuri'\n\t\t| 'MC'\n\t\t| 'FeMC'\n\t\t| 'Chad'\n\t\t| 'Amy'\n\t\t| 'Other';\n\ttalkingOther: string;\n\tstyle: 'normal' | 'corrupt' | 'custom';\n\tcustomColor: string;\n\tderiveCustomColors: boolean;\n\tcustomControlsColor: string;\n\tcustomNameboxColor: string;\n\tcustomNameboxStroke: string;\n\tcustomNameboxWidth: number;\n\tcontrols: boolean;\n\tskip: boolean;\n\tautoQuoting: boolean;\n\tcontinue: boolean;\n\tresetBounds: {\n\t\tx: number;\n\t\ty: number;\n\t\twidth: number;\n\t\theight: number;\n\t};\n}\n\nexport const textBoxMutations: MutationTree<IObjectsState> = {\n\tsetText(state, command: ISetTextBoxTextMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.text = command.text;\n\t\t++obj.version;\n\t},\n\tsetTalkingDefault(state, command: ISetTextBoxTalkingDefaultMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.talkingDefault = command.talkingDefault;\n\t\t++obj.version;\n\t},\n\tsetTalkingOther(state, command: ISetTextBoxTalkingOtherMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.talkingOther = command.talkingOther;\n\t\tobj.talkingDefault = 'Other';\n\t\t++obj.version;\n\t},\n\tsetStyle(state, command: ISetTextBoxStyleMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.style = command.style;\n\t\t++obj.version;\n\t},\n\tsetControlsVisible(state, command: ISetTextBoxControlsVisibleMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.controls = command.controls;\n\t\t++obj.version;\n\t},\n\tsetControlsColor(state, command: ISetTextBoxCustomControlsColorMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.customControlsColor = command.customControlsColor;\n\t\t++obj.version;\n\t},\n\tsetDeriveCustomColors(state, command: ISetTextBoxDeriveCustomColorMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.deriveCustomColors = command.deriveCustomColors;\n\t\t++obj.version;\n\t},\n\tsetNameboxColor(state, command: ISetTextBoxNameboxColorMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.customNameboxColor = command.customNameboxColor;\n\t\t++obj.version;\n\t},\n\tsetNameboxStroke(state, command: ISetTextBoxNameboxStrokeMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.customNameboxStroke = command.customNameboxStroke;\n\t\t++obj.version;\n\t},\n\tsetNameboxWidth(state, command: ISetTextBoxNameboxWidthMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.customNameboxWidth = command.customNameboxWidth;\n\t\t++obj.version;\n\t},\n\tsetSkipable(state, command: ISetTextBoxControlsSkipMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.skip = command.skip;\n\t\t++obj.version;\n\t},\n\tsetContinueArrow(state, command: ISetTextBoxControlsContinueMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.continue = command.continue;\n\t\t++obj.version;\n\t},\n\tsetCustomColor(state, command: ISetTextBoxCustomColorMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.customColor = command.color;\n\t\t++obj.version;\n\t},\n\tsetAutoQuoting(state, command: ISetTextBoxAutoQuotingMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.autoQuoting = command.autoQuoting;\n\t\t++obj.version;\n\t},\n\tsetResetBounds(state, command: ISetResetBoundsMutation) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tobj.resetBounds = command.resetBounds;\n\t\tobj.x = command.resetBounds.x;\n\t\tobj.y = command.resetBounds.y;\n\t\tobj.height = command.resetBounds.height;\n\t\tobj.width = command.resetBounds.width;\n\t\t++obj.version;\n\t},\n};\n\nlet lastTextBoxId = 0;\n\nexport const textBoxActions: ActionTree<IObjectsState, IRootState> = {\n\tcreateTextBox({ commit, rootState }, command: ICreateTextBoxAction): string {\n\t\tconst id = 'textBox_' + ++lastTextBoxId;\n\t\tconst resetBounds = command.resetBounds || {\n\t\t\tx: 640,\n\t\t\ty: NameboxY,\n\t\t\twidth: TextBoxWidth,\n\t\t\theight: TextBoxHeight,\n\t\t};\n\t\tcommit('create', {\n\t\t\tobject: {\n\t\t\t\t...resetBounds,\n\t\t\t\tpanelId: rootState.panels.currentPanel,\n\t\t\t\tflip: false,\n\t\t\t\tid,\n\t\t\t\tonTop: true,\n\t\t\t\topacity: 100,\n\t\t\t\ttype: 'textBox',\n\t\t\t\tversion: 0,\n\t\t\t\tpreserveRatio: false,\n\t\t\t\tratio: TextBoxWidth / TextBoxHeight,\n\t\t\t\tcontinue: true,\n\t\t\t\tcontrols: true,\n\t\t\t\tskip: true,\n\t\t\t\tautoQuoting: true,\n\t\t\t\tstyle: 'normal',\n\t\t\t\tcustomColor: '#ffa8d2',\n\t\t\t\tderiveCustomColors: true,\n\t\t\t\tcustomControlsColor: '#552222',\n\t\t\t\tcustomNameboxColor: '#ffeef6',\n\t\t\t\tcustomNameboxWidth: 168,\n\t\t\t\tcustomNameboxStroke: '#bb5599',\n\t\t\t\ttalkingDefault: 'No-one',\n\t\t\t\ttalkingOther: '',\n\t\t\t\ttext: '',\n\t\t\t\tresetBounds,\n\t\t\t} as ITextBox,\n\t\t} as ICreateObjectMutation);\n\t\treturn id;\n\t},\n\n\tsetStyle({ commit }, command: ISetTextBoxStyleAction) {\n\t\tcommit('setStyle', {\n\t\t\tid: command.id,\n\t\t\tstyle: command.style,\n\t\t} as ISetTextBoxStyleMutation);\n\t},\n\n\tresetTextboxBounds(\n\t\t{ commit, state, dispatch },\n\t\tcommand: IResetTextboxBounds\n\t) {\n\t\tconst obj = state.objects[command.id] as ITextBox;\n\t\tcommit('setPosition', {\n\t\t\tid: command.id,\n\t\t\tx: obj.resetBounds.x,\n\t\t\ty: obj.resetBounds.y,\n\t\t} as ISetObjectPositionMutation);\n\t\tcommit('setSize', {\n\t\t\tid: command.id,\n\t\t\theight: obj.resetBounds.height,\n\t\t\twidth: obj.resetBounds.width,\n\t\t} as ISetSpriteSizeMutation);\n\t},\n\n\tasync splitTextbox({ commit, state, dispatch }, command: ISplitTextbox) {\n\t\tconst obj = state.objects[command.id];\n\t\tconst newWidth = (obj.width - 4) / 2;\n\t\tcommit('setResetBounds', {\n\t\t\tid: command.id,\n\t\t\tresetBounds: {\n\t\t\t\tx: obj.x - newWidth / 2,\n\t\t\t\ty: obj.y,\n\t\t\t\twidth: newWidth,\n\t\t\t\theight: obj.height,\n\t\t\t},\n\t\t} as ISetResetBoundsMutation);\n\t\tcommit('setStyle', {\n\t\t\tid: command.id,\n\t\t\tstyle: 'custom',\n\t\t} as ISetTextBoxStyleMutation);\n\t\tconst id = (await dispatch('createTextBox', {\n\t\t\tresetBounds: {\n\t\t\t\tx: obj.x + newWidth + 2,\n\t\t\t\ty: obj.y,\n\t\t\t\twidth: newWidth,\n\t\t\t\theight: obj.height,\n\t\t\t},\n\t\t} as ICreateTextBoxAction)) as string;\n\t\tcommit('setStyle', {\n\t\t\tid,\n\t\t\tstyle: 'custom',\n\t\t} as ISetTextBoxStyleMutation);\n\t\tif (obj.flip) {\n\t\t\tcommit('setFlip', {\n\t\t\t\tid,\n\t\t\t\tflip: obj.flip,\n\t\t\t} as ISetObjectFlipMutation);\n\t\t}\n\t},\n};\n\nexport interface ISetTextBoxTextMutation extends ICommand {\n\treadonly text: string;\n}\n\nexport interface ISetTextBoxTalkingDefaultMutation extends ICommand {\n\treadonly talkingDefault: ITextBox['talkingDefault'];\n}\n\nexport interface ISetTextBoxTalkingOtherMutation extends ICommand {\n\treadonly talkingOther: string;\n}\n\nexport interface ISetTextBoxStyleMutation extends ICommand {\n\treadonly style: ITextBox['style'];\n}\n\nexport interface ISetTextBoxControlsVisibleMutation extends ICommand {\n\treadonly controls: boolean;\n}\n\nexport interface ISetTextBoxDeriveCustomColorMutation extends ICommand {\n\treadonly deriveCustomColors: boolean;\n}\n\nexport interface ISetTextBoxCustomControlsColorMutation extends ICommand {\n\treadonly customControlsColor: string;\n}\n\nexport interface ISetTextBoxNameboxColorMutation extends ICommand {\n\treadonly customNameboxColor: string;\n}\n\nexport interface ISetTextBoxNameboxStrokeMutation extends ICommand {\n\treadonly customNameboxStroke: string;\n}\n\nexport interface ISetTextBoxNameboxWidthMutation extends ICommand {\n\treadonly customNameboxWidth: number;\n}\n\nexport interface ISetTextBoxAutoQuotingMutation extends ICommand {\n\treadonly autoQuoting: boolean;\n}\n\nexport interface ISetResetBoundsMutation extends ICommand {\n\treadonly resetBounds: ITextBox['resetBounds'];\n}\n\nexport interface ISetTextBoxControlsSkipMutation extends ICommand {\n\treadonly skip: boolean;\n}\n\nexport interface ISetTextBoxControlsContinueMutation extends ICommand {\n\treadonly continue: boolean;\n}\n\nexport interface ISetTextBoxCustomColorMutation extends ICommand {\n\treadonly color: string;\n}\n\nexport interface ICreateTextBoxAction extends ICommand {\n\treadonly resetBounds?: ITextBox['resetBounds'];\n}\n\nexport interface ISetTextBoxStyleAction extends ICommand {\n\treadonly style: ITextBox['style'];\n}\n\nexport interface ISplitTextbox extends ICommand {}\n\nexport interface IResetTextboxBounds extends ICommand {}\n","import { Module } from 'vuex';\nimport { ICommand } from '@/eventbus/command';\nimport { spriteMutations, spriteActions } from './objectTypes/sprite';\nimport {\n\tcharacterActions,\n\tcharacterMutations,\n\tfixContentPackRemovalFromCharacter,\n} from './objectTypes/characters';\nimport { textBoxActions, textBoxMutations } from './objectTypes/textbox';\nimport { IRootState } from '.';\nimport { ContentPack } from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\nimport { IAsset } from './content';\nimport Vue from 'vue';\n\nexport interface IPanel {\n\tid: string;\n\torder: string[];\n\tonTopOrder: string[];\n}\n\nexport interface IObjectsState {\n\tobjects: { [id: string]: IObject };\n\tpanels: { [id: string]: IPanel };\n}\n\nexport interface IObject {\n\ttype: ObjectTypes;\n\tpanelId: string;\n\tid: string;\n\tx: number;\n\ty: number;\n\twidth: number;\n\theight: number;\n\tpreserveRatio: boolean;\n\tratio: number;\n\topacity: number;\n\tversion: number;\n\tflip: boolean;\n\tonTop: boolean;\n}\n\nexport type ObjectTypes = 'sprite' | 'character' | 'textBox';\n\nlet lastCopyId = 0;\n\nexport default {\n\tnamespaced: true,\n\tstate: {\n\t\tobjects: {},\n\t\tpanels: {},\n\t},\n\tmutations: {\n\t\tcreate(state, { object }: ICreateObjectMutation) {\n\t\t\tif (!state.panels[object.panelId]) {\n\t\t\t\tVue.set(state.panels, object.panelId, {\n\t\t\t\t\tid: object.panelId,\n\t\t\t\t\tonTopOrder: [],\n\t\t\t\t\torder: [],\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst panel = state.panels[object.panelId];\n\t\t\tconst collection = object.onTop ? panel.onTopOrder : panel.order;\n\t\t\tVue.set(state.objects, object.id, object);\n\t\t\tcollection.push(object.id);\n\t\t},\n\t\tremoveFromList(state, command: IRemoveFromListMutation) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tconst panel = state.panels[obj.panelId];\n\t\t\tconst collection = command.onTop ? panel.onTopOrder : panel.order;\n\t\t\tconst idx = collection.indexOf(command.id);\n\t\t\tcollection.splice(idx, 1);\n\t\t},\n\t\taddToList(state, command: IAddToListMutation) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tconst panel = state.panels[obj.panelId];\n\t\t\tconst collection = command.onTop ? panel.onTopOrder : panel.order;\n\t\t\tcollection.splice(command.position, 0, command.id);\n\t\t},\n\t\tsetOnTop(state, command: ISetOnTopMutation) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tobj.onTop = command.onTop;\n\t\t},\n\t\tsetPosition(state, command: ISetObjectPositionMutation) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tobj.x = command.x;\n\t\t\tobj.y = command.y;\n\t\t},\n\t\tsetFlip(state, command: ISetObjectFlipMutation) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tobj.flip = command.flip;\n\t\t},\n\t\tsetOpacity(state, command: ISetObjectOpacityMutation) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tobj.opacity = command.opacity;\n\t\t},\n\t\tsetSize(state, command: ISetSpriteSizeMutation) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tobj.width = command.width;\n\t\t\tobj.height = command.height;\n\t\t},\n\t\tsetRatio(state, command: ISetSpriteRatioMutation) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tobj.preserveRatio = command.preserveRatio;\n\t\t\tobj.ratio = command.ratio;\n\t\t},\n\t\tremoveObject(state, command: IRemoveObjectMutation) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tdelete state.objects[command.id];\n\t\t\tconst panel = state.panels[obj.panelId];\n\t\t\tif (panel.onTopOrder.length === 0 && panel.order.length === 0) {\n\t\t\t\tdelete state.panels[obj.panelId];\n\t\t\t}\n\t\t},\n\t\t...spriteMutations,\n\t\t...characterMutations,\n\t\t...textBoxMutations,\n\t},\n\tactions: {\n\t\tremoveObject({ state, commit, rootState }, command: IRemoveObjectAction) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tif (rootState.ui.selection === command.id) {\n\t\t\t\tcommit('ui/setSelection', null, { root: true });\n\t\t\t}\n\t\t\tcommit('removeFromList', {\n\t\t\t\tid: command.id,\n\t\t\t\tonTop: obj.onTop,\n\t\t\t} as IRemoveFromListMutation);\n\t\t\tcommit('removeObject', {\n\t\t\t\tid: command.id,\n\t\t\t} as IRemoveObjectMutation);\n\t\t},\n\t\tsetPosition({ state, commit, dispatch }, command: ISetPositionAction) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tif (obj.type === 'character') {\n\t\t\t\tdispatch('setCharacterPosition', command as ISetPositionAction);\n\t\t\t} else {\n\t\t\t\tcommit('setPosition', command as ISetObjectPositionMutation);\n\t\t\t}\n\t\t},\n\t\tsetOnTop({ state, commit }, command: IObjectSetOnTopAction) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tconst panel = state.panels[obj.panelId];\n\t\t\tif (obj.onTop === command.onTop) return;\n\t\t\tcommit('removeFromList', {\n\t\t\t\tid: command.id,\n\t\t\t\tonTop: obj.onTop,\n\t\t\t} as IRemoveFromListMutation);\n\t\t\tcommit('addToList', {\n\t\t\t\tid: command.id,\n\t\t\t\tposition: (command.onTop ? panel.onTopOrder : panel.order).length,\n\t\t\t\tonTop: command.onTop,\n\t\t\t} as IRemoveFromListMutation);\n\t\t\tcommit('setOnTop', {\n\t\t\t\tid: command.id,\n\t\t\t\tonTop: command.onTop,\n\t\t\t} as ISetOnTopMutation);\n\t\t},\n\t\tshiftLayer({ state, commit }, command: IObjectShiftLayerAction) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tconst panel = state.panels[obj.panelId];\n\t\t\tconst collection = obj.onTop ? panel.onTopOrder : panel.order;\n\t\t\tconst position = collection.indexOf(obj.id);\n\n\t\t\tlet newPosition = position + command.delta;\n\t\t\tif (newPosition < 0) {\n\t\t\t\tnewPosition = 0;\n\t\t\t}\n\t\t\tif (newPosition > collection.length) {\n\t\t\t\tnewPosition = collection.length;\n\t\t\t}\n\t\t\tcommit('removeFromList', {\n\t\t\t\tid: command.id,\n\t\t\t\tonTop: obj.onTop,\n\t\t\t} as IRemoveFromListMutation);\n\t\t\tcommit('addToList', {\n\t\t\t\tid: command.id,\n\t\t\t\tposition: newPosition,\n\t\t\t\tonTop: obj.onTop,\n\t\t\t} as IAddToListMutation);\n\t\t},\n\t\tsetPreserveRatio({ commit, state }, command: ISetRatioAction) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tconst ratio = command.preserveRatio ? obj.width / obj.height : 0;\n\t\t\tcommit('setRatio', {\n\t\t\t\tid: command.id,\n\t\t\t\tpreserveRatio: command.preserveRatio,\n\t\t\t\tratio,\n\t\t\t} as ISetSpriteRatioMutation);\n\t\t},\n\t\tsetWidth({ commit, state }, command: ISetWidthAction) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tconst height = !obj.preserveRatio\n\t\t\t\t? obj.height\n\t\t\t\t: command.width / obj.ratio;\n\t\t\tcommit('setSize', {\n\t\t\t\tid: command.id,\n\t\t\t\theight,\n\t\t\t\twidth: command.width,\n\t\t\t} as ISetSpriteSizeMutation);\n\t\t},\n\t\tsetHeight({ commit, state }, command: ISetHeightAction) {\n\t\t\tconst obj = state.objects[command.id];\n\t\t\tconst width = !obj.preserveRatio ? obj.width : command.height * obj.ratio;\n\t\t\tcommit('setSize', {\n\t\t\t\tid: command.id,\n\t\t\t\theight: command.height,\n\t\t\t\twidth,\n\t\t\t} as ISetSpriteSizeMutation);\n\t\t},\n\t\tfixContentPackRemoval(context, oldContent: ContentPack<IAsset>) {\n\t\t\tObject.values(context.state.objects).map(obj => {\n\t\t\t\tswitch (obj.type) {\n\t\t\t\t\tcase 'character':\n\t\t\t\t\t\tfixContentPackRemovalFromCharacter(context, obj.id, oldContent);\n\t\t\t\t\t\treturn;\n\t\t\t\t\tcase 'sprite':\n\t\t\t\t\t\treturn;\n\t\t\t\t\tcase 'textBox':\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tcopyObjects(\n\t\t\t{ commit, state },\n\t\t\t{ sourcePanelId, targetPanelId }: ICopyObjectsAction\n\t\t) {\n\t\t\tconst sourceOrders = state.panels[sourcePanelId];\n\t\t\tfor (const id of [...sourceOrders.onTopOrder, ...sourceOrders.order]) {\n\t\t\t\tconst oldObject = state.objects[id];\n\t\t\t\tcommit('create', {\n\t\t\t\t\tobject: {\n\t\t\t\t\t\t...JSON.parse(JSON.stringify(oldObject)),\n\t\t\t\t\t\tid: `copy_${oldObject.id}_${++lastCopyId}`,\n\t\t\t\t\t\tpanelId: targetPanelId,\n\t\t\t\t\t},\n\t\t\t\t} as ICreateObjectMutation);\n\t\t\t}\n\t\t},\n\t\tdeleteAllOfPanel({ state, dispatch }, { panelId }: IDeleteAllOfPanel) {\n\t\t\tconst panel = state.panels[panelId];\n\t\t\tfor (const id of [...panel.onTopOrder, ...panel.order]) {\n\t\t\t\tdispatch('removeObject', { id } as IRemoveObjectAction);\n\t\t\t}\n\t\t},\n\t\t...spriteActions,\n\t\t...characterActions,\n\t\t...textBoxActions,\n\t},\n} as Module<IObjectsState, IRootState>;\n\nexport interface ICreateObjectMutation {\n\treadonly object: IObject;\n}\n\nexport interface IDeleteAllOfPanel {\n\treadonly panelId: string;\n}\n\nexport interface IObjectMutation {\n\treadonly id: string;\n}\n\nexport interface ISetSpriteSizeMutation extends ICommand {\n\treadonly width: number;\n\treadonly height: number;\n}\n\nexport interface ISetSpriteRatioMutation extends ICommand {\n\treadonly preserveRatio: boolean;\n\treadonly ratio: number;\n}\n\nexport interface ISetObjectPositionMutation extends IObjectMutation {\n\treadonly x: number;\n\treadonly y: number;\n}\n\nexport interface ISetOnTopMutation extends IObjectMutation {\n\treadonly onTop: boolean;\n}\n\nexport interface ISetObjectFlipMutation extends IObjectMutation {\n\treadonly flip: boolean;\n}\n\nexport interface ISetObjectOpacityMutation extends IObjectMutation {\n\treadonly opacity: number;\n}\n\nexport interface IRemoveFromListMutation extends IObjectMutation {\n\treadonly onTop: boolean;\n}\n\nexport interface IAddToListMutation extends IObjectMutation {\n\treadonly onTop: boolean;\n\treadonly position: number;\n}\n\nexport interface IObjectShiftLayerAction extends ICommand {\n\treadonly delta: number;\n}\n\nexport interface IObjectSetOnTopAction extends ICommand {\n\treadonly onTop: boolean;\n}\n\nexport interface ISetWidthAction extends ICommand {\n\treadonly width: number;\n}\n\nexport interface ISetHeightAction extends ICommand {\n\treadonly height: number;\n}\n\nexport interface ISetRatioAction extends ICommand {\n\treadonly preserveRatio: boolean;\n}\n\nexport interface IRemoveObjectMutation extends ICommand {}\nexport interface IRemoveObjectAction extends ICommand {}\n\nexport interface ISetPositionAction extends ICommand {\n\treadonly x: number;\n\treadonly y: number;\n}\n\nexport interface IObjectContentPackRemovalAction extends ICommand {\n\treadonly oldPack: ContentPack<IAsset>;\n}\n\nexport interface ICopyObjectsAction {\n\treadonly sourcePanelId: string;\n\treadonly targetPanelId: string;\n}\n","import { Module } from 'vuex';\nimport { IRootState } from '.';\n\nexport interface IUiState {\n\tvertical: boolean;\n\tnsfw: boolean;\n\tselection: string | null;\n\tlqRendering: boolean;\n\tlastDownload: string | null;\n}\n\nexport default {\n\tnamespaced: true,\n\tstate: {\n\t\tvertical: false,\n\t\tlqRendering: true,\n\t\tnsfw: false,\n\t\tselection: null,\n\t\tlastDownload: null,\n\t},\n\tmutations: {\n\t\tsetVertical(state, vertical: boolean) {\n\t\t\tstate.vertical = vertical;\n\t\t},\n\t\tsetNsfw(state, nsfw: boolean) {\n\t\t\tstate.nsfw = nsfw;\n\t\t},\n\t\tsetLqRendering(state, lqRendering: boolean) {\n\t\t\tstate.lqRendering = lqRendering;\n\t\t},\n\t\tsetSelection(state, selection: string | null) {\n\t\t\tstate.selection = selection;\n\t\t},\n\t\tsetLastDownload(state, download: string) {\n\t\t\tstate.lastDownload = download;\n\t\t},\n\t},\n} as Module<IUiState, IRootState>;\n","import {\r\n\tContentPack,\r\n\tBackground,\r\n\tCharacter,\r\n\tHeadCollections,\r\n\tPose,\r\n} from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\r\nimport { IAsset } from '.';\r\n\r\nexport function mergeContentPacks(\r\n\tx: ContentPack<IAsset>,\r\n\ty: ContentPack<IAsset>\r\n): ContentPack<IAsset> {\r\n\treturn {\r\n\t\tbackgrounds: mergeBackgrounds(x.backgrounds, y.backgrounds),\r\n\t\tcharacters: mergeCharacters<IAsset>(x.characters, y.characters),\r\n\t\tfonts: mergeIdArrays(\r\n\t\t\tx.fonts,\r\n\t\t\ty.fonts,\r\n\t\t\tobj => obj.id,\r\n\t\t\t(xObj, yObj) => ({\r\n\t\t\t\t...xObj,\r\n\t\t\t\tfiles: mergeArrayUnique(xObj.files, yObj.files),\r\n\t\t\t})\r\n\t\t),\r\n\t\tpoemStyles: mergeIdArrays(\r\n\t\t\tx.poemStyles,\r\n\t\t\ty.poemStyles,\r\n\t\t\tobj => obj.label,\r\n\t\t\t() => {\r\n\t\t\t\tthrow new Error();\r\n\t\t\t}\r\n\t\t),\r\n\t\tsprites: mergeIdArrays(\r\n\t\t\tx.sprites,\r\n\t\t\ty.sprites,\r\n\t\t\tobj => obj.label,\r\n\t\t\t(xObj, yObj) => ({\r\n\t\t\t\tlabel: xObj.label,\r\n\t\t\t\tvariants: [...xObj.variants, ...yObj.variants],\r\n\t\t\t})\r\n\t\t),\r\n\t\tcolors: mergeIdArrays(\r\n\t\t\tx.colors,\r\n\t\t\ty.colors,\r\n\t\t\tobj => obj.color,\r\n\t\t\txObj => xObj\r\n\t\t),\r\n\t};\r\n}\r\n\r\nfunction mergeBackgrounds<A>(\r\n\tx: Array<Background<A>>,\r\n\ty: Array<Background<A>>\r\n): Array<Background<A>> {\r\n\treturn mergeIdArrays(x, y, obj => obj.id, mergeBackground);\r\n}\r\n\r\nfunction mergeBackground<A>(x: Background<A>, y: Background<A>): Background<A> {\r\n\treturn {\r\n\t\tid: x.id,\r\n\t\tlabel: x.label,\r\n\t\tvariants: [...x.variants, ...y.variants],\r\n\t};\r\n}\r\n\r\nfunction mergeCharacters<A>(\r\n\tx: Array<Character<A>>,\r\n\ty: Array<Character<A>>\r\n): Array<Character<A>> {\r\n\treturn mergeIdArrays(x, y, obj => obj.id, mergeCharacter);\r\n}\r\n\r\nfunction mergeCharacter<A>(x: Character<A>, y: Character<A>): Character<A> {\r\n\treturn {\r\n\t\tchibi: x.chibi,\r\n\t\tid: x.id,\r\n\t\tlabel: x.label,\r\n\t\tsize: x.size,\r\n\t\tstyleComponents: mergeIdArrays(\r\n\t\t\tx.styleComponents,\r\n\t\t\ty.styleComponents,\r\n\t\t\tobj => obj.name,\r\n\t\t\t(xObj, yObj) => ({\r\n\t\t\t\tlabel: xObj.label,\r\n\t\t\t\tname: xObj.name,\r\n\t\t\t\tvariants: {\r\n\t\t\t\t\t...yObj.variants,\r\n\t\t\t\t\t...xObj.variants,\r\n\t\t\t\t},\r\n\t\t\t})\r\n\t\t),\r\n\t\theads: mergeHeadCollections(x.heads, y.heads),\r\n\t\tposes: mergeIdArrays(x.poses, y.poses, obj => obj.name, mergePose),\r\n\t\tstyles: mergeIdArrays(\r\n\t\t\tx.styles,\r\n\t\t\ty.styles,\r\n\t\t\tobj => obj.name,\r\n\t\t\t(xStyle, yStyle) => {\r\n\t\t\t\tthrow new Error('Colliding style definitions');\r\n\t\t\t}\r\n\t\t),\r\n\t};\r\n}\r\n\r\nfunction mergePose<A>(x: Pose<A>, y: Pose<A>): Pose<A> {\r\n\tif (x.static && x.static.length > 0 && y.static && y.static.length > 0) {\r\n\t\tthrow new Error('Colliding static poses');\r\n\t}\r\n\r\n\treturn {\r\n\t\tcompatibleHeads: mergeArrayUnique(x.compatibleHeads, y.compatibleHeads),\r\n\t\theadAnchor: x.headAnchor,\r\n\t\tleft: [...x.left, ...y.left],\r\n\t\tright: [...x.right, ...y.right],\r\n\t\tname: x.name,\r\n\t\toffset: x.offset,\r\n\t\trenderOrder: x.renderOrder,\r\n\t\tsize: x.size,\r\n\t\tstatic: x.static,\r\n\t\tstyle: x.style,\r\n\t\tvariant: [...x.variant, ...y.variant],\r\n\t};\r\n}\r\n\r\nfunction mergeHeadCollections<A>(\r\n\tx: HeadCollections<A>,\r\n\ty: HeadCollections<A>\r\n): HeadCollections<A> {\r\n\tconst ret = { ...x };\r\n\r\n\tfor (const headGroupKey in y) {\r\n\t\tif (!y.hasOwnProperty(headGroupKey)) continue;\r\n\t\tconst headGroup = y[headGroupKey];\r\n\t\tif (ret[headGroupKey]) {\r\n\t\t\tconst oldHeadGroup = ret[headGroupKey];\r\n\t\t\tret[headGroupKey] = {\r\n\t\t\t\toffset: oldHeadGroup.offset,\r\n\t\t\t\tsize: oldHeadGroup.size,\r\n\t\t\t\tvariants: [...oldHeadGroup.variants, ...headGroup.variants],\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tret[headGroupKey] = headGroup;\r\n\t\t}\r\n\t}\r\n\r\n\treturn ret;\r\n}\r\n\r\nfunction mergeArrayUnique<A>(x: A[], y: A[]): A[] {\r\n\tconst ret = [...x];\r\n\tfor (const yObj of y) {\r\n\t\tif (!ret.includes(yObj)) {\r\n\t\t\tret.push(yObj);\r\n\t\t}\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\nfunction mergeIdArrays<A, B>(\r\n\tx: A[],\r\n\ty: A[],\r\n\tgetId: (obj: A) => B,\r\n\tmerge: (x: A, y: A) => A\r\n): A[] {\r\n\tconst ret = [...x];\r\n\tconst definedIds = new Map<B, number>(\r\n\t\tx.map((xObj, idx) => [getId(xObj), idx])\r\n\t);\r\n\r\n\tfor (const yObj of y) {\r\n\t\tconst yId = getId(yObj);\r\n\t\tif (definedIds.has(yId)) {\r\n\t\t\tconst existingIdx = definedIds.get(yId)!;\r\n\t\t\tconst existing = ret[existingIdx];\r\n\t\t\tret.splice(existingIdx, 1, merge(existing, yObj));\r\n\t\t} else {\r\n\t\t\tdefinedIds.set(yId, ret.length);\r\n\t\t\tret.push(yObj);\r\n\t\t}\r\n\t}\r\n\r\n\treturn ret;\r\n}\r\n","import { Module } from 'vuex';\r\nimport {\r\n\tContentPack,\r\n\tCharacter,\r\n\tBackground,\r\n} from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\r\nimport {\r\n\tassetWalker,\r\n\tnormalizePath,\r\n} from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/util';\r\nimport { normalizeContentPack } from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/parser';\r\nimport { convert as convertV1 } from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/convertV1';\r\n// tslint:disable-next-line: max-line-length\r\nimport { normalizeCharacter as normalizeCharacterV1 } from '@edave64/doki-doki-dialog-generator-pack-format/dist/v1/parser';\r\nimport { isWebPSupported } from '@/asset-manager';\r\nimport { mergeContentPacks } from './merge';\r\nimport { IRootState } from '..';\r\n\r\nexport interface IContentState {\r\n\tcontentPacks: Array<ContentPack<IAsset>>;\r\n\tcurrent: ContentPack<IAsset>;\r\n}\r\n\r\nexport interface IAsset {\r\n\thq: string;\r\n\tlq: string;\r\n\tsourcePack: string;\r\n}\r\n\r\nfunction baseDir(url: string): string {\r\n\treturn (\r\n\t\turl\r\n\t\t\t.split('/')\r\n\t\t\t.slice(0, -1)\r\n\t\t\t.join('/') + '/'\r\n\t);\r\n}\r\n\r\n// These types are assumed to always be supported\r\nconst baseTypes = new Set(['png', 'gif', 'bmp', 'svg']);\r\n\r\nexport type BackgroundLookup = Map<\r\n\tBackground<IAsset>['id'],\r\n\tBackground<IAsset>\r\n>;\r\n\r\nexport default {\r\n\tnamespaced: true,\r\n\tstate: {\r\n\t\tcontentPacks: [],\r\n\t\tcurrent: {\r\n\t\t\tbackgrounds: [],\r\n\t\t\tcharacters: [],\r\n\t\t\tfonts: [],\r\n\t\t\tpoemStyles: [],\r\n\t\t\tsprites: [],\r\n\t\t\tcolors: [],\r\n\t\t},\r\n\t},\r\n\tmutations: {\r\n\t\tsetContentPacks(state: IContentState, packs: Array<ContentPack<IAsset>>) {\r\n\t\t\tstate.contentPacks = packs;\r\n\t\t},\r\n\t\tsetCurrentContent(state: IContentState, content: ContentPack<IAsset>) {\r\n\t\t\tstate.current = content;\r\n\t\t},\r\n\t},\r\n\tactions: {\r\n\t\tasync contentPack({ commit, state }, contentPack: ContentPack) {\r\n\t\t\tconst convertedPack = await convertContentPack(contentPack);\r\n\t\t\tcommit('setContentPacks', [...state.contentPacks, convertedPack]);\r\n\t\t\tcommit(\r\n\t\t\t\t'setCurrentContent',\r\n\t\t\t\tmergeContentPacks(state.current, convertedPack)\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\tasync removeContentPacks({ commit, state }, packIds: Set<string>) {\r\n\t\t\tconst newContentPacks = state.contentPacks.filter(\r\n\t\t\t\tpack => !packIds.has(pack.packId!)\r\n\t\t\t);\r\n\t\t\tcommit('setContentPacks', newContentPacks);\r\n\t\t\tcommit(\r\n\t\t\t\t'setCurrentContent',\r\n\t\t\t\tnewContentPacks.reduce((acc, value) => mergeContentPacks(acc, value))\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\tasync replaceContentPack(\r\n\t\t\t{ commit, state },\r\n\t\t\taction: ReplaceContentPackAction\r\n\t\t) {\r\n\t\t\tconst convertedPack = action.processed\r\n\t\t\t\t? action.contentPack\r\n\t\t\t\t: await convertContentPack(action.contentPack);\r\n\t\t\tconst packs = state.contentPacks;\r\n\t\t\tconst packIdx = packs.findIndex(\r\n\t\t\t\tpack => pack.packId === action.contentPack.packId\r\n\t\t\t);\r\n\t\t\tif (packIdx === -1) {\r\n\t\t\t\tpacks.push(convertedPack);\r\n\t\t\t} else {\r\n\t\t\t\tpacks.splice(packIdx, 1, convertedPack);\r\n\t\t\t}\r\n\t\t\tcommit('setContentPacks', packs);\r\n\t\t\tcommit(\r\n\t\t\t\t'setCurrentContent',\r\n\t\t\t\tpacks.reduce((acc, value) => mergeContentPacks(acc, value))\r\n\t\t\t);\r\n\t\t},\r\n\r\n\t\tasync loadContentPacks({ dispatch }, urls: string | string[]) {\r\n\t\t\tif (typeof urls === 'string') {\r\n\t\t\t\turls = [urls];\r\n\t\t\t}\r\n\t\t\tconst contentPacks = await Promise.all(\r\n\t\t\t\turls.map(async url => {\r\n\t\t\t\t\tconst response = await fetch(url);\r\n\t\t\t\t\tif (response.status !== 200) {\r\n\t\t\t\t\t\terror(\r\n\t\t\t\t\t\t\t`Could not load content pack. Server responded with: ${response.statusText}`\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet json;\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tjson = await response.json();\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\terror('Content pack is not valid json!');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet contentPack: ContentPack;\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tconst paths = {\r\n\t\t\t\t\t\t\t'./': baseDir(url),\r\n\t\t\t\t\t\t\t'/': baseDir(location.href) + 'assets/',\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tif (json.version === '2.0') {\r\n\t\t\t\t\t\t\tcontentPack = normalizeContentPack(json, paths);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcontentPack = convertV1(normalizeCharacterV1(json, paths), false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\terror('Content pack is not in a valid format!', e);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn contentPack;\r\n\t\t\t\t})\r\n\t\t\t);\r\n\r\n\t\t\tfor (const contentPack of contentPacks) {\r\n\t\t\t\tawait dispatch('contentPack', contentPack);\r\n\t\t\t}\r\n\t\t},\r\n\t},\r\n\tgetters: {\r\n\t\tgetCharacters({\r\n\t\t\tcurrent,\r\n\t\t}): Map<Character<IAsset>['id'], Character<IAsset>> {\r\n\t\t\tconst ret = new Map<Character<IAsset>['id'], Character<IAsset>>();\r\n\t\t\tfor (const character of current.characters) {\r\n\t\t\t\tret.set(character.id, character);\r\n\t\t\t}\r\n\t\t\treturn ret;\r\n\t\t},\r\n\t\tgetBackgrounds({ current }): BackgroundLookup {\r\n\t\t\tconst ret = new Map<Background<IAsset>['id'], Background<IAsset>>();\r\n\t\t\tfor (const background of current.backgrounds) {\r\n\t\t\t\tret.set(background.id, background);\r\n\t\t\t}\r\n\t\t\treturn ret;\r\n\t\t},\r\n\t},\r\n} as Module<IContentState, IRootState>;\r\n\r\nasync function convertContentPack(\r\n\tpack: ContentPack\r\n): Promise<ContentPack<IAsset>> {\r\n\tconst types: ReadonlySet<string> = new Set(\r\n\t\t(await isWebPSupported()) ? ['webp', ...baseTypes] : baseTypes\r\n\t);\r\n\r\n\treturn assetWalker(\r\n\t\tpack,\r\n\t\t(path: string, type: 'image' | 'font'): IAsset => {\r\n\t\t\tconst replacementMap = new Map([\r\n\t\t\t\t['ext', '{lq:.lq:}.{format:webp:webp:png:png}'],\r\n\t\t\t]);\r\n\t\t\tconst hq = normalizePath(path, replacementMap, types, false);\r\n\t\t\tconst lq = normalizePath(path, replacementMap, types, true);\r\n\r\n\t\t\treturn {\r\n\t\t\t\thq,\r\n\t\t\t\tlq,\r\n\t\t\t\tsourcePack: pack.packId || 'buildIn',\r\n\t\t\t};\r\n\t\t}\r\n\t);\r\n}\r\n\r\nfunction error(msg: string, payload?: any): never {\r\n\tconsole.error(msg, payload);\r\n\tthrow new Error(msg);\r\n}\r\n\r\n// tslint:disable: indent\r\nexport type ReplaceContentPackAction =\r\n\t| {\r\n\t\t\tcontentPack: ContentPack<string>;\r\n\t\t\tprocessed: false;\r\n\t  }\r\n\t| {\r\n\t\t\tcontentPack: ContentPack<IAsset>;\r\n\t\t\tprocessed: true;\r\n\t  };\r\n// tslint:enable: indent\r\n","import Vue from 'vue';\nimport Vuex from 'vuex';\nimport objects, { IObjectsState } from './objects';\nimport ui, { IUiState } from './ui';\nimport panels, { IPanels } from './panels';\nimport content, { IContentState, IAsset } from './content';\nimport { ContentPack } from '@edave64/doki-doki-dialog-generator-pack-format/dist/v2/model';\n\nVue.use(Vuex);\n\nexport interface IRootState {\n\tobjects: IObjectsState;\n\tui: IUiState;\n\tpanels: IPanels;\n\tcontent: IContentState;\n\tunsafe: boolean;\n}\n\nexport default new Vuex.Store<IRootState>({\n\tmodules: {\n\t\tobjects,\n\t\tui,\n\t\tpanels,\n\t\tcontent,\n\t},\n\tstate: {\n\t\tunsafe: false,\n\t} as any,\n\tmutations: {\n\t\tsetUnsafe(state, unsafe: boolean) {},\n\t},\n\tactions: {\n\t\tasync removePacks(\n\t\t\t{ dispatch, commit, state },\n\t\t\t{ packs }: IRemovePacksAction\n\t\t) {\n\t\t\tconst oldState: ContentPack<IAsset> = JSON.parse(\n\t\t\t\tJSON.stringify(state.content.current)\n\t\t\t);\n\n\t\t\tcommit('setUnsafe', true);\n\t\t\tawait dispatch('content/removeContentPacks', packs);\n\t\t\tawait dispatch('panels/fixContentPackRemoval', oldState);\n\t\t\tawait dispatch('objects/fixContentPackRemoval', oldState);\n\t\t\tcommit('setUnsafe', false);\n\t\t},\n\t},\n});\n\nexport interface IRemovePacksAction {\n\tpacks: Set<string>;\n}\n","import { IHistoryOptions } from '@/plugins/vuex-history';\n\nexport default {\n\tmutations: {},\n} as IHistoryOptions;\n","import { IHistoryOptions } from '@/plugins/vuex-history';\nimport SpriteHistoryOptions from './objectTypes/sprite_history_properties';\n\nexport default {\n\tmutations: {\n\t\t'objects/*': {\n\t\t\tcombinable: (oldMut, newMut) =>\n\t\t\t\toldMut.type === newMut.type && oldMut.payload.id === newMut.payload.id,\n\t\t},\n\t\t'objects/create': {\n\t\t\tcombinable: () => false,\n\t\t},\n\t\t'objects/removeObject': {\n\t\t\tcombinable: () => false,\n\t\t},\n\t\t...SpriteHistoryOptions.mutations,\n\t},\n} as IHistoryOptions;\n","import Vue from 'vue';\r\nimport Vuex from 'vuex';\r\nimport History from './plugins/vuex-history';\r\nimport App from './App.vue';\r\nimport store from '@/store';\r\n// import './registerServiceWorker';\r\nimport ObjectsHistoryProperties from './store/objects_history_properties';\r\n\r\nVue.config.productionTip = false;\r\nVue.use(Vuex);\r\nVue.use(History, {\r\n\tmutations: {\r\n\t\t...ObjectsHistoryProperties.mutations,\r\n\t},\r\n});\r\n\r\nnew Vue({\r\n\tstore: store as any,\r\n\trender: h => h(App),\r\n}).$mount('#app');\r\n","import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./button.vue?vue&type=style&index=0&id=73a85b48&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./button.vue?vue&type=style&index=0&id=73a85b48&lang=scss&scoped=true&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./opacity.vue?vue&type=style&index=0&id=28c7d1e4&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./opacity.vue?vue&type=style&index=0&id=28c7d1e4&lang=scss&scoped=true&\"","import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./text.vue?vue&type=style&index=0&id=3077e0d8&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./text.vue?vue&type=style&index=0&id=3077e0d8&lang=scss&scoped=true&\"","import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./color.vue?vue&type=style&index=0&id=6d18bc19&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./color.vue?vue&type=style&index=0&id=6d18bc19&lang=scss&scoped=true&\""],"sourceRoot":""}