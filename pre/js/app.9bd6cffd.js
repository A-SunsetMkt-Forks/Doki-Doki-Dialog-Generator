(function(t){function e(e){for(var r,o,c=e[0],s=e[1],u=e[2],l=0,d=[];l<c.length;l++)o=c[l],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&d.push(a[o][0]),a[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);p&&p(e);while(d.length)d.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(r=!1)}r&&(i.splice(e--,1),t=s(s.s=n[0]))}return t}var r={},o={app:0},a={app:0},i=[];function c(t){return s.p+"js/"+({}[t]||t)+"."+{"chunk-60772680":"0665ae51","chunk-73a8933a":"7874c4e7"}[t]+".js"}function s(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(t){var e=[],n={"chunk-60772680":1,"chunk-73a8933a":1};o[t]?e.push(o[t]):0!==o[t]&&n[t]&&e.push(o[t]=new Promise((function(e,n){for(var r="css/"+({}[t]||t)+"."+{"chunk-60772680":"ff8562d7","chunk-73a8933a":"797ebd56"}[t]+".css",a=s.p+r,i=document.getElementsByTagName("link"),c=0;c<i.length;c++){var u=i[c],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===r||l===a))return e()}var d=document.getElementsByTagName("style");for(c=0;c<d.length;c++){u=d[c],l=u.getAttribute("data-href");if(l===r||l===a)return e()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=e,p.onerror=function(e){var r=e&&e.target&&e.target.src||a,i=new Error("Loading CSS chunk "+t+" failed.\n("+r+")");i.code="CSS_CHUNK_LOAD_FAILED",i.request=r,delete o[t],p.parentNode.removeChild(p),n(i)},p.href=a;var b=document.getElementsByTagName("head")[0];b.appendChild(p)})).then((function(){o[t]=0})));var r=a[t];if(0!==r)if(r)e.push(r[2]);else{var i=new Promise((function(e,n){r=a[t]=[e,n]}));e.push(r[2]=i);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,s.nc&&l.setAttribute("nonce",s.nc),l.src=c(t);var d=new Error;u=function(e){l.onerror=l.onload=null,clearTimeout(p);var n=a[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",d.name="ChunkLoadError",d.type=r,d.request=o,n[1](d)}a[t]=void 0}};var p=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(e)},s.m=t,s.c=r,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(n,r,function(e){return t[e]}.bind(null,r));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=e,u=u.slice();for(var d=0;d<u.length;d++)e(u[d]);var p=l;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"02e0":function(t,e,n){"use strict";n("7592")},"032b":function(t,e,n){"use strict";n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("96cf");var r=n("1da1"),o=n("d4ec"),a=n("bee2"),i=n("262e"),c=n("2caf"),s=(n("ac1f"),n("25f0"),n("1276"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("5530")),u=n("7a23"),l=function(){function t(){var e=this;Object(o["a"])(this,t),this.state=Object(u["s"])({autoAdd:[]}),this.isSavingEnabled=Object(u["t"])(!1),this.localRepositoryUrl="";var n=this,a=d.canSave();window.addEventListener("beforeunload",(function(t){t.preventDefault(),t.returnValue="Are you sure you want to leave? All your progress will be lost!"}));var i=Object(u["s"])({optionalSaving:a,get autoLoading(){return a&&n.isSavingEnabled.value},backgroundInstall:!1,localRepo:!1,lq:!0});this.supports=i,this.loading=a?Object(r["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d.doesDbExists();case 2:n=t.sent,e.savingEnabled=n;case 4:case"end":return t.stop()}}),t)})))():Promise.resolve()}return Object(a["a"])(t,[{key:"saveToFile",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){var r,o,a,i,c=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=c.length>2&&void 0!==c[2]?c[2]:"image/png",o=c.length>3&&void 0!==c[3]?c[3]:1,a=document.createElement("a"),a.setAttribute("download",n),t.next=6,this.createObjectURL(e,r,o);case 6:return i=t.sent,a.setAttribute("href",i),document.body.appendChild(a),a.click(),document.body.removeChild(a),t.abrupt("return",i);case 12:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"installBackground",value:function(t){throw new Error("This environment does not support installing backgrounds")}},{key:"uninstallBackground",value:function(t){throw new Error("This environment does not support uninstalling backgrounds")}},{key:"localRepoInstall",value:function(t){throw new Error("This environment does not support a local repository")}},{key:"localRepoUninstall",value:function(t){throw new Error("This environment does not support a local repository")}},{key:"autoLoadAdd",value:function(t){throw new Error("This environment does not support auto loading")}},{key:"autoLoadRemove",value:function(t){throw new Error("This environment does not support auto loading")}},{key:"loadSettings",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.loading;case 2:return t.next=4,this.creatingDB;case 4:if(e={darkMode:void 0,lq:!0,nsfw:!1,defaultCharacterTalkingZoom:!0},this.isSavingEnabled.value){t.next=7;break}return t.abrupt("return",e);case 7:return t.t0=s["a"],t.t1=Object(s["a"])({},e),t.next=11,d.loadSettings();case 11:return t.t2=t.sent,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 13:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"saveSettings",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.loading;case 2:return t.next=4,this.creatingDB;case 4:if(this.isSavingEnabled.value){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,d.saveSettings(e);case 8:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"isInitialized",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.loading;case 2:return t.next=4,this.creatingDB;case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"prompt",value:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e){return new Promise((function(n,r){n(prompt(t,e))}))}))},{key:"onPanelChange",value:function(t){}},{key:"createObjectURL",value:function(t,e,n){var r=this;return new Promise((function(o,a){var i=!(!window.URL||!window.URL.createObjectURL);if(!i)return o(t.toDataURL(e,n));if(t.toBlob)t.toBlob((function(t){t?o(URL.createObjectURL(t)):a()}),e,n);else{var c=t.toDataURL(e,n),s=r.dataURItoBlob(c,e);o(URL.createObjectURL(s))}}))}},{key:"dataURItoBlob",value:function(t,e){for(var n=atob(t.split(",")[1]),r=n.length,o=new Uint8Array(r),a=0;a<r;a++)o[a]=n.charCodeAt(a);return new Blob([o],{type:e})}},{key:"savingEnabled",get:function(){return this.isSavingEnabled.value},set:function(t){var e=this;t?(localStorage.setItem("saving","true"),this.creatingDB=d.createDB(),this.creatingDB.then((function(){e.creatingDB=void 0,e.isSavingEnabled.value=!0})).catch((function(){}))):(localStorage.clear(),this.isSavingEnabled.value=!1,this.creatingDB=d.clearDB().then((function(){e.creatingDB=void 0})).catch((function(){})))}}]),t}(),d={indexedDB:function(){try{return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB}catch(t){return null}}(),transaction:function(){try{return window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction}catch(t){return null}}(),db:null,canSave:function(){return!(!d.indexedDB||!window.localStorage)},doesDbExists:function(){var t=localStorage.getItem("saving");return"true"===t?Promise.resolve(!0):Promise.resolve(!1)},createDB:function(){return d.db?d.db:d.db=new Promise((function(t,e){var n=d.indexedDB.open("dddg",1);n.onerror=function(t){e(t)},n.onupgradeneeded=function(t){var e,n=t.target.result,r=null!==(e=t.oldVersion)&&void 0!==e?e:t.version;r<1&&n.createObjectStore("settings")},n.onsuccess=function(e){t(n.result)}}))},clearDB:function(){return new Promise((function(t,e){if(d.db){var n=d.indexedDB.deleteDatabase("dddg");d.db=null,n.onerror=function(t){e(t)},n.onsuccess=function(e){t()}}else t()}))},saveSettings:function(t){var e=this;return this.db?new Promise(function(){var n=Object(r["a"])(regeneratorRuntime.mark((function n(r,o){var a,i,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.db;case 2:a=n.sent.transaction(["settings"],"readwrite"),i=a.objectStore("settings"),c=i.put(Object(s["a"])({},t),0),c.onerror=function(t){o(t)},c.onsuccess=function(){r()};case 7:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}()):Promise.reject("No database")},loadSettings:function(){var t=this;return this.db?new Promise(function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(n,r){var o,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.db;case 2:o=e.sent.transaction(["settings"],"readonly"),a=o.objectStore("settings"),i=a.get(0),i.onerror=function(t){r(t)},i.onsuccess=function(t){n(i.result||{})};case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()):Promise.reject("No database")}},p=function(t){Object(i["a"])(n,t);var e=Object(c["a"])(n);function n(){return Object(o["a"])(this,n),e.apply(this,arguments)}return Object(a["a"])(n,[{key:"saveToFile",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){var r,o,a,i,c=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=c.length>2&&void 0!==c[2]?c[2]:"image/png",o=c.length>3&&void 0!==c[3]?c[3]:1,a=e.toDataURL(r,o),i=this.dataURItoBlob(a,r),window.URL&&window.URL.createObjectURL&&(a=URL.createObjectURL(i)),window.navigator.msSaveBlob(i,n),t.abrupt("return",a);case 7:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()}]),n}(l),b=(n("d81d"),n("2ca0"),n("5947")),h=n("0c0f"),f=n("4918"),v={packId:"dddg.buildin.installedBackgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},m=function(){function t(){var e=this;Object(o["a"])(this,t),this.state=Object(u["s"])({autoAdd:[]}),this.localRepositoryUrl="/repo/",this.electron=window,this.vuexHistory=null,this.$store=null,this.bgInvalidation=null,this.pendingContentPacks=[],this.supports={autoLoading:!0,backgroundInstall:!0,localRepo:!0,lq:!1,optionalSaving:!1},this.savingEnabled=!0,this.electron.ipcRenderer.on("add-persistent-content-pack",function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n,o){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$store&&e.vuexHistory){t.next=3;break}return e.pendingContentPacks.push(o),t.abrupt("return");case 3:e.vuexHistory.transaction(Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("content/loadContentPacks",o);case 2:case"end":return t.stop()}}),t)}))));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),this.electron.ipcRenderer.on("add-persistent-background",function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n,r){var o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:o="persistentBg-"+r,a=r.split("/"),Object(b["g"])(o,r),v.backgrounds.push({id:o,variants:[[o]],label:a[a.length-1]}),e.invalidateInstalledBGs();case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),this.electron.ipcRenderer.on("push-message",function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:h["g"].fire(new h["e"](n));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),this.electron.ipcRenderer.onConversation("load-packs",function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n,o){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,f["a"].getInstance();case 2:a=t.sent,i=o.map((function(t){var e=a.getPack(t);return e.dddg2Path||e.dddg1Path})),e.vuexHistory.transaction(Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("content/loadContentPacks",i);case 2:case"end":return t.stop()}}),t)}))));case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),this.electron.ipcRenderer.send("init")}return Object(a["a"])(t,[{key:"onPanelChange",value:function(t){}},{key:"saveSettings",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.electron.ipcRenderer.sendConvo("config.set","nsfw",e.nsfw);case 2:return t.next=4,this.electron.ipcRenderer.sendConvo("config.set","darkMode",null!==(n=e.darkMode)&&void 0!==n?n:void 0);case 4:return t.next=6,this.electron.ipcRenderer.sendConvo("config.set","defaultCharacterTalkingZoom",e.defaultCharacterTalkingZoom);case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"loadSettings",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.electron.ipcRenderer.sendConvo("config.get","nsfw");case 2:if(t.t1=e=t.sent,t.t0=null!==t.t1,!t.t0){t.next=6;break}t.t0=void 0!==e;case 6:if(!t.t0){t.next=10;break}t.t2=e,t.next=11;break;case 10:t.t2=!1;case 11:return t.t3=t.t2,t.next=14,this.electron.ipcRenderer.sendConvo("config.get","darkMode");case 14:if(t.t5=n=t.sent,t.t4=null!==t.t5,!t.t4){t.next=18;break}t.t4=void 0!==n;case 18:if(!t.t4){t.next=22;break}t.t6=n,t.next=23;break;case 22:t.t6=void 0;case 23:return t.t7=t.t6,t.next=26,this.electron.ipcRenderer.sendConvo("config.get","defaultCharacterTalkingZoom");case 26:if(t.t9=r=t.sent,t.t8=null!==t.t9,!t.t8){t.next=30;break}t.t8=void 0!==r;case 30:if(!t.t8){t.next=34;break}t.t10=r,t.next=35;break;case 34:t.t10=void 0;case 35:return t.t11=t.t10,t.abrupt("return",{lq:!1,nsfw:t.t3,darkMode:t.t7,defaultCharacterTalkingZoom:t.t11});case 37:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"localRepoInstall",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.electron.ipcRenderer.sendConvo("repo.install",e);case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"localRepoUninstall",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.electron.ipcRenderer.sendConvo("repo.uninstall",e);case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"autoLoadAdd",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.electron.ipcRenderer.sendConvo("auto-load.add",e);case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"autoLoadRemove",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.electron.ipcRenderer.sendConvo("auto-load.remove",e);case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"saveToFile",value:function(t,e){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return new Promise((function(i,c){t.toBlob(function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(r){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=3;break}return c(),t.abrupt("return");case 3:return t.next=5,r.arrayBuffer();case 5:return o=t.sent,t.next=8,n.electron.ipcRenderer.sendConvo("save-file",e,new Uint8Array(o));case 8:i(URL.createObjectURL(r));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),o,a)}))}},{key:"installBackground",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1===e.assets.length){t.next=2;break}return t.abrupt("return");case 2:if("dddg.buildin.uploadedBackgrounds"===e.assets[0].sourcePack){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,Object(b["b"])(e.assets[0].hq,!0);case 6:if(n=t.sent,n instanceof HTMLImageElement){t.next=9;break}return t.abrupt("return");case 9:return t.next=11,fetch(n.src);case 11:return r=t.sent,t.t0=Uint8Array,t.next=15,r.arrayBuffer();case 15:t.t1=t.sent,o=new t.t0(t.t1),this.electron.ipcRenderer.send("install-background",o);case 18:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"uninstallBackground",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(1===e.assets.length){t.next=2;break}return t.abrupt("return");case 2:if("dddg.buildin.installedBackgrounds"===e.assets[0].sourcePack){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,Object(b["b"])(e.assets[0].hq,!0);case 6:if(n=t.sent,n instanceof HTMLImageElement){t.next=9;break}return t.abrupt("return");case 9:if(n.src.startsWith("blob:")){t.next=18;break}return t.next=12,fetch(n.src);case 12:return r=t.sent,t.next=15,r.blob();case 15:o=t.sent,a=URL.createObjectURL(o),Object(b["g"])(e.assets[0].hq,a);case 18:this.electron.ipcRenderer.send("uninstall-background",e.id);case 19:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"prompt",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.electron.ipcRenderer.sendConvo("show-prompt",e,n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"connectToStore",value:function(t,e){var n=this;this.vuexHistory=t,this.$store=e,this.invalidateInstalledBGs(),this.pendingContentPacks.length>0&&this.vuexHistory.transaction(Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.$store.dispatch("content/loadContentPacks",n.pendingContentPacks);case 2:case"end":return t.stop()}}),t)}))))}},{key:"invalidateInstalledBGs",value:function(){var t=this;this.vuexHistory&&this.$store&&null===this.bgInvalidation&&(this.bgInvalidation=requestAnimationFrame((function(){t.updateInstalledBGs()})))}},{key:"updateInstalledBGs",value:function(){var t=this;this.bgInvalidation&&(cancelAnimationFrame(this.bgInvalidation),this.bgInvalidation=null),this.vuexHistory&&this.$store&&this.vuexHistory.transaction((function(){t.$store.dispatch("content/replaceContentPack",{contentPack:v})}))}}]),t}();function j(){return window.isElectron?new m:void 0!==window.navigator.msSaveOrOpenBlob?new p:new l}var g=j();window.toast=g;e["a"]=g},"0c0f":function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return c})),n.d(e,"d",(function(){return s})),n.d(e,"e",(function(){return u})),n.d(e,"b",(function(){return l})),n.d(e,"f",(function(){return d}));var r=n("d4ec"),o=n("14b7"),a=Object(o["a"])();e["g"]={fire:function(t){a.emit(t.kind,t)},subscribe:function(t,e){a.on(t.kind,e)},unsubscribe:function(t,e){a.off(t.kind,e)}};var i=function t(e){Object(r["a"])(this,t),this.path=e,this.kind="AssetFailureEvent"};i.kind="AssetFailureEvent";var c=function t(e){Object(r["a"])(this,t),this.error=e,this.kind="CustomAssetFailureEvent"};c.kind="CustomAssetFailureEvent";var s=function t(){Object(r["a"])(this,t),this.kind="InvalidateRenderEvent"};s.kind="InvalidateRenderEvent";var u=function t(e){Object(r["a"])(this,t),this.message=e,this.kind="ShowMessageEvent"};u.kind="ShowMessageEvent";var l=function t(e){Object(r["a"])(this,t),this.color=e,this.kind="ColorPickedEvent"};l.kind="ColorPickedEvent";var d=function t(e,n){Object(r["a"])(this,t),this.error=e,this.info=n,this.kind="VueErrorEvent"};d.kind="VueErrorEvent"},1049:function(t,e,n){},"13f8":function(t,e,n){"use strict";n("d7eb")},1831:function(t,e,n){},"1a7b":function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var r=n("b85c"),o=n("d4ec"),a=n("bee2"),i=n("45eb"),c=n("7e84"),s=n("262e"),u=n("2caf"),l=n("ba37"),d=n("4a6f"),p=function(t){Object(s["a"])(n,t);var e=Object(u["a"])(n);function n(t,r){var a;return Object(o["a"])(this,n),a=e.call(this,t),a.data=r,a.scaleable=!0,a}return Object(a["a"])(n,[{key:"updatedContent",value:function(t,e){Object(i["a"])(Object(c["a"])(n.prototype),"updatedContent",this).call(this,t,e),this.data=Object(l["e"])(t,this.obj)}},{key:"getAssetList",value:function(){var t,e=Object(l["h"])(this.data,this.obj),n=Object(l["f"])(this.data,this.obj),o=[],a=Object(r["a"])(e.renderCommands);try{for(a.s();!(t=a.n()).done;){var i=t.value;switch(i.type){case"head":o.push({offset:i.offset,composite:i.composite,assets:n?n.variants[this.obj.posePositions.head||0]:[]});break;case"image":o.push({offset:i.offset,composite:i.composite,assets:i.images});break;case"pose-part":var c=e.positions[i.part];if(!c||0===c.length)break;var s=c[this.obj.posePositions[i.part]||0];if(!s)break;o.push({offset:i.offset,composite:i.composite,assets:s});break}}}catch(u){a.e(u)}finally{a.f()}return o}},{key:"canvasHeight",get:function(){var t=Object(l["h"])(this.data,this.obj);return t.size[1]}},{key:"canvasWidth",get:function(){var t=Object(l["h"])(this.data,this.obj);return t.size[0]}},{key:"closeZoom",get:function(){var t=1;return this.obj.close&&(t*=2),t}},{key:"width",get:function(){return this.obj.width*this.closeZoom}},{key:"height",get:function(){return this.obj.height*this.closeZoom}}]),n}(d["a"])},"1b86":function(t,e,n){"use strict";n("3f8f")},"1c59":function(t,e,n){"use strict";n("d2ab")},2130:function(t,e,n){},2284:function(t,e,n){},2286:function(t,e,n){"use strict";n("1049")},"25d4":function(t,e,n){"use strict";n("f526")},"28de":function(t,e,n){"use strict";n("2130")},"2b40":function(t,e,n){},"2c10":function(t,e,n){"use strict";n("afc0")},"2c55":function(t,e,n){"use strict";n("350e")},"350e":function(t,e,n){},3672:function(t,e,n){"use strict";n("8eea")},3742:function(t,e,n){"use strict";n("859a")},"39b7":function(t,e,n){"use strict";var r=n("7a23");function o(t,e,n,o,a,i){return Object(r["p"])(),Object(r["g"])("a",{target:"_blank",rel:"noopener noreferrer",href:t.href},[Object(r["v"])(t.$slots,"default")],8,["href"])}n("ac1f"),n("5319");var a=n("aacd"),i=Object(r["m"])({mixins:[a["a"]],props:{to:{type:String,required:!0}},computed:{href:function(){var t=this.to;return t=t.replace(/^github:\/\//,"https://github.com/edave64/Doki-Doki-Dialog-Generator/"),t=t.replace(/^wiki:\/\/(.*)/,(function(t,e){return"https://github.com/edave64/Doki-Doki-Dialog-Generator/wiki/Version-2:-"+e.replaceAll(" ","-")})),t}}});i.render=o;e["a"]=i},"3f8f":function(t,e,n){},4265:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));n("d3b7");var r=n("3835"),o=(n("96cf"),n("1da1")),a=n("d4ec"),i=n("bee2"),c=n("fd0b"),s=n("8cae"),u=function(){function t(e){Object(a["a"])(this,t),this.obj=e,this.localRenderer=null,this.lastVersion=null,this.hitDetectionFallback=!1,this.renderable=!1,this.lastHq=!1,this.ready=Promise.resolve()}return Object(i["a"])(t,[{key:"updateLocalCanvas",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.ready;case 2:if(n=this.canvasWidth,r=this.canvasHeight,0!==r||0!==n){t.next=7;break}return this.renderable=!1,t.abrupt("return");case 7:return this.renderable=!0,this.localRenderer=new c["a"](n,r),this.lastHq=e,t.next=12,this.localRenderer.render(this.renderLocal.bind(this));case 12:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"needsRedraw",value:function(){return null===this.localRenderer||this.lastVersion!==this.version}},{key:"getRenderRotation",value:function(){return[this.flip?-this.rotation:this.rotation,{x:this.x,y:this.y+this.height/2}]}},{key:"render",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e,n){var o,a,i,c,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(o=this.lastHq!==n.hq||this.needsRedraw(),!o){t.next=4;break}return t.next=4,this.updateLocalCanvas(!n.hq);case 4:if(this.lastVersion=this.version,this.renderable){t.next=7;break}return t.abrupt("return");case 7:a=this.getRenderRotation(),i=Object(r["a"])(a,2),c=i[0],s=i[1],n.drawImage({image:this.localRenderer,x:this.canvasDrawPosX,y:this.canvasDrawPosY,w:this.canvasDrawWidth,h:this.canvasDrawHeight,rotation:c,rotationAnchor:s,flip:this.flip,shadow:e&&n.preview?{blur:20,color:"red"}:void 0,composite:this.composite,filters:this.filters});case 9:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"hitTest",value:function(t,e){if(!this.localRenderer)return!1;var n=this.getHitbox(),o=n.x0+(n.x1-n.x0)/2,a=n.y0+(n.y1-n.y0)/2,i=Object(s["a"])(t,e,o,a,this.flip?this.rotation:-this.rotation),c=Object(r["a"])(i,2),u=c[0],l=c[1],d=u>=n.x0&&u<=n.x1&&l>=n.y0&&l<=n.y1;if(!d)return!1;if(this.hitDetectionFallback)return!0;try{return this.pixelPerfectHitTest(t,e)}catch(p){this.hitDetectionFallback=!0}return!0}},{key:"pixelPerfectHitTest",value:function(t,e){if(!this.localRenderer)return!1;var n=this.getRenderRotation(),o=Object(r["a"])(n,2),a=o[0],i=o[1],c=i?Object(s["a"])(t,e,i.x,i.y,-a):[t,e],u=Object(r["a"])(c,2),l=u[0],d=u[1],p=Math.round(l-this.canvasDrawPosX),b=Math.round(d-this.canvasDrawPosY),h=this.canvasDrawWidth,f=this.canvasDrawHeight;if(p>=0&&p<=h&&b>=0&&b<=f){var v=this.flip?this.canvasDrawWidth-p:p,m=this.canvasWidth/this.canvasDrawWidth,j=this.canvasHeight/this.canvasDrawHeight,g=this.localRenderer.getDataAt(Math.round(v*m),Math.round(b*j));return 0!==g[3]}return!1}},{key:"getHitbox",value:function(){return{x0:this.x-this.width/2,x1:this.x+this.width/2,y0:this.y,y1:this.y+this.height}}},{key:"updatedContent",value:function(t,e){}},{key:"id",get:function(){return this.obj.id}},{key:"x",get:function(){return this.obj.x}},{key:"y",get:function(){return this.obj.y}},{key:"version",get:function(){return this.obj.version}},{key:"flip",get:function(){return this.obj.flip}},{key:"rotation",get:function(){return this.obj.rotation/180*Math.PI}},{key:"composite",get:function(){return this.obj.composite}},{key:"filters",get:function(){return this.obj.filters}},{key:"width",get:function(){return this.obj.width}},{key:"height",get:function(){return this.obj.height}}]),t}()},4918:function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));n("99af"),n("4de4"),n("7db0"),n("d81d"),n("4ec9"),n("dca8"),n("d3b7"),n("6062"),n("3ca3"),n("2ca0"),n("ddb0");var r=n("3835"),o=(n("96cf"),n("1da1")),a=n("5530"),i=n("2909"),c=n("d4ec"),s=n("bee2"),u=n("032b"),l=n("0c0f"),d=n("7a23"),p="https://edave64.github.io/Doki-Doki-Dialog-Generator-Packs/",b=function(){function t(e,n,r){var o=this;Object(c["a"])(this,t),this.$store=r,e||(e={authors:{},packs:[]},l["g"].fire(new l["e"]("Couldn't load remote repository."))),n||(n={authors:{},packs:[]},u["a"].supports.localRepo&&l["g"].fire(new l["e"]("Couldn't load local repository."))),this.onlineRepo=Object(d["t"])(e),this.localRepo=Object(d["t"])(n),this.combinedList=Object(d["e"])((function(){var t,e,n,r,c=o.onlineRepo.value,s=null!==(t=null===c||void 0===c?void 0:c.packs)&&void 0!==t?t:[],l=(e=null===c||void 0===c?void 0:c.authors,new Map(s.map((function(t){return[t.id,t]})))),d=o.localRepo.value,p=null!==(n=null===d||void 0===d?void 0:d.packs)&&void 0!==n?n:[],b=(r=null===d||void 0===d?void 0:d.authors,new Map(p.map((function(t){return[t.id,t]})))),h=new Set(u["a"].state.autoAdd),f=o.$store.state.content.contentPacks.map((function(t){return t.packId})).filter((function(t){return!!t})),v=new Set(f),m=new Set;return[].concat(Object(i["a"])(f),Object(i["a"])(p.map((function(t){return t.id}))),Object(i["a"])(s.map((function(t){return t.id})))).filter((function(t){return!t.startsWith("dddg.buildin.")&&(!m.has(t)&&(m.add(t),!0))})).map((function(t){var e,n;return Object(a["a"])(Object(a["a"])(Object(a["a"])({},null!==(e=l.get(t))&&void 0!==e?e:{}),null!==(n=b.get(t))&&void 0!==n?n:{}),{},{autoloading:h.has(t),installed:b.has(t),online:l.has(t),loaded:v.has(t)})}))})),this.authors=Object(d["e"])((function(){var t,e,n=o.onlineRepo.value,r=null!==(t=null===n||void 0===n?void 0:n.authors)&&void 0!==t?t:{},i=o.localRepo.value,c=null!==(e=null===i||void 0===i?void 0:i.authors)&&void 0!==e?e:{};return Object(a["a"])(Object(a["a"])({},r),c)})),Object.freeze(this)}return Object(s["a"])(t,[{key:"getPacks",value:function(){return this.combinedList.value}},{key:"getPack",value:function(t){return this.getPacks().find((function(e){return e.id===t}))}},{key:"getAuthor",value:function(t){return this.authors.value[t]||null}},{key:"getAuthors",value:function(){return this.authors.value}}],[{key:"getInstance",value:function(){return t.instance||(t.instance=this.createInstance()),t.instance}},{key:"createInstance",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var n,o,a,i,c,s,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.loadRepo(p),o=u["a"].supports.localRepo?t.loadRepo(u["a"].localRepositoryUrl):null,e.next=4,Promise.all([n,o,t.$store]);case 4:return a=e.sent,i=Object(r["a"])(a,3),c=i[0],s=i[1],l=i[2],e.abrupt("return",new t(c,s,l));case 10:case"end":return e.stop()}}),e)})));function n(){return e.apply(this,arguments)}return n}()},{key:"loadRepo",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(n){var o,a,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all([t.fetchJSON(n+"repo.json"),t.fetchJSON(n+"people.json")]);case 3:return o=e.sent,a=Object(r["a"])(o,2),i=a[0],c=a[1],e.abrupt("return",{packs:i,authors:c});case 10:return e.prev=10,e.t0=e["catch"](0),e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));function n(t){return e.apply(this,arguments)}return n}()},{key:"fetchJSON",value:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch(e);case 2:return n=t.sent,t.next=5,n.json();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()}]),t}();b.$store=new Promise((function(t,e){b.setStore=t}))},"4a6f":function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));n("99af"),n("4de4"),n("d81d"),n("d3b7"),n("3ca3"),n("ddb0"),n("96cf");var r=n("1da1"),o=n("b85c"),a=n("2909"),i=n("d4ec"),c=n("bee2"),s=n("45eb"),u=n("7e84"),l=n("262e"),d=n("2caf"),p=n("5947"),b=n("4265"),h=function(t){Object(l["a"])(n,t);var e=Object(d["a"])(n);function n(){var t;return Object(i["a"])(this,n),t=e.apply(this,arguments),t.refTextbox=null,t}return Object(c["a"])(n,[{key:"getHitbox",value:function(){var t=Object(s["a"])(Object(u["a"])(n.prototype),"getHitbox",this).call(this),e=this.width*(this.objZoom-1),r=this.height*(this.objZoom-1);return{x0:t.x0-e/2,x1:t.x1+e/2,y0:t.y0-r,y1:t.y1}}},{key:"updatedContent",value:function(t,e){var n=t.state.objects.panels[e],r=[].concat(Object(a["a"])(n.order),Object(a["a"])(n.onTopOrder));this.refTextbox=null;var i,c=Object(o["a"])(r);try{for(c.s();!(i=c.n()).done;){var s=i.value,u=t.state.objects.objects[s];if("textBox"===u.type&&u.talkingObjId===this.obj.id)return void(this.refTextbox=u)}}catch(l){c.e(l)}finally{c.f()}}},{key:"renderLocal",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,i,c,s,u,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=this.getAssetList(),t.next=3,Promise.all(n.filter((function(t){return t.assets})).map((function(t){return f(t,e.hq)})));case 3:r=t.sent,a=Object(o["a"])(r);try{for(a.s();!(i=a.n()).done;){c=i.value,s=Object(o["a"])(c.assets);try{for(s.s();!(u=s.n()).done;)l=u.value,e.drawImage({image:l,composite:c.composite,x:c.offset[0],y:c.offset[1]})}catch(d){s.e(d)}finally{s.f()}}}catch(d){a.e(d)}finally{a.f()}case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"canvasDrawWidth",get:function(){return this.width*this.objZoom}},{key:"canvasDrawHeight",get:function(){return this.height*this.objZoom}},{key:"canvasDrawPosX",get:function(){return this.x-this.width/2+(this.height-this.canvasDrawHeight)/2}},{key:"canvasDrawPosY",get:function(){return this.y+(this.height-this.canvasDrawHeight)}},{key:"objZoom",get:function(){var t=this.obj.enlargeWhenTalking&&this.refTextbox?1.05:1;return t*this.obj.zoom}}]),n}(b["a"]);function f(t,e){return v.apply(this,arguments)}function v(){return v=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!("loaded"in e)){t.next=2;break}return t.abrupt("return",e);case 2:return t.t0=e.offset,t.next=5,Promise.all(e.assets.map((function(t){return Object(p["a"])(t,n)})));case 5:return t.t1=t.sent,t.t2=e.composite,t.abrupt("return",{loaded:!0,offset:t.t0,assets:t.t1,composite:t.t2});case 8:case"end":return t.stop()}}),t)}))),v.apply(this,arguments)}},"4ad0":function(t,e,n){"use strict";n("a63c")},"4b53":function(t,e,n){},"50ef":function(t,e,n){"use strict";n("2284")},"51b0":function(t,e,n){"use strict";n("9e5a")},5947:function(t,e,n){"use strict";n.d(e,"e",(function(){return u})),n.d(e,"d",(function(){return l})),n.d(e,"a",(function(){return b})),n.d(e,"c",(function(){return f})),n.d(e,"b",(function(){return j})),n.d(e,"f",(function(){return O})),n.d(e,"g",(function(){return k}));n("99af"),n("d3b7"),n("ac1f"),n("3ca3"),n("5319"),n("ddb0"),n("2b3d"),n("96cf");var r,o,a=n("1da1"),i=n("0c0f"),c=n("9be5"),s=n("032b");function u(){return r||(r=new Promise((function(t,e){var n="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=",r=document.createElement("img");r.addEventListener("load",(function(){t(2===r.width&&1===r.height)})),r.addEventListener("error",(function(){t(!1)})),r.src=n}))),r}function l(){return o||(o=new Promise((function(t,e){var n="data:image/heic;base64,AAAAGGZ0eXBoZWljAAAAAG1pZjFoZWljAAAAsW1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAHBpY3QAXABjAGMAcwBsAGEAAAAADnBpdG0AAAAAAAEAAAAQaWxvYwAAAABEQAAAAAAAI2lpbmYAAAAAAAEAAAAVaW5mZQIAAAAAAQAAaHZjMQAAAABDaXBycAAAACdpcGNvAAAAH2h2Y0NmzGx1ci0AAAAAAABv9HP+//v9bjr3AAAAABRpcG1hAAAAAAAAAAEAAQGBAAAACG1kYXQ=",r=document.createElement("img");r.addEventListener("load",(function(){console.log("Heif no error. "+(2===r.width&&1===r.height)),t(2===r.width&&1===r.height)})),r.addEventListener("error",(function(){console.log("Heif not supported"),t(!1)})),r.src=n}))),o}var d={},p={};function b(t){return h.apply(this,arguments)}function h(){return h=Object(a["a"])(regeneratorRuntime.mark((function t(e){var n,r=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=!(r.length>1&&void 0!==r[1])||r[1],t.abrupt("return",f(s["a"].supports.lq&&!n?e.lq:e.hq));case 2:case"end":return t.stop()}}),t)}))),h.apply(this,arguments)}function f(t){return v.apply(this,arguments)}function v(){return v=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return d[e]||(d[e]=new Promise((function(t,n){var r=new Image;r.addEventListener("load",(function(){t(r)})),r.addEventListener("error",(function(){i["g"].fire(new i["a"](e)),d[e]=void 0,t(new c["a"])})),r.crossOrigin="Anonymous",r.src=e,r.style.display="none",document.body.appendChild(r)}))),t.abrupt("return",d[e]);case 2:case"end":return t.stop()}}),t)}))),v.apply(this,arguments)}var m=".";function j(t){return g.apply(this,arguments)}function g(){return g=Object(a["a"])(regeneratorRuntime.mark((function t(e){var n,r,o=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=!(o.length>1&&void 0!==o[1])||o[1],!p[e]){t.next=3;break}return t.abrupt("return",p[e]);case 3:return t.t0="".concat(m,"/assets/").concat(e).concat(n?"":".lq"),t.next=6,u();case 6:if(!t.sent){t.next=10;break}t.t1=".webp",t.next=11;break;case 10:t.t1=".png";case 11:return t.t2=t.t1,r=t.t0.concat.call(t.t0,t.t2).replace(/\/+/,"/"),t.abrupt("return",f(r));case 14:case"end":return t.stop()}}),t)}))),g.apply(this,arguments)}function O(t,e){var n=URL.createObjectURL(e);return p[t]=new Promise((function(t,e){var r=new Image;r.addEventListener("load",(function(){t(r)})),r.addEventListener("error",(function(t){i["g"].fire(new i["c"](t)),e('Failed to load "'.concat(n,'"'))})),r.crossOrigin="Anonymous",r.src=n,r.style.display="none",document.body.appendChild(r)})),n}function k(t,e){return p[t]=new Promise((function(t,n){var r=new Image;r.addEventListener("load",(function(){t(r)})),r.addEventListener("error",(function(t){i["g"].fire(new i["c"](t)),n('Failed to load "'.concat(e,'"'))})),r.crossOrigin="Anonymous",r.src=e,r.style.display="none",document.body.appendChild(r)}))}},"5b30":function(t,e,n){"use strict";n("63f9")},"5c35":function(t,e,n){"use strict";n("61be")},"614d":function(t,e,n){},"61be":function(t,e,n){},6289:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n("fec4");function o(){return{flip:!1,rotation:0,version:0,opacity:100,x:r["d"]/2,composite:"source-over",filters:[],label:null,textboxColor:null,enlargeWhenTalking:!1,nameboxWidth:null,zoom:1}}},"63f9":function(t,e,n){},"6a18":function(t,e,n){"use strict";n("6ceb")},"6ae4":function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));n("99af"),n("cb29"),n("4de4"),n("a15b"),n("96cf");var r=n("1da1"),o=n("b85c"),a=n("5530"),i=n("d4ec"),c=n("bee2"),s=n("73e5"),u=n("fd0b"),l=n("9be5"),d=function(){function t(e,n,r,o){Object(i["a"])(this,t),this.canvas=e,this.fsCtx=n,this.hq=r,this.preview=o,this.aborted=!1}return Object(c["a"])(t,[{key:"drawText",value:function(t){if(this.aborted)throw new s["a"];this.fsCtx.save();var e=Object(a["a"])(Object(a["a"])({},{font:"20px aller",align:"left"}),t),n=e.font,r=e.align,o=e.x,i=void 0===o?0:o,c=e.y,u=void 0===c?0:c,l=e.text,d=void 0===l?"":l;this.fsCtx.lineJoin="round",this.fsCtx.textAlign=r,this.fsCtx.font=n,t.outline&&(this.fsCtx.strokeStyle=t.outline.style,this.fsCtx.lineWidth=t.outline.width,this.fsCtx.strokeText(d,i,u)),t.fill&&(this.fsCtx.fillStyle=t.fill.style,this.fsCtx.fillText(d,i,u)),this.fsCtx.restore()}},{key:"measureText",value:function(t){if(this.aborted)throw new s["a"];this.fsCtx.save();var e=Object(a["a"])(Object(a["a"])({},{font:"20px aller",align:"left"}),t),n=e.font,r=e.align,o=e.text,i=void 0===o?"":o;this.fsCtx.lineJoin="round",this.fsCtx.textAlign=r,this.fsCtx.font=n,t.outline&&(this.fsCtx.strokeStyle=t.outline.style,this.fsCtx.lineWidth=t.outline.width),t.fill&&(this.fsCtx.fillStyle=t.fill.style);var c=this.fsCtx.measureText(i);return this.fsCtx.restore(),c}},{key:"drawImage",value:function(t){if(this.aborted)throw new s["a"];if(!(t.image instanceof l["a"])){var e=Object(a["a"])({flip:!1,w:t.image.width,h:t.image.height,composite:"source-over"},t),n=e.image,r=e.flip,i=e.x,c=e.y,d=e.w,p=e.h,b=e.filters,h=e.composite;if(this.fsCtx.save(),this.fsCtx.globalCompositeOperation=h,b)if("filter"in this.fsCtx){var f,v=[],m=Object(o["a"])(b);try{for(m.s();!(f=m.n()).done;){var j=f.value;"drop-shadow"===j.type?v.push("drop-shadow(".concat(j.offsetX,"px ").concat(j.offsetY,"px ").concat(j.blurRadius,"px ").concat(j.color,")")):"hue-rotate"===j.type?v.push("hue-rotate(".concat(j.value,"deg)")):"blur"===j.type?v.push("blur(".concat(j.value,"px)")):v.push("".concat(j.type,"(").concat(100*j.value,"%)"))}}catch(S){m.e(S)}finally{m.f()}this.fsCtx.filter=v.join(" ")}else{var g,O=1,k=Object(o["a"])(b);try{for(k.s();!(g=k.n()).done;){var y=g.value;"opacity"===y.type&&(O*=y.value)}}catch(S){k.e(S)}finally{k.f()}this.fsCtx.globalAlpha=O}if(t.shadow){var w=t.shadow;w.color&&(this.fsCtx.shadowColor=w.color),w.blur&&(this.fsCtx.shadowBlur=w.blur),w.offsetX&&(this.fsCtx.shadowOffsetX=w.offsetX),w.offsetY&&(this.fsCtx.shadowOffsetY=w.offsetY)}if(t.rotation){var x=t.rotationAnchor?t.rotationAnchor.x:0,C=t.rotationAnchor?t.rotationAnchor.y:0;t.rotationAnchor&&this.fsCtx.translate(x,C),this.fsCtx.fillRect(-10,-1,21,3),this.fsCtx.rotate(t.rotation),t.rotationAnchor&&this.fsCtx.translate(-x,-C)}this.fsCtx.translate(i+d/2,c+p/2),this.fsCtx.scale(r?-1:1,1),n instanceof u["a"]?n.paintOnto(this.fsCtx,{x:-d/2,y:-p/2,w:d,h:p}):this.fsCtx.drawImage(n,-d/2,-p/2,d,p),this.fsCtx.restore(),this.fsCtx.globalCompositeOperation="source-over"}}},{key:"drawRect",value:function(t){var e=t.x,n=t.y,r=t.w,o=t.h,a=t.outline,i=t.fill,c=t.composition;if(this.aborted)throw new s["a"];this.fsCtx.save(),this.fsCtx.beginPath(),this.fsCtx.rect(e,n,r,o),c&&(this.fsCtx.globalCompositeOperation=c),i&&(this.fsCtx.fillStyle=i.style,this.fsCtx.fill()),a&&(this.fsCtx.strokeStyle=a.style,this.fsCtx.lineWidth=a.width,this.fsCtx.stroke()),this.fsCtx.restore()}},{key:"drawPath",value:function(t){var e=t.outline,n=t.fill,r=t.path;if(this.aborted)throw new s["a"];this.fsCtx.save(),this.fsCtx.beginPath(),r(this.fsCtx),n&&(this.fsCtx.fillStyle=n.style,this.fsCtx.fill()),e&&(this.fsCtx.strokeStyle=e.style,this.fsCtx.lineWidth=e.width,this.fsCtx.stroke()),this.fsCtx.restore()}},{key:"patternFrom",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"repeat";return t instanceof u["a"]&&(t=t.previewCanvas),this.fsCtx.createPattern(t,e)}},{key:"customTransform",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.fsCtx.save(),t.next=3,e(this.fsCtx);case 3:return t.next=5,n(this);case 5:this.fsCtx.restore();case 6:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"linearGradient",value:function(t,e,n,r){return this.fsCtx.createLinearGradient(t,e,n,r)}},{key:"applyFilters",value:function(t){if(0!==t.length){this.fsCtx.save();var e,n=1,r=Object(o["a"])(t);try{for(r.s();!(e=r.n()).done;){var a=e.value;"opacity"===a.type&&(n*=a.value)}}catch(l){r.e(l)}finally{r.f()}if("filter"in this.fsCtx){var i,c=[],s=Object(o["a"])(t);try{for(s.s();!(i=s.n()).done;){var u=i.value;"opacity"!==u.type&&("drop-shadow"===u.type?c.push("drop-shadow(".concat(u.offsetX,"px ").concat(u.offsetY,"px ").concat(u.blurRadius,"px ").concat(u.color,")")):"hue-rotate"===u.type?c.push("hue-rotate(".concat(u.value,"deg)")):"blur"===u.type?c.push("blur(".concat(u.value,"px)")):c.push("".concat(u.type,"(").concat(100*u.value,"%)")))}}catch(l){s.e(l)}finally{s.f()}this.fsCtx.filter=c.join(" ")}this.fsCtx.drawImage(this.canvas,0,0),1!==n&&(this.fsCtx.globalCompositeOperation="destination-atop",this.fsCtx.fillStyle="rgba(0,0,0,".concat(n,")"),this.fsCtx.fillRect(0,0,this.canvas.width,this.canvas.height),this.fsCtx.globalCompositeOperation="source-over"),"filter"in this.fsCtx&&(this.fsCtx.filter="none"),this.fsCtx.restore()}}},{key:"abort",value:function(){this.aborted=!0}}],[{key:"make",value:function(e,n,r){return new t(e,e.getContext("2d"),n,r)}},{key:"makeWithContext",value:function(e,n,r,o){return new t(e,n,r,o)}}]),t}()},"6ceb":function(t,e,n){},"6cff":function(t,e,n){},"6f08":function(t,e,n){"use strict";n("e3f7")},"71ca":function(t,e,n){"use strict";n("614d")},"73e5":function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n("d4ec"),o=function t(){Object(r["a"])(this,t)}},7592:function(t,e,n){},"76bd":function(t,e,n){},"7e59":function(t,e,n){},"80a6":function(t,e,n){"use strict";n("1831")},"859a":function(t,e,n){},"85e7":function(t,e,n){"use strict";n("76bd")},"866c":function(t,e,n){},"8bf3":function(t,e,n){"use strict";n("9f4c")},"8cae":function(t,e,n){"use strict";function r(t,e,n,r,o){var a=Math.cos(o),i=Math.sin(o),c=t-n,s=e-r,u=a*c-i*s+n,l=i*c+a*s+r;return[u,l]}n.d(e,"a",(function(){return r}))},"8eea":function(t,e,n){},9566:function(t,e,n){"use strict";n("a070")},"9be5":function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n("d4ec"),o=function t(){Object(r["a"])(this,t)}},"9e3d":function(t,e,n){"use strict";n("f317")},"9e5a":function(t,e,n){},"9f4c":function(t,e,n){},a070:function(t,e,n){},a354:function(t,e,n){"use strict";n("4b53")},a47b:function(t,e,n){},a582:function(t,e,n){},a63c:function(t,e,n){},a6d1:function(t,e,n){},aacd:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=25,o={methods:{verticalScrollRedirect:function(t){if("wheel"===t.type&&t.currentTarget){var e=t.currentTarget,n=getComputedStyle(e),o=t;if(0!==o.deltaY){if("auto"===n.overflowY)if(o.deltaY>0){if(e.scrollHeight>e.scrollTop+e.clientHeight)return void t.stopPropagation()}else if(e.scrollTop>0)return void t.stopPropagation();var a=e.scrollLeft;o.mozInputSource?e.scrollLeft+=o.deltaY*r:e.scrollLeft+=o.deltaY,e.scrollLeft!==a&&t.stopPropagation()}}}}}},ae6d:function(t,e,n){"use strict";n("a582")},afc0:function(t,e,n){},b3d7:function(t,e,n){"use strict";var r=n("7a23"),o=Object(r["F"])("data-v-36ffea9a");Object(r["r"])("data-v-36ffea9a");var a={class:"fieldset_wrapper"},i={key:0},c={class:"fieldset_contents"};Object(r["q"])();var s=o((function(t,e,n,o,s,u){return Object(r["p"])(),Object(r["g"])("div",a,[Object(r["k"])("fieldset",null,[t.title>""?(Object(r["p"])(),Object(r["g"])("legend",i,Object(r["x"])(t.title),1)):Object(r["h"])("",!0),Object(r["k"])("div",c,[Object(r["v"])(t.$slots,"default")])])])})),u=Object(r["m"])({props:{title:{required:!0,type:String}}});n("25d4");u.render=s,u.__scopeId="data-v-36ffea9a";e["a"]=u},ba37:function(t,e,n){"use strict";n.d(e,"b",(function(){return p})),n.d(e,"e",(function(){return b})),n.d(e,"h",(function(){return f})),n.d(e,"g",(function(){return v})),n.d(e,"f",(function(){return m})),n.d(e,"c",(function(){return j})),n.d(e,"a",(function(){return O})),n.d(e,"d",(function(){return k}));n("99af"),n("4de4"),n("7db0"),n("c740"),n("5db7"),n("c975"),n("d81d"),n("73d9"),n("b64b"),n("d3b7"),n("ddb0"),n("96cf");var r=n("1da1"),o=n("ade3"),a=n("2909"),i=n("5530"),c=n("fec4"),s=n("c837"),u=n("6289"),l=-74,d=-26,p={setPose:function(t,e){var n=t.objects[e.id];n.poseId=e.poseId,++n.version},setCharStyleGroup:function(t,e){var n=e.id,r=e.styleGroupId,o=t.objects[n];o.styleGroupId=r,++o.version},setCharStyle:function(t,e){var n=e.id,r=e.styleId,o=t.objects[n];o.styleId=r,++o.version},setPosePosition:function(t,e){var n=t.objects[e.id];n.posePositions=Object(i["a"])(Object(i["a"])({},n.posePositions),e.posePositions),++n.version},setClose:function(t,e){var n=t.objects[e.id];n.close=e.close,++n.version},setFreeMove:function(t,e){var n=t.objects[e.id];n.freeMove=e.freeMove,n.freeMove||(n.x=c["a"][j(n.x)],n.y=d)}};function b(t,e){var n=t.getters["content/getCharacters"];return n.get(e.characterType)}function h(t,e){var n=t["content/getCharacters"];return n.get(e)}function f(t,e){return t.styleGroups[e.styleGroupId].styles[e.styleId].poses[e.poseId]}function v(t,e){var n=f(t,e),r=Object(a["a"])(Object.keys(n.positions).filter((function(t){return n.positions[t].length>1})));return n.compatibleHeads.length>0&&r.unshift("head"),r}function m(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.posePositions.headType||0,r=f(t,e).compatibleHeads;if(!r||0===r.length)return null;var o=t.heads[r[n]];return o}function j(t){var e=c["a"].map((function(e,n){return{pos:Math.abs(t-e),idx:n}})).sort((function(t,e){return t.pos-e.pos}));return e[0].idx}var g=0,O={createCharacters:function(t,e){var n=t.rootState,r=t.rootGetters,o=t.commit,a=h(r,e.characterType);o("create",{object:Object(i["a"])(Object(i["a"])({},Object(u["a"])()),{},{id:"characters_"+ ++g,panelId:n.panels.currentPanel,onTop:!1,type:"character",y:d,preserveRatio:!0,ratio:1,height:768,width:768,characterType:e.characterType,close:!1,freeMove:!1,poseId:0,styleId:0,styleGroupId:0,posePositions:{},label:a.label||a.id,enlargeWhenTalking:n.ui.defaultCharacterTalkingZoom})})},seekPart:function(t,e){var n=t.state,r=t.commit,a=t.dispatch,i=t.rootGetters,c=e.delta,u=e.id,l=e.part;if("head"!==l){var d=n.objects[u],p=f(h(i,d.characterType),d);p.positions[l]&&r("setPosePosition",{id:u,posePositions:Object(o["a"])({},l,Object(s["a"])(p.positions[l],d.posePositions[l]||0,c))})}else a("seekHead",{id:u,delta:c})},seekPose:function(t,e){var n=t.state,r=t.commit,o=t.rootGetters,a=e.id,i=e.delta,c=n.objects[a],u=h(o,c.characterType),l=u.styleGroups[c.styleGroupId].styles[c.styleId].poses;C(r,c,u,(function(t){t.poseId=Object(s["a"])(l,t.poseId,i)}))},seekStyle:function(t,e){var n=t.state,r=t.commit,o=t.rootGetters,a=e.id,i=e.delta,c=n.objects[a],u=h(o,c.characterType),l=u.styleGroups.flatMap((function(t,e){return t.styles.map((function(t,n){return{styleGroupIdx:e,styleIdx:n,styleGroupJson:JSON.stringify(t.components)}}))})).sort((function(t,e){return t.styleGroupJson.localeCompare(e.styleGroupJson)})),d=l.findIndex((function(t){return t.styleGroupIdx===c.styleGroupId&&t.styleIdx===c.styleId}));C(r,c,u,(function(t){var e=Object(s["a"])(l,d,i),n=l[e];t.styleGroupId=n.styleGroupIdx,t.styleId=n.styleIdx}))},seekHead:function(t,e){var n=t.state,r=t.commit,o=t.rootGetters,a=e.id,i=e.delta,c=n.objects[a],u=h(o,c.characterType),l=f(u,c),d=m(u,c);if(d){var p=(c.posePositions.head||0)+i,b=c.posePositions.headType||0;(p<0||p>=d.variants.length)&&(b=Object(s["a"])(l.compatibleHeads.map((function(t){return u.heads[t]})),b,i),d=m(u,c,b),p=1===i?0:d.variants.length-1),r("setPosePosition",{id:a,posePositions:{head:p,headType:b}})}},setPart:function(t,e){var n=t.state,r=t.commit,o=t.rootGetters,a=e.id,i=e.part,c=e.val,s=n.objects[a],u=h(o,s.characterType);C(r,s,u,"pose"===i?function(t){t.poseId=c}:"style"===i?function(t){t.styleId=c}:function(t){t.posePositions[i]=c})},setCharStyle:function(t,e){var n=t.state,r=t.commit,o=t.rootGetters,a=e.id,i=e.styleGroupId,c=e.styleId,s=n.objects[a],u=h(o,s.characterType);C(r,s,u,(function(t){t.styleGroupId=i,t.styleId=c}))},setCharacterPosition:function(t,e){var n=t.state,r=t.commit,o=e.id,a=e.x,i=e.y,s=n.objects[o];s.freeMove?r("setPosition",{id:o,x:a,y:i}):r("setPosition",{id:o,x:c["a"][j(a)],y:d+(s.close?l:0)})},shiftCharacterSlot:function(t,e){var n=t.state,r=t.commit,o=e.id,a=e.delta,i=n.objects[o],s=j(i.x),u=s+a;u<0&&(u=0),u>=c["a"].length&&(u=c["a"].length-1),r("setPosition",{id:o,x:c["a"][u],y:i.y})}};function k(t,e,n){return y.apply(this,arguments)}function y(){return y=Object(r["a"])(regeneratorRuntime.mark((function t(e,n,r){var o,a,i,c,s,u,l,d,p,b,h,f,v,m,j,g,O,k,y,C,S,R;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(o=e.state.objects[n],a=r.characters.find((function(t){return t.id===o.characterType})),a){t.next=6;break}return console.error("Character data is missing. Dropping the character."),e.dispatch("removeObject",{id:n}),t.abrupt("return");case 6:if(i=w(o),c=a.styleGroups[o.styleGroupId],s=c.styles[i.styleId],u=s.poses[i.poseId],l=e.rootState.content.current.characters.find((function(t){return t.id===a.id})),l){t.next=15;break}return console.error("Character data is missing. Dropping the character."),e.dispatch("removeObject",{id:n}),t.abrupt("return");case 15:d=l.styleGroups.findIndex((function(t){return t.id===c.id})),i.styleGroupId=-1===d?0:d,p=l.styleGroups[i.styleGroupId],b=JSON.stringify(s.components),h=p.styles.findIndex((function(t){return JSON.stringify(t.components)===b})),i.styleId=-1===h?0:h,f=p.styles[i.styleId],v=f.poses.findIndex((function(t){return t.id===u.id})),i.poseId=-1===v?0:v,m=f.poses[i.poseId],j={},t.t0=regeneratorRuntime.keys(m.positions);case 27:if((t.t1=t.t0()).done){t.next=35;break}if(g=t.t1.value,m.positions.hasOwnProperty(g)){t.next=31;break}return t.abrupt("continue",27);case 31:O=m.positions[g],u.positions[g]?(k=i.posePositions[g],k>=0&&k<O.length?j[g]=k:j[g]=0):j[g]=0,t.next=27;break;case 35:y=u.compatibleHeads[o.posePositions.headType],C=m.compatibleHeads.indexOf(y),-1===C?(i.posePositions.headType=0,i.posePositions.head=0):(C!==o.posePositions.headType&&(i.posePositions.headType=C),S=JSON.stringify(a.heads[y].variants[o.posePositions.head]),R=l.heads[y].variants.findIndex((function(t){return JSON.stringify(t)===S})),i.posePositions.head=-1===R?0:R),x(e.commit,o,i);case 39:case"end":return t.stop()}}),t)}))),y.apply(this,arguments)}function w(t){return{styleGroupId:t.styleGroupId,styleId:t.styleId,poseId:t.poseId,posePositions:Object(i["a"])({},t.posePositions)}}function x(t,e,n){n.styleGroupId!==e.styleGroupId&&t("setCharStyleGroup",{id:e.id,styleGroupId:n.styleGroupId}),n.styleId!==e.styleId&&(console.log("Setting style of ".concat(e.id," to ").concat(n.styleId)),t("setCharStyle",{id:e.id,styleId:n.styleId})),n.poseId!==e.poseId&&t("setPose",{id:e.id,poseId:n.poseId}),JSON.stringify(n.posePositions)!==JSON.stringify(e.posePositions)&&t("setPosePosition",{id:e.id,posePositions:n.posePositions})}function C(t,e,n,r){var o=w(e);r(o),n.styleGroups[o.styleGroupId]||(o.styleGroupId=0);var a=n.styleGroups[o.styleGroupId];a.styles[o.styleId]||(o.styleId=0);var i=a.styles[o.styleId];i.poses[o.poseId]||(o.poseId=0);var c=i.poses[o.poseId];for(var s in c.positions)c.positions[s]&&(c.positions[s][o.posePositions[s]]||(o.posePositions[s]=0));var u=n.styleGroups[e.styleGroupId].styles[e.styleId].poses[e.poseId],l=u.compatibleHeads[e.posePositions.headType||0],d=c.compatibleHeads.indexOf(l);d>=0?o.posePositions.headType=d:(o.posePositions.headType=0,o.posePositions.head=0),x(t,e,o)}},c02d:function(t,e,n){"use strict";n("da86")},c185:function(t,e,n){"use strict";n("a47b")},c4e5:function(t,e,n){"use strict";var r=n("7a23"),o={class:"toggle_box"};function a(t,e,n,a,i,c){return Object(r["p"])(),Object(r["g"])("div",o,[Object(r["D"])(Object(r["k"])("input",{id:t._.uid,type:"checkbox",ref:"checkbox","onUpdate:modelValue":e[1]||(e[1]=function(e){return t.value=e})},null,8,["id"]),[[r["y"],t.value]]),Object(r["k"])("label",{for:t._.uid,class:"switch"},null,8,["for"]),Object(r["k"])("label",{for:t._.uid,class:"toggle_label"},Object(r["x"])(t.label),9,["for"])])}var i=Object(r["m"])({props:{label:String,modelValue:{type:Boolean,default:!1}},computed:{value:{get:function(){return this.modelValue},set:function(t){this.$emit("update:modelValue",t)}},checkbox:function(){return this.$refs.checkbox}}});n("85e7");i.render=a;e["a"]=i},c837:function(t,e,n){"use strict";function r(t,e,n){var r=e+n,o=t.length;return r<0&&(r+=o),r>=o&&(r-=o),r}n.d(e,"a",(function(){return r}))},cd49:function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23"),o={key:0},a={key:1,id:"app"},i={id:"container"},c=Object(r["k"])("div",{id:"modal-messages"},null,-1);function s(t,e,n,s,u,l){var d=Object(r["w"])("render"),p=Object(r["w"])("message-console"),b=Object(r["w"])("tool-box"),h=Object(r["w"])("single-box"),f=Object(r["w"])("modal-dialog"),v=Object(r["w"])("expression-builder");return Object(r["p"])(),Object(r["g"])(r["a"],null,[t.canvasTooSmall&&t.isSafari?(Object(r["p"])(),Object(r["g"])("div",o," Protrait mode is not supported by safari. Please turn the device sideways. ")):(Object(r["p"])(),Object(r["g"])("div",a,[Object(r["k"])("div",i,[Object(r["k"])(d,{ref:"render",canvasWidth:t.canvasWidth,canvasHeight:t.canvasHeight},null,8,["canvasWidth","canvasHeight"])]),Object(r["k"])(p),Object(r["k"])(b,{"onShow-prev-render":t.drawLastDownload,onDownload:e[1]||(e[1]=function(e){return t.$refs.render.download()}),"onShow-dialog":t.showDialog,"onShow-expression-dialog":t.showExpressionDialog},null,8,["onShow-prev-render","onShow-dialog","onShow-expression-dialog"]),(Object(r["p"])(),Object(r["g"])(r["b"],null,[t.dialogVisable?Object(r["k"])(f,{key:0,ref:"dialog",onLeave:e[3]||(e[3]=function(e){return t.dialogVisable=!1})},{default:Object(r["C"])((function(){return[Object(r["k"])(h,{ref:"packDialog",onLeave:e[2]||(e[2]=function(e){return t.dialogVisable=!1})},null,512)]})),_:1},512):Object(r["h"])("",!0)],1024)),t.expressionBuilderVisible?Object(r["k"])(f,{key:0,ref:"dialog",onLeave:e[5]||(e[5]=function(e){return t.expressionBuilderVisible=!1})},{default:Object(r["C"])((function(){return[Object(r["k"])(v,{character:t.expressionBuilderCharacter,initHeadGroup:t.expressionBuilderHeadGroup,onLeave:e[4]||(e[4]=function(e){return t.expressionBuilderVisible=!1})},null,8,["character","initHeadGroup"])]})),_:1},512):Object(r["h"])("",!0)])),c],64)}n("b64b"),n("d3b7"),n("07ac"),n("6062"),n("3ca3"),n("ddb0"),n("96cf");var u=n("1da1"),l=n("3835"),d={id:"toolbar"},p=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"add_box",-1),b=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"panorama",-1),h=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"view_module",-1),f=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"settings_applications",-1),v={id:"toolbar-end"},m=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"help",-1),j=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"extension",-1),g=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"flip_to_back",-1),O=Object(r["k"])("i",{class:"material-icons","aria-hidden":"true"},"photo_camera",-1);function k(t,e,n,o,a,i){var c=Object(r["w"])("settings-panel"),s=Object(r["w"])("content-packs-panel"),u=Object(r["w"])("backgrounds-panel"),l=Object(r["w"])("credits-panel"),k=Object(r["w"])("character-panel"),y=Object(r["w"])("sprite-panel"),w=Object(r["w"])("text-box-panel"),x=Object(r["w"])("choice-panel"),C=Object(r["w"])("panels-panel"),S=Object(r["w"])("notification-panel"),R=Object(r["w"])("poem-panel"),P=Object(r["w"])("add-panel");return Object(r["p"])(),Object(r["g"])("div",{id:"panels",class:{vertical:t.vertical}},[Object(r["k"])("div",d,[Object(r["k"])("button",{class:{active:"add"===t.panel},onClick:e[1]||(e[1]=function(e){return t.setPanel("add")}),title:"Add new objects to the scene","aria-label":"Add new objects to the scene"},[p],2),Object(r["k"])("button",{class:{active:"backgrounds"===t.panel},onClick:e[2]||(e[2]=function(e){return t.setPanel("backgrounds")}),"aria-label":"Change the current background",title:"Change the current background"},[b],2),Object(r["k"])("button",{class:{active:"panels"===t.panel},title:"Panels","aria-label":"Panels",onClick:e[3]||(e[3]=function(e){return t.setPanel("panels")})},[h],2),Object(r["k"])("button",{class:{active:"settings"===t.panel},title:"Settings","aria-label":"Settings",onClick:e[4]||(e[4]=function(e){return t.setPanel("settings")})},[f],2)]),"settings"===t.panel?Object(r["k"])(c,{key:0}):"packs"===t.panel?Object(r["k"])(s,{key:1}):"backgrounds"===t.panel?Object(r["k"])(u,{key:2,"onShow-dialog":e[5]||(e[5]=function(e){return t.$emit("show-dialog",e)})}):"help_credits"===t.panel?Object(r["k"])(l,{key:3}):"character"===t.panel?Object(r["k"])(k,{key:4,"onShow-dialog":e[6]||(e[6]=function(e){return t.$emit("show-dialog",e)}),"onShow-expression-dialog":e[7]||(e[7]=function(e){return t.$emit("show-expression-dialog",e)})}):"sprite"===t.panel?Object(r["k"])(y,{key:5}):"textBox"===t.panel?Object(r["k"])(w,{key:6}):"choice"===t.panel?Object(r["k"])(x,{key:7}):"panels"===t.panel?Object(r["k"])(C,{key:8}):"notification"===t.panel?Object(r["k"])(S,{key:9}):"poem"===t.panel?Object(r["k"])(R,{key:10}):Object(r["k"])(P,{key:11,"onShow-dialog":e[8]||(e[8]=function(e){return t.$emit("show-dialog",e)})}),Object(r["k"])("div",v,[Object(r["k"])("button",{class:{active:"help_credits"===t.panel},onClick:e[9]||(e[9]=function(e){return t.setPanel("help_credits")}),title:"Help & Credits","aria-label":"Help & Credits"},[m],2),Object(r["k"])("button",{class:{active:"packs"===t.panel},onClick:e[10]||(e[10]=function(e){return t.$emit("show-dialog")}),title:"Content packs","aria-label":"Content packs"},[j],2),Object(r["k"])("button",{onClick:e[11]||(e[11]=function(e){return t.$emit("show-prev-render")}),title:"Show last downloaded panel","aria-label":"Show last downloaded panel",disabled:!t.hasPrevRender},[g],8,["disabled"]),Object(r["k"])("button",{title:"Take a screenshot of the current scene","aria-label":"Take a screenshot of the current scene",onClick:e[12]||(e[12]=function(e){return t.$emit("download")})},[O])])],2)}var y=Object(r["F"])("data-v-ba6b5c3e");Object(r["r"])("data-v-ba6b5c3e");var w={class:"panel"},x=Object(r["k"])("h1",null,"Settings",-1),C={class:"modal-scroll-area"},S=Object(r["k"])("p",null," Do you want to allow DDDG to save settings on your device? ",-1),R=Object(r["k"])("p",null," By choosing to enable saving settings, DDDG can save data to your device, and nowhere else. However, your browser and any installed browser extensions might possibly read and send this data to other servers, e.g. to sync between devices. This is outside of our control. But in general, we recommend only using browsers and browser extensions that you trust with your personal data. ",-1),P=Object(r["k"])("p",null," You can revoke this permission at any time. ",-1),I=Object(r["j"])(" Our usual "),T=Object(r["j"])("privacy policy"),A=Object(r["j"])(" still applies. "),_={class:"modal-scroll-area"},$=Object(r["k"])("p",null," Do you want to deny DDDG from saving settings on your device? ",-1),D=Object(r["k"])("p",null," This will cause all your settings to reset when leaving the page. ",-1),H=Object(r["j"])(" Our usual "),V=Object(r["j"])("privacy policy"),E=Object(r["j"])(" still applies. "),B={key:0,disabled:""},F=Object(r["k"])("td",null,[Object(r["k"])("label",null,"Theme:")],-1),L=Object(r["k"])("option",{value:null},"System",-1),M=Object(r["k"])("option",{value:!1},"Light",-1),N=Object(r["k"])("option",{value:!0},"Dark",-1);Object(r["q"])();var W=y((function(t,e,n,o,a,i){var c=Object(r["w"])("l"),s=Object(r["w"])("modal-dialog"),u=Object(r["w"])("toggle");return Object(r["p"])(),Object(r["g"])("div",w,[x,(Object(r["p"])(),Object(r["g"])(r["c"],{to:"#modal-messages"},[t.allowSavesModal?Object(r["k"])(s,{key:0,options:["Allow","Deny"],onLeave:e[1]||(e[1]=function(e){return t.allowSaves("Deny")}),onOption:t.allowSaves,"no-base-size":""},{default:y((function(){return[Object(r["k"])("div",C,[S,R,P,Object(r["k"])("p",null,[I,Object(r["k"])(c,{to:"wiki://Privacy Statement"},{default:y((function(){return[T]})),_:1}),A])])]})),_:1},8,["onOption"]):Object(r["h"])("",!0),t.denySavesModal?Object(r["k"])(s,{key:1,options:["Deny","Cancle"],onLeave:e[2]||(e[2]=function(e){return t.denySaves("Cancle")}),onOption:t.denySaves,"no-base-size":""},{default:y((function(){return[Object(r["k"])("div",_,[$,D,Object(r["k"])("p",null,[H,Object(r["k"])(c,{to:"wiki://Privacy Statement"},{default:y((function(){return[V]})),_:1}),E])])]})),_:1},8,["onOption"]):Object(r["h"])("",!0)])),t.waitOnSaveChange?(Object(r["p"])(),Object(r["g"])("button",B," Applying... ")):!t.savesAllowed&&t.savesEnabledInEnv?(Object(r["p"])(),Object(r["g"])("button",{key:1,onClick:e[3]||(e[3]=function(e){return t.allowSavesModal=!0})}," Allow saving options ")):t.savesAllowed&&t.savesEnabledInEnv?(Object(r["p"])(),Object(r["g"])("button",{key:2,onClick:e[4]||(e[4]=function(e){return t.denySavesModal=!0})}," Deny saving options ")):Object(r["h"])("",!0),t.lqAllowed?Object(r["k"])(u,{key:3,label:"Low quality preview?",title:"Reduces the quality of the preview images to speed up the user experience and consume less data. Does not effect final render.",modelValue:t.lqRendering,"onUpdate:modelValue":e[5]||(e[5]=function(e){return t.lqRendering=e})},null,8,["modelValue"]):Object(r["h"])("",!0),Object(r["k"])(u,{label:"NSFW Mode?",modelValue:t.nsfw,"onUpdate:modelValue":e[6]||(e[6]=function(e){return t.nsfw=e})},null,8,["modelValue"]),Object(r["k"])(u,{label:"Enlarge talking objects? (Default value)",modelValue:t.defaultCharacterTalkingZoom,"onUpdate:modelValue":e[7]||(e[7]=function(e){return t.defaultCharacterTalkingZoom=e})},null,8,["modelValue"]),Object(r["k"])("table",null,[Object(r["k"])("tr",null,[F,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("select",{"onUpdate:modelValue":e[8]||(e[8]=function(e){return t.theme=e})},[L,M,N],512),[[r["z"],t.theme]])])])])])})),U=n("c4e5"),z=n("aacd"),q={mixins:[z["a"]],computed:{vertical:function(){return this.$store.state.ui.vertical}},mounted:function(){var t=this;this.updateVertical(),this.$el.addEventListener("wheel",(function(e){t.vertical||t.verticalScrollRedirect(e)}),{passive:!0})},methods:{updateVertical:function(){this.$el&&(this.vertical?this.$el.classList.add("vertical"):this.$el.classList.remove("vertical"))}},watch:{vertical:function(){this.updateVertical()}}},G=n("032b"),Y=Object(r["F"])("data-v-64aeb4c5");Object(r["r"])("data-v-64aeb4c5");var K={key:0,id:"submit-options"};Object(r["q"])();var X=Y((function(t,e,n,o,a,i){return Object(r["p"])(),Object(r["g"])("div",{class:"dialog-wrapper",onClick:e[2]||(e[2]=function(e){return t.$emit("leave")})},[Object(r["k"])("dialog",{open:"",class:{"base-size":!t.noBaseSize},onClick:e[1]||(e[1]=Object(r["E"])((function(){}),["stop"]))},[Object(r["v"])(t.$slots,"default"),t.options.length>0?(Object(r["p"])(),Object(r["g"])("div",K,[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.options,(function(e){return Object(r["p"])(),Object(r["g"])("button",{key:e,class:"option",onClick:function(n){return t.$emit("option",e)}},Object(r["x"])(e),9,["onClick"])})),128))])):Object(r["h"])("",!0)],2)])})),J=Object(r["m"])({props:{noBaseSize:Boolean,options:{type:Array,default:[]}}});n("c02d");J.render=X,J.__scopeId="data-v-64aeb4c5";var Z=J,Q=n("39b7"),tt=Object(r["m"])({mixins:[q],components:{Toggle:U["a"],ModalDialog:Z,L:Q["a"]},data:function(){return{allowSavesModal:!1,denySavesModal:!1,waitOnSaveChange:!1}},computed:{savesAllowed:{get:function(){return G["a"].savingEnabled},set:function(t){this.waitOnSaveChange=!0,G["a"].savingEnabled=t,this.saveSettings()}},savesEnabledInEnv:function(){return G["a"].supports.optionalSaving},lqAllowed:function(){return G["a"].supports.lq},lqRendering:{get:function(){return this.$store.state.ui.lqRendering},set:function(t){var e=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$store.commit("ui/setLqRendering",t);case 2:case"end":return n.stop()}}),n)})))),this.saveSettings()}},nsfw:{get:function(){return!!this.$store.state.ui.nsfw},set:function(t){var e=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$store.commit("ui/setNsfw",t);case 2:e.saveSettings();case 3:case"end":return n.stop()}}),n)}))))}},defaultCharacterTalkingZoom:{get:function(){return!!this.$store.state.ui.defaultCharacterTalkingZoom},set:function(t){var e=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$store.commit("ui/setDefaultCharacterTalkingZoom",t);case 2:e.saveSettings();case 3:case"end":return n.stop()}}),n)}))))}},theme:{get:function(){return this.$store.state.ui.useDarkTheme},set:function(t){var e=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$store.commit("ui/setDarkTheme",t);case 2:e.saveSettings();case 3:case"end":return n.stop()}}),n)}))))}}},watch:{savesAllowed:function(){this.waitOnSaveChange=!1}},methods:{allowSaves:function(t){this.allowSavesModal=!1,"Allow"===t&&(this.savesAllowed=!0)},denySaves:function(t){this.denySavesModal=!1,"Deny"===t&&(this.savesAllowed=!1)},saveSettings:function(){var t;G["a"].saveSettings({lq:this.$store.state.ui.lqRendering,nsfw:this.$store.state.ui.nsfw,darkMode:null!==(t=this.$store.state.ui.useDarkTheme)&&void 0!==t?t:void 0,defaultCharacterTalkingZoom:this.$store.state.ui.defaultCharacterTalkingZoom})}}});n("9566");tt.render=W,tt.__scopeId="data-v-ba6b5c3e";var et=tt,nt=Object(r["F"])("data-v-5f8bbaab");Object(r["r"])("data-v-5f8bbaab");var rt=Object(r["j"])("Drop here to add as a new sprite"),ot=Object(r["k"])("h1",null,"Add",-1),at=Object(r["j"])(" Char­acters "),it=Object(r["j"])(" Sprites "),ct=Object(r["j"])(" UI "),st=Object(r["j"])(" Search in content packs "),ut=Object(r["j"])(" Upload new sprite "),lt=Object(r["j"])(" New sprite from URL "),dt=Object(r["j"])(" Search in content packs ");Object(r["q"])();var pt=nt((function(t,e,n,o,a,i){var c=Object(r["w"])("drop-target"),s=Object(r["w"])("d-button");return void 0!==t.isWebPSupported?(Object(r["p"])(),Object(r["g"])("div",{key:0,class:"panel",onDragenter:e[14]||(e[14]=function(){return t.showDropTarget.apply(t,arguments)}),onMouseleave:e[15]||(e[15]=function(){return t.hideDropTarget.apply(t,arguments)})},[Object(r["k"])(c,{ref:"spriteDt",class:"drop-target",onDrop:t.addCustomSpriteFile},{default:nt((function(){return[rt]})),_:1},8,["onDrop"]),ot,Object(r["k"])("div",{class:{"group-selector":!0,vertical:t.vertical}},[Object(r["k"])(s,{class:{active:"characters"===t.group},"icon-pos":"top",icon:"emoji_people",onClick:e[1]||(e[1]=function(e){return t.group="characters"})},{default:nt((function(){return[at]})),_:1},8,["class"]),Object(r["k"])(s,{class:{active:"sprites"===t.group},"icon-pos":"top",icon:"change_history",onClick:e[2]||(e[2]=function(e){return t.group="sprites"})},{default:nt((function(){return[it]})),_:1},8,["class"]),Object(r["k"])(s,{class:{active:"ui"===t.group},"icon-pos":"top",icon:"view_quilt",onClick:e[3]||(e[3]=function(e){return t.group="ui"})},{default:nt((function(){return[ct]})),_:1},8,["class"])],2),Object(r["k"])("div",{class:{"item-grid":!0,vertical:t.vertical}},["characters"===t.group?(Object(r["p"])(),Object(r["g"])(r["a"],{key:0},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.characters,(function(e){return Object(r["p"])(),Object(r["g"])("div",{class:"character",key:e.id,title:e.label,onClick:function(n){return t.onChosen(e.id.toLowerCase())}},[Object(r["k"])("img",{src:t.assetPath(e),alt:e.label},null,8,["src","alt"])],8,["title","onClick"])})),128)),Object(r["k"])(s,{class:"custom-sprite",icon:"extension",onClick:e[4]||(e[4]=function(e){return t.$emit("show-dialog","type: Characters")})},{default:nt((function(){return[st]})),_:1})],64)):Object(r["h"])("",!0),"sprites"===t.group?(Object(r["p"])(),Object(r["g"])(r["a"],{key:1},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.sprites,(function(e){return Object(r["p"])(),Object(r["g"])("div",{class:"sprite",key:e.label,title:e.label,style:{background:t.assetSpriteBackground(e)},onClick:function(n){return t.addSpriteToScene(e)}},Object(r["x"])(e.label),13,["title","onClick"])})),128)),Object(r["k"])(s,{class:"custom-sprite",icon:"publish",onClick:e[6]||(e[6]=function(e){return t.$refs.spriteUpload.click()})},{default:nt((function(){return[ut,Object(r["k"])("input",{type:"file",ref:"spriteUpload",onChange:e[5]||(e[5]=function(){return t.onSpriteFileUpload.apply(t,arguments)})},null,544)]})),_:1}),Object(r["k"])(s,{icon:"insert_link",onClick:t.uploadFromURL},{default:nt((function(){return[lt]})),_:1},8,["onClick"]),Object(r["k"])(s,{icon:"extension",onClick:e[7]||(e[7]=function(e){return t.$emit("show-dialog","type: Sprites")})},{default:nt((function(){return[dt]})),_:1})],64)):Object(r["h"])("",!0),"ui"===t.group?(Object(r["p"])(),Object(r["g"])(r["a"],{key:2},[Object(r["k"])("button",{onClick:e[8]||(e[8]=function(){return t.addTextBox.apply(t,arguments)})},"Textbox"),Object(r["k"])("button",{onClick:e[9]||(e[9]=function(){return t.addPoem.apply(t,arguments)})},"Poem"),Object(r["k"])("button",{onClick:e[10]||(e[10]=function(){return t.addDialog.apply(t,arguments)})},"Notification"),Object(r["k"])("button",{onClick:e[11]||(e[11]=function(){return t.addChoice.apply(t,arguments)})},"Choice"),Object(r["k"])("button",{onClick:e[12]||(e[12]=function(){return t.addConsole.apply(t,arguments)})},"Console")],64)):Object(r["h"])("",!0),Object(r["k"])("button",{onClick:e[13]||(e[13]=function(){return t.paste.apply(t,arguments)}),disabled:!t.hasClipboardContent}," Paste ",8,["disabled"])],2)],32)):Object(r["h"])("",!0)})),bt=(n("7db0"),n("a630"),n("a15b"),n("d81d"),n("fb6a"),n("b0c0"),n("ac1f"),n("466d"),n("1276"),n("2b3d"),n("b85c")),ht=n("5947"),ft=n("dc61"),vt=Object(r["F"])("data-v-465f5994");Object(r["r"])("data-v-465f5994");var mt={class:"material-icons","aria-hidden":"true"},jt={class:"content"};Object(r["q"])();var gt=vt((function(t,e,n,o,a,i){return Object(r["p"])(),Object(r["g"])("button",{class:[t.iconPos],disabled:t.disabled},[Object(r["k"])("div",mt,Object(r["x"])(t.icon),1),Object(r["k"])("div",jt,[Object(r["v"])(t.$slots,"default")])],10,["disabled"])})),Ot=Object(r["m"])({props:{icon:{type:String,required:!0},iconPos:{type:String,default:"left"},disabled:{type:Boolean,default:!1}}});n("4ad0");Ot.render=gt,Ot.__scopeId="data-v-465f5994";var kt=Ot,yt={packId:"dddg.buildin.uploadedSprites",packCredits:[""],dependencies:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},wt=Object(r["m"])({mixins:[q],components:{DropTarget:ft["a"],DButton:kt},data:function(){return{isWebPSupported:null,customAssetCount:0,group:"characters"}},computed:{characters:function(){return this.$store.state.content.current.characters},sprites:function(){return this.$store.state.content.current.sprites},hasClipboardContent:function(){return!!this.$store.state.ui.clipboard}},methods:{assetSpriteBackground:function(t){return t.variants[0].map((function(t){return"url('".concat(t.lq,"')")})).join(",")},assetPath:function(t){return t.chibi?G["a"].supports.lq?t.chibi.lq:t.chibi.hq:""},showDropTarget:function(t){t.dataTransfer&&(t.dataTransfer.effectAllowed="none",Array.from(t.dataTransfer.items).find((function(t){return t.type.match(/^image.*$/)}))&&(t.dataTransfer.effectAllowed="link","sprites"===this.group&&this.$refs.spriteDt.show()))},hideDropTarget:function(){"sprites"===this.group&&this.$refs.spriteDt.hide()},onSpriteFileUpload:function(){var t=this.$refs.spriteUpload;if(t.files){var e,n=Object(bt["a"])(t.files);try{for(n.s();!(e=n.n()).done;){var r=e.value;this.addCustomSpriteFile(r)}}catch(o){n.e(o)}finally{n.f()}}},uploadFromURL:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=prompt("Enter the URL of the image"),n){e.next=3;break}return e.abrupt("return");case 3:r=n.split("/").slice(-1)[0],t.addNewCustomSprite(r,n);case 5:case"end":return e.stop()}}),e)})))()},addSpriteToScene:function(t){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$store.dispatch("objects/createSprite",{assets:t.variants[0]});case 2:case"end":return n.stop()}}),n)}))));case 1:case"end":return n.stop()}}),n)})))()},addTextBox:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createTextBox",{});case 1:case"end":return e.stop()}}),e)}))))},addChoice:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createChoice",{});case 1:case"end":return e.stop()}}),e)}))))},addDialog:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createNotification",{});case 1:case"end":return e.stop()}}),e)}))))},addPoem:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createPoem",{});case 1:case"end":return e.stop()}}),e)}))))},addConsole:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/createConsole",{});case 1:case"end":return e.stop()}}),e)}))))},paste:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/pasteObjectFromClipboard",{});case 1:case"end":return e.stop()}}),e)}))))},onChosen:function(t){var e=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.$store.dispatch("objects/createCharacters",{characterType:t});case 1:case"end":return n.stop()}}),n)}))))},addCustomSpriteFile:function(t){var e=URL.createObjectURL(t);this.addNewCustomSprite(t.name,e)},addNewCustomSprite:function(t,e){var n=this;yt.sprites.push({id:e,label:t,variants:[[e]]}),this.vuexHistory.transaction((function(){n.$store.dispatch("content/replaceContentPack",{contentPack:yt,processed:!1})}))}},created:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(ht["e"])();case 2:t.isWebPSupported=e.sent;case 3:case"end":return e.stop()}}),e)})))()}});n("50ef");wt.render=pt,wt.__scopeId="data-v-5f8bbaab";var xt=wt,Ct=Object(r["F"])("data-v-47403597");Object(r["r"])("data-v-47403597");var St={key:0},Rt={class:"arrow-col"},Pt={class:"arrow-col"},It={key:1},Tt={class:"arrow-col"},At={class:"arrow-col"},_t={class:"arrow-col"},$t={class:"arrow-col"};Object(r["q"])();var Dt=Ct((function(t,e,n,o,a,i){var c=Object(r["w"])("parts"),s=Object(r["w"])("d-fieldset"),u=Object(r["w"])("toggle"),l=Object(r["w"])("object-tool");return Object(r["p"])(),Object(r["g"])(l,{object:t.object,title:t.label,showAltPanel:t.panelForParts},{"alt-panel":Ct((function(){return[t.panelForParts?Object(r["k"])(c,{key:0,character:t.object,part:t.panelForParts,onLeave:e[1]||(e[1]=function(e){return t.panelForParts=null}),"onShow-dialog":e[2]||(e[2]=function(e){return t.$emit("show-dialog",e)}),"onShow-expression-dialog":e[3]||(e[3]=function(e){return t.$emit("show-expression-dialog",e)})},null,8,["character","part"]):Object(r["h"])("",!0)]})),default:Ct((function(){return[t.hasMultiplePoses||t.parts.length>0?Object(r["k"])(s,{key:0,class:"pose-list",title:"Pose:"},{default:Ct((function(){return[Object(r["k"])("table",null,[Object(r["k"])("tbody",null,[t.hasMultipleStyles?(Object(r["p"])(),Object(r["g"])("tr",St,[Object(r["k"])("td",Rt,[Object(r["k"])("button",{onClick:e[4]||(e[4]=function(e){return t.seekStyle(-1)})},"<")]),Object(r["k"])("td",null,[Object(r["k"])("button",{class:"middle-button",onClick:e[5]||(e[5]=function(e){return t.panelForParts="style"})}," Style ")]),Object(r["k"])("td",Pt,[Object(r["k"])("button",{onClick:e[6]||(e[6]=function(e){return t.seekStyle(1)})},">")])])):Object(r["h"])("",!0),t.hasMultiplePoses?(Object(r["p"])(),Object(r["g"])("tr",It,[Object(r["k"])("td",Tt,[Object(r["k"])("button",{onClick:e[7]||(e[7]=function(e){return t.seekPose(-1)})},"<")]),Object(r["k"])("td",null,[Object(r["k"])("button",{class:"middle-button",onClick:e[8]||(e[8]=function(e){return t.panelForParts="pose"})}," Pose ")]),Object(r["k"])("td",At,[Object(r["k"])("button",{onClick:e[9]||(e[9]=function(e){return t.seekPose(1)})},">")])])):Object(r["h"])("",!0),(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.parts,(function(e){return Object(r["p"])(),Object(r["g"])("tr",{key:e},[Object(r["k"])("td",_t,[Object(r["k"])("button",{onClick:function(n){return t.seekPart(e,-1)}},"<",8,["onClick"])]),Object(r["k"])("td",null,[Object(r["k"])("button",{class:"middle-button",onClick:function(n){return t.panelForParts=e}},Object(r["x"])(t.captialize(e)),9,["onClick"])]),Object(r["k"])("td",$t,[Object(r["k"])("button",{onClick:function(n){return t.seekPart(e,1)}},">",8,["onClick"])])])})),128))])])]})),_:1}):Object(r["h"])("",!0)]})),options:Ct((function(){return[Object(r["k"])(u,{modelValue:t.closeUp,"onUpdate:modelValue":e[10]||(e[10]=function(e){return t.closeUp=e}),label:"Close up?"},null,8,["modelValue"])]})),_:1},8,["object","title","showAltPanel"])})),Ht=n("ba37"),Vt=n("b3d7"),Et=Object(r["F"])("data-v-47f2e1e8");Object(r["r"])("data-v-47f2e1e8");var Bt=Object(r["k"])("i",{class:"material-icons"},"extension",-1),Ft=Object(r["k"])("span",{class:"text-block"},"Create new expressions",-1),Lt=Object(r["k"])("i",{class:"material-icons"},"extension",-1),Mt=Object(r["k"])("span",{class:"text-block"},"Search in content packs",-1),Nt=Object(r["k"])("i",{class:"material-icons"},"extension",-1),Wt=Object(r["k"])("span",null,"Search in content packs",-1),Ut=Object(r["k"])("i",{class:"material-icons"},"extension",-1),zt=Object(r["k"])("span",null,"Search in content packs",-1);Object(r["q"])();var qt=Et((function(t,e,n,o,a,i){var c=Object(r["w"])("part-button"),s=Object(r["w"])("d-flow"),u=Object(r["w"])("d-fieldset");return Object(r["p"])(),Object(r["g"])(s,{"no-wraping":""},{default:Et((function(){return[Object(r["k"])("button",{onClick:e[1]||(e[1]=function(e){return t.$emit("leave")})},"Back"),"head"===t.part?(Object(r["p"])(),Object(r["g"])("button",{key:0,onClick:e[2]||(e[2]=function(e){return t.$emit("show-expression-dialog",{character:t.character.characterType})}),class:"icon-button"},[Bt,Ft])):Object(r["h"])("",!0),"head"===t.part?(Object(r["p"])(),Object(r["g"])("button",{key:1,onClick:e[3]||(e[3]=function(e){return t.$emit("show-dialog","type: Expressions character: "+t.charData.label)}),class:"icon-button"},[Lt,Mt])):"style"===t.part?(Object(r["p"])(),Object(r["g"])("button",{key:2,onClick:e[4]||(e[4]=function(e){return t.$emit("show-dialog","type: Styles character: "+t.charData.label)}),class:"icon-button"},[Nt,Wt])):(Object(r["p"])(),Object(r["g"])("button",{key:3,onClick:e[5]||(e[5]=function(e){return t.$emit("show-dialog","type: Poses character: "+t.charData.label)}),class:"icon-button"},[Ut,zt])),(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.parts,(function(e,n){return Object(r["p"])(),Object(r["g"])(c,{key:n,value:n,part:e,onClick:function(e){t.choose(n),t.$emit("leave")}},null,8,["value","part","onClick"])})),128)),(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.styleComponents,(function(e){return Object(r["p"])(),Object(r["g"])(u,{key:e.name,title:e.label},{default:Et((function(){return[Object(r["k"])(s,{noWraping:""},{default:Et((function(){return[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(e.buttons,(function(n,o){return Object(r["p"])(),Object(r["g"])(c,{size:130,key:o,value:o,part:n,onClick:function(n){return t.choose_component(e.name,o)}},null,8,["value","part","onClick"])})),128))]})),_:2},1024)]})),_:2},1032,["title"])})),128))]})),_:1})})),Gt=(n("99af"),n("4de4"),n("c740"),n("c975"),n("a434"),Object(r["F"])("data-v-7d67a652")),Yt=Gt((function(t,e,n,o,a,i){return Object(r["p"])(),Object(r["g"])("div",{class:{part:!0,active:!1},style:t.style,onClick:e[1]||(e[1]=function(e){return t.$emit("click")})},null,4)})),Kt=(n("a9e3"),n("5319"),960),Xt=Object(r["m"])({props:{part:{required:!0},value:{required:!0},size:{type:Number,default:150}},data:function(){return{lookups:[],loaded:!1}},computed:{scaleX:function(){return this.size/this.part.size[0]},scaleY:function(){return this.size/this.part.size[1]},backgroundSize:function(){return"".concat(Math.floor(Kt*this.scaleX),"px ").concat(Math.floor(Kt*this.scaleY),"px")},backgroundPosition:function(){return"".concat(Math.floor(this.part.offset[0]*-this.scaleX),"px ")+"".concat(Math.floor(this.part.offset[1]*-this.scaleY),"px")},style:function(){var t=this.lookups.filter((function(t){return t instanceof HTMLImageElement})).map((function(t){return"url('".concat(t.src.replace("'","\\'"),"')")}));return{backgroundImage:t.join(","),height:this.size+"px",width:this.size+"px",backgroundPosition:this.backgroundPosition,backgroundSize:this.backgroundSize}}},created:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.part.images.map((function(t){return"string"===typeof t.asset?Object(ht["b"])(t.asset,!1):Object(ht["a"])(t.asset,!1)})));case 2:t.lookups=e.sent;case 3:case"end":return e.stop()}}),e)})))()}});n("ddde");Xt.render=Yt,Xt.__scopeId="data-v-7d67a652";var Jt=Xt,Zt=n("ade3"),Qt=n("5530"),te=Object(r["m"])({mixins:[z["a"]],props:{noWraping:{type:Boolean,default:!1},direction:{type:String,default:"global"},maxSize:{},gap:{type:String,default:"0px"}},computed:{finalDirection:function(){return"global"===this.direction?this.$store.state.ui.vertical?"vertical":"horizontal":"inverted"===this.direction?this.$store.state.ui.vertical?"horizontal":"vertical":this.direction}},render:function(){var t=this.noWraping?"no-wraping":"wraping",e={},n=Object(r["n"])("div",Object(Qt["a"])(Object(Qt["a"])({},e),{},{class:["d-flow",this.finalDirection,t],style:{gap:this.gap}}),this.$slots.default());if(this.maxSize){var o=this.maxSize instanceof Array?this.maxSize["horizontal"===this.finalDirection?0:1]:this.maxSize;return Object(r["n"])("div",{ref:"scrollContainer",class:["d-flow-scroll-container",this.finalDirection],style:Object(Zt["a"])({},"horizontal"===this.finalDirection?"maxWidth":"maxHeight",o)},[n])}return n},mounted:function(){this.$refs.scrollContainer&&this.$refs.scrollContainer.addEventListener("wheel",this.verticalScrollRedirect)}});n("9e3d");te.__scopeId="data-v-64adfc9c";var ee=te,ne=Object(r["m"])({components:{PartButton:Jt,DFieldset:Vt["a"],DFlow:ee},props:{character:{type:Object,required:!0},part:{required:!0,type:String}},data:function(){return{isWebPSupported:null,stylePriorities:[]}},computed:{vertical:function(){return this.$store.state.ui.vertical},styleComponents:function(){if("style"!==this.part)return[];var t=this.charData.styleGroups[this.character.styleGroupId];return t.styleComponents.map((function(e){var n={};for(var r in e.variants)if(e.variants.hasOwnProperty(r)){var o=e.variants[r];n[r]={size:t.styles[0].poses[0].size,offset:[0,0],images:[{offset:[0,0],asset:o}]}}return{label:e.label,name:e.id,buttons:n}}))},parts:function(){var t,e,n,r={},o=this.charData,a=Object(Ht["h"])(o,this.character);switch(this.part){case"head":for(var i=0;i<a.compatibleHeads.length;++i)for(var c=a.compatibleHeads[i],s=o.heads[c],u=0;u<s.variants.length;++u){var l=s.variants[u];r["".concat(i,"_").concat(u)]={size:s.previewSize,offset:s.previewOffset,images:l.map((function(t){return{asset:t,offset:[0,0]}}))}}return r;case"pose":for(var d=o.styleGroups[this.character.styleGroupId].styles[this.character.styleId],p=0;p<d.poses.length;++p){var b=d.poses[p];r[p]=this.generatePosePreview(b)}return r;case"style":var h,f=Object(bt["a"])(o.styleGroups);try{for(f.s();!(h=f.n()).done;){var v=h.value;r[v.id]=this.generatePosePreview(v.styles[0].poses[0])}}catch(g){f.e(g)}finally{f.f()}return r;default:t=a.positions[this.part],n=a.previewSize,e=a.previewOffset;break}for(var m=0;m<t.length;++m){var j=t[m];r[m]={images:j.map((function(t){return{offset:[0,0],asset:t}})),size:n,offset:e}}return r},charData:function(){return Object(Ht["e"])(this.$store,this.character)}},methods:{updateStyleData:function(){var t=this.charData.styleGroups[this.character.styleGroupId].styles[this.character.styleId];this.stylePriorities=Object.keys(t.components).map((function(e){return[e,t.components[e]]}))},generatePosePreview:function(t){var e,n=this.charData,r=n.heads[t.compatibleHeads[0]],o=r?r.variants[0]:null,a=[],i=Object(bt["a"])(t.renderCommands);try{for(i.s();!(e=i.n()).done;){var c=e.value;switch(c.type){case"pose-part":var s=t.positions[c.part];if(!s||0===s.length)break;a=a.concat(s[0]);break;case"head":o&&(a=a.concat(o));break;case"image":a=a.concat(c.images);break}}}catch(u){i.e(u)}finally{i.f()}return{images:a.map((function(t){return{asset:t,offset:[0,0]}})),size:t.previewSize,offset:t.previewOffset}},updatePose:function(t){var e=this;void 0===t&&(t=this.character.styleGroupId);var n,r=this.charData,o=r.styleGroups[t],a=o.styles,i=Object(bt["a"])(this.stylePriorities);try{var c=function(){var t=n.value,e=a.filter((function(e){return e.components[t[0]]===t[1]}));e.length>0&&(a=e)};for(i.s();!(n=i.n()).done;)c()}catch(s){i.e(s)}finally{i.f()}this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setCharStyle",{id:e.character.id,styleGroupId:t,styleId:o.styles.indexOf(a[0])})}))},choose:function(t){if("style"===this.part)this.updatePose(this.charData.styleGroups.findIndex((function(e){return e.id===t})));else if("head"===this.part){var e=t.split("_",2).map((function(t){return parseInt(t,10)})),n=Object(l["a"])(e,2),r=n[0],o=n[1];this.$store.commit("objects/setPosePosition",{id:this.character.id,posePositions:{headType:r,head:o}})}else this.setPart(this.part,parseInt(t,10))},choose_component:function(t,e){var n=this.stylePriorities.findIndex((function(e){return e[0]===t}));this.stylePriorities.splice(n,1),this.stylePriorities.unshift([t,e]),this.updatePose()},setPart:function(t,e){var n=this;this.vuexHistory.transaction((function(){n.$store.dispatch("objects/setPart",{id:n.character.id,part:t,val:e})}))}},created:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.updateStyleData(),e.next=3,Object(ht["e"])();case 3:t.isWebPSupported=e.sent;case 4:case"end":return e.stop()}}),e)})))()},watch:{character:function(){this.updateStyleData()}}});n("1c59");ne.render=qt,ne.__scopeId="data-v-47f2e1e8";var re=ne;function oe(){return function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{get:function(){return this.object[t]},set:function(r){var o=this;this.vuexHistory.transaction((function(){o.$store[n?"dispatch":"commit"](e,Object(Zt["a"])({id:o.object.id},t,r))}))}}}}var ae=Object(r["F"])("data-v-585ac6ce");Object(r["r"])("data-v-585ac6ce");var ie={class:"panel"},ce=Object(r["k"])("span",{class:"icon material-icons"},"edit",-1),se=Object(r["k"])("p",{class:"modal-text"}," Enter the new name ",-1),ue={class:"modal-text"},le={class:"input-table"},de=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"rotation"},"Rotation: °")],-1),pe={key:0},be=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"zoom"},"Zoom: ")],-1),he={key:0},fe=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"textbox_color"},"Color:")],-1),ve=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"namebox_width"},"Namebox width:")],-1);Object(r["q"])();var me=ae((function(t,e,n,o,a,i){var c=Object(r["w"])("modal-dialog"),s=Object(r["w"])("text-editor"),u=Object(r["w"])("color"),l=Object(r["w"])("image-options"),d=Object(r["w"])("position-and-size"),p=Object(r["w"])("layers"),b=Object(r["w"])("toggle"),h=Object(r["w"])("d-fieldset"),f=Object(r["w"])("delete");return Object(r["p"])(),Object(r["g"])("div",ie,[Object(r["k"])("h1",{style:{fontStyle:this.hasLabel?"italic":"normal"},onClick:e[1]||(e[1]=function(){return t.enableNameEdit.apply(t,arguments)})},[Object(r["j"])(Object(r["x"])(t.heading)+" ",1),ce]),(Object(r["p"])(),Object(r["g"])(r["c"],{to:"#modal-messages"},[t.showRename?Object(r["k"])(c,{key:0,options:["Apply","Cancel"],"no-base-size":"",class:"modal-rename",onOption:t.renameOption,onLeave:e[3]||(e[3]=function(e){return t.renameOption("Cancel")})},{default:ae((function(){return[se,Object(r["k"])("p",ue,[Object(r["D"])(Object(r["k"])("input",{"onUpdate:modelValue":e[2]||(e[2]=function(e){return t.modalNameInput=e}),style:{width:"100%"}},null,512),[[r["A"],t.modalNameInput]])])]})),_:1},8,["onOption"]):Object(r["h"])("",!0)])),t.textHandler?Object(r["k"])(s,{key:0,title:t.textHandler.title,modelValue:t.textHandler.get(),"onUpdate:modelValue":e[4]||(e[4]=function(e){return t.textHandler.set(e)}),onLeave:e[5]||(e[5]=function(e){return t.textHandler.leave()})},null,8,["title","modelValue"]):t.finalColorHandler?Object(r["k"])(u,{key:1,title:t.finalColorHandler.title,modelValue:t.finalColorHandler.get(),"onUpdate:modelValue":e[6]||(e[6]=function(e){return t.finalColorHandler.set(e)}),onLeave:e[7]||(e[7]=function(e){return t.finalColorHandler.leave()})},null,8,["title","modelValue"]):t.imageOptionsOpen?Object(r["k"])(l,{key:2,type:"object",id:t.object.id,onLeave:e[8]||(e[8]=function(e){return t.imageOptionsOpen=!1})},null,8,["id"]):t.showAltPanel?Object(r["v"])(t.$slots,"alt-panel",{key:3}):(Object(r["p"])(),Object(r["g"])(r["a"],{key:4},[Object(r["v"])(t.$slots,"default"),Object(r["k"])(d,{obj:t.object},null,8,["obj"]),Object(r["k"])(p,{object:t.object},null,8,["object"]),Object(r["k"])(b,{modelValue:t.flip,"onUpdate:modelValue":e[9]||(e[9]=function(e){return t.flip=e}),label:"Flip?"},null,8,["modelValue"]),Object(r["k"])("table",le,[Object(r["k"])("tr",null,[de,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"rotation",class:"smol",type:"number","onUpdate:modelValue":e[10]||(e[10]=function(e){return t.rotation=e}),onKeydown:e[11]||(e[11]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.rotation]])])]),"character"===t.object.type||"sprite"===t.object.type?(Object(r["p"])(),Object(r["g"])("tr",pe,[be,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"zoom",type:"number",class:"smol",step:"1",min:"0","onUpdate:modelValue":e[12]||(e[12]=function(e){return t.zoom=e}),onKeydown:e[13]||(e[13]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.zoom]])])])):Object(r["h"])("",!0)]),Object(r["v"])(t.$slots,"options"),t.hasLabel?Object(r["k"])(h,{key:0,title:"Textbox settings"},{default:ae((function(){return["character"===t.object.type||"sprite"===t.object.type?Object(r["k"])(b,{key:0,label:"Enlarge when talking",modelValue:t.enlargeWhenTalking,"onUpdate:modelValue":e[14]||(e[14]=function(e){return t.enlargeWhenTalking=e})},null,8,["modelValue"]):Object(r["h"])("",!0),Object(r["k"])(b,{label:"Use custom textbox color",modelValue:t.useCustomTextboxColor,"onUpdate:modelValue":e[15]||(e[15]=function(e){return t.useCustomTextboxColor=e})},null,8,["modelValue"]),Object(r["k"])("table",null,[t.useCustomTextboxColor?(Object(r["p"])(),Object(r["g"])("tr",he,[fe,Object(r["k"])("td",null,[Object(r["k"])("button",{id:"textbox_color",class:"color-button",style:{background:t.object.textboxColor},onClick:e[16]||(e[16]=function(){return t.selectTextboxColor.apply(t,arguments)})},null,4)])])):Object(r["h"])("",!0),Object(r["k"])("tr",null,[ve,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"namebox_width",type:"number",placeholder:t.defaultNameboxWidth,"onUpdate:modelValue":e[17]||(e[17]=function(e){return t.nameboxWidth=e})},null,8,["placeholder"]),[[r["A"],t.nameboxWidth,void 0,{lazy:!0}]])])])])]})),_:1}):Object(r["h"])("",!0),Object(r["k"])("button",{onClick:e[18]||(e[18]=function(e){return t.imageOptionsOpen=!0})},"Image options"),Object(r["k"])("button",{onClick:e[19]||(e[19]=function(){return t.copy.apply(t,arguments)})},"Copy"),Object(r["k"])(f,{obj:t.object},null,8,["obj"])],64))])})),je=(n("498a"),Object(r["F"])("data-v-7f101752"));Object(r["r"])("data-v-7f101752");var ge={colspan:"2"},Oe={key:0},ke={colspan:"2"},ye={class:"arrow-col"},we={class:"arrow-col"},xe=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"sprite_x"},"X:")],-1),Ce=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"sprite_y"},"Y:")],-1),Se=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"sprite_w"},"Width:")],-1),Re=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"sprite_h"},"Height:")],-1),Pe={colspan:"2"};Object(r["q"])();var Ie=je((function(t,e,n,o,a,i){var c=Object(r["w"])("toggle"),s=Object(r["w"])("d-fieldset");return Object(r["p"])(),Object(r["g"])(s,{title:"Position"+(t.allowSize?"/Size":"")},{default:je((function(){return[Object(r["k"])("table",null,[Object(r["k"])("tr",null,[Object(r["k"])("td",ge,[t.allowStepMove?Object(r["k"])(c,{key:0,modelValue:t.freeMove,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.freeMove=e}),label:"Move freely?"},null,8,["modelValue"]):Object(r["h"])("",!0)])]),t.allowStepMove&&!t.freeMove?(Object(r["p"])(),Object(r["g"])("tr",Oe,[Object(r["k"])("td",ke,[Object(r["k"])("table",null,[Object(r["k"])("tr",null,[Object(r["k"])("td",ye,[Object(r["k"])("button",{onClick:e[2]||(e[2]=function(e){return--t.pos}),disabled:t.isFirstPos},"<",8,["disabled"])]),Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("select",{id:"current_talking","onUpdate:modelValue":e[3]||(e[3]=function(e){return t.pos=e})},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.positionNames,(function(t,e){return Object(r["p"])(),Object(r["g"])("option",{key:e,value:e},Object(r["x"])(t),9,["value"])})),128))],512),[[r["z"],t.pos,void 0,{number:!0}]])]),Object(r["k"])("td",we,[Object(r["k"])("button",{onClick:e[4]||(e[4]=function(e){return++t.pos}),disabled:t.isLastPos},">",8,["disabled"])])])])])])):(Object(r["p"])(),Object(r["g"])(r["a"],{key:1},[Object(r["k"])("tr",null,[xe,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"sprite_x",type:"number","onUpdate:modelValue":e[5]||(e[5]=function(e){return t.x=e}),onKeydown:e[6]||(e[6]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.x,void 0,{number:!0}]])])]),Object(r["k"])("tr",null,[Ce,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"sprite_y",type:"number","onUpdate:modelValue":e[7]||(e[7]=function(e){return t.y=e}),onKeydown:e[8]||(e[8]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.y,void 0,{number:!0}]])])])],64)),t.allowSize?(Object(r["p"])(),Object(r["g"])(r["a"],{key:2},[Object(r["k"])("tr",null,[Se,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"sprite_w",min:"0",type:"number","onUpdate:modelValue":e[9]||(e[9]=function(e){return t.width=e}),onKeydown:e[10]||(e[10]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.width,void 0,{number:!0}]])])]),Object(r["k"])("tr",null,[Re,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"sprite_h",min:"0",type:"number","onUpdate:modelValue":e[11]||(e[11]=function(e){return t.height=e}),onKeydown:e[12]||(e[12]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.height,void 0,{number:!0}]])])]),Object(r["k"])("tr",null,[Object(r["k"])("td",Pe,[Object(r["k"])(c,{modelValue:t.preserveRatio,"onUpdate:modelValue":e[13]||(e[13]=function(e){return t.preserveRatio=e}),label:"Lock ratio?"},null,8,["modelValue"])])])],64)):Object(r["h"])("",!0)])]})),_:1},8,["title"])})),Te=n("fec4"),Ae=Object(r["m"])({components:{Toggle:U["a"],DFieldset:Vt["a"]},props:{obj:{required:!0}},computed:{freeMove:{get:function(){return this.obj.freeMove},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setFreeMove",{id:e.obj.id,freeMove:t})}))}},preserveRatio:{get:function(){return this.obj.preserveRatio},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setPreserveRatio",{id:e.obj.id,preserveRatio:t})}))}},pos:{get:function(){return Object(Ht["c"])(this.obj.x)},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setPosition",{id:e.obj.id,x:Te["a"][t],y:e.obj.y})}))}},x:{get:function(){return this.obj.x},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setPosition",{id:e.obj.id,x:t,y:e.y})}))}},y:{get:function(){return this.obj.y},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setPosition",{id:e.obj.id,x:e.x,y:t})}))}},height:{get:function(){return this.obj.height},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setHeight",{id:e.obj.id,height:t})}))}},width:{get:function(){return this.obj.width},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setWidth",{id:e.obj.id,width:t})}))}},allowSize:function(){var t=this.obj;return("textBox"!==t.type||"custom"===t.style)&&!("character"===t.type&&!t.freeMove)},allowStepMove:function(){return"freeMove"in this.obj},positionNames:function(){return Te["b"]},isFirstPos:function(){return 0===this.pos},isLastPos:function(){return this.pos===Te["b"].length-1}}});n("3742");Ae.render=Ie,Ae.__scopeId="data-v-7f101752";var _e=Ae,$e=Object(r["F"])("data-v-90b83fd8");Object(r["r"])("data-v-90b83fd8");var De=Object(r["k"])("i",{class:"material-icons"},"vertical_align_bottom",-1),He=Object(r["k"])("i",{class:"material-icons"},"arrow_downward",-1),Ve=Object(r["k"])("i",{class:"material-icons"},"arrow_upward",-1),Ee=Object(r["k"])("i",{class:"material-icons"},"vertical_align_top",-1);Object(r["q"])();var Be=$e((function(t,e,n,o,a,i){var c=Object(r["w"])("toggle"),s=Object(r["w"])("d-fieldset");return Object(r["p"])(),Object(r["g"])(s,{id:"layerfs",title:"Layer:"},{default:$e((function(){return[Object(r["k"])("table",null,[Object(r["k"])("tbody",null,[Object(r["k"])("tr",null,[Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[1]||(e[1]=function(e){return t.shiftLayer(-1/0)}),title:"Move to back"},[De])]),Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[2]||(e[2]=function(e){return t.shiftLayer(-1)}),title:"Move backwards"},[He])]),Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[3]||(e[3]=function(e){return t.shiftLayer(1)}),title:"Move forwards"},[Ve])]),Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[4]||(e[4]=function(e){return t.shiftLayer(1/0)}),title:"Move to front"},[Ee])])])])]),Object(r["k"])(c,{modelValue:t.onTop,"onUpdate:modelValue":e[5]||(e[5]=function(e){return t.onTop=e}),label:"In front?"},null,8,["modelValue"])]})),_:1})})),Fe=Object(r["m"])({components:{Toggle:U["a"],DFieldset:Vt["a"]},props:{object:{required:!0}},computed:{onTop:oe()("onTop","objects/setOnTop",!0)},methods:{shiftLayer:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/shiftLayer",{id:e.object.id,delta:t})}))}}});n("71ca");Fe.render=Be,Fe.__scopeId="data-v-90b83fd8";var Le=Fe;function Me(t,e,n,o,a,i){return Object(r["p"])(),Object(r["g"])("button",{onClick:e[1]||(e[1]=function(){return t.onClick.apply(t,arguments)})},"Delete")}var Ne=Object(r["m"])({props:{obj:{required:!0}},methods:{onClick:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("objects/removeObject",{id:t.obj.id})}))}}});Ne.render=Me;var We=Ne,Ue=(n("b680"),Object(r["F"])("data-v-4dd06317"));Object(r["r"])("data-v-4dd06317");var ze=Object(r["k"])("h2",null,"Image options",-1),qe={class:"column ok-col"},Ge={key:0,class:"column"},Ye=Object(r["k"])("label",{for:"compositionSelect"},"Compositing Mode:",-1),Ke=Object(r["j"])("[?]"),Xe=Object(r["i"])('<option value="source-over" data-v-4dd06317>source-over</option><option value="source-atop" data-v-4dd06317>source-atop</option><option value="destination-over" data-v-4dd06317>destination-over</option><option value="destination-in" data-v-4dd06317>destination-in</option><option value="destination-in" data-v-4dd06317>destination-out</option><option value="destination-in" data-v-4dd06317>destination-atop</option><option value="lighter" data-v-4dd06317>lighter</option><option value="xor" data-v-4dd06317>xor</option><option value="multiply" data-v-4dd06317>multiply</option><option value="screen" data-v-4dd06317>screen</option><option value="overlay" data-v-4dd06317>overlay</option><option value="darken" data-v-4dd06317>darken</option><option value="lighten" data-v-4dd06317>lighten</option><option value="color-dodge" data-v-4dd06317>color-dodge</option><option value="color-burn" data-v-4dd06317>color-burn</option><option value="hard-light" data-v-4dd06317>hard-light</option><option value="soft-light" data-v-4dd06317>soft-light</option><option value="difference" data-v-4dd06317>difference</option><option value="exclusion" data-v-4dd06317>exclusion</option><option value="hue" data-v-4dd06317>hue</option><option value="saturation" data-v-4dd06317>saturation</option><option value="color" data-v-4dd06317>color</option><option value="luminosity" data-v-4dd06317>luminosity</option>',23),Je=Object(r["k"])("label",{for:"addEffect"},"Add new effect",-1),Ze={key:0,class:"value-input-table"},Qe=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"shadow_color"},"Color:")],-1),tn=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"filter_x"},"X:")],-1),en=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"filter_y"},"Y:")],-1),nn=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"filter_blur"},"Blur:")],-1),rn=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"filter_value"},"Value:")],-1),on=Object(r["j"])("% "),an={key:0},cn={colspan:"2"},sn=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"filter_value"},"Value:")],-1),un={key:0},ln={colspan:"2"};Object(r["q"])();var dn=Ue((function(t,e,n,o,a,i){var c=Object(r["w"])("color"),s=Object(r["w"])("l"),u=Object(r["w"])("d-flow"),l=Object(r["w"])("slider"),d=Object(r["w"])("d-fieldset");return t.showShadowColor?Object(r["k"])(c,{key:0,modelValue:t.shadowColor,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.shadowColor=e}),format:"rgb",onLeave:e[2]||(e[2]=function(e){return t.showShadowColor=!1})},null,8,["modelValue"]):Object(r["k"])(u,{key:1,"no-wraping":"",class:"image-options-subpanel"},{default:Ue((function(){return[ze,Object(r["k"])("div",qe,[Object(r["k"])("button",{onClick:e[3]||(e[3]=function(e){return t.$emit("leave")})},"Back")]),t.noComposition?Object(r["h"])("",!0):(Object(r["p"])(),Object(r["g"])("div",Ge,[Ye,Object(r["k"])(s,{to:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation#Types"},{default:Ue((function(){return[Ke]})),_:1}),Object(r["D"])(Object(r["k"])("select",{id:"compositionSelect","onUpdate:modelValue":e[4]||(e[4]=function(e){return t.compositionMode=e}),onKeydown:e[5]||(e[5]=Object(r["E"])((function(){}),["stop"]))},[Xe],544),[[r["z"],t.compositionMode]])])),Object(r["k"])(d,{class:"column",title:"Effects",style:{overflow:"hidden"}},{default:Ue((function(){return[Object(r["k"])(u,{class:"filter-flow","no-wraping":"",gap:"8px"},{default:Ue((function(){return[Object(r["k"])(u,{direction:"vertical","no-wraping":""},{default:Ue((function(){return[Je,Object(r["D"])(Object(r["k"])("select",{id:"addEffect","onUpdate:modelValue":e[6]||(e[6]=function(e){return t.addEffectSelection=e}),onKeydown:e[7]||(e[7]=Object(r["E"])((function(){}),["stop"]))},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.filterTypes,(function(e){return Object(r["p"])(),Object(r["g"])("option",{key:e,value:e},Object(r["x"])(t.getFilterLabel(e)),9,["value"])})),128))],544),[[r["z"],t.addEffectSelection]]),Object(r["k"])("button",{disabled:""===t.addEffectSelection,onClick:e[8]||(e[8]=function(){return t.addFilter.apply(t,arguments)}),onKeydown:e[9]||(e[9]=Object(r["E"])((function(){}),["stop"]))}," Add ",40,["disabled"]),Object(r["k"])("button",{disabled:!t.currentFilter,onClick:e[10]||(e[10]=function(){return t.removeFilter.apply(t,arguments)}),onKeydown:e[11]||(e[11]=Object(r["E"])((function(){}),["stop"]))}," Remove ",40,["disabled"]),Object(r["k"])("button",{disabled:0===t.currentFilterIdx,onClick:e[12]||(e[12]=function(e){return t.moveFilter(-1)}),onKeydown:e[13]||(e[13]=Object(r["E"])((function(){}),["stop"]))}," Move up ",40,["disabled"]),Object(r["k"])("button",{disabled:t.currentFilterIdx===t.filters.length-1||0===t.filters.length,onClick:e[14]||(e[14]=function(e){return t.moveFilter(1)}),onKeydown:e[15]||(e[15]=Object(r["E"])((function(){}),["stop"]))}," Move down ",40,["disabled"])]})),_:1}),Object(r["k"])(u,{maxSize:"100%",direction:"vertical","no-wraping":""},{default:Ue((function(){return[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.filters,(function(e,n){return Object(r["p"])(),Object(r["g"])("div",{key:n,class:{choiceBtn:!0,active:n===t.currentFilterIdx},onClick:function(e){return t.selectFilter(n)}},Object(r["x"])(t.getFilterText(e)),11,["onClick"])})),128))]})),_:1}),t.currentFilter?(Object(r["p"])(),Object(r["g"])("table",Ze,["drop-shadow"===t.currentFilter.type?(Object(r["p"])(),Object(r["g"])(r["a"],{key:0},[Object(r["k"])("tr",null,[Qe,Object(r["k"])("td",null,[Object(r["k"])("button",{id:"shadow_color",class:"color-button",style:{background:t.shadowColor},onClick:e[16]||(e[16]=function(e){return t.showShadowColor=!0})},"   ",4)])]),Object(r["k"])("tr",null,[tn,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"filter_x",type:"number","onUpdate:modelValue":e[17]||(e[17]=function(e){return t.shadowX=e}),onKeydown:e[18]||(e[18]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.shadowX,void 0,{number:!0}]])])]),Object(r["k"])("tr",null,[en,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"filter_y",type:"number","onUpdate:modelValue":e[19]||(e[19]=function(e){return t.shadowY=e}),onKeydown:e[20]||(e[20]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.shadowY,void 0,{number:!0}]])])]),Object(r["k"])("tr",null,[nn,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"filter_blur",type:"number","onUpdate:modelValue":e[21]||(e[21]=function(e){return t.shadowBlur=e}),onKeydown:e[22]||(e[22]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.shadowBlur,void 0,{number:!0}]])])])],64)):t.isPercentFilter?(Object(r["p"])(),Object(r["g"])(r["a"],{key:1},[Object(r["k"])("tr",null,[rn,Object(r["k"])("td",null,[Object(r["k"])("input",{id:"filter_value",value:(100*t.currentFilter.value).toFixed(),type:"number",max:t.maxValue,min:t.minValue,onInput:e[23]||(e[23]=function(e){return t.setValue({value:Number(e.target.value/100)})}),onKeydown:e[24]||(e[24]=Object(r["E"])((function(){}),["stop"]))},null,40,["value","max","min"]),on])]),0===t.minValue&&void 0!==t.maxValue?(Object(r["p"])(),Object(r["g"])("tr",an,[Object(r["k"])("td",cn,[Object(r["k"])(l,{gradientStops:["#000000","#ffffff"],label:"",maxValue:t.maxValue,modelValue:100*t.currentFilter.value,"no-input":"","onUpdate:modelValue":e[25]||(e[25]=function(e){return t.setValue({value:Math.round(e)/100})})},null,8,["maxValue","modelValue"])])])):Object(r["h"])("",!0)],64)):(Object(r["p"])(),Object(r["g"])(r["a"],{key:2},[Object(r["k"])("tr",null,[sn,Object(r["k"])("td",null,[Object(r["k"])("input",{id:"filter_value",value:t.currentFilter.value,type:"number",max:t.maxValue,min:t.minValue,onInput:e[26]||(e[26]=function(e){return t.setValue({value:Number(e.target.value)})}),onKeydown:e[27]||(e[27]=Object(r["E"])((function(){}),["stop"]))},null,40,["value","max","min"])])]),0===t.minValue&&void 0!==t.maxValue?(Object(r["p"])(),Object(r["g"])("tr",un,[Object(r["k"])("td",ln,[Object(r["k"])(l,{gradientStops:t.hueStops,label:"",maxValue:t.maxValue,modelValue:t.currentFilter.value,"no-input":"","onUpdate:modelValue":e[28]||(e[28]=function(e){return t.setValue({value:Math.round(e)})})},null,8,["gradientStops","maxValue","modelValue"]),Object(r["k"])(l,{gradientStops:t.hueStops,label:"",maxValue:t.maxValue,modelValue:t.currentFilter.value,"shift-gradient":"","no-input":"",disabled:""},null,8,["gradientStops","maxValue","modelValue"])])])):Object(r["h"])("",!0)],64))])):Object(r["h"])("",!0)]})),_:1})]})),_:1})]})),_:1})})),pn=(n("4ec9"),Object(r["F"])("data-v-f14035dc")),bn=pn((function(t,e,n,o,a,i){return Object(r["p"])(),Object(r["g"])("div",{class:{slider:!0,vertical:t.vertical},onKeydown:e[9]||(e[9]=Object(r["E"])((function(){}),["stop"]))},[t.noInput?Object(r["h"])("",!0):(Object(r["p"])(),Object(r["g"])("label",{key:0,for:t._.uid},Object(r["x"])(t.label),9,["for"])),Object(r["k"])("div",null,[(Object(r["p"])(),Object(r["g"])("svg",{ref:"svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 271 24",onMousedown:e[1]||(e[1]=function(){return t.enterSlide.apply(t,arguments)}),onTouchstart:e[2]||(e[2]=function(){return t.enterSlide.apply(t,arguments)}),onMousemove:e[3]||(e[3]=function(){return t.moveSlide.apply(t,arguments)}),onTouchmove:e[4]||(e[4]=function(){return t.moveSlide.apply(t,arguments)}),onMouseup:e[5]||(e[5]=function(){return t.exitSlide.apply(t,arguments)}),onTouchend:e[6]||(e[6]=function(){return t.exitSlide.apply(t,arguments)})},[Object(r["k"])("defs",null,[Object(r["k"])("linearGradient",{id:"gradient".concat(t._.uid),x1:100*t.gradientOffset+"%",y1:"0%",x2:100*(t.gradientOffset+1)+"%",y2:"0%",spreadMethod:"repeat"},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.gradientStops,(function(e,n){return Object(r["p"])(),Object(r["g"])("stop",{key:n,offset:n/(t.gradientStops.length-1)*100+"%",style:"stop-color:"+e},null,12,["offset"])})),128))],8,["id","x1","x2"])]),Object(r["k"])("g",null,[Object(r["k"])("path",{d:"M7 0H262V24H7z","stroke-width":"2","paint-order":"fill stroke markers",fill:"url(#gradient".concat(t._.uid,")")},null,8,["fill"]),Object(r["k"])("path",{d:t.pointerPath,"stroke-width":"2",class:"slider-pointer"},null,8,["d"])])],544))]),t.noInput?Object(r["h"])("",!0):(Object(r["p"])(),Object(r["g"])("input",{key:1,id:t._.uid,class:"sliderInput",min:"0",max:t.maxValue,value:t.modelValue,type:"number",onInput:e[7]||(e[7]=function(e){return t.$emit("update:modelValue",parseFloat(e.target.value))}),onKeydown:e[8]||(e[8]=Object(r["E"])((function(){}),["stop"]))},null,40,["id","max","value"]))],34)})),hn=255,fn=8,vn=Object(r["m"])({props:{label:{type:String,required:!0},gradientStops:{required:!0},modelValue:{type:Number,required:!0},maxValue:{type:Number,required:!0},shiftGradient:{type:Boolean,default:!1},noInput:{type:Boolean,default:!1}},data:function(){return{slideActive:!1}},computed:{vertical:function(){return this.$store.state.ui.vertical},pointerPath:function(){var t=this.modelValue/this.maxValue*hn;return"M".concat(t," 0L").concat(t+14," 0L").concat(t+7," 12Z")},gradientOffset:function(){return this.shiftGradient?0===this.modelValue?0:this.modelValue/this.maxValue:0}},methods:{enterSlide:function(t){this.slideActive=!0,this.moveSlide(t)},moveSlide:function(t){if(this.slideActive){var e=this.$refs.svg;if(e.contains(t.target)||t.target===e)if(t instanceof MouseEvent&&1!==t.which)this.slideActive=!1;else{var n=e.getBoundingClientRect(),r=n.width/(fn+hn+fn),o=(t instanceof MouseEvent?t.clientX:t.touches[0].clientX)-n.x,a=o/r;t.preventDefault();var i=Math.max(Math.min(a-fn,hn),0)/hn*this.maxValue;this.$emit("update:modelValue",i)}}},exitSlide:function(){this.slideActive=!1}}});n("ae6d");vn.render=bn,vn.__scopeId="data-v-f14035dc";var mn=vn,jn=Object(r["F"])("data-v-8ecc10b2");Object(r["r"])("data-v-8ecc10b2");var gn={class:"column"},On={class:"hex-selector"},kn=Object(r["j"])("Pick color");Object(r["q"])();var yn=jn((function(t,e,n,o,a,i){var c=Object(r["w"])("slider-group"),s=Object(r["w"])("d-button");return Object(r["p"])(),Object(r["g"])("div",{class:{color:!0,vertical:t.vertical}},[Object(r["k"])("h2",null,Object(r["x"])(t.title),1),Object(r["k"])("button",{onClick:e[1]||(e[1]=function(e){return t.$emit("leave")})},"OK"),Object(r["k"])("table",null,[Object(r["k"])("tr",null,[Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[2]||(e[2]=function(e){return t.mode="hsla"})},"HSLA")]),Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[3]||(e[3]=function(e){return t.mode="rgba"})},"RGBA")])])]),Object(r["k"])("div",gn,[Object(r["k"])(c,{mode:t.mode,modelValue:t.color,"onUpdate:modelValue":e[4]||(e[4]=function(e){return t.color=e}),relative:!0},null,8,["mode","modelValue"]),Object(r["k"])("div",On,[Object(r["k"])("label",{class:"hex-label",for:"hex_".concat(t._.uid)},"Hex",8,["for"]),Object(r["k"])("input",{id:"hex_".concat(t._.uid),value:t.color,onInput:e[5]||(e[5]=function(){return t.updateHex.apply(t,arguments)}),onKeydown:e[6]||(e[6]=Object(r["E"])((function(){}),["stop"]))},null,40,["id","value"])]),Object(r["k"])("button",{onClick:e[7]||(e[7]=function(){return t.addSwatch.apply(t,arguments)})},"Add as swatch"),Object(r["k"])(s,{icon:"colorize",onClick:t.pickColor},{default:jn((function(){return[kn]})),_:1},8,["onClick"])]),Object(r["k"])("div",{id:"color-swatches",class:{vertical:t.vertical}},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.swatches,(function(e){return Object(r["p"])(),Object(r["g"])("button",{class:"swatch",key:e.color,style:{backgroundColor:e.color},title:e.label,onClick:function(n){t.color=e.color,t.$emit("leave")}},null,12,["title","onClick"])})),128))],2)],2)})),wn=n("2909"),xn=Object(r["F"])("data-v-24b7dbc3"),Cn=xn((function(t,e,n,o,a,i){var c=Object(r["w"])("slider");return Object(r["p"])(),Object(r["g"])("div",null,[Object(r["k"])(c,{label:t.label1,modelValue:t.v1,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.v1=e}),"max-value":t.maxValue1,"gradient-stops":t.stops1},null,8,["label","modelValue","max-value","gradient-stops"]),Object(r["k"])(c,{label:t.label2,modelValue:t.v2,"onUpdate:modelValue":e[2]||(e[2]=function(e){return t.v2=e}),"max-value":t.maxValue2,"gradient-stops":t.stops2},null,8,["label","modelValue","max-value","gradient-stops"]),Object(r["k"])(c,{label:t.label3,modelValue:t.v3,"onUpdate:modelValue":e[3]||(e[3]=function(e){return t.v3=e}),"max-value":t.maxValue3,"gradient-stops":t.stops3},null,8,["label","modelValue","max-value","gradient-stops"]),Object(r["k"])(c,{label:"Alpha",modelValue:t.a,"onUpdate:modelValue":e[4]||(e[4]=function(e){return t.a=e}),"max-value":255,"gradient-stops":t.stopsAlpha},null,8,["modelValue","gradient-stops"])])})),Sn=(n("25f0"),n("4d90"),n("d4ec")),Rn=n("bee2"),Pn=(n("dca8"),function(){function t(e,n,r,o){Object(Sn["a"])(this,t),this.h=e,this.s=n,this.l=r,this.a=o,Object.freeze(this)}return Object(Rn["a"])(t,[{key:"toCss",value:function(){return this.a>=1?"hsl(".concat(this.h,", ").concat(this.s,", ").concat(this.l,")"):"hsla(".concat(this.h,", ").concat(this.s,", ").concat(this.l,", ").concat(this.a,")")}},{key:"shift",value:function(e){var n=this.h,r=this.s,o=this.l,a=this.a;return n+=e.h,n>=1?n-=1:n<0&&(n+=1),r+e.s>1?r-=e.s:(r+=e.s,r<0&&(r=0)),o+e.l>1||o+e.l<0?o-=e.l:o+=e.l,a+e.a>1||a+e.a<0?a-=e.a:a+=e.a,new t(n,r,o,a)}},{key:"toRgb",value:function(){var t,e,n,r=this.h,o=this.s,a=this.l,i=this.a;if(0===o)t=e=n=a;else{var c=a<.5?a*(1+o):a+o-a*o,s=2*a-c;t=this.hue2rgb(s,c,r+1/3),e=this.hue2rgb(s,c,r),n=this.hue2rgb(s,c,r-1/3)}return new In(Math.round(255*t),Math.round(255*e),Math.round(255*n),i)}},{key:"toHSL",value:function(){return this}},{key:"hue2rgb",value:function(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}}]),t}()),In=function(){function t(e,n,r,o){Object(Sn["a"])(this,t),this.r=e,this.g=n,this.b=r,this.a=o}return Object(Rn["a"])(t,[{key:"toCss",value:function(){return this.a>1?"rgb(".concat(this.r,",").concat(this.g,",").concat(this.b,")"):"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.a,")")}},{key:"toHex",value:function(){return"#".concat(Math.round(this.r).toString(16).padStart(2,"0")).concat(Math.round(this.g).toString(16).padStart(2,"0")).concat(Math.round(this.b).toString(16).padStart(2,"0")).concat(Math.round(255*this.a).toString(16).padStart(2,"0"))}},{key:"toRgb",value:function(){return this}},{key:"toHSL",value:function(){var t=this.r,e=this.g,n=this.b,r=this.a;t/=255,e/=255,n/=255;var o,a,i=Math.max(t,e,n),c=Math.min(t,e,n),s=(i+c)/2;if(i===c)o=a=0;else{var u=i-c;switch(a=s>.5?u/(2-i-c):u/(i+c),i){case t:o=(e-n)/u+(e<n?6:0);break;case e:o=(n-t)/u+2;break;case n:o=(t-e)/u+4;break}o/=6}return new Pn(o,a,s,r)}},{key:"luminance",get:function(){return Math.sqrt(Math.pow(this.r/255*.299,2)+Math.pow(this.g/255*.587,2)+Math.pow(this.b/255*.114,2))}}],[{key:"validCss",value:function(t){return this.validCssRgb(t)||this.validHex(t)}},{key:"fromCss",value:function(t){if(this.validCssRgb(t))return this.fromCssRgb(t);if(this.validHex(t))return this.fromHex(t);throw new Error("Invalid RGB color format")}},{key:"validCssRgb",value:function(t){return this.rgbEx.test(t)||this.rgbaEx.test(t)}},{key:"fromCssRgb",value:function(e){if(!this.validCssRgb(e))throw new Error("Invalid RGB color format");var n=e.slice(0,-1),r=n.indexOf("("),o=n.slice(r+1),a=o.split(",").map((function(t){return parseFloat(t.trim())}));return new t(a[0],a[1],a[2],4===a.length?a[3]:1)}},{key:"validHex",value:function(t){return this.hexShortEx.test(t)||this.hexLongEx.test(t)}},{key:"fromHex",value:function(e){if(!this.validHex(e))throw new Error("Invalid Hex color format");var n=e.slice(1);if(3===n.length)return new t(parseInt(n[0]+n[0],16),parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),1);if(4===n.length)return new t(parseInt(n[0]+n[0],16),parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),parseInt(n[3]+n[3],16)/255);if(6===n.length)return new t(parseInt(n[0]+n[1],16),parseInt(n[2]+n[3],16),parseInt(n[4]+n[5],16),1);if(8===n.length)return new t(parseInt(n[0]+n[1],16),parseInt(n[2]+n[3],16),parseInt(n[4]+n[5],16),parseInt(n[6]+n[7],16)/255);throw new Error("Invalid Hex color format length")}}]),t}();In.rgbEx=/^rgb\((\d*?),(\d*?),(\d*?)\)$/i,In.rgbaEx=/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),([\d.]+)\)$/i,In.hexShortEx=/^#[0-9A-Z]{3,4}$/i,In.hexLongEx=/^#[0-9A-Z]{6,8}$/i;var Tn=Object(r["m"])({components:{Slider:mn},props:{modelValue:{type:String,validator:function(t){return!!t.match(/^#[0-9a-f]{6,8}$/i)}},mode:{type:String},relative:Boolean},data:function(){return{lastRGBEmit:null,v1:0,v2:0,v3:0,a:0}},computed:{vertical:function(){return this.$store.state.ui.vertical},maxValue1:function(){return"rgba"===this.mode?255:360},label1:function(){return"rgba"===this.mode?"Red":"Hue"},stops1:function(){var t=[];if("rgba"===this.mode){var e=this.relative?this.v2:0,n=this.relative?this.v3:0;t=[new In(0,e,n,1),new In(255,e,n,1)]}else{var r=this.relative?this.v2/100:1,o=this.relative?this.v3/100:.5;t=this.eightsStops((function(t){return new Pn(t,r,o,1)}))}return t.map((function(t){return t.toRgb().toCss()}))},maxValue2:function(){return"rgba"===this.mode?255:100},label2:function(){return"rgba"===this.mode?"Green":"Saturation"},stops2:function(){var t=[];if("rgba"===this.mode){var e=this.relative?this.v1:0,n=this.relative?this.v3:0;t=[new In(e,0,n,1),new In(e,255,n,1)]}else{var r=this.relative?this.v1/360:0,o=this.relative?this.v3/100:.5;t=this.eightsStops((function(t){return new Pn(r,t,o,1)}))}return t.map((function(t){return t.toRgb().toCss()}))},maxValue3:function(){return"rgba"===this.mode?255:100},label3:function(){return"rgba"===this.mode?"Blue":"Luminosity"},stops3:function(){var t=[];if("rgba"===this.mode){var e=this.relative?this.v1:0,n=this.relative?this.v2:0;t=[new In(e,n,0,1),new In(e,n,255,1)]}else{var r=this.relative?this.v1/360:0,o=this.relative?this.v2/100:.5;t=this.eightsStops((function(t){return new Pn(r,o,t,1)}))}return t.map((function(t){return t.toRgb().toCss()}))},stopsAlpha:function(){var t=In.fromHex(this.modelValue);return[new In(t.r,t.g,t.b,0).toCss(),new In(t.r,t.g,t.b,1).toCss()]}},created:function(){this.initValues()},methods:{valueChanged:function(){this.modelValue!==this.lastRGBEmit&&this.initValues()},updateValue:function(){var t;t="rgba"===this.mode?new In(this.v1,this.v2,this.v3,this.a/255):new Pn(this.v1/360,this.v2/100,this.v3/100,this.a/255);var e=t.toRgb().toHex();if(this.lastRGBEmit!==e){if(9!==e.length)throw new Error("Invalid color code: ".concat(e));this.lastRGBEmit=e,this.$emit("update:modelValue",e)}},initValues:function(){var t=In.fromHex(this.modelValue);if(this.lastRGBEmit=t.toHex(),this.a=255*t.a,"hsla"===this.mode){var e=t.toHSL();this.v1=360*e.h,this.v2=100*e.s,this.v3=100*e.l}else this.v1=t.r,this.v2=t.g,this.v3=t.b},eightsStops:function(t){for(var e=[],n=0;n<=8;++n)e.push(t(n/8));return e}},watch:{value:function(){this.valueChanged()},v1:function(){this.updateValue()},v2:function(){this.updateValue()},v3:function(){this.updateValue()},a:function(){this.updateValue()},mode:function(){this.initValues()}}});n("02e0");Tn.render=Cn,Tn.__scopeId="data-v-24b7dbc3";var An=Tn,_n=n("0c0f"),$n="dddg.generated.colors",Dn=Object(r["m"])({components:{SliderGroup:An,DButton:kt},inheritAttrs:!1,emits:["leave","update:modelValue"],props:{modelValue:{required:!0,type:String},title:{default:""},format:{type:String,default:"hex"}},data:function(){return{mode:"hsla",relative:!0}},computed:{vertical:function(){return this.$store.state.ui.vertical},swatches:function(){return this.$store.state.content.current.colors},color:{get:function(){if("rgb"===this.format){var t=In.fromCss(this.modelValue);return t.toHex()}return this.modelValue},set:function(t){if("rgb"===this.format){var e=In.fromCss(t);this.$emit("update:modelValue",e.toCss())}else this.$emit("update:modelValue",t)}}},mounted:function(){_n["g"].subscribe(_n["b"],this.settingColor)},unmounted:function(){_n["g"].unsubscribe(_n["b"],this.settingColor)},methods:{settingColor:function(t){this.color=In.fromCss(t.color).toHex()},updateHex:function(t){var e=t.target.value;!In.validHex(e)||7!==e.length&&9!==e.length||(this.color=e)},addSwatch:function(){var t=this;if(!this.swatches.find((function(e){return e.color===t.color}))){var e=this.$store.state.content.contentPacks.find((function(t){return"generatedPackId"===t.packId}))||{packId:$n,packCredits:[""],dependencies:[],characters:[],fonts:[],backgrounds:[],sprites:[],poemStyles:[],poemBackgrounds:[],colors:[]},n=Object(Qt["a"])(Object(Qt["a"])({},e),{},{colors:[].concat(Object(wn["a"])(e.colors),[{label:this.color,color:this.color}])});this.vuexHistory.transaction((function(){t.$store.dispatch("content/replaceContentPack",{contentPack:n,processed:!0})}))}},pickColor:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.commit("ui/setColorPicker",!0)}))}}});n("c185");Dn.render=yn,Dn.__scopeId="data-v-8ecc10b2";var Hn=Dn;function Vn(t){throw new Error('Unexpected value "'.concat(t,'"'))}var En=new Set(["brightness","contrast","grayscale","invert","opacity","saturate","sepia"]);function Bn(t,e,n){var r,o=e(t.id),a=Object(wn["a"])(o.filters);switch(t.type){case"hue-rotate":r={type:t.type,value:0};break;case"sepia":case"invert":case"blur":case"grayscale":case"brightness":case"contrast":case"opacity":case"saturate":r={type:t.type,value:1};break;case"drop-shadow":r={type:t.type,blurRadius:0,offsetX:10,offsetY:10,color:"#555555"};break;default:Vn(t.type)}a.splice(t.idx,0,r),n({id:t.id,filters:a})}function Fn(t,e,n){var r=e(t.id),o=Object(wn["a"])(r.filters);o.splice(t.idx,1),n({id:t.id,filters:o})}function Ln(t,e,n){var r=e(t.id),o=Object(wn["a"])(r.filters),a=o[t.idx];o.splice(t.idx,1),o.splice(t.idx+t.moveBy,0,a),n({id:t.id,filters:o})}function Mn(t,e,n){var r=e(t.id),o=Object(wn["a"])(r.filters),a=Object(Qt["a"])({},o[t.idx]);o[t.idx]=a,"drop-shadow"===a.type?(void 0!==t.blurRadius&&(a.blurRadius=t.blurRadius),void 0!==t.color&&(a.color=t.color),void 0!==t.offsetX&&(a.offsetX=t.offsetX),void 0!==t.offsetY&&(a.offsetY=t.offsetY)):a.value=t.value,n({id:t.id,filters:o})}var Nn=new Map([["blur","Blur"],["brightness","Brightness"],["contrast","Contrast"],["grayscale","Grayscale"],["hue-rotate","Rotate hue"],["invert","Invert colors"],["opacity","Opacity"],["saturate","Saturate"],["sepia","Sepia"],["drop-shadow","Drop shadow"]]),Wn=Array.from(Nn.keys()).sort(),Un=Object(r["m"])({components:{DFlow:ee,DFieldset:Vt["a"],Color:Hn,Slider:mn,L:Q["a"]},props:{type:{type:String,required:!0},title:{type:String},id:{required:!0},noComposition:{type:Boolean,default:!1}},emits:["leave"],data:function(){return{addEffectSelection:"",currentFilterIdx:0,showShadowColor:!1}},computed:{object:function(){switch(this.type){case"object":return this.$store.state.objects.objects[this.id];case"background":return this.$store.state.panels.panels[this.id].background;case"panel":return this.$store.state.panels.panels[this.id];default:return Vn(this.type),null}},compositionMode:{get:function(){return this.object.composite},set:function(t){var e=this;this.vuexHistory.transaction((function(){switch(e.type){case"object":e.$store.commit("objects/setComposition",{id:e.id,composite:t});break;case"background":break;case"panel":break;default:Vn(e.type);break}}))}},filters:function(){return this.object.filters},filterTypes:function(){try{var t=document.createElement("canvas"),e=t.getContext("2d");if("filter"in e)return Wn}catch(n){}return["opacity"]},currentFilter:function(){return this.filters[this.currentFilterIdx]||null},isPercentFilter:function(){var t=this.currentFilter;return!!t&&En.has(t.type)},maxValue:function(){var t=this.currentFilter;if(t)return"hue-rotate"===t.type?360:"grayscale"===t.type||"sepia"===t.type||"opacity"===t.type||"invert"===t.type?100:void 0},minValue:function(){var t=this.currentFilter;if(t)switch(t.type){case"blur":case"brightness":case"contrast":case"grayscale":case"hue-rotate":case"invert":case"opacity":case"saturate":case"sepia":return 0}},shadowColor:{get:function(){var t=this.currentFilter;if(t&&"color"in t)return t.color},set:function(t){this.setValue({color:t})}},shadowX:{get:function(){var t=this.currentFilter;if(t&&"offsetX"in t)return t.offsetX},set:function(t){this.setValue({offsetX:t})}},shadowY:{get:function(){var t=this.currentFilter;if(t&&"offsetY"in t)return t.offsetY},set:function(t){this.setValue({offsetY:t})}},shadowBlur:{get:function(){var t=this.currentFilter;if(t&&"blurRadius"in t)return t.blurRadius},set:function(t){this.setValue({blurRadius:t})}},hueStops:function(){var t=this.eightsStops((function(t){return new Pn(t,1,.5,1)}));return t.map((function(t){return t.toRgb().toCss()}))}},methods:{getFilterLabel:function(t){return Nn.get(t)},getFilterText:function(t){return En.has(t.type)?"".concat(Nn.get(t.type)," ").concat((100*t.value).toFixed(),"%"):"hue-rotate"===t.type?"".concat(Nn.get(t.type)," ").concat(t.value.toFixed(),"°"):"blur"===t.type?"".concat(Nn.get(t.type)," ").concat(t.value.toFixed(),"px"):Nn.get(t.type)},objectTypeScope:function(t){switch(this.type){case"object":return"objects/"+t;case"background":return"panels/background"+t[0].toUpperCase()+t.slice(1);case"panel":return"panels/"+t}},addFilter:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch(t.objectTypeScope("addFilter"),{id:t.id,type:t.addEffectSelection,idx:t.currentFilterIdx+1})}))},selectFilter:function(t){this.currentFilterIdx=t},removeFilter:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch(t.objectTypeScope("removeFilter"),{id:t.id,idx:t.currentFilterIdx})}))},moveFilter:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch(e.objectTypeScope("moveFilter"),{id:e.id,idx:e.currentFilterIdx,moveBy:t}),e.currentFilterIdx+=t}))},setValue:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch(e.objectTypeScope("setFilter"),Object(Qt["a"])({id:e.id,idx:e.currentFilterIdx},t))}))},eightsStops:function(t){for(var e=[],n=0;n<=8;++n)e.push(t(n/8));return e}}});n("80a6");Un.render=dn,Un.__scopeId="data-v-4dd06317";var zn=Un,qn=Object(r["F"])("data-v-7fb63b2e");Object(r["r"])("data-v-7fb63b2e");var Gn={class:"column ok-col"},Yn={class:"column"},Kn={key:0,class:"column error-col"},Xn={class:"column"},Jn=Object(r["k"])("p",{class:"hint-col"},"Apply style to selected text:",-1),Zn={class:"column"},Qn={class:"column"},tr={class:"column"},er=Object(r["i"])('<option value data-v-7fb63b2e>Font</option><option value="aller" style="font-family:aller;" data-v-7fb63b2e>Aller (Textbox)</option><option value="riffic" style="font-family:riffic;" data-v-7fb63b2e>Riffic (Bold text)</option><option value="hashtag" style="font-family:hashtag;" data-v-7fb63b2e>Hashtag (Sayori)</option><option value="ammy_handwriting" style="font-family:ammy_handwriting;" data-v-7fb63b2e>Ammy&#39;s Handwriting (Natsuki)</option><option value="journal" style="font-family:journal;" data-v-7fb63b2e>Journal (Monika)</option><option value="jp_hand_slanted" style="font-family:jp_hand_slanted;" data-v-7fb63b2e>JP Hand Slanted (Yuri)</option><option value="damagrafik_script" style="font-family:damagrafik_script;" data-v-7fb63b2e>Damagrafik (Yuri, Act 2)</option><option value="as_i_lay_dying" style="font-family:as_i_lay_dying;" data-v-7fb63b2e>As I Lay Dying (Yuri, Act Unused)</option><option value="halogen" style="font-family:halogen;" data-v-7fb63b2e>Halogen (MC)</option>',10);Object(r["q"])();var nr=qn((function(t,e,n,o,a,i){var c=Object(r["w"])("color");return t.colorSelector?Object(r["k"])(c,{key:0,modelValue:t.selectedColor,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.selectedColor=e}),onLeave:t.applyColor},null,8,["modelValue","onLeave"]):(Object(r["p"])(),Object(r["g"])("div",{key:1,class:{"text-subpanel":!0,vertical:t.vertical}},[Object(r["k"])("h2",null,Object(r["x"])(t.title),1),Object(r["k"])("div",Gn,[Object(r["k"])("button",{onClick:e[2]||(e[2]=function(e){return t.$emit("leave")})},"OK")]),Object(r["k"])("div",Yn,[Object(r["k"])("textarea",{ref:"textArea",value:t.modelValue,onInput:e[3]||(e[3]=function(){return t.onValueChanged.apply(t,arguments)}),onKeydown:e[4]||(e[4]=Object(r["E"])((function(){}),["stop"])),onKeypress:e[5]||(e[5]=Object(r["E"])((function(){}),["stop"]))},null,40,["value"])]),t.error?(Object(r["p"])(),Object(r["g"])("div",Kn,Object(r["x"])(t.error),1)):Object(r["h"])("",!0),Object(r["k"])("div",Xn,[Object(r["k"])("button",{onClick:e[6]||(e[6]=function(e){return t.insertText("\\\\")}),class:"style-button"},"Insert \\"),Object(r["k"])("button",{onClick:e[7]||(e[7]=function(e){return t.insertText("\\{")}),class:"style-button"},"Insert {"),Object(r["k"])("button",{onClick:e[8]||(e[8]=function(e){return t.insertText("\\}")}),class:"style-button"},"Insert }")]),Jn,Object(r["k"])("div",Zn,[Object(r["k"])("button",{onClick:e[9]||(e[9]=function(e){return t.insertCommand("b")}),class:"style-button",style:{"font-weight":"bold"}}," Bold "),Object(r["k"])("button",{onClick:e[10]||(e[10]=function(e){return t.insertCommand("i")}),class:"style-button",style:{"font-style":"italic"}}," Italics "),Object(r["k"])("button",{onClick:e[11]||(e[11]=function(e){return t.insertCommand("plain")}),class:"style-button"}," Plain "),Object(r["k"])("button",{onClick:e[12]||(e[12]=function(e){return t.insertCommand("edited")}),class:"style-button edited-style"}," Edited "),Object(r["k"])("button",{onClick:e[13]||(e[13]=function(e){return t.insertCommand("k",2)}),class:"style-button",style:{"letter-spacing":"5px"}}," Kerning ")]),Object(r["k"])("div",Qn,[Object(r["k"])("button",{onClick:e[14]||(e[14]=function(e){return t.insertCommand("alpha",.5)}),class:"style-button"}," Alpha ")]),Object(r["k"])("div",tr,[Object(r["k"])("button",{onClick:e[15]||(e[15]=function(e){return t.insertCommand("size",12)}),class:"style-button",style:{"font-size":"20px"}}," Font size "),Object(r["D"])(Object(r["k"])("select",{"onUpdate:modelValue":e[16]||(e[16]=function(e){return t.selectedFont=e}),class:"style-button"},[er],512),[[r["z"],t.selectedFont]]),Object(r["k"])("button",{onClick:e[17]||(e[17]=function(e){return t.selectColor("text")}),class:"style-button"}," Text color "),Object(r["k"])("button",{onClick:e[18]||(e[18]=function(e){return t.selectColor("outline")}),class:"style-button"}," Outline color ")])],2))})),rr=5,or=function(){function t(e){Object(Sn["a"])(this,t),this.str=e,this.i=0}return Object(Rn["a"])(t,[{key:"current",value:function(){return this.str[this.i]}},{key:"next",value:function(){return++this.i,this.current()}},{key:"pos",get:function(){return this.i}},{key:"around",get:function(){return this.str.slice(Math.max(0,this.i-rr),this.i+rr)}},{key:"ahead",get:function(){return this.str[this.i+1]}},{key:"behind",get:function(){return this.str[this.i+1]}}]),t}();function ar(t){var e=[],n=new or(t),r=ir;while(r!==cr)r=r(e,n);return e}function ir(t,e){return void 0===e.current()?cr:"{"===e.current()?lr:"\n"===e.current()?dr:sr}function cr(){return cr}function sr(t,e){var n,r=e.pos,o="",a=!1;while(1){if(void 0===e.current()){n=cr;break}if(a)o+=e.current(),a=!1;else if("\\"===e.current())a=!0;else{if("{"===e.current()||"\n"===e.current()){n=ir;break}o+=e.current()}e.next()}return t.push({type:"text",pos:r,content:o}),n}function ur(t,e){throw new Error("Error at position ".concat(t.pos,": (around: ").concat(t.around,") ").concat(e))}function lr(t,e){var n=e.pos;if("{"!==e.current())throw new Error("Parser error: Command does not start with {");var r="/"===e.next();r&&e.next();var o="",a="",i=!1;while(1){if(void 0===e.current()&&ur(e,"Unexpected end of text inside a command"),"}"===e.current())break;i?a+=e.current():e.current().match(/[a-z]/i)?o+=e.current():"="===e.current()?(r&&ur(e,"Closing commands may not contain arguments"),i=!0):ur(e,"Unexpected character in command name."),e.next()}return e.next(),r?t.push({type:"commandClose",commandName:o,pos:n}):t.push({type:"command",pos:n,argument:a,commandName:o}),ir}function dr(t,e){return t.push({type:"newline",pos:e.pos}),e.next(),ir}var pr=new Map([br("i",(function(t){return Object(Qt["a"])(Object(Qt["a"])({},t),{},{isItalic:!0})})),br("b",(function(t){return Object(Qt["a"])(Object(Qt["a"])({},t),{},{isBold:!0})})),br("u",(function(t){return Object(Qt["a"])(Object(Qt["a"])({},t),{},{isUnderlined:!0})})),br("s",(function(t){return Object(Qt["a"])(Object(Qt["a"])({},t),{},{isStrikethrough:!0})})),br("plain",(function(t){return Object(Qt["a"])(Object(Qt["a"])({},t),{},{isStrikethrough:!1,isUnderlined:!1,isBold:!1,isItalic:!1})})),br("edited",(function(t){return Object(Qt["a"])(Object(Qt["a"])({},t),{},{fontName:"verily",strokeColor:"#000000",strokeWidth:20,letterSpacing:8})})),hr("k",(function(t,e,n){return Object(Qt["a"])(Object(Qt["a"])({},t),{},{letterSpacing:e?t.letterSpacing+n:n})})),hr("size",(function(t,e,n){return Object(Qt["a"])(Object(Qt["a"])({},t),{},{fontSize:e?t.fontSize+n:n})})),hr("alpha",(function(t,e,n){return Object(Qt["a"])(Object(Qt["a"])({},t),{},{alpha:e?t.alpha+n:n})})),hr("stroke",(function(t,e,n){return Object(Qt["a"])(Object(Qt["a"])({},t),{},{strokeWidth:e?t.strokeWidth+n:n})})),["font",function(t,e){return Object(Qt["a"])(Object(Qt["a"])({},t),{},{fontName:e})}],["color",function(t,e){return Object(Qt["a"])(Object(Qt["a"])({},t),{},{color:e})}],["outlinecolor",function(t,e){return Object(Qt["a"])(Object(Qt["a"])({},t),{},{strokeColor:e})}]]);function br(t,e){return[t,function(n,r){if(r)throw new Error("Operator '".concat(t,"' does not take any arguments."));return e(n)}]}function hr(t,e){return[t,function(n,r){if(!r)throw new Error("Operator '".concat(t,"' needs an argument."));var o="+"===r[0]||"-"===r[0],a=Number(r);if(isNaN(a))throw new Error("Operator '".concat(t,"' needs a numeric argument."));return e(n,o,a)}]}var fr=function(){function t(e,n){Object(Sn["a"])(this,t),this.str=e,this.baseStyle=n,this.tokens=ar(e),this.rebuildParts()}return Object(Rn["a"])(t,[{key:"rebuildParts",value:function(){this.renderParts=this.getRenderParts(this.tokens,this.baseStyle)}},{key:"loadFonts",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){var e,n,r,o,a,i,c,s,u,l,d,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("fonts"in document){t.next=2;break}return t.abrupt("return");case 2:e=new Set,n=null,r=Object(bt["a"])(this.renderParts),t.prev=5,r.s();case 7:if((o=r.n()).done){t.next=14;break}if(a=o.value,"style"in a){t.next=11;break}return t.abrupt("continue",12);case 11:a.style!==n&&(n=a.style,n.fontName&&e.add(n.fontName));case 12:t.next=7;break;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](5),r.e(t.t0);case 19:return t.prev=19,r.f(),t.finish(19);case 22:i=!1,c=Object(bt["a"])(e),t.prev=24,c.s();case 26:if((s=c.n()).done){t.next=36;break}if(u=s.value,l=document,d="8px ".concat(u),l.fonts.check(d)){t.next=34;break}return i=!0,t.next=34,l.fonts.load(d);case 34:t.next=26;break;case 36:t.next=41;break;case 38:t.prev=38,t.t1=t["catch"](24),c.e(t.t1);case 41:return t.prev=41,c.f(),t.finish(41);case 44:i&&(p=ar(this.str),this.renderParts=this.getRenderParts(p,this.baseStyle));case 45:case"end":return t.stop()}}),t,this,[[5,16,19,22],[24,38,41,44]])})));function e(){return t.apply(this,arguments)}return e}()},{key:"render",value:function(t){t.save();var e,n=null,r=Object(bt["a"])(this.renderParts);try{for(r.s();!(e=r.n()).done;){var o=e.value;"newline"!==o.type&&(o.style!==n&&(n=o.style,kr(n,t)),n.strokeWidth>0&&n.strokeColor>""&&t.strokeText(o.character,o.x,o.y))}}catch(s){r.e(s)}finally{r.f()}var a,i=Object(bt["a"])(this.renderParts);try{for(i.s();!(a=i.n()).done;){var c=a.value;"newline"!==c.type&&(c.style!==n&&(n=c.style,kr(n,t)),t.fillText(c.character,c.x,c.y))}}catch(s){i.e(s)}finally{i.f()}t.restore()}},{key:"quote",value:function(){var t;(function(t){t[t["None"]=0]="None",t[t["ExplictQuote"]=1]="ExplictQuote",t[t["ImplictQuote"]=2]="ImplictQuote",t[t["Star"]=3]="Star"})(t||(t={}));for(var e=-1,n=t.None,r=0;r<this.renderParts.length;++r){var o=this.renderParts[r];if("character"===o.type)switch(n){case t.None:if(o.character.match(/\s/))continue;'"'===o.character?(n=t.ExplictQuote,e=r):"*"===o.character?(n=t.Star,e=r):(this.renderParts.splice(r,0,{type:"character",x:0,y:0,style:o.style,character:'"',height:o.height,width:jr(o.style,'"')}),r++,e=r,n=t.ImplictQuote);break;case t.ExplictQuote:e=r,'"'===o.character&&(n=t.None);break;case t.ImplictQuote:if(o.character.match(/\s/))continue;"*"===o.character&&(this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:o.style,character:'"',height:o.height,width:jr(o.style,'"')}),n=t.Star,r++),e=r;break;case t.Star:"*"===o.character&&(n=t.None),e=r;break}}var a=this.renderParts[e];a&&n===t.Star&&this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:a.style,character:"*",height:a.height,width:jr(a.style,'"')}),!a||n!==t.ExplictQuote&&n!==t.ImplictQuote||this.renderParts.splice(e+1,0,{type:"character",x:0,y:0,style:a.style,character:'"',height:a.height,width:jr(a.style,'"')})}},{key:"fixAlignment",value:function(t,e,n,r,o){var a=0,i=[];function c(){var r=e;"center"===t?r=e+(n-e)/2-a/2:"right"===t&&(r=n-a);var o,c=Object(bt["a"])(i);try{for(c.s();!(o=c.n()).done;){var s=o.value;s.x=r,r+=s.width}}catch(u){c.e(u)}finally{c.f()}}var s=this.renderParts;o>0&&(s=this.applyLineWrapping(this.renderParts.slice(0),o));var u,l=r,d=[],p=0,b=Object(bt["a"])(s);try{for(b.s();!(u=b.n()).done;){var h=u.value;p=Math.max(p,h.height),"newline"===h.type&&(d.push(p),p=0)}}catch(O){b.e(O)}finally{b.f()}d.push(p);var f,v=0,m=Object(bt["a"])(s);try{for(m.s();!(f=m.n()).done;){var j=f.value;if(p=Math.max(p,j.height),j.y=l,i.push(j),a+=j.width,"newline"===j.type)c(),l+=d[++v]||0,a=0,p=0,i=[];else if("character"===j.type){var g=i[i.length-1];"character"===g.type&&(a+=g.style.letterSpacing,g.width+=g.style.letterSpacing)}}}catch(O){m.e(O)}finally{m.f()}c()}},{key:"getHeight",value:function(t){var e,n=0,r=0,o=0===t?this.renderParts:this.applyLineWrapping(this.renderParts.slice(0),t),a=Object(bt["a"])(o);try{for(a.s();!(e=a.n()).done;){var i=e.value;n=Math.max(n,i.height),"newline"===i.type&&(r+=n,n=0)}}catch(c){a.e(c)}finally{a.f()}return r+=n,r}},{key:"getWidth",value:function(){var t,e=0,n=0,r=null,o=Object(bt["a"])(this.renderParts);try{for(o.s();!(t=o.n()).done;){var a=t.value;e+=a.width,"newline"===a.type?(n=Math.max(n,e),e=0,r=null):"character"===a.type&&(r&&"character"===r.type&&(e+=r.style.letterSpacing),r=a)}}catch(i){o.e(i)}finally{o.f()}return n=Math.max(n,e),n}},{key:"getRenderParts",value:function(e,n){var r,o=[],a=[],i=[],c=Or(n),s=n,u=null,l=Object(bt["a"])(e);try{for(l.s();!(r=l.n()).done;){var d=r.value;switch(d.type){case"command":if(!t.textCommands.has(d.commandName))throw new Error("There is no text command called '".concat(d.commandName,"' at position ").concat(d.pos,"."));a.push(s),i.push(u),s=t.textCommands.get(d.commandName)(s,d.argument),c=Or(s),u=d;break;case"commandClose":if(!u)throw new Error("Unmatched closing command at position ".concat(d.pos,". Closed '").concat(d.commandName,"', but no commands are currently open."));if(d.commandName!==u.commandName)throw new Error("Unmatched closing command at position ".concat(d.pos,". Closed '").concat(d.commandName,"', expected to close '").concat(u,"' first. (Opened at position ").concat(u.pos,")"));u=i.pop(),s=a.pop();break;case"newline":o.push({height:c,width:0,x:0,y:0,type:"newline"});break;case"text":var p,b=Object(bt["a"])(d.content);try{for(b.s();!(p=b.n()).done;){var h=p.value;o.push({type:"character",character:h,height:c,width:jr(s,h),style:s,x:0,y:0})}}catch(f){b.e(f)}finally{b.f()}}}}catch(f){l.e(f)}finally{l.f()}return o}},{key:"applyLineWrapping",value:function(t,e){var n,r=-1,o=0,a=0,i=[],c=Object(bt["a"])(t);try{for(c.s();!(n=c.n()).done;){var s=n.value;if("newline"===s.type)r=-1,o=0,a=0,i.push(s);else if("character"===s.type)if(" "===s.character){if(o>e){r=-1,o=0,a=0,i.push({type:"newline",height:s.height,width:0,x:0,y:0});continue}o+=s.width,a=o,r=i.length,i.push(s)}else o+=s.width,o>e&&-1!==r?(o-=a,i.splice(r,1,{type:"newline",height:s.height,width:0,x:0,y:0}),r=-1,a=0,i.push(s)):i.push(s);else Vn(s)}}catch(u){c.e(u)}finally{c.f()}return i}}]),t}();fr.textCommands=pr;var vr=document.createElement("canvas").getContext("2d"),mr=null;function jr(t,e){return t!==mr&&(kr(t,vr),mr=t),vr.measureText(e).width}var gr=new Map;function Or(t){var e=t.fontSize+" "+t.fontName;if(gr.has(e))return gr.get(e)*t.lineSpacing;var n=document.createElement("span");n.innerHTML="Hg",n.style.fontFamily=t.fontName,n.style.fontSize="".concat(t.fontSize,"px"),n.style.lineHeight="1";var r=document.createElement("div");r.style.opacity="0",r.style.fontFamily=t.fontName,r.style.fontSize="".concat(t.fontSize,"px"),r.style.lineHeight="1",r.style.position="absolute",r.style.top="0",r.style.left="0",r.appendChild(n),document.body.appendChild(r);try{var o=r.offsetHeight;return gr.set(e,o),o*t.lineSpacing}finally{r.remove()}}function kr(t,e){e.textAlign="left",e.font=(t.isItalic?"italic ":"")+(t.isBold?"bold ":"")+t.fontSize+"px "+t.fontName,e.lineJoin="round",t.strokeWidth>0&&t.strokeColor>""?(e.strokeStyle=t.strokeColor,e.lineWidth=t.strokeWidth):(e.strokeStyle="",e.lineWidth=0),e.globalAlpha=t.alpha||0,e.fillStyle=t.color}var yr="#ffa8d2",wr="#552222",xr="#ffeef6",Cr="#bb5599",Sr=new Pn(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),Rr=new Pn(.002028397565922768,0,.13725490196078438,0),Pr=.82,Ir=new Pn(-.004901960784313708,-.8599999999999999,-.16274509803921566,0),Tr=12,Ar=12,_r=1.5,$r=new Pn(.08045977011494243,-.5714285714285714,-.5960784313725489,0),Dr=new Pn(0,-.14285714285714296,.3,0),Hr=new Pn(.004269293924466178,-.01869158878504662,-.039215686274509665,0),Vr=9.5,Er=47,Br=new Pn(.0023347701149424305,0,.10784313725490202,0),Fr=816,Lr=900,Mr=146,Nr=568,Wr=38,Ur=50,zr=39,qr=168,Gr=34,Yr=29,Kr=12,Xr=-126,Jr=-72,Zr=-38,Qr=30.75,to=26,eo=426,no=58,ro={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},oo=Object(Qt["a"])(Object(Qt["a"])({},ro),{},{fontName:"riffic",fontSize:24,strokeColor:Cr,strokeWidth:6,color:"white",letterSpacing:1}),ao={align:"left",font:"13px aller",fill:{style:"#522"}},io=Object(Qt["a"])(Object(Qt["a"])({},ao),{},{fill:{style:"#a66"}}),co=(Te["d"],Te["d"],Nr-zr),so=Object(r["m"])({inheritAttrs:!1,components:{Color:Hn},props:{modelValue:{type:String,required:!0},title:{type:String,default:""}},data:function(){return{colorSelector:"",selectedFont:"",selectedColor:"#000000",rememberedStart:0,rememberedEnd:0,error:""}},computed:{vertical:function(){return this.$store.state.ui.vertical}},watch:{selectedFont:function(){""!==this.selectedFont&&(this.insertCommand("font",this.selectedFont),this.selectedFont="")}},methods:{onValueChanged:function(){var t=this.$refs.textArea.value;try{new fr(t,oo),this.error=""}catch(e){this.error=e.message}this.$emit("update:modelValue",t)},selectColor:function(t){var e=this.$refs.textArea;this.colorSelector=t,this.rememberedStart=e.selectionStart,this.rememberedEnd=e.selectionEnd},applyColor:function(){var t=this,e=this.selectedColor,n=this.colorSelector,r=function r(){var o=t.$refs.textArea;o?(o.selectionStart=t.rememberedStart,o.selectionEnd=t.rememberedEnd,t.insertCommand("text"===n?"color":"outlinecolor",e)):t.$nextTick(r)};this.$nextTick(r),this.selectedColor="#000000",this.colorSelector=""},insertText:function(t){var e=this.$refs.textArea,n=e.value,r=e.selectionStart,o=e.selectionEnd;e.value=n.slice(0,r)+t+n.slice(o),e.selectionStart=e.selectionEnd=r+t.length,e.focus(),this.onValueChanged()},insertCommand:function(t,e){var n=this.$refs.textArea,r=n.value,o=n.selectionStart,a=n.selectionEnd,i=r.slice(o,a),c=r.slice(0,o),s=r.slice(a),u=t;e&&(u+="="+e),n.value="".concat(c,"{").concat(u,"}").concat(i,"{/").concat(t,"}").concat(s),n.selectionStart=o+u.length+2,n.selectionEnd=n.selectionStart+i.length,n.focus(),this.onValueChanged()}}});n("8bf3");so.render=nr,so.__scopeId="data-v-7fb63b2e";var uo=so,lo=oe(),po=Object(r["m"])({mixins:[q],components:{Toggle:U["a"],PositionAndSize:_e,Layers:Le,Delete:We,TextEditor:uo,ImageOptions:zn,Color:Hn,ModalDialog:Z,DFieldset:Vt["a"]},props:{object:{type:Object,required:!0},title:String,textHandler:{type:Object},colorHandler:{type:Object},showAltPanel:Boolean},data:function(){return{imageOptionsOpen:!1,canEdit:!0,modalNameInput:"",showRename:!1,localColorHandler:null}},computed:{flip:lo("flip","objects/setFlip"),rotation:lo("rotation","objects/setRotation"),enlargeWhenTalking:lo("enlargeWhenTalking","objects/setEnlargeWhenTalking"),nameboxWidth:{get:function(){var t=this.object.nameboxWidth;return null===t?"":t+""},set:function(t){var e=this,n=""===t.trim()?null:parseInt(t);this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$store.commit("objects/setObjectNameboxWidth",{id:e.object.id,nameboxWidth:n});case 1:case"end":return t.stop()}}),t)}))))}},zoom:{get:function(){return 100*this.object.zoom},set:function(t){var e=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.$store.commit("objects/setObjectZoom",{id:e.object.id,zoom:t/100});case 1:case"end":return n.stop()}}),n)}))))}},defaultNameboxWidth:function(){return qr},finalColorHandler:function(){return this.localColorHandler||this.colorHandler||null},hasLabel:function(){return null!==this.object.label},heading:function(){return console.log("heading",this.object.label,this.title,"Object"),this.object.label||this.title||"Object"},useCustomTextboxColor:{get:function(){return null!==this.object.textboxColor},set:function(t){var e=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.$store.commit("objects/setTextboxColor",{id:e.object.id,textboxColor:t?yr:null});case 1:case"end":return n.stop()}}),n)}))))}}},methods:{copy:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("objects/copyObjectToClipboard",{id:t.object.id});case 1:case"end":return e.stop()}}),e)}))))},enableNameEdit:function(){this.modalNameInput=this.object.label||"",this.showRename=!0},renameOption:function(t){var e=this;this.showRename=!1,"Apply"===t&&this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$store.commit("objects/setLabel",{id:e.object.id,label:e.modalNameInput});case 1:case"end":return t.stop()}}),t)}))))},selectTextboxColor:function(){var t=this;this.localColorHandler={title:"Textbox color",get:function(){return t.object.textboxColor},set:function(e){t.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.$store.commit("objects/setTextboxColor",{id:t.object.id,textboxColor:e});case 1:case"end":return n.stop()}}),n)}))))},leave:function(){t.localColorHandler=null}}}}});n("2c55"),n("a354");po.render=me,po.__scopeId="data-v-585ac6ce";var bo=po,ho=oe(),fo=Object(r["m"])({mixins:[q],components:{Toggle:U["a"],Parts:re,DFieldset:Vt["a"],ObjectTool:bo},data:function(){return{panelForParts:null}},computed:{flip:ho("flip","objects/setFlip"),closeUp:ho("close","objects/setClose"),selection:function(){return this.$store.state.ui.selection},object:function(){var t=this.$store.state.objects.objects[this.selection];if("character"===t.type)return t},charData:function(){return Object(Ht["e"])(this.$store,this.object)},label:function(){return this.charData.label||""},parts:function(){return Object(Ht["g"])(this.charData,this.object)},hasMultipleStyles:function(){return this.charData.styleGroups[this.object.styleGroupId].styles.length>1||this.charData.styleGroups.length>1},hasMultiplePoses:function(){var t=this.charData.styleGroups[this.object.styleGroupId],e=t.styles[this.object.styleId];return e.poses.length>1}},methods:{seekPose:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/seekPose",{id:e.object.id,delta:t})}))},seekStyle:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("objects/seekStyle",{id:e.object.id,delta:t})}))},seekPart:function(t,e){var n=this;this.vuexHistory.transaction((function(){n.$store.dispatch("objects/seekPart",{id:n.object.id,delta:e,part:t})}))},captialize:function(t){return t.charAt(0).toUpperCase()+t.substring(1)}},watch:{selection:function(){this.panelForParts=null}}});n("dd24");fo.render=Dt,fo.__scopeId="data-v-47403597";var vo=fo;function mo(t,e,n,o,a,i){var c=Object(r["w"])("object-tool");return Object(r["p"])(),Object(r["g"])(c,{object:t.object,title:"Custom Sprite"},null,8,["object"])}var jo=Object(r["m"])({mixins:[q],components:{ObjectTool:bo},computed:{object:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("sprite"===t.type)return t}}});jo.render=mo;var go=jo,Oo=Object(r["F"])("data-v-07f8e3d3");Object(r["r"])("data-v-07f8e3d3");var ko={class:"upper-combos"},yo=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"text_style"},"Style:")],-1),wo={colspan:"2"},xo=Object(r["k"])("option",{value:"normal"},"Normal",-1),Co=Object(r["k"])("option",{value:"corrupt"},"Corrupt",-1),So=Object(r["k"])("option",{value:"custom"},"Custom",-1),Ro=Object(r["k"])("option",{value:"none"},"None",-1),Po=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"current_talking"},"Person talking:")],-1),Io=Object(r["k"])("option",{value:"$null$"},"No-one",-1),To=Object(r["k"])("option",{value:"$other$"},"Other",-1),Ao=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"custom_name"},"Other name:")],-1),_o={id:"dialog_text_wrapper"},$o=Object(r["k"])("label",{for:"dialog_text"},"Dialog:",-1),Do={key:0},Ho=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"custom_namebox_width"},"Namebox width:")],-1),Vo={colspan:"2"},Eo={key:0},Bo=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"textbox_color"},"Color:")],-1),Fo={key:1},Lo={colspan:"2"},Mo=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"custom_controls_color"},"Controls Color:")],-1),No=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"custom_namebox_color"},"Namebox Color:")],-1),Wo=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"custom_namebox_stroke"},"Namebox text stroke:")],-1);Object(r["q"])();var Uo=Oo((function(t,e,n,o,a,i){var c=Object(r["w"])("toggle"),s=Object(r["w"])("d-flow"),u=Object(r["w"])("d-fieldset"),d=Object(r["w"])("object-tool");return Object(r["p"])(),Object(r["g"])(d,{object:t.object,title:"Textbox",textHandler:t.textHandler,colorHandler:t.colorHandler},{default:Oo((function(){return[Object(r["k"])("table",ko,[Object(r["k"])("tr",null,[yo,Object(r["k"])("td",wo,[Object(r["D"])(Object(r["k"])("select",{id:"text_style","onUpdate:modelValue":e[1]||(e[1]=function(e){return t.textBoxStyle=e}),onKeydown:e[2]||(e[2]=Object(r["E"])((function(){}),["stop"]))},[xo,Co,So,Ro],544),[[r["z"],t.textBoxStyle]])])]),Object(r["k"])("tr",null,[Po,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("select",{id:"current_talking","onUpdate:modelValue":e[3]||(e[3]=function(e){return t.talkingObjId=e}),onKeydown:e[4]||(e[4]=Object(r["E"])((function(){}),["stop"]))},[Io,(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.nameList,(function(t){var e=Object(l["a"])(t,2),n=e[0],o=e[1];return Object(r["p"])(),Object(r["g"])("option",{key:n,value:n},Object(r["x"])(o),9,["value"])})),128)),To],544),[[r["z"],t.talkingObjId]])]),Object(r["k"])("td",null,[Object(r["k"])("button",{title:"Jump to talking character",onClick:e[5]||(e[5]=function(){return t.jumpToCharacter.apply(t,arguments)}),disabled:"$null$"===t.talkingObjId||"$other$"===t.talkingObjId}," > ",8,["disabled"])])]),Object(r["k"])("tr",null,[Ao,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"custom_name","onUpdate:modelValue":e[6]||(e[6]=function(e){return t.talkingOther=e}),onKeydown:e[7]||(e[7]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.talkingOther]])]),Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[8]||(e[8]=function(e){return t.textEditor="name"})},"...")])])]),Object(r["k"])(c,{label:"Auto quoting?",modelValue:t.autoQuoting,"onUpdate:modelValue":e[9]||(e[9]=function(e){return t.autoQuoting=e})},null,8,["modelValue"]),Object(r["k"])(c,{label:"Auto line wrap?",modelValue:t.autoWrap,"onUpdate:modelValue":e[10]||(e[10]=function(e){return t.autoWrap=e})},null,8,["modelValue"]),Object(r["k"])("div",_o,[$o,Object(r["D"])(Object(r["k"])("textarea",{"onUpdate:modelValue":e[11]||(e[11]=function(e){return t.dialog=e}),id:"dialog_text",onKeydown:e[12]||(e[12]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.dialog]]),Object(r["k"])("button",{onClick:e[13]||(e[13]=function(e){return t.textEditor="body"})},"Formatting")])]})),options:Oo((function(){return[Object(r["k"])(u,{title:"Customization:",class:"custom"===t.textBoxStyle?"customization-set":""},{default:Oo((function(){return[Object(r["k"])(s,{direction:"vertical",maxSize:"100%","no-wraping":""},{default:Oo((function(){return[Object(r["k"])(c,{label:"Controls visible?",modelValue:t.showControls,"onUpdate:modelValue":e[14]||(e[14]=function(e){return t.showControls=e})},null,8,["modelValue"]),Object(r["k"])(c,{label:"Able to skip?",modelValue:t.allowSkipping,"onUpdate:modelValue":e[15]||(e[15]=function(e){return t.allowSkipping=e})},null,8,["modelValue"]),Object(r["k"])(c,{label:"Continue arrow?",modelValue:t.showContinueArrow,"onUpdate:modelValue":e[16]||(e[16]=function(e){return t.showContinueArrow=e})},null,8,["modelValue"]),"custom"===t.textBoxStyle?(Object(r["p"])(),Object(r["g"])("table",Do,[Object(r["k"])("tr",null,[Ho,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"custom_namebox_width",type:"number",style:{width:"48px"},"onUpdate:modelValue":e[17]||(e[17]=function(e){return t.customNameboxWidth=e}),disabled:t.overrideColor,onKeydown:e[18]||(e[18]=Object(r["E"])((function(){}),["stop"]))},null,40,["disabled"]),[[r["A"],t.customNameboxWidth,void 0,{number:!0}]])])]),Object(r["k"])("tr",null,[Object(r["k"])("td",Vo,[Object(r["k"])(c,{modelValue:t.overrideColor,"onUpdate:modelValue":e[19]||(e[19]=function(e){return t.overrideColor=e}),label:"Override color"},null,8,["modelValue"])])]),t.overrideColor?(Object(r["p"])(),Object(r["g"])("tr",Eo,[Bo,Object(r["k"])("td",null,[Object(r["k"])("button",{id:"textbox_color",class:"color-button",style:{background:t.object.customColor},onClick:e[20]||(e[20]=function(e){return t.colorSelect="base"})},null,4)])])):Object(r["h"])("",!0),t.overrideColor?(Object(r["p"])(),Object(r["g"])("tr",Fo,[Object(r["k"])("td",Lo,[Object(r["k"])(c,{id:"derive_custom_colors",modelValue:t.deriveCustomColors,"onUpdate:modelValue":e[21]||(e[21]=function(e){return t.deriveCustomColors=e}),label:"Derive other colors"},null,8,["modelValue"])])])):Object(r["h"])("",!0),t.overrideColor&&!t.deriveCustomColors?(Object(r["p"])(),Object(r["g"])(r["a"],{key:2},[Object(r["k"])("tr",null,[Mo,Object(r["k"])("td",null,[Object(r["k"])("button",{id:"custom_controls_color",class:"color-button",style:{background:t.object.customControlsColor},onClick:e[22]||(e[22]=function(e){return t.colorSelect="controls"})},null,4)])]),Object(r["k"])("tr",null,[No,Object(r["k"])("td",null,[Object(r["k"])("button",{id:"custom_namebox_color",class:"color-button",style:{background:t.object.customNameboxColor},onClick:e[23]||(e[23]=function(e){return t.colorSelect="namebox"})},null,4)])]),Object(r["k"])("tr",null,[Wo,Object(r["k"])("td",null,[Object(r["k"])("button",{id:"custom_namebox_stroke",class:"color-button",style:{background:t.object.customNameboxStroke},onClick:e[24]||(e[24]=function(e){return t.colorSelect="nameboxStroke"})},null,4)])])],64)):Object(r["h"])("",!0)])):Object(r["h"])("",!0)]})),_:1})]})),_:1},8,["class"]),Object(r["k"])("button",{onClick:e[25]||(e[25]=function(){return t.resetPosition.apply(t,arguments)})},"Reset position"),Object(r["k"])("button",{onClick:e[26]||(e[26]=function(){return t.splitTextbox.apply(t,arguments)})},"Split textbox")]})),_:1},8,["object","textHandler","colorHandler"])})),zo=oe(),qo=Object(r["m"])({components:{Toggle:U["a"],DFieldset:Vt["a"],ObjectTool:bo,DFlow:ee},mixins:[q],data:function(){return{textEditor:"",colorSelect:""}},computed:{object:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("textBox"===t.type)return t},textHandler:function(){var t=this;if(this.textEditor)return{title:this.textEditorName,get:function(){return"name"===t.textEditor?t.object.talkingOther:"body"===t.textEditor?t.dialog:""},set:function(e){"name"===t.textEditor?t.talkingOther=e:"body"===t.textEditor&&(t.dialog=e)},leave:function(){t.textEditor=""}}},colorHandler:function(){var t=this;if(this.colorSelect)return{title:this.colorName,get:function(){switch(t.colorSelect){case"":return"#000000";case"base":return t.object.customColor;case"controls":return t.object.customControlsColor;case"namebox":return t.object.customNameboxColor;case"nameboxStroke":return t.object.customNameboxStroke;default:return Vn(t.colorSelect),""}},set:function(e){t.vuexHistory.transaction((function(){switch(t.colorSelect){case"":return;case"base":return void t.$store.commit("objects/setCustomColor",{id:t.object.id,color:e});case"controls":return void t.$store.commit("objects/setControlsColor",{id:t.object.id,customControlsColor:e});case"namebox":return void t.$store.commit("objects/setNameboxColor",{id:t.object.id,customNameboxColor:e});case"nameboxStroke":return void t.$store.commit("objects/setNameboxStroke",{id:t.object.id,customNameboxStroke:e})}}))},leave:function(){t.colorSelect=""}}},talkingObjId:{get:function(){return this.object.talkingObjId||"$null$"},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("objects/setTalkingObject",{id:e.object.id,talkingObjId:"$null$"===t?null:t})}))}},talkingOther:zo("talkingOther","objects/setTalkingOther"),showControls:zo("controls","objects/setControlsVisible"),allowSkipping:zo("skip","objects/setSkipable"),autoQuoting:zo("autoQuoting","objects/setAutoQuoting"),autoWrap:zo("autoWrap","objects/setAutoWrapping"),showContinueArrow:zo("continue","objects/setContinueArrow"),dialog:zo("text","objects/setText"),textBoxStyle:zo("style","objects/setStyle"),overrideColor:zo("overrideColor","objects/setColorOverride"),deriveCustomColors:zo("deriveCustomColors","objects/setDeriveCustomColors"),customNameboxWidth:zo("customNameboxWidth","objects/setNameboxWidth"),nameList:function(){for(var t=this.$store.state.objects.panels[this.$store.state.panels.currentPanel],e=[],n=0,r=[].concat(Object(wn["a"])(t.order),Object(wn["a"])(t.onTopOrder));n<r.length;n++){var o=r[n],a=this.$store.state.objects.objects[o];null!==a.label&&e.push([o,a.label])}return e},textEditorName:function(){return"name"===this.textEditor?"Name":"body"===this.textEditor?"Dialog":""},customControlsColor:function(){return this.object.customControlsColor},colorName:function(){switch(this.colorSelect){case"":return"";case"base":return"Base color";case"controls":return"Controls color";case"namebox":return"Namebox color";case"nameboxStroke":return"Namebox text stroke";default:return Vn(this.colorSelect),""}}},methods:{splitTextbox:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("objects/splitTextbox",{id:t.object.id})}))},resetPosition:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("objects/resetTextboxBounds",{id:t.object.id})}))},jumpToCharacter:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.commit("ui/setSelection",t.talkingObjId)}))}}});n("dc3c");qo.render=Uo,qo.__scopeId="data-v-07f8e3d3";var Go=qo,Yo=Object(r["F"])("data-v-6218d3d4");Object(r["r"])("data-v-6218d3d4");var Ko=Object(r["k"])("tr",null,[Object(r["k"])("td",{colspan:"2"},[Object(r["k"])("label",{for:"choice-button-input"},"Text")])],-1);Object(r["q"])();var Xo=Yo((function(t,e,n,o,a,i){var c=Object(r["w"])("d-flow"),s=Object(r["w"])("d-fieldset"),u=Object(r["w"])("toggle"),l=Object(r["w"])("object-tool");return Object(r["p"])(),Object(r["g"])(l,{object:t.object,title:"Choice",textHandler:t.textHandler},{default:Yo((function(){return[Object(r["k"])(s,{class:"buttons",title:"Buttons:"},{default:Yo((function(){return[Object(r["k"])(c,{maxSize:"100%",direction:"vertical",noWraping:""},{default:Yo((function(){return[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.buttons,(function(e,n){return Object(r["p"])(),Object(r["g"])("div",{class:{choiceBtn:!0,active:n===t.currentIdx},key:n,onClick:function(e){return t.select(n)}},Object(r["x"])(""===e.text.trim()?"[Empty]":e.text),11,["onClick"])})),128))]})),_:1})]})),_:1}),Object(r["k"])(s,{class:"current_button",title:"Current button:"},{default:Yo((function(){return[Object(r["k"])("table",null,[Ko,Object(r["k"])("tr",null,[Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"choice-button-input","onUpdate:modelValue":e[1]||(e[1]=function(e){return t.buttonText=e}),onKeydown:e[2]||(e[2]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.buttonText]])]),Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[3]||(e[3]=function(e){return t.textEditor=!0})},"...")])])])]})),_:1}),Object(r["k"])("button",{onClick:e[4]||(e[4]=function(){return t.addChoice.apply(t,arguments)})},"Add"),Object(r["k"])("button",{onClick:e[5]||(e[5]=function(){return t.removeChoice.apply(t,arguments)})},"Remove"),Object(r["k"])(u,{label:"Auto line wrap?",modelValue:t.autoWrap,"onUpdate:modelValue":e[6]||(e[6]=function(e){return t.autoWrap=e})},null,8,["modelValue"])]})),_:1},8,["object","textHandler"])})),Jo=oe(),Zo=Object(r["m"])({mixins:[q],components:{Toggle:U["a"],DFieldset:Vt["a"],DFlow:ee,ObjectTool:bo},data:function(){return{currentIdx:0,textEditor:!1}},computed:{object:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("choice"===t.type)return t},autoWrap:Jo("autoWrap","objects/setAutoWrapping"),buttonText:Qo("text","objects/setChoiceText",!0),buttons:function(){return this.object.choices},textHandler:function(){var t=this;if(this.textEditor)return{title:"Text",get:function(){return t.buttonText},set:function(e){t.buttonText=e},leave:function(){t.textEditor=!1}}}},methods:{select:function(t){this.currentIdx=t},addChoice:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("objects/addChoice",{id:t.object.id,text:""})}))},removeChoice:function(){var t=this;this.vuexHistory.transaction((function(){t.currentIdx===t.object.choices.length-1&&t.currentIdx>0&&t.select(t.currentIdx-1),t.$store.dispatch("objects/removeChoice",{id:t.object.id,choiceIdx:t.currentIdx})}))}}});function Qo(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{get:function(){return this.object.choices[this.currentIdx][t]},set:function(r){var o=this;this.vuexHistory.transaction((function(){o.$store[n?"dispatch":"commit"](e,Object(Zt["a"])({id:o.object.id,choiceIdx:o.currentIdx},t,r))}))}}}n("5c35");Zo.render=Xo,Zo.__scopeId="data-v-6218d3d4";var ta=Zo,ea=Object(r["F"])("data-v-753d2b9a");Object(r["r"])("data-v-753d2b9a");var na={class:"panel"},ra=Object(r["k"])("h1",null,"Help and Credits",-1),oa=Object(r["j"])("Help"),aa=Object(r["j"])("Fork me on GitHub"),ia=Object(r["j"])("Privacy Statement"),ca=Object(r["k"])("p",null," All assets used are IP of Team Salvato and created by them, unless noted otherwise. ",-1),sa=Object(r["k"])("p",null,[Object(r["j"])(" Doki Doki Dialog Generator developed by EDave64 "),Object(r["k"])("br"),Object(r["j"])("Based on gemdude46's DDLC Shitpost generator ")],-1),ua=Object(r["j"])(" Unused House Background by "),la=Object(r["j"])(" Fatelogic "),da=Object(r["j"])(" Aller Font by "),pa=Object(r["j"])("Dalton Maag Ltd"),ba=Object(r["j"])(" Riffic Bold Font by "),ha=Object(r["j"])("InkyType"),fa=Object(r["j"])(" Verily Serif Mono Font by "),va=Object(r["j"])("Stephen G. Hartke"),ma=Object(r["j"])(" F25 Bank Printer Font by "),ja=Object(r["j"])("F25 Digital Typeface Design"),ga=Object(r["j"])(" Journal Font by "),Oa=Object(r["j"])("Fontourist"),ka=Object(r["j"])(" Hashtag Font by "),ya=Object(r["j"])(" TitanVex"),wa=Object(r["j"])(" JP Hand Slanted Font by "),xa=Object(r["j"])("Jonathan Paterson"),Ca=Object(r["j"])(" As I Lay Dying Font by "),Sa=Object(r["j"])("Moises Esqueda"),Ra=Object(r["j"])(" Damagrafik Script Font by "),Pa=Object(r["j"])("Davide Terenzi"),Ia=Object(r["j"])(" Ammy's Handwriting Font by "),Ta=Object(r["j"])("Ammy K."),Aa=Object(r["j"])(" Halogen Font by "),_a=Object(r["j"])("JLH Fonts"),$a=Object(r["i"])("<p data-v-753d2b9a> MC Classic Sprite by Childish-N <br data-v-753d2b9a>MC Classic Chibi by GyleToTheRescue </p><p data-v-753d2b9a> MC Sprite by Childish-N <br data-v-753d2b9a>MC Casual Sprite by SlightlySimple <br data-v-753d2b9a>MC Chibi by SlightlySimple </p><p data-v-753d2b9a> MC Chad Sprite by Cylent-Nite <br data-v-753d2b9a>MC Chad Poses and expressions by SlightlySimple <br data-v-753d2b9a>MC Chad Poses and chibi by Meddy-sin </p><p data-v-753d2b9a> FeMC Sprite by Meddy-sin <br data-v-753d2b9a>FeMC Casual Sprite by SlightlySimple </p><p data-v-753d2b9a>Classic Amy Sprite by Meddy-sin</p><p data-v-753d2b9a>Amy Sprite by Meddy-sin and SlightlySimple</p><p data-v-753d2b9a>Special thanks to SlightlySimple for testing and technical help</p><p data-v-753d2b9a> Atlas421, T-Rex Harris, smearglexd and Tactical Cupcakes for suggestions and testing </p>",8);Object(r["q"])();var Da=ea((function(t,e,n,o,a,i){var c=Object(r["w"])("l");return Object(r["p"])(),Object(r["g"])("div",na,[ra,Object(r["k"])(c,{class:"btn",to:"wiki://Dokumentation"},{default:ea((function(){return[oa]})),_:1}),Object(r["k"])(c,{class:"btn",to:"github://"},{default:ea((function(){return[aa]})),_:1}),Object(r["k"])(c,{class:"btn",to:"wiki://Privacy Statement"},{default:ea((function(){return[ia]})),_:1}),ca,sa,Object(r["k"])("p",null,[ua,Object(r["k"])(c,{to:"https://www.deviantart.com/fatelogic/art/VN-Background-Practice-295671161"},{default:ea((function(){return[la]})),_:1})]),Object(r["k"])("p",null,[da,Object(r["k"])(c,{to:"https://www.daltonmaag.com/library/aller"},{default:ea((function(){return[pa]})),_:1})]),Object(r["k"])("p",null,[ba,Object(r["k"])(c,{to:"https://www.fontspring.com/fonts/inky-type/riffic"},{default:ea((function(){return[ha]})),_:1})]),Object(r["k"])("p",null,[fa,Object(r["k"])(c,{to:"https://www.dafont.com/verily-serif-mono.font"},{default:ea((function(){return[va]})),_:1})]),Object(r["k"])("p",null,[ma,Object(r["k"])(c,{to:"https://www.dafont.com/f25-bank-printer.font"},{default:ea((function(){return[ja]})),_:1})]),Object(r["k"])("p",null,[ga,Object(r["k"])(c,{to:"https://www.dafont.com/journal.font"},{default:ea((function(){return[Oa]})),_:1})]),Object(r["k"])("p",null,[ka,Object(r["k"])(c,{to:"https://www.dafont.com/hashtag.font"},{default:ea((function(){return[ya]})),_:1})]),Object(r["k"])("p",null,[wa,Object(r["k"])(c,{to:"https://www.dafont.com/jp-hand-slanted.font"},{default:ea((function(){return[xa]})),_:1})]),Object(r["k"])("p",null,[Ca,Object(r["k"])(c,{to:"https://www.dafont.com/as-i-lay-dying.font"},{default:ea((function(){return[Sa]})),_:1})]),Object(r["k"])("p",null,[Ra,Object(r["k"])(c,{to:"https://www.dafont.com/damagrafik-script.font"},{default:ea((function(){return[Pa]})),_:1})]),Object(r["k"])("p",null,[Ia,Object(r["k"])(c,{to:"https://www.dafont.com/ammys-handwriting.font"},{default:ea((function(){return[Ta]})),_:1})]),Object(r["k"])("p",null,[Aa,Object(r["k"])(c,{to:"https://www.dafont.com/halogen.font"},{default:ea((function(){return[_a]})),_:1})]),$a])})),Ha=Object(r["m"])({mixins:[q],components:{L:Q["a"]}});n("6a18");Ha.render=Da,Ha.__scopeId="data-v-753d2b9a";var Va=Ha,Ea=Object(r["F"])("data-v-4594b0c3");Object(r["r"])("data-v-4594b0c3");var Ba=Object(r["j"])("Drop here to add as a new background"),Fa=Object(r["k"])("h1",null,"Background",-1),La=Object(r["j"])(" Upload "),Ma=Object(r["k"])("i",{class:"material-icons"},"extension",-1),Na=Object(r["j"])(" Search in content packs ");Object(r["q"])();var Wa=Ea((function(t,e,n,o,a,i){var c=Object(r["w"])("drop-target"),s=Object(r["w"])("color"),u=Object(r["w"])("image-options"),l=Object(r["w"])("background-settings"),d=Object(r["w"])("background-button");return Object(r["p"])(),Object(r["g"])("div",{class:"panel",onDragenter:e[10]||(e[10]=function(){return t.dragEnter.apply(t,arguments)}),onMouseleave:e[11]||(e[11]=function(e){return t.$refs.dt.hide()})},[Object(r["k"])(c,{ref:"dt",class:"drop-target",onDrop:t.addImageFile},{default:Ea((function(){return[Ba]})),_:1},8,["onDrop"]),Fa,t.colorSelect?Object(r["k"])(s,{key:0,modelValue:t.bgColor,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.bgColor=e}),onLeave:e[2]||(e[2]=function(e){return t.colorSelect=!1})},null,8,["modelValue"]):t.imageOptions?Object(r["k"])(u,{key:1,type:"background",title:"",id:t.$store.state.panels.currentPanel,"no-composition":"",onLeave:e[3]||(e[3]=function(e){return t.imageOptions=!1})},null,8,["id"]):(Object(r["p"])(),Object(r["g"])(r["a"],{key:2},[Object(r["k"])(l,{"onChange-color":e[4]||(e[4]=function(e){return t.colorSelect=!0}),"onOpen-image-options":e[5]||(e[5]=function(e){return t.imageOptions=!0})}),Object(r["k"])("div",{class:"btn upload-background",onClick:e[7]||(e[7]=function(e){return t.$refs.upload.click()})},[La,Object(r["k"])("input",{type:"file",ref:"upload",onChange:e[6]||(e[6]=function(){return t.onFileUpload.apply(t,arguments)})},null,544)]),Object(r["k"])("button",{class:"upload-background",onClick:e[8]||(e[8]=function(){return t.addByUrl.apply(t,arguments)})},"Add by URL"),Object(r["k"])("button",{class:"upload-background",title:"Not yet implemented",onClick:e[9]||(e[9]=function(e){return t.$emit("show-dialog","type: Backgrounds")})},[Ma,Na]),(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.backgrounds,(function(e){return Object(r["p"])(),Object(r["g"])(d,{key:e,backgroundId:e,onInput:function(n){return t.setBackground(e)}},null,8,["backgroundId","onInput"])})),128))],64))],32)})),Ua=Object(r["F"])("data-v-09138076"),za=Ua((function(t,e,n,o,a,i){return Object(r["p"])(),Object(r["g"])("div",{class:{background:!0,active:t.isActive},title:t.title,style:t.style,onClick:e[1]||(e[1]=function(e){return t.$emit("input",t.backgroundId)})},Object(r["x"])(t.title),15,["title"])})),qa=Object(r["m"])({props:{backgroundId:{type:String,required:!0}},data:function(){return{isWebPSupported:null,assets:[]}},computed:{background:function(){var t=this.$store.state.panels.currentPanel;return this.$store.state.panels.panels[t].background},bgData:function(){var t=this.$store.getters["content/getBackgrounds"];return t.get(this.backgroundId)||null},isActive:function(){return this.backgroundId===this.background.current},title:function(){switch(this.backgroundId){case"buildin.static-color":return"Static color";case"buildin.transparent":return"Transparent"}return this.bgData.label||""},style:function(){switch(this.backgroundId){case"buildin.static-color":return{"background-color":this.background.color};case"buildin.transparent":return{}}var t=this.assets.filter((function(t){return t instanceof HTMLImageElement})).map((function(t){return"url('".concat(t.src,"')")})).join(",");return{backgroundImage:t}}},created:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.bgData){e.next=4;break}return e.next=3,Promise.all(t.bgData.variants[0].map((function(t){return Object(ht["a"])(t,!1)})));case 3:t.assets=e.sent;case 4:case"end":return e.stop()}}),e)})))()}});n("6f08");qa.render=za,qa.__scopeId="data-v-09138076";var Ga=qa,Ya=Object(r["F"])("data-v-99a6545a");Object(r["r"])("data-v-99a6545a");var Ka=Object(r["k"])("label",{for:"bg_color"},"Color:",-1),Xa={key:1},Ja={colspan:"3"},Za={key:0},Qa={class:"arrow-col"},ti=Object(r["k"])("td",{style:{"text-align":"center"}},"Variant",-1),ei={class:"arrow-col"},ni={colspan:"3"},ri=Object(r["k"])("option",{value:"0"},"None",-1),oi=Object(r["k"])("option",{value:"1"},"Stretch",-1),ai=Object(r["k"])("option",{value:"2"},"Cover",-1),ii={colspan:"3"};Object(r["q"])();var ci=Ya((function(t,e,n,o,a,i){var c=Object(r["w"])("toggle"),s=Object(r["w"])("d-fieldset");return Object(r["p"])(),Object(r["g"])(s,{class:{"bg-settings":!0,vertical:t.vertical},title:"Settings:"},{default:Ya((function(){return[t.isColor?(Object(r["p"])(),Object(r["g"])(r["a"],{key:0},[Ka,Object(r["k"])("button",{id:"bg_color",class:"color-button",style:{background:t.color},onClick:e[1]||(e[1]=function(e){return t.$emit("change-color")})},null,4)],64)):Object(r["h"])("",!0),t.isVariant?(Object(r["p"])(),Object(r["g"])("table",Xa,[Object(r["k"])("tr",null,[Object(r["k"])("td",Ja,[Object(r["k"])(c,{modelValue:t.flipped,"onUpdate:modelValue":e[2]||(e[2]=function(e){return t.flipped=e}),label:"Flipped?"},null,8,["modelValue"])])]),t.hasVariants?(Object(r["p"])(),Object(r["g"])("tr",Za,[Object(r["k"])("td",Qa,[Object(r["k"])("button",{class:"small-button",onClick:e[3]||(e[3]=function(e){return t.seekVariant(-1)})},"<")]),ti,Object(r["k"])("td",ei,[Object(r["k"])("button",{class:"small-button",onClick:e[4]||(e[4]=function(e){return t.seekVariant(1)})},">")])])):Object(r["h"])("",!0),Object(r["k"])("tr",null,[Object(r["k"])("td",ni,[Object(r["D"])(Object(r["k"])("select",{"onUpdate:modelValue":e[5]||(e[5]=function(e){return t.scaling=e}),onKeydown:e[6]||(e[6]=Object(r["E"])((function(){}),["stop"]))},[ri,oi,ai],544),[[r["z"],t.scaling]])])]),Object(r["k"])("tr",null,[Object(r["k"])("td",ii,[Object(r["k"])("button",{id:"image_options_button",onClick:e[7]||(e[7]=function(e){return t.$emit("open-image-options")})}," Image options ")])])])):Object(r["h"])("",!0)]})),_:1},8,["class"])})),si=Object(r["m"])({components:{Toggle:U["a"],DFieldset:Vt["a"]},computed:{vertical:function(){return this.$store.state.ui.vertical},color:{get:function(){return this.background.color},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("panels/setBackgroundColor",{color:t,panelId:e.$store.state.panels.currentPanel})}))}},flipped:{get:function(){return this.background.flipped},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("panels/setBackgroundFlipped",{flipped:t,panelId:e.$store.state.panels.currentPanel})}))}},scaling:{get:function(){return this.background.scaling.toString()},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("panels/setBackgroundScaling",{scaling:parseInt(t,10),panelId:e.$store.state.panels.currentPanel})}))}},currentBackgroundId:function(){return this.background.current},background:function(){var t=this.$store.state.panels.currentPanel;return this.$store.state.panels.panels[t].background},bgData:function(){var t=this;return this.$store.state.content.current.backgrounds.find((function(e){return e.id===t.currentBackgroundId}))||null},isColor:function(){return"buildin.static-color"===this.currentBackgroundId},isVariant:function(){return!!this.bgData},hasVariants:function(){return!!this.bgData&&this.bgData.variants.length>1}},methods:{seekVariant:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.dispatch("panels/seekBackgroundVariant",{delta:t,panelId:e.$store.state.panels.currentPanel})}))}}});n("5b30");si.render=ci,si.__scopeId="data-v-99a6545a";var ui=si,li={packId:"dddg.buildin.uploadedBackgrounds",dependencies:[],packCredits:[],characters:[],fonts:[],sprites:[],poemStyles:[],poemBackgrounds:[],backgrounds:[],colors:[]},di=Object(r["m"])({mixins:[q],components:{BackgroundButton:Ga,BackgroundSettings:ui,DropTarget:ft["a"],Color:Hn,ImageOptions:zn},data:function(){return{colorSelect:!1,imageOptions:!1}},computed:{bgColor:{get:function(){return this.$store.state.panels.panels[this.$store.state.panels.currentPanel].background.color},set:function(t){var e=this;this.vuexHistory.transaction((function(){e.$store.commit("panels/setBackgroundColor",{color:t,panelId:e.$store.state.panels.currentPanel})}))}},backgrounds:function(){return[].concat(Object(wn["a"])(this.$store.state.content.current.backgrounds.map((function(t){return t.id}))),["buildin.static-color","buildin.transparent"])}},methods:{setBackground:function(t){this.$store.commit("panels/setCurrentBackground",{current:t,panelId:this.$store.state.panels.currentPanel})},onFileUpload:function(t){var e=this.$refs.upload;if(e.files){var n,r=Object(bt["a"])(e.files);try{for(r.s();!(n=r.n()).done;){var o=n.value;this.addImageFile(o)}}catch(a){r.e(a)}finally{r.f()}}},addImageFile:function(t){var e=URL.createObjectURL(t);this.addNewCustomBackground(t.name,t.name,e)},addByUrl:function(){var t=prompt("Enter the URL of the image");if(t){var e=t.split("/").slice(-1)[0];this.addNewCustomBackground(e,e,t)}},addNewCustomBackground:function(t,e,n){var r=this;li.backgrounds.push({id:t,label:e,variants:[[n]]}),this.vuexHistory.transaction((function(){r.$store.dispatch("content/replaceContentPack",{contentPack:li}),r.setBackground(t)}))},dragEnter:function(t){t.dataTransfer&&(t.dataTransfer.effectAllowed="none",Array.from(t.dataTransfer.items).find((function(t){return t.type.match(/^image.*$/)}))&&(t.dataTransfer.effectAllowed="link",this.$refs.dt.show()))}}});n("1b86");di.render=Wa,di.__scopeId="data-v-4594b0c3";var pi=di,bi=Object(r["F"])("data-v-cf19b12c");Object(r["r"])("data-v-cf19b12c");var hi={class:"panel"},fi=Object(r["k"])("h1",null,"Content Packs",-1),vi={class:"list"},mi=Object(r["k"])("label",{for:"pack_name"},"Name:",-1),ji=Object(r["k"])("label",{for:"pack_credits"},"Credits:",-1),gi={key:4},Oi=Object(r["j"])(" The tool need restart for changes to take effect. ");Object(r["q"])();var ki=bi((function(t,e,n,o,a,i){var c=Object(r["w"])("d-fieldset");return Object(r["p"])(),Object(r["g"])("div",hi,[fi,Object(r["k"])("button",{onClick:e[1]||(e[1]=function(){return t.addNew.apply(t,arguments)})},"Add new Pack"),Object(r["k"])(c,{title:"Installed Packs:"},{default:bi((function(){return[Object(r["k"])("div",vi,[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.packs,(function(e){return Object(r["p"])(),Object(r["g"])("div",{class:{active:e.name===t.name},key:e.name,onClick:function(n){return t.select(e.name)}},Object(r["x"])(e.name),11,["onClick"])})),128))])]})),_:1}),mi,Object(r["k"])("input",{id:"pack_name",value:t.name,readonly:""},null,8,["value"]),ji,Object(r["k"])("div",{id:"pack_credits",innerHTML:t.credits},null,8,["innerHTML"]),t.activatable?(Object(r["p"])(),Object(r["g"])("button",{key:0,onClick:e[2]||(e[2]=function(){return t.activate.apply(t,arguments)})},"Activate")):Object(r["h"])("",!0),t.deactivatable?(Object(r["p"])(),Object(r["g"])("button",{key:1,onClick:e[3]||(e[3]=function(){return t.deactivate.apply(t,arguments)})},"Deactivate")):Object(r["h"])("",!0),t.installable?(Object(r["p"])(),Object(r["g"])("button",{key:2,onClick:e[4]||(e[4]=function(){return t.install.apply(t,arguments)})},"Install")):Object(r["h"])("",!0),t.uninstallable?(Object(r["p"])(),Object(r["g"])("button",{key:3,onClick:e[5]||(e[5]=function(){return t.uninstall.apply(t,arguments)})},"Uninstall")):Object(r["h"])("",!0),t.needRestart?(Object(r["p"])(),Object(r["g"])("div",gi,[Oi,Object(r["k"])("button",{onClick:e[6]||(e[6]=function(){return t.restart.apply(t,arguments)})},"Restart Now")])):Object(r["h"])("",!0)])})),yi=(n("2ca0"),Object(r["m"])({mixins:[q],components:{DFieldset:Vt["a"]},data:function(){return{selectedPack:null,needRestart:!1}},computed:{packs:function(){var t=this.$store.state.content.contentPacks;return t.filter((function(t){return t.packId&&!t.packId.startsWith("dddg.buildin.")})).map((function(t){return{name:t.packId,credits:t.packCredits,installed:!0,active:!0,queuedUninstall:!1,freshInstall:!1,url:""}}))},name:function(){return this.selectedPack?this.selectedPack.name:""},credits:function(){return this.selectedPack?this.selectedPack.credits:[""]},activatable:function(){return!!G["a"].supports.autoLoading&&(!!this.selectedPack&&(!!this.selectedPack.installed&&(!this.selectedPack.queuedUninstall&&(!this.selectedPack.freshInstall&&!this.selectedPack.active))))},deactivatable:function(){return!!G["a"].supports.autoLoading&&(!!this.selectedPack&&(!!this.selectedPack.installed&&(!this.selectedPack.queuedUninstall&&(!this.selectedPack.freshInstall&&this.selectedPack.active))))},installable:function(){return!!G["a"].supports.autoLoading&&(!!this.selectedPack&&(this.selectedPack.queuedUninstall||!this.selectedPack.installed))},uninstallable:function(){return!!G["a"].supports.autoLoading&&(!!this.selectedPack&&(!this.selectedPack.freshInstall&&!(this.selectedPack.queuedUninstall||!this.selectedPack.installed)))}},methods:{select:function(t){this.selectedPack=this.packs.find((function(e){return e.name===t}))||null},addNew:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,G["a"].prompt("Enter the URL of the character pack:");case 2:if(n=e.sent,n){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,t.$store.dispatch("content/loadContentPacks",n);case 7:case"end":return e.stop()}}),e)})))()},restart:function(){location.reload(!0)},install:function(){this.selectedPack&&(G["a"].localRepoInstall(this.selectedPack.url),this.selectedPack.queuedUninstall?this.selectedPack.queuedUninstall=!1:this.selectedPack.installed=!0)},uninstall:function(){this.selectedPack&&(G["a"].localRepoUninstall(this.selectedPack.url),this.selectedPack.queuedUninstall=!0,this.needRestart=!0)},activate:function(){this.selectedPack&&(G["a"].autoLoadAdd(this.selectedPack.url),this.selectedPack.active=!0,this.needRestart=!0)},deactivate:function(){this.selectedPack&&(G["a"].autoLoadRemove(this.selectedPack.url),this.selectedPack.active=!1,this.needRestart=!0)}}}));n("2c10");yi.render=ki,yi.__scopeId="data-v-cf19b12c";var wi=yi,xi=Object(r["F"])("data-v-2ffec108");Object(r["r"])("data-v-2ffec108");var Ci={class:"panel"},Si=Object(r["k"])("h1",null,"Panels",-1),Ri={class:"panel_text"},Pi={class:"panel_nr"},Ii={class:"column"},Ti=Object(r["j"])(" Add new "),Ai=Object(r["j"])(" Delete panel "),_i=Object(r["j"])(" Move ahead "),$i=Object(r["j"])(" Move behind "),Di=Object(r["j"])(" Image options "),Hi=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"export_format"},"Format")],-1),Vi=Object(r["k"])("option",{value:"image/png"},"PNG (lossless)",-1),Ei={key:0,value:"image/webp"},Bi={key:1,value:"image/heif"},Fi=Object(r["k"])("option",{value:"image/jpeg"},"JPEG (lossy)",-1),Li={key:0},Mi=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"export_quality"},"Quality:")],-1),Ni=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"export_ppi"},[Object(r["j"])(" Panels per image: "),Object(r["k"])("br"),Object(r["k"])("small",null,"(0 for one single image)")])],-1),Wi=Object(r["k"])("td",null,[Object(r["k"])("label",{for:"export_pages"},[Object(r["j"])(" Panels to export: "),Object(r["k"])("br"),Object(r["k"])("small",null,"(Leave empty for all)")])],-1),Ui=Object(r["j"])(" Download ");Object(r["q"])();var zi,qi=xi((function(t,e,n,o,a,i){var c=Object(r["w"])("image-options"),s=Object(r["w"])("d-flow"),u=Object(r["w"])("d-fieldset"),l=Object(r["w"])("d-button");return Object(r["p"])(),Object(r["g"])("div",Ci,[Si,t.imageOptions?Object(r["k"])(c,{key:0,type:"panel",title:"",id:t.currentPanel,"no-composition":"",onLeave:e[1]||(e[1]=function(e){t.imageOptions=!1,t.renderThumbnail()})},null,8,["id"]):(Object(r["p"])(),Object(r["g"])(r["a"],{key:1},[Object(r["k"])(u,{class:"existing_panels_fieldset",title:"Existing Panels"},{default:xi((function(){return[Object(r["k"])(s,{"no-wraping":"",maxSize:"350px"},{default:xi((function(){return[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.panelButtons,(function(e,n){return Object(r["p"])(),Object(r["g"])("div",{key:e.id,class:{panel_button:!0,active:e.id===t.currentPanel},style:"background-image: url('".concat(e.image,"')"),onClick:function(n){return t.updateCurrentPanel(e.id)}},[Object(r["k"])("div",Ri,[Object(r["k"])("p",null,Object(r["x"])(e.text),1)]),Object(r["k"])("div",Pi,Object(r["x"])(n+1),1)],14,["onClick"])})),128))]})),_:1})]})),_:1}),Object(r["k"])("div",Ii,[Object(r["k"])(l,{icon:"add_to_queue",onClick:t.addNewPanel},{default:xi((function(){return[Ti]})),_:1},8,["onClick"]),Object(r["k"])(l,{icon:"remove_from_queue",onClick:t.deletePanel,disabled:!t.canDeletePanel},{default:xi((function(){return[Ai]})),_:1},8,["onClick","disabled"]),Object(r["k"])(l,{icon:"arrow_upward",onClick:t.moveAhead,disabled:!t.canMoveAhead},{default:xi((function(){return[_i]})),_:1},8,["onClick","disabled"]),Object(r["k"])(l,{icon:"arrow_downward",onClick:t.moveBehind,disabled:!t.canMoveBehind},{default:xi((function(){return[$i]})),_:1},8,["onClick","disabled"]),Object(r["k"])(l,{icon:"color_lens",onClick:e[2]||(e[2]=function(e){return t.imageOptions=!0})},{default:xi((function(){return[Di]})),_:1})]),Object(r["k"])(u,{title:"Export"},{default:xi((function(){return[Object(r["k"])("table",null,[Object(r["k"])("tr",null,[Hi,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("select",{id:"export_format","onUpdate:modelValue":e[3]||(e[3]=function(e){return t.format=e})},[Vi,t.webpSupport?(Object(r["p"])(),Object(r["g"])("option",Ei,"WebP (lossy)")):Object(r["h"])("",!0),t.heifSupport?(Object(r["p"])(),Object(r["g"])("option",Bi,"HEIF (lossy)")):Object(r["h"])("",!0),Fi],512),[[r["z"],t.format]])])]),t.isLossy?(Object(r["p"])(),Object(r["g"])("tr",Li,[Mi,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"export_quality",type:"number",min:"0",max:"100","onUpdate:modelValue":e[4]||(e[4]=function(e){return t.quality=e}),onKeydown:e[5]||(e[5]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.quality,void 0,{number:!0}]])])])):Object(r["h"])("",!0),Object(r["k"])("tr",null,[Ni,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"export_ppi",type:"number",min:"0","onUpdate:modelValue":e[6]||(e[6]=function(e){return t.ppi=e}),onKeydown:e[7]||(e[7]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.ppi,void 0,{number:!0}]])])]),Object(r["k"])("tr",null,[Wi,Object(r["k"])("td",null,[Object(r["D"])(Object(r["k"])("input",{id:"export_pages","onUpdate:modelValue":e[8]||(e[8]=function(e){return t.pages=e}),placeholder:"E.g. 1-5, 8, 11-13"},null,512),[[r["A"],t.pages]])])]),Object(r["k"])("tr",null,[Object(r["k"])("td",null,[Object(r["k"])(l,{icon:"photo_camera",onClick:t.download},{default:xi((function(){return[Ui]})),_:1},8,["onClick"])]),Object(r["k"])("td",null,[Object(r["k"])("button",{onClick:e[9]||(e[9]=function(){return t.estimateExportSize.apply(t,arguments)})},"Estimate filesizes")])])])]})),_:1})],64))])})),Gi=(n("13d5"),n("caad"),n("2532"),n("53ca")),Yi=n("c837");(function(t){t[t["None"]=0]="None",t[t["Stretch"]=1]="Stretch",t[t["Cover"]=2]="Cover"})(zi||(zi={}));var Ki="buildin.transparent",Xi=0,Ji={panelToUrl:new Map,urlToPanel:new Map,register:function(t,e){if(this.panelToUrl.has(t)){if(this.panelToUrl.get(t)===e)return;this.unregister(t,this.panelToUrl.get(t))}this.panelToUrl.set(t,e),this.urlToPanel.has(e)?this.urlToPanel.get(e).push(t):this.urlToPanel.set(e,[t])},unregister:function(t,e){if(this.urlToPanel.has(e)){var n=this.urlToPanel.get(e);n.splice(n.indexOf(t),1),0===n.length&&(this.urlToPanel.delete(e),URL.revokeObjectURL(e))}this.panelToUrl.delete(t)}},Zi={namespaced:!0,state:{panels:{},panelOrder:[],currentPanel:null},mutations:{setCurrentPanel:function(t,e){var n=e.panelId;t.currentPanel=n},setPanelPreview:function(t,e){var n=e.panelId,r=e.url;t.panels[n].lastRender=r,Ji.register(n,r)},createPanel:function(t,e){var n=e.panel;t.panels[n.id]=n},setPanelOrder:function(t,e){var n=e.panelOrder;t.panelOrder=Object(wn["a"])(n)},setCurrentBackground:function(t,e){var n=e.current,r=e.panelId,o=t.panels[r];o.background.current=n,o.background.variant=0},setBackgroundColor:function(t,e){var n=e.color,r=e.panelId,o=t.panels[r];o.background.color=n},setBackgroundFlipped:function(t,e){var n=e.flipped,r=e.panelId,o=t.panels[r];o.background.flipped=n},setBackgroundVariant:function(t,e){var n=e.variant,r=e.panelId,o=t.panels[r];o.background.variant=n},setBackgroundScaling:function(t,e){var n=e.scaling,r=e.panelId,o=t.panels[r];o.background.scaling=n},deletePanel:function(t,e){var n=e.panelId;Ji.unregister(n,Ji.panelToUrl.get(n)),delete t.panels[n]},setComposition:function(t,e){var n=t.panels[e.id];n.composite=e.composite},setFilters:function(t,e){var n=t.panels[e.id];n.filters=e.filters},backgroundSetComposition:function(t,e){var n=t.panels[e.id];n.background.composite=e.composite},backgroundSetFilters:function(t,e){var n=t.panels[e.id];n.background.filters=e.filters}},actions:{createPanel:function(t){var e=t.state,n=t.commit,r="panel"+ ++Xi;n("createPanel",{panel:{id:r,background:{color:"#000000",current:Ki,flipped:!1,scaling:zi.None,variant:0,composite:"source-over",filters:[]},lastRender:"",composite:"source-over",filters:[]}}),e.panelOrder?n("setPanelOrder",{panelOrder:[].concat(Object(wn["a"])(e.panelOrder),[r])}):n("setPanelOrder",{panelOrder:[r]}),n("setCurrentPanel",{panelId:r})},duplicatePanel:function(t,e){var n=t.state,r=t.commit,o=t.dispatch,a=e.panelId,i=n.panels[a],c="panel"+ ++Xi;Ji.register(c,i.lastRender),r("createPanel",{panel:{id:c,background:JSON.parse(JSON.stringify(i.background)),lastRender:i.lastRender,composite:i.composite,filters:JSON.parse(JSON.stringify(i.filters))}}),o("objects/copyObjects",{sourcePanelId:a,targetPanelId:c},{root:!0});var s=n.panelOrder.indexOf(a);r("setPanelOrder",{panelOrder:[].concat(Object(wn["a"])(n.panelOrder.slice(0,s+1)),[c],Object(wn["a"])(n.panelOrder.slice(s+1)))}),r("setCurrentPanel",{panelId:c})},seekBackgroundVariant:function(t,e){var n=t.state,r=t.rootGetters,o=t.commit,a=e.delta,i=n.panels[n.currentPanel],c=r["content/getBackgrounds"],s=c.get(i.background.current);s&&o("setBackgroundVariant",{panelId:n.currentPanel,variant:Object(Yi["a"])(s.variants,i.background.variant,a)})},delete:function(t,e){var n=t.state,r=t.dispatch,o=t.commit,a=e.panelId;if(!(n.panelOrder.length<=1)){var i,c=n.panelOrder.indexOf(a);i=c===n.panelOrder.length-1?c-1:c+1,o("setCurrentPanel",{panelId:n.panelOrder[i]}),o("setPanelOrder",{panelOrder:[].concat(Object(wn["a"])(n.panelOrder.slice(0,c)),Object(wn["a"])(n.panelOrder.slice(c+1)))}),r("objects/deleteAllOfPanel",{panelId:a},{root:!0}),o("deletePanel",{panelId:a})}},fixContentPackRemoval:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,a,i,c,s,u,l;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=t.state,o=t.rootGetters,a=t.commit,i=t.rootState,c=function(){var t=u[s],n=e.backgrounds.find((function(e){return e.id===t.background.current}));if(!n)return{v:void 0};var r=o["content/getBackgrounds"].get(t.background.current);if(!r)return i.content.current.backgrounds[0]?a("setCurrentBackground",{current:i.content.current.backgrounds[0].id,panelId:t.id}):a("setCurrentBackground",{current:"buildin.transparent",panelId:t.id}),{v:void 0};var c=JSON.stringify(n.variants[t.background.variant]),l=r.variants.findIndex((function(t){return JSON.stringify(t)===c}));l!==t.background.variant&&a("setBackgroundVariant",{variant:-1===l?0:l,panelId:t.id})},s=0,u=Object.values(r.panels);case 3:if(!(s<u.length)){n.next=10;break}if(l=c(),"object"!==Object(Gi["a"])(l)){n.next=7;break}return n.abrupt("return",l.v);case 7:s++,n.next=3;break;case 10:case"end":return n.stop()}}),n)})))()},move:function(t,e){var n=t.state,r=t.commit,o=e.panelId,a=e.delta,i=Object(wn["a"])(n.panelOrder),c=i.indexOf(o);i.splice(c,1);var s=Math.max(c+a,0);i.splice(s,0,o),r("setPanelOrder",{panelOrder:i})},addFilter:function(t,e){var n=t.state,r=t.commit;Bn(e,(function(t){return n.panels[t]}),(function(t){return r("setFilters",t)}))},removeFilter:function(t,e){var n=t.state,r=t.commit;Fn(e,(function(t){return n.panels[t]}),(function(t){return r("setFilters",t)}))},moveFilter:function(t,e){var n=t.state,r=t.commit;Ln(e,(function(t){return n.panels[t]}),(function(t){return r("setFilters",t)}))},setFilter:function(t,e){var n=t.state,r=t.commit;Mn(e,(function(t){return n.panels[t]}),(function(t){return r("setFilters",t)}))},backgroundAddFilter:function(t,e){var n=t.state,r=t.commit;Bn(e,(function(t){return n.panels[t].background}),(function(t){return r("backgroundSetFilters",t)}))},backgroundRemoveFilter:function(t,e){var n=t.state,r=t.commit;Fn(e,(function(t){return n.panels[t].background}),(function(t){return r("backgroundSetFilters",t)}))},backgroundMoveFilter:function(t,e){var n=t.state,r=t.commit;Ln(e,(function(t){return n.panels[t].background}),(function(t){return r("backgroundSetFilters",t)}))},backgroundSetFilter:function(t,e){var n=t.state,r=t.commit;Mn(e,(function(t){return n.panels[t].background}),(function(t){return r("backgroundSetFilters",t)}))}}},Qi=function(){function t(e,n,r,o,a,i){Object(Sn["a"])(this,t),this.id=e,this.assets=n,this.flip=r,this.scale=o,this.compositeMode=a,this.filters=i}return Object(Rn["a"])(t,[{key:"render",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,i,c,s,u,l,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.assets.map((function(t){return Object(ht["a"])(t,e.hq)})));case 2:n=t.sent,r=Object(bt["a"])(n),t.prev=4,r.s();case 6:if((o=r.n()).done){t.next=31;break}if(a=o.value,a instanceof HTMLImageElement){t.next=10;break}return t.abrupt("return");case 10:i=0,c=0,s=a.width,u=a.height,t.t0=this.scale,t.next=t.t0===zi.None?17:t.t0===zi.Stretch?20:t.t0===zi.Cover?23:28;break;case 17:return i=Te["d"]/2-s/2,c=Te["c"]/2-u/2,t.abrupt("break",28);case 20:return s=Te["d"],u=Te["c"],t.abrupt("break",28);case 23:l=s/u,d=Te["d"]/Te["c"],l>d?(u=Te["c"],s=u*l):(s=Te["d"],u=s/l),i=Te["d"]/2-s/2,c=Te["c"]/2-u/2;case 28:e.drawImage({image:a,x:i,y:c,w:s,h:u,flip:this.flip,composite:this.compositeMode,filters:this.filters});case 29:t.next=6;break;case 31:t.next=36;break;case 33:t.prev=33,t.t1=t["catch"](4),r.e(t.t1);case 36:return t.prev=36,r.f(),t.finish(36);case 39:case"end":return t.stop()}}),t,this,[[4,33,36,39]])})));function e(e){return t.apply(this,arguments)}return e}()}]),t}(),tc={id:"buildin.static-color",name:"Static color",color:"#000000",render:function(t){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.drawRect({x:0,y:0,w:Te["d"],h:Te["c"],fill:{style:e.color}});case 1:case"end":return n.stop()}}),n)})))()}},ec=n("262e"),nc=n("2caf"),rc=n("4a6f"),oc=function(t){Object(ec["a"])(n,t);var e=Object(nc["a"])(n);function n(t){var r;return Object(Sn["a"])(this,n),r=e.call(this,t),r.canvasHeight=0,r.canvasWidth=0,r.init(),r}return Object(Rn["a"])(n,[{key:"init",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){var e,n,r,o,a,i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.ready=new Promise((function(t,n){e=t})),t.next=3,Promise.all(this.obj.assets.map((function(t){return Object(ht["a"])(t)})));case 3:n=t.sent,r=0,o=0,a=Object(bt["a"])(n);try{for(a.s();!(i=a.n()).done;)c=i.value,c instanceof HTMLImageElement&&(c.height>o&&(o=c.height),c.width>r&&(r=c.width))}catch(s){a.e(s)}finally{a.f()}this.canvasWidth=r,this.canvasHeight=o,this.assets=[{loaded:!0,assets:n,offset:[0,0]}],e();case 12:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"getAssetList",value:function(){return this.assets||[]}},{key:"version",get:function(){return null===this.assets?-1:this.obj.version}}]),n}(rc["a"]),ac=n("1a7b"),ic=n("45eb"),cc=n("7e84"),sc=n("fd0b");function uc(t,e,n,r,o,a){r<0&&(r=0),o<0&&(o=0),r<2*a&&(a=r/2),o<2*a&&(a=o/2),t.moveTo(e+a,n),t.arcTo(e+r,n,e+r,n+o,a),t.arcTo(e+r,n+o,e,n+o,a),t.arcTo(e,n+o,e,n,a),t.arcTo(e,n,e+r,n,a),t.closePath()}function lc(t,e,n,r,o,a){r<0&&(r=0),o<0&&(o=0),r<2*a&&(a=r/2),o<2*a&&(a=o/2),t.moveTo(e+a,n),t.arcTo(e+r,n,e+r,n+o,a),t.lineTo(e+r,n+o),t.lineTo(e,n+o),t.arcTo(e,n,e+r,n,a),t.closePath()}var dc=n("4265"),pc=function(t){Object(ec["a"])(n,t);var e=Object(nc["a"])(n);function n(){var t;return Object(Sn["a"])(this,n),t=e.apply(this,arguments),t.lastWidth=-1,t.lastHeight=-1,t.lastX=-1,t.lastY=-1,t.lastFlip=null,t.canvasHeight=Te["c"],t.canvasWidth=Te["d"],t.canvasDrawHeight=Te["c"],t.canvasDrawWidth=Te["d"],t.canvasDrawPosX=0,t.canvasDrawPosY=0,t}return Object(Rn["a"])(n,[{key:"getRenderRotation",value:function(){return[0,void 0]}},{key:"needsRedraw",value:function(){return!!Object(ic["a"])(Object(cc["a"])(n.prototype),"needsRedraw",this).call(this)||(this.width!==this.lastWidth||this.height!==this.lastHeight||this.x!==this.lastX||this.y!==this.lastY||this.flip!==this.lastFlip)}},{key:"updateLocalCanvas",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.lastWidth=this.width,this.lastHeight=this.height,this.lastX=this.x,this.lastY=this.y,this.lastFlip=this.flip,t.next=7,Object(ic["a"])(Object(cc["a"])(n.prototype),"updateLocalCanvas",this).call(this,e);case 7:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"renderLocal",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!==this.rotation){t.next=2;break}return t.abrupt("return",this.draw(e));case 2:return t.next=4,e.customTransform(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var r,o,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=n.getHitbox(),o=r.x0+(r.x1-r.x0)/2,a=r.y0+(r.y1-r.y0)/2,i=n.flip?Te["d"]-o:o,e.translate(i,a),e.rotate(n.rotation),e.translate(-i,-a);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.draw.bind(this));case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getHitbox",value:function(){var t=this.centeredVertically,e=this.width/2,n=this.height/2;return{x0:this.x-e,x1:this.x+e,y0:t?this.y-n:this.y,y1:t?this.y+n:this.y+this.height}}},{key:"centeredVertically",get:function(){return!1}}]),n}(dc["a"]),bc=function(t){Object(ec["a"])(n,t);var e=Object(nc["a"])(n);function n(){var t;return Object(Sn["a"])(this,n),t=e.apply(this,arguments),t.refObject=null,t}return Object(Rn["a"])(n,[{key:"updatedContent",value:function(t,e){Object(ic["a"])(Object(cc["a"])(n.prototype),"updatedContent",this).call(this,t,e);var r=this.obj.talkingObjId;if(null!==r&&"$other$"!==r){var o=t.state.objects.objects[r];if(o)return void(this.refObject=o)}this.refObject=null}},{key:"draw",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,i,c,s,u,l,d,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=this.width,r=this.height,o=n/2,a=this.flip?Te["d"]-this.obj.x:this.obj.x,i=a-o,c=this.obj.y,t.next=8,this.renderBackdrop(e,i,c+zr);case 8:if(null===this.obj.talkingObjId){t.next=12;break}return u="$other$"===this.obj.talkingObjId?this.obj.talkingOther:(null===(s=this.refObject)||void 0===s?void 0:s.label)||"Missing name",t.next=12,this.renderNamebox(e,i+Gr,c,u);case 12:return t.next=14,this.renderText(e,i,c,this.obj.autoWrap?n:0);case 14:if(l=c+r,d=l-Kr,p=i+n/2,this.obj.controls&&(e.drawText(Object(Qt["a"])({text:"History",x:p+Xr,y:d},this.controlsStyle)),e.drawText(Object(Qt["a"])({text:"Skip",x:p+Jr,y:d},this.obj.skip?this.controlsStyle:this.controlsDisableStyle)),e.drawText(Object(Qt["a"])({text:"Auto   Save   Load   Settings",x:p+Zr,y:d},this.controlsStyle))),!this.obj.continue){t.next=27;break}return t.t0=e,t.next=22,Object(ht["b"])("next");case 22:t.t1=t.sent,t.t2=i+n-Qr,t.t3=l-to,t.t4={image:t.t1,x:t.t2,y:t.t3},t.t0.drawImage.call(t.t0,t.t4);case 27:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"renderNamebox",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,n,r,o){var a,i,c,s,l=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i=zr,c=oo,"custom"!==this.forcedStyle){t.next=9;break}return c=Object(Qt["a"])(Object(Qt["a"])({},c),{},{strokeColor:this.nameboxOutlineColor,strokeWidth:6,color:"#FFFFFF"}),a=this.nameboxWidth,t.next=7,e.customTransform(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.beginPath(),lc(e,n,r,a,i,Tr),e.clip();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var o,a,c,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:o=e.linearGradient(n,r,n,r+zr),a=In.fromCss(l.nameboxBackgroundColor),c=new In(a.r,a.g,a.b,.95),s=c.toHSL().shift(Ir).toRgb(),o.addColorStop(0,c.toCss()),o.addColorStop(Pr,c.toCss()),o.addColorStop(1,s.toCss()),e.drawRect({x:n,y:r,w:l.obj.width,h:i,fill:{style:o}});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 7:t.next=22;break;case 9:if("none"===this.forcedStyle){t.next=21;break}return a=this.nameboxWidth,t.t0=e,t.next=14,Object(ht["b"])("namebox");case 14:t.t1=t.sent,t.t2=n,t.t3=r,t.t4={image:t.t1,x:t.t2,y:t.t3},t.t0.drawImage.call(t.t0,t.t4),t.next=22;break;case 21:a=this.nameboxWidth;case 22:return s=new fr(o,c),t.next=25,s.loadFonts();case 25:s.fixAlignment("center",n,n+a,r+Yr,0),s.render(e.fsCtx);case 27:case"end":return t.stop()}}),t,this)})));function e(e,n,r,o){return t.apply(this,arguments)}return e}()},{key:"renderBackdrop",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,n,r){var o,a,i,c,s=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("custom"!==this.forcedStyle){t.next=10;break}return o=In.fromCss(this.customColor).toHSL(),a=new sc["a"](Er,Er),a.render(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=function(t,r){e.drawPath({path:function(e){e.ellipse(t,r,Vr,Vr,0,0,2*Math.PI)},fill:n})},n={style:o.shift(Hr).toRgb().toCss()},r(0,0),r(Er,0),r(0,Er),r(Er,Er),r(Er/2,Er/2);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),!0),t.next=6,e.customTransform(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.beginPath(),uc(e,n+_r,r+_r,s.obj.width-2*_r,s.obj.height-2*_r,Ar),e.clip();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var o,i,c,l,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=s.obj.height,i=s.obj.width,c=e.linearGradient(n,r,n,r+o),l=In.fromHex(s.customColor),c.addColorStop(0,l.toCss()),c.addColorStop(1,"rgba(".concat(l.r,",").concat(l.g,",").concat(l.b,",0.6667)")),e.drawRect({x:n,y:r,w:i,h:o,fill:{style:c},outline:{style:"#ffdfee",width:6}}),t.next=9,e.customTransform(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.translate(n,r);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=e.patternFrom(a),e.drawRect({x:0,y:0,w:i,h:o,fill:{style:r},composition:"source-atop"});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 9:d=e.linearGradient(n,r+o-no,n,r+o),d.addColorStop(0,"rgba(255,255,255,0.3137)"),d.addColorStop(.5,"rgba(255,255,255,0.0627)"),d.addColorStop(1,"rgba(255,255,255,0)"),e.drawPath({path:function(t){t.ellipse(n+i/2,r+o,eo,no,0,0,2*Math.PI)},fill:{style:d}});case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 6:i=o.shift(Br).toRgb().toCss(),e.drawPath({path:function(t){uc(t,n+_r,r+_r,s.obj.width-2*_r,s.obj.height-2*_r,Ar)},outline:{style:i,width:3}}),t.next=16;break;case 10:if("none"===this.forcedStyle){t.next=16;break}return"corrupt"===this.forcedStyle&&(n+=(Fr-Lr)/2),t.next=14,Object(ht["b"])("corrupt"===this.forcedStyle?"textbox_monika":"textbox");case 14:c=t.sent,e.drawImage({image:c,x:n,y:r});case 16:case"end":return t.stop()}}),t,this)})));function e(e,n,r){return t.apply(this,arguments)}return e}()},{key:"renderText",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,n,r,o){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=new fr(this.obj.text,{alpha:1,color:"#ffffff",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,strokeColor:"#523140",strokeWidth:4,lineSpacing:1.2}),this.obj.autoQuoting&&null!==this.obj.talkingObjId&&a.quote(),t.next=4,a.loadFonts();case 4:a.fixAlignment("left",n+Wr,0,r+zr+Ur,o-Wr-Wr),a.render(e.fsCtx);case 6:case"end":return t.stop()}}),t,this)})));function e(e,n,r,o){return t.apply(this,arguments)}return e}()},{key:"width",get:function(){return"custom"===this.obj.style?this.obj.width:Fr}},{key:"height",get:function(){return("custom"===this.obj.style?this.obj.height:Mr)+zr}},{key:"forcedStyle",get:function(){return"normal"===this.obj.style&&this.refObject&&(this.refObject.textboxColor||null!==this.refObject.nameboxWidth)?"custom":this.obj.style}},{key:"customColor",get:function(){return this.obj.overrideColor?this.obj.customColor:this.refObject&&this.refObject.textboxColor?this.refObject.textboxColor:yr}},{key:"controlColor",get:function(){if(this.obj.deriveCustomColors){var t=In.fromCss(this.customColor).toHSL();return t.shift($r).toRgb().toCss()}return this.obj.customControlsColor}},{key:"controlsStyle",get:function(){return"custom"!==this.forcedStyle?ao:Object(Qt["a"])(Object(Qt["a"])({},ao),{},{fill:{style:this.controlColor}})}},{key:"controlsDisableStyle",get:function(){if("custom"!==this.forcedStyle)return io;var t=In.fromCss(this.controlColor).toHSL(),e=t.shift(Dr).toRgb().toCss();return Object(Qt["a"])(Object(Qt["a"])({},ao),{},{fill:{style:e}})}},{key:"nameboxOutlineColor",get:function(){if(this.obj.deriveCustomColors){var t=In.fromCss(this.customColor).toHSL();return t.shift(Sr).toRgb().toCss()}return this.obj.customNameboxStroke}},{key:"nameboxBackgroundColor",get:function(){if(this.obj.deriveCustomColors){var t=In.fromCss(this.customColor).toHSL();return t.shift(Rr).toRgb().toCss()}return this.obj.customNameboxColor}},{key:"nameboxWidth",get:function(){return"custom"!==this.forcedStyle?qr:this.refObject&&null!==this.refObject.nameboxWidth?this.refObject.nameboxWidth:null!==this.obj.customNameboxWidth?this.obj.customNameboxWidth:qr}}]),n}(pc),hc=(new Pn(-.03065134099616873,-.5714285714285714,-.29607843137254897,0),"#ffe6f4"),fc="#ffbde1",vc=420,mc=22,jc=270,gc=7,Oc=(Te["c"]-jc)/2,kc={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1,strokeColor:"",strokeWidth:0},yc=function(t){Object(ec["a"])(n,t);var e=Object(nc["a"])(n);function n(){var t;return Object(Sn["a"])(this,n),t=e.apply(this,arguments),t._height=0,t.choiceRenderers=[],t}return Object(Rn["a"])(n,[{key:"draw",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,i,c,s,u,l,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.updateChoiceBounds();case 2:console.log("rerender choice"),n=this.obj.width,r=this.height,o=n/2,a=this.flip?Te["d"]-this.obj.x:this.obj.x,i=a-o,c=this.obj.y-r/2,s=Object(bt["a"])(this.choiceRenderers),t.prev=10,s.s();case 12:if((u=s.n()).done){t.next=23;break}return l=u.value,t.next=16,l.loadFonts();case 16:d=l.getHeight(this.obj.autoWrap?this.obj.width:0),e.drawRect({x:i,y:c,w:n,h:d+2*gc,outline:{style:fc,width:3},fill:{style:hc}}),l.fixAlignment("center",i,i+n,c+1.25*mc,this.obj.autoWrap?n:0),l.render(e.fsCtx),c+=d+2*gc+mc;case 21:t.next=12;break;case 23:t.next=28;break;case 25:t.prev=25,t.t0=t["catch"](10),s.e(t.t0);case 28:return t.prev=28,s.f(),t.finish(28);case 31:case"end":return t.stop()}}),t,this,[[10,25,28,31]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"updateChoiceBounds",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.choiceRenderers=this.obj.choices.map((function(t){return new fr(t.text||" ",kc)})),this._height=this.choiceRenderers.reduce((function(t,n){return t+n.getHeight(e.obj.autoWrap?e.obj.width:0)+2*gc}),0)+this.obj.choiceDistance*(this.obj.choices.length-1);case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"height",get:function(){return this._height}},{key:"centeredVertically",get:function(){return!0}}]),n}(pc),wc="rgba(255,255,255,0.6)",xc=40,Cc=30,Sc=Object(Qt["a"])(Object(Qt["a"])({},ro),{},{fontName:"riffic",fontSize:24,strokeColor:Cr,strokeWidth:8,letterSpacing:1,color:"white"}),Rc={alpha:1,color:"black",fontName:"aller",fontSize:24,isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0},Pc=function(t){Object(ec["a"])(n,t);var e=Object(nc["a"])(n);function n(){var t;return Object(Sn["a"])(this,n),t=e.apply(this,arguments),t._height=0,t._width=0,t}return Object(Rn["a"])(n,[{key:"render",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.obj.backdrop&&r.drawRect({x:0,y:0,w:Te["d"],h:Te["c"],fill:{style:wc}}),t.next=3,Object(ic["a"])(Object(cc["a"])(n.prototype),"render",this).call(this,e,r);case 3:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"draw",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,i,c,s,u,l,d,p,b,h;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new fr(this.obj.text,Rc),r=new fr("OK",Sc),t.next=4,n.loadFonts();case 4:return t.next=6,r.loadFonts();case 6:o=this.obj.autoWrap?this.obj.width-2*xc:0,a=this.obj.autoWrap?o:n.getWidth(),i=n.getHeight(o),c=this.obj.autoWrap?o:r.getWidth(),s=r.getHeight(o),u=this._width=Math.max(a,c)+2*xc,l=this._height=i+2*xc+Cc+s,d=u/2,p=this.flip?Te["d"]-this.obj.x:this.obj.x,b=p-d,h=this.obj.y-l/2,e.drawRect({x:b,y:h,w:u,h:l,outline:{style:fc,width:3},fill:{style:hc}}),n.fixAlignment("center",b,b+u,h+1.5*xc,o),n.render(e.fsCtx),r.fixAlignment("center",b,b+u,h+l-xc,o),r.render(e.fsCtx);case 22:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"height",get:function(){return this._height}},{key:"width",get:function(){return this._width}},{key:"centeredVertically",get:function(){return!0}},{key:"id",get:function(){return this.obj.id}}]),n}(pc),Ic=[{name:"Normal paper",file:"poem.jpg"},{name:"Lightly soiled paper",file:"poem_y1.jpg"},{name:"Heavily soiled paper",file:"poem_y2.jpg"},{name:"Console",file:"internal:console"},{name:"Transparent",file:"internal:transparent"}],Tc=0,Ac=0,_c=Te["d"]/2,$c=Te["c"]/2,Dc=33,Hc=30,Vc=800,Ec=720,Bc="rgba(51,51,51,0.75)",Fc=480,Lc=180,Mc=3,Nc=7,Wc={alpha:1,color:"black",isBold:!1,isItalic:!1,isStrikethrough:!1,isUnderlined:!1,letterSpacing:0,lineSpacing:1.2,strokeColor:"",strokeWidth:0,fontName:"aller",fontSize:12},Uc=[Object(Qt["a"])(Object(Qt["a"])({},Wc),{},{name:"Sayori",fontName:"hashtag",fontSize:34,lineSpacing:1.05,letterSpacing:0}),Object(Qt["a"])(Object(Qt["a"])({},Wc),{},{name:"Natsuki",fontName:"ammy_handwriting",fontSize:28}),Object(Qt["a"])(Object(Qt["a"])({},Wc),{},{name:"Monika",fontName:"journal",fontSize:34}),Object(Qt["a"])(Object(Qt["a"])({},Wc),{},{name:"Yuri",fontName:"jp_hand_slanted",lineSpacing:1.5,fontSize:32}),Object(Qt["a"])(Object(Qt["a"])({},Wc),{},{name:"Yuri Act 2",fontName:"damagrafik_script",fontSize:18,letterSpacing:-8}),Object(Qt["a"])(Object(Qt["a"])({},Wc),{},{name:"Yuri Unused",fontName:"as_i_lay_dying",fontSize:40}),Object(Qt["a"])(Object(Qt["a"])({},Wc),{},{name:"MC",fontName:"halogen",fontSize:30,lineSpacing:1.53}),Object(Qt["a"])(Object(Qt["a"])({},Wc),{},{name:"Console",fontName:"f25_bank_printer",fontSize:18,color:"white",lineSpacing:1.1})],zc=-2,qc=26,Gc=10,Yc=10,Kc=function(t){Object(ec["a"])(n,t);var e=Object(nc["a"])(n);function n(){var t;return Object(Sn["a"])(this,n),t=e.apply(this,arguments),t._height=0,t._width=0,t}return Object(Rn["a"])(n,[{key:"draw",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,i,c,s,u,l,d,p,b;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=Ic[this.obj.background],r=this.flip?Te["d"]-this.obj.x:this.obj.x,o=this.obj.y,a=r+Yc,i=Hc,c=Dc,s=2*i,"internal:console"!==n.file){t.next=16;break}u=this._height=this.obj.height,l=this._width=this.obj.width,e.drawRect({x:r-l/2,y:this.obj.y-u/2,h:u,w:l,fill:{style:Bc}}),i=zc,c=qc,s=Gc,t.next=25;break;case 16:if("internal:transparent"!==n.file){t.next=21;break}this._height=this.obj.height,this._width=this.obj.width,t.next=25;break;case 21:return t.next=23,Object(ht["c"])("assets/poemBackgrounds/".concat(n.file));case 23:d=t.sent,d instanceof HTMLImageElement&&(e.drawImage({image:d,x:r-d.width/2,y:this.obj.y-d.height/2}),this._height=d.height,this._width=d.width);case 25:return o-=this.height/2,a-=this.width/2,p=Uc[this.obj.font],b=new fr(this.obj.text,p),t.next=31,b.loadFonts();case 31:b.fixAlignment("left",a+i,a+i,o+c+i,this.obj.autoWrap?this.width-s:0),b.render(e.fsCtx);case 33:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"height",get:function(){return this._height}},{key:"width",get:function(){return this._width}},{key:"centeredVertically",get:function(){return!0}}]),n}(pc),Xc=function(){function t(e,n,r,o){Object(Sn["a"])(this,t),this.store=e,this.panelId=n,this.canvasWidth=r,this.canvasHeight=o,this.renderObjectCache=new Map,this.lCurrentlyRendering=!1,this.renderer=new sc["a"](r,o)}return Object(Rn["a"])(t,[{key:"render",value:function(t,e){return this.panel?this.renderer.render(this.renderCallback.bind(this),t,e):Promise.resolve(!1)}},{key:"download",value:function(){var t=new Date,e="panel-".concat([t.getFullYear(),"".concat(t.getMonth()+1).padStart(2,"0"),"".concat(t.getDate()).padStart(2,"0"),"".concat(t.getHours()).padStart(2,"0"),"".concat(t.getMinutes()).padStart(2,"0"),"".concat(t.getSeconds()).padStart(2,"0")].join("-"),".png");return this.renderer.download(this.renderCallback.bind(this),e)}},{key:"paintOnto",value:function(t,e){this.renderer.paintOnto(t,e)}},{key:"objectsAt",value:function(t,e){return this.getRenderObjects().filter((function(n){return n.hitTest(t,e)})).map((function(t){return t.id}))}},{key:"renderCallback",value:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.lCurrentlyRendering=!0,t.prev=1,e.fsCtx.imageSmoothingEnabled=!0,e.fsCtx.imageSmoothingQuality=e.hq?"high":"low",t.next=6,null===(n=this.getBackgroundRenderer())||void 0===n?void 0:n.render(e);case 6:r=this.store.state.ui.selection,o=Object(bt["a"])(this.getRenderObjects()),t.prev=8,o.s();case 10:if((a=o.n()).done){t.next=18;break}return i=a.value,c=!1,i instanceof dc["a"]&&(i.updatedContent(this.store,this.panelId),c=r===i.id),t.next=16,i.render(c,e);case 16:t.next=10;break;case 18:t.next=23;break;case 20:t.prev=20,t.t0=t["catch"](8),o.e(t.t0);case 23:return t.prev=23,o.f(),t.finish(23);case 26:if(e.applyFilters(Object(wn["a"])(this.panel.filters)),!e.preview){t.next=34;break}return t.t1=e,t.next=31,Object(ht["b"])("backgrounds/transparent");case 31:t.t2=t.sent,t.t3={x:0,y:0,composite:"destination-over",image:t.t2},t.t1.drawImage.call(t.t1,t.t3);case 34:return t.prev=34,this.lCurrentlyRendering=!1,t.finish(34);case 37:case"end":return t.stop()}}),t,this,[[1,,34,37],[8,20,23,26]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getRenderObjects",value:function(){var t,e=this,n=this.store.state.objects.panels[this.panelId],r=n?[].concat(Object(wn["a"])(n.order),Object(wn["a"])(n.onTopOrder)):[],o=this.store.state.objects.objects,a=Object.keys(this.renderObjectCache).filter((function(t){return!r.includes(t)})),i=Object(bt["a"])(a);try{for(i.s();!(t=i.n()).done;){var c=t.value;this.renderObjectCache.delete(c)}}catch(s){i.e(s)}finally{i.f()}return r.map((function(t){var n=e.renderObjectCache.get(t);if(!n){var r=o[t];switch(r.type){case"sprite":n=new oc(r);break;case"character":var a=r;n=new ac["a"](a,Object(Ht["e"])(e.store,a));break;case"textBox":n=new bc(r);break;case"choice":n=new yc(r);break;case"notification":n=new Pc(r);break;case"poem":n=new Kc(r);break}e.renderObjectCache.set(t,n)}return n}))}},{key:"getBackgroundRenderer",value:function(){var t=this.panel;switch(t.background.current){case"buildin.static-color":return tc.color=t.background.color,tc;default:var e=this.store.getters["content/getBackgrounds"],n=e.get(t.background.current);if(!n)return null;var r=n.variants[t.background.variant];return r?new Qi(t.background.current,r,t.background.flipped,t.background.scaling,t.background.composite,t.background.filters):null}}},{key:"currentlyRendering",get:function(){return this.lCurrentlyRendering}},{key:"panel",get:function(){return this.store.state.panels.panels[this.panelId]}}]),t}(),Jc=1.5,Zc=1/4,Qc=.5,ts=100,es=90,ns=70,rs=Object(r["m"])({mixins:[q],components:{DFieldset:Vt["a"],DFlow:ee,DButton:kt,ImageOptions:zn},data:function(){return{webpSupport:!1,heifSupport:!1,ppi:0,pages:"",format:"image/png",quality:es,imageOptions:!1}},computed:{currentPanel:function(){return this.$store.state.panels.currentPanel},isLossy:function(){return"image/png"!==this.format},canDeletePanel:function(){return this.panelButtons.length>1},panelButtons:function(){var t=this,e=this.$store.state.panels.panelOrder;return e.map((function(e){var n=t.$store.state.panels.panels[e],r=t.$store.state.objects.panels[e],o=r?[].concat(r.order,r.onTopOrder).map((function(e){return t.$store.state.objects.objects[e]})).map(t.extractObjectText):[];return{id:e,image:n.lastRender,text:o.reduce((function(t,e){return t.length>e.length?t:e}),"")}}))},canMoveAhead:function(){var t=this.$store.state.panels.panelOrder,e=t.indexOf(this.currentPanel);return e>0},canMoveBehind:function(){var t=this.$store.state.panels.panelOrder,e=t.indexOf(this.currentPanel);return e<t.length-1}},created:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Object(ht["e"])(),Object(ht["d"])()]);case 2:n=e.sent,r=Object(l["a"])(n,2),t.webpSupport=r[0],t.heifSupport=r[1];case 6:case"end":return e.stop()}}),e)})))()},mounted:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.moveFocusToActivePanel(),t.renderThumbnail();case 2:case"end":return e.stop()}}),e)})))()},methods:{download:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n,r,o,a,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.getPanelDistibution(),r=new Date,o="cd-".concat([r.getFullYear(),"".concat(r.getMonth()+1).padStart(2,"0"),"".concat(r.getDate()).padStart(2,"0"),"".concat(r.getHours()).padStart(2,"0"),"".concat(r.getMinutes()).padStart(2,"0"),"".concat(r.getSeconds()).padStart(2,"0")].join("-")),a=t.format.split("/")[1],i=t.format,c=t.quality,e.next=8,t.renderObjects(n,!0,function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:G["a"].saveToFile(n,"".concat(o,"_").concat(e,".").concat(a),i,c/ts);case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 8:case"end":return e.stop()}}),e)})))()},estimateExportSize:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n,r,o,a,i,c,s,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.getPanelDistibution(),r=t.format||"image/png",o=t.quality||es,e.next=5,t.renderObjects(n,!1,function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,a){n.toBlob((function(n){n?t(n.size):a("Image ".concat(e+1," could not be rendered."))}),r,o/ts)})));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 5:a=e.sent,i=a.map((function(t){return(t*Jc/1024/1024).toFixed(2)+"MiB"})),c=i.length>1?"files":"file",s=i.length>1?"These":"It",l=i.length>1?"sizes":"size",_n["g"].fire(new _n["e"]("This would export ".concat(i.length," ").concat(c,". ").concat(s," would have the following (aproximate) ").concat(l,": ").concat(i.join(","))));case 11:case"end":return e.stop()}}),e)})))()},renderObjects:function(t,e,n){var r=this;return Object(u["a"])(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,Promise.all(t.map(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(o,a){var i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=document.createElement("canvas"),i.width=Te["d"],i.height=Te["c"]*o.length,c=i.getContext("2d"),t.next=6,Promise.all(o.map(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(n,a){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=new Xc(r.$store,o[a],Te["d"],Te["c"]),t.next=3,i.render(e,!1);case 3:i.paintOnto(c,{x:0,y:Te["c"]*a,w:Te["d"],h:Te["c"]});case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()));case 6:return t.next=8,n(a,i);case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()));case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}}),o)})))()},getLimitedPanelList:function(){var t,e=this,n=this.$store.state.panels.panelOrder.length-1,r=0,o=this.pages.split(","),a=[],i=!1,c=Object(bt["a"])(o);try{for(c.s();!(t=c.n()).done;){var s=t.value,u=s.trim(),l=u.match(/^\s*((\d+)|(\d+)\s*-\s*(\d+))\s*$/);if(l)if(i=!0,l[2])a.push(parseInt(l[2],10)-1);else{var d=Math.max(parseInt(l[3],10)-1,r),p=Math.min(parseInt(l[4],10)-1,n);if(void 0===d||void 0===p||d>p)continue;for(var b=d;b<=p;++b)a.push(b)}else""!==u&&_n["g"].fire(new _n["e"]("Could not read '".concat(s,"' in the page list.")))}}catch(h){c.e(h)}finally{c.f()}return i?a.sort((function(t,e){return t-e})).filter((function(t,e,n){return n[e-1]!==t})).map((function(t){return e.$store.state.panels.panelOrder[t]})):this.$store.state.panels.panelOrder},getPanelDistibution:function(){var t=this.getLimitedPanelList();if(0===this.ppi)return[t];for(var e=[],n=0;n<t.length/this.ppi;++n){var r=n*this.ppi,o=r+this.ppi;e.push(Object(wn["a"])(t.slice(r,o)))}return e},moveFocusToActivePanel:function(){var t=this.$el.querySelector(".panel_button.active");t&&this.scrollIntoView(t)},scrollIntoView:function(t){var e=t.parentElement.parentElement,n=Array.from(t.parentElement.children).indexOf(t);if(this.$store.state.ui.vertical){var r=n*t.clientHeight-e.clientHeight/2+t.clientHeight/2;e.scrollTop=r,e.scrollLeft=0}else{var o=n*t.clientWidth-e.clientWidth/2+t.clientWidth/2;e.scrollLeft=o,e.scrollTop=0}},extractObjectText:function(t){switch(t.type){case"textBox":return t.text;case"notification":return t.text;case"poem":return t.text;case"choice":return t.choices.map((function(t){return"[".concat(t.text,"]")})).join("\n")}return""},addNewPanel:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("panels/duplicatePanel",{panelId:t.$store.state.panels.currentPanel});case 1:case"end":return e.stop()}}),e)}))));case 2:t.$nextTick((function(){t.moveFocusToActivePanel()}));case 3:case"end":return e.stop()}}),e)})))()},updateCurrentPanel:function(t){var e=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.$store.commit("panels/setCurrentPanel",{panelId:t});case 1:case"end":return n.stop()}}),n)})))),this.$nextTick((function(){e.moveFocusToActivePanel()}))},deletePanel:function(){var t=this;this.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.dispatch("panels/delete",{panelId:t.$store.state.panels.currentPanel});case 1:case"end":return e.stop()}}),e)})))),this.$nextTick((function(){t.moveFocusToActivePanel()}))},moveAhead:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("panels/move",{panelId:t.currentPanel,delta:-1})}))},moveBehind:function(){var t=this;this.vuexHistory.transaction((function(){t.$store.dispatch("panels/move",{panelId:t.currentPanel,delta:1})}))},renderThumbnail:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=new Xc(t.$store,t.currentPanel,Te["d"],Te["c"]),e.next=3,n.render(!1,!0);case 3:return r=document.createElement("canvas"),r.width=Te["d"]*Zc,r.height=Te["c"]*Zc,n.paintOnto(r.getContext("2d"),{x:0,y:0,w:r.width,h:r.height}),e.t0=r,e.t1=function(e){if(e){var n=URL.createObjectURL(e);t.vuexHistory.transaction((function(){t.$store.commit("panels/setPanelPreview",{panelId:t.$store.state.panels.currentPanel,url:n})}))}},e.next=11,Object(ht["e"])();case 11:if(!e.sent){e.next=15;break}e.t2="image/webp",e.next=16;break;case 15:e.t2="image/jpeg";case 16:e.t3=e.t2,e.t4=Qc,e.t0.toBlob.call(e.t0,e.t1,e.t3,e.t4);case 19:case"end":return e.stop()}}),e)})))()}},watch:{quality:function(t,e){t!==ts?e>ns&&t<=ns&&_n["g"].fire(new _n["e"]("Note: A quality level below 70% might be very noticable and impair legibility of text.")):_n["g"].fire(new _n["e"]("Note: 100% quality on a lossy format is still not lossless! Select PNG if you want lossless compression."))}}});n("51b0");rs.render=qi,rs.__scopeId="data-v-2ffec108";var os=rs,as=Object(r["F"])("data-v-618f75f2");Object(r["r"])("data-v-618f75f2");var is={id:"notification_text"},cs=Object(r["k"])("label",{for:"notification_text"},"Text:",-1);Object(r["q"])();var ss=as((function(t,e,n,o,a,i){var c=Object(r["w"])("toggle"),s=Object(r["w"])("object-tool");return Object(r["p"])(),Object(r["g"])(s,{object:t.object,title:"Notification",textHandler:t.textHandler},{default:as((function(){return[Object(r["k"])("div",is,[cs,Object(r["D"])(Object(r["k"])("textarea",{"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.text=e}),id:"notification_text",onKeydown:e[2]||(e[2]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.text]]),Object(r["k"])("button",{onClick:e[3]||(e[3]=function(e){return t.textEditor=!0})},"Formatting")])]})),options:as((function(){return[Object(r["k"])(c,{modelValue:t.renderBackdrop,"onUpdate:modelValue":e[4]||(e[4]=function(e){return t.renderBackdrop=e}),label:"Show backdrop?"},null,8,["modelValue"])]})),_:1},8,["object","textHandler"])})),us=oe(),ls=Object(r["m"])({mixins:[q],components:{Toggle:U["a"],ObjectTool:bo},data:function(){return{textEditor:!1}},computed:{object:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("notification"===t.type)return t},textHandler:function(){var t=this;if(this.textEditor)return{title:"Text",get:function(){return t.text},set:function(e){t.text=e},leave:function(){t.textEditor=!1}}},text:us("text","objects/setNotificationText"),autoWrap:us("autoWrap","objects/setAutoWrapping"),renderBackdrop:us("backdrop","objects/setNotificationBackdrop")}});n("28de");ls.render=ss,ls.__scopeId="data-v-618f75f2";var ds=ls,ps=Object(r["F"])("data-v-2a8686c0");Object(r["r"])("data-v-2a8686c0");var bs={id:"poem_text"},hs=Object(r["k"])("label",{for:"poem_text"},"Text:",-1);Object(r["q"])();var fs=ps((function(t,e,n,o,a,i){var c=Object(r["w"])("toggle"),s=Object(r["w"])("object-tool");return Object(r["p"])(),Object(r["g"])(s,{object:t.object,title:"poem"===t.object.subType?"Poem":"Console",textHandler:t.textHandler},{default:ps((function(){return[Object(r["k"])("div",bs,[hs,Object(r["D"])(Object(r["k"])("textarea",{"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.text=e}),onKeydown:e[2]||(e[2]=Object(r["E"])((function(){}),["stop"]))},null,544),[[r["A"],t.text]]),Object(r["k"])("button",{onClick:e[3]||(e[3]=function(e){return t.textEditor=!0})},"Formatting")]),Object(r["k"])(c,{label:"Auto line wrap?",modelValue:t.autoWrap,"onUpdate:modelValue":e[4]||(e[4]=function(e){return t.autoWrap=e})},null,8,["modelValue"]),"poem"===t.object.subType?(Object(r["p"])(),Object(r["g"])(r["a"],{key:0},[Object(r["D"])(Object(r["k"])("select",{"onUpdate:modelValue":e[5]||(e[5]=function(e){return t.poemBackground=e}),onKeydown:e[6]||(e[6]=Object(r["E"])((function(){}),["stop"]))},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.backgrounds,(function(t,e){return Object(r["p"])(),Object(r["g"])("option",{value:e,key:e},Object(r["x"])(t.name),9,["value"])})),128))],544),[[r["z"],t.poemBackground]]),Object(r["D"])(Object(r["k"])("select",{"onUpdate:modelValue":e[7]||(e[7]=function(e){return t.poemStyle=e}),onKeydown:e[8]||(e[8]=Object(r["E"])((function(){}),["stop"]))},[(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.poemTextStyles,(function(t,e){return Object(r["p"])(),Object(r["g"])("option",{value:e,key:e},Object(r["x"])(t.name),9,["value"])})),128))],544),[[r["z"],t.poemStyle]])],64)):Object(r["h"])("",!0)]})),_:1},8,["object","title","textHandler"])})),vs=oe(),ms=Object(r["m"])({mixins:[q],components:{Toggle:U["a"],ObjectTool:bo},data:function(){return{textEditor:!1}},computed:{backgrounds:function(){return Ic},poemTextStyles:function(){return Uc},object:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("poem"===t.type)return t},textHandler:function(){var t=this;if(this.textEditor)return{title:"Text",get:function(){return t.text},set:function(e){t.text=e},leave:function(){t.textEditor=!1}}},text:vs("text","objects/setPoemText"),autoWrap:vs("autoWrap","objects/setAutoWrapping"),poemStyle:vs("font","objects/setPoemFont"),poemBackground:vs("background","objects/setPoemBackground")}});n("dddf");ms.render=fs,ms.__scopeId="data-v-2a8686c0";var js=ms,gs=Object(r["m"])({components:{SettingsPanel:et,AddPanel:xt,BackgroundsPanel:pi,CreditsPanel:Va,CharacterPanel:vo,TextBoxPanel:Go,ChoicePanel:ta,SpritePanel:go,ContentPacksPanel:wi,PanelsPanel:os,NotificationPanel:ds,PoemPanel:js},data:function(){return{panelSelection:"add"}},computed:{vertical:function(){return this.$store.state.ui.vertical},selection:function(){return this.$store.state.ui.selection},panel:function(){if("selection"===this.panelSelection){if(null!==this.selection){var t=this.$store.state.objects.objects[this.selection];return t.type}this.panelSelection="add"}return this.panelSelection},hasPrevRender:function(){return null!==this.$store.state.ui.lastDownload}},methods:{create:function(){var t=this;G["a"].onPanelChange((function(e){t.panelSelection=e}))},setPanel:function(t){if(t===this.panelSelection&&(t="add"),this.panelSelection=t,this.selection){if(null===this.$store.state.ui.selection)return;this.$store.commit("ui/setSelection",null)}}},watch:{selection:function(t){t?this.panelSelection="selection":"selection"===this.panelSelection&&(this.panelSelection="add")}}});n("3672");gs.render=k;var Os=gs,ks=Object(r["F"])("data-v-51633a54");Object(r["r"])("data-v-51633a54");var ys={key:0};Object(r["q"])();var ws=ks((function(t,e,n,o,a,i){return Object(r["p"])(),Object(r["g"])("div",{id:"messageConsole",class:{vertical:t.vertical}},[t.showLoading?(Object(r["p"])(),Object(r["g"])("p",ys,"Loading...")):Object(r["h"])("",!0),(Object(r["p"])(!0),Object(r["g"])(r["a"],null,Object(r["u"])(t.messages,(function(t,e){return Object(r["p"])(),Object(r["g"])("p",{key:t+"_"+e},Object(r["x"])(t),1)})),128))],2)})),xs=5e3,Cs=2e4,Ss=100,Rs=Object(r["m"])({props:{loading:{default:!1,type:Boolean}},data:function(){return{messages:[],showLoading:!1,showLoadingTimeout:0,hideLoadingTimeout:0}},computed:{vertical:function(){return this.$store.state.ui.vertical}},created:function(){var t=this;this.onLoadingChange(this.loading),_n["g"].subscribe(_n["a"],(function(e){t.messages.push("Failed to load asset '".concat(e.path,"'")),setTimeout((function(){t.messages.shift()}),xs)})),_n["g"].subscribe(_n["c"],(function(e){t.messages.push("Failed to load custom asset. Try to download it manually and then upload it."),setTimeout((function(){t.messages.shift()}),Cs)})),_n["g"].subscribe(_n["e"],(function(e){t.messages.push(e.message),setTimeout((function(){t.messages.shift()}),Cs)})),_n["g"].subscribe(_n["f"],(function(e){t.messages.push(e.error.name),t.messages.push(JSON.stringify(e.error.stack)),t.messages.push(e.info),setTimeout((function(){t.messages.shift(),t.messages.shift(),t.messages.shift()}),Cs)}))},methods:{onLoadingChange:function(t){var e=this;t?(this.hideLoadingTimeout&&(clearTimeout(this.hideLoadingTimeout),this.hideLoadingTimeout=0),this.showLoading||this.showLoadingTimeout||(this.showLoadingTimeout=setTimeout((function(){e.showLoading=!0,e.showLoadingTimeout=0}),Ss))):(this.showLoadingTimeout&&(clearTimeout(this.showLoadingTimeout),this.showLoadingTimeout=0),this.showLoading&&!this.hideLoadingTimeout&&(this.hideLoadingTimeout=setTimeout((function(){e.showLoading=!1,e.hideLoadingTimeout=0}),Ss)))}},watch:{loading:function(t){this.onLoadingChange(t)}}});n("13f8");Rs.render=ws,Rs.__scopeId="data-v-51633a54";var Ps=Rs;function Is(t,e,n,o,a,i){return Object(r["p"])(),Object(r["g"])("canvas",{id:"scaled_display",ref:"sd",height:t.bitmapHeight,width:t.bitmapWidth,style:{width:t.canvasWidth+"px",height:t.canvasHeight+"px",cursor:t.cursor},draggable:"true",onClick:e[1]||(e[1]=function(){return t.onUiClick.apply(t,arguments)}),onTouchstart:e[2]||(e[2]=function(){return t.onTouchStart.apply(t,arguments)}),onDragstart:e[3]||(e[3]=function(){return t.onDragStart.apply(t,arguments)}),onTouchmove:e[4]||(e[4]=function(){return t.onSpriteDragMove.apply(t,arguments)}),onMousemove:e[5]||(e[5]=function(){return t.onSpriteDragMove.apply(t,arguments)}),onTouchend:e[6]||(e[6]=function(){return t.onSpriteDrop.apply(t,arguments)}),onMouseup:e[7]||(e[7]=function(){return t.onSpriteDrop.apply(t,arguments)}),onDragover:e[8]||(e[8]=function(){return t.onDragOver.apply(t,arguments)}),onDrop:e[9]||(e[9]=function(){return t.onDrop.apply(t,arguments)}),onMouseenter:e[10]||(e[10]=function(){return t.onMouseEnter.apply(t,arguments)})},"HTML5 is required to use the Doki Doki Dialog Generator.",44,["height","width"])}var Ts=n("6ae4"),As=Object(r["m"])({props:{canvasWidth:{default:0},canvasHeight:{default:0}},data:function(){return{sdCtx:null,currentlyRendering:!1,queuedRender:null,showingLast:!1,dropSpriteCount:0,dropPreventClick:!1,draggedObject:null,dragXOffset:0,dragYOffset:0,dragXOriginal:0,dragYOriginal:0}},computed:{selection:function(){return this.$store.state.ui.selection},lqRendering:function(){return this.$store.state.ui.lqRendering},sceneRender:function(){return new Xc(this.$store,this.$store.state.panels.currentPanel,this.bitmapWidth,this.bitmapHeight)},bitmapHeight:function(){return Te["c"]},bitmapWidth:function(){return Te["d"]},pickerMode:function(){return this.$store.state.ui.pickColor},cursor:function(){return this.pickerMode?"crosshair":"default"}},methods:{download:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.sceneRender.download();case 2:n=e.sent,t.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=t.$store.state.ui.lastDownload,t.$store.commit("ui/setLastDownload",n),r&&URL.revokeObjectURL(r);case 3:case"end":return e.stop()}}),e)}))));case 4:case"end":return e.stop()}}),e)})))()},invalidateRender:function(){var t=this;this.queuedRender||(this.queuedRender=requestAnimationFrame((function(){return t.render_()})))},render_:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.queuedRender&&(cancelAnimationFrame(t.queuedRender),t.queuedRender=null),!t.$store.state.unsafe){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,t.sceneRender.render(!t.lqRendering,!0);case 5:t.display();case 6:case"end":return e.stop()}}),e)})))()},renderLoadingScreen:function(){if(this.sdCtx){var t=document.createElement("canvas");t.height=this.bitmapHeight,t.width=this.bitmapWidth;var e=Ts["a"].make(t,!0,!1);e.drawText({text:"Starting...",x:t.width/2,y:t.height/2,align:"center",outline:{width:5,style:"#b59"},font:"32px riffic",fill:{style:"white"}}),this.sdCtx.drawImage(t,this.canvasWidth,this.canvasHeight)}},display:function(){this.sdCtx&&(this.showingLast=!1,this.sceneRender.paintOnto(this.sdCtx,{x:0,y:0,w:this.bitmapWidth,h:this.bitmapHeight}))},toRendererCoordinate:function(t,e){var n=this.$refs.sd,r=t-n.offsetLeft,o=e-n.offsetTop,a=r/n.offsetWidth*n.width,i=o/n.offsetWidth*n.width;return[a,i]},onUiClick:function(t){var e=this,n=this.toRendererCoordinate(t.clientX,t.clientY),r=Object(l["a"])(n,2),o=r[0],a=r[1];if(this.pickerMode){var i=this.sdCtx.getImageData(o,a,1,1).data,c="rgba(".concat(i[0].toString(),",").concat(i[1].toString(),",").concat(i[2].toString(),",").concat((i[3]/255).toString(),")");this.vuexHistory.transaction((function(){e.$store.commit("ui/setColorPicker",!1),_n["g"].fire(new _n["b"](c))}))}else if(this.dropPreventClick)this.dropPreventClick=!1;else{var s,u=this.sceneRender.objectsAt(o,a),d=u.findIndex((function(t){return t===e.selection}));s=0===d?null:-1!==d?u[d-1]:u[u.length-1]||null,this.$store.state.ui.selection!==s&&this.vuexHistory.transaction((function(){e.$store.commit("ui/setSelection",s)}))}},onDragStart:function(t){if(t.preventDefault(),this.selection){this.draggedObject=this.$store.state.objects.objects[this.selection];var e=this.toRendererCoordinate(t.clientX,t.clientY),n=Object(l["a"])(e,2),r=n[0],o=n[1];this.dragXOffset=r-this.draggedObject.x,this.dragYOffset=o-this.draggedObject.y,this.dragXOriginal=this.draggedObject.x,this.dragYOriginal=this.draggedObject.y}},onTouchStart:function(t){if(this.selection){this.draggedObject=this.$store.state.objects.objects[this.selection];var e=this.toRendererCoordinate(t.touches[0].clientX,t.touches[0].clientY),n=Object(l["a"])(e,2),r=n[0],o=n[1];this.dragXOffset=r-this.draggedObject.x,this.dragYOffset=o-this.draggedObject.y,this.dragXOriginal=this.draggedObject.x,this.dragYOriginal=this.draggedObject.y}},onDragOver:function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"},onSpriteDragMove:function(t){var e=this;if(this.draggedObject){t.preventDefault();var n=t instanceof MouseEvent?this.toRendererCoordinate(t.clientX,t.clientY):this.toRendererCoordinate(t.touches[0].clientX,t.touches[0].clientY),r=Object(l["a"])(n,2),o=r[0],a=r[1];o-=this.dragXOffset,a-=this.dragYOffset;var i=Math.abs(o-this.dragXOriginal),c=Math.abs(a-this.dragYOriginal);i+c>1&&(this.dropPreventClick=!0),t.shiftKey&&(i>c?a=this.dragYOriginal:o=this.dragXOriginal),this.vuexHistory.transaction((function(){e.$store.dispatch("objects/setPosition",{id:e.draggedObject.id,x:o,y:a})}))}},onDrop:function(t){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.stopPropagation(),t.preventDefault(),t.dataTransfer){n.next=4;break}return n.abrupt("return");case 4:r=Object(bt["a"])(t.dataTransfer.items);try{for(r.s();!(o=r.n()).done;)a=o.value,"file"===a.kind&&a.type.match(/image.*/)&&function(){var t="dropCustomAsset"+ ++e.dropSpriteCount,n=Object(ht["f"])(t,a.getAsFile());e.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("objects/createSprite",{assets:[{hq:n,lq:n,sourcePack:"dddg.generated.uploaded-sprites"}]});case 2:case"end":return t.stop()}}),t)}))))}()}catch(i){r.e(i)}finally{r.f()}case 6:case"end":return n.stop()}}),n)})))()},onSpriteDrop:function(t){this.draggedObject&&("TouchEvent"in window&&t instanceof TouchEvent&&(this.dropPreventClick=!1),this.draggedObject=null)},onMouseEnter:function(t){1!==t.buttons&&(this.draggedObject=null)}},watch:{canvasWidth:function(){this.display()},canvasHeight:function(){this.display()}},created:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:_n["g"].subscribe(_n["d"],(function(){return t.invalidateRender()})),t.$store.subscribe((function(e){"panels/setPanelPreview"!==e.type&&"panels/currentPanel"!==e.type&&t.invalidateRender()}));case 2:case"end":return e.stop()}}),e)})))()},mounted:function(){var t=this.$refs.sd;this.sdCtx=t.getContext("2d"),this.renderLoadingScreen(),this.invalidateRender()}});As.render=Is;var _s=As,$s=n("4918"),Ds=16/9,Hs=20,Vs=50,Es=200,Bs={"dddg.buildin.backgrounds.nsfw":"".concat("","packs/buildin.base.backgrounds.nsfw.json"),"dddg.buildin.sayori.nsfw":"".concat("","packs/buildin.base.sayori.nsfw.json"),"dddg.buildin.base.natsuki.nsfw":"".concat("","packs/buildin.base.natsuki.nsfw.json"),"dddg.buildin.yuri.nsfw":"".concat("","packs/buildin.base.yuri.nsfw.json")},Fs=new Set(Object.keys(Bs)),Ls=Object.values(Bs),Ms=Object(r["m"])({components:{ToolBox:Os,MessageConsole:Ps,Render:_s,ModalDialog:Z,SingleBox:Object(r["l"])((function(){return n.e("chunk-60772680").then(n.bind(null,"dcb9"))})),ExpressionBuilder:Object(r["l"])((function(){return n.e("chunk-73a8933a").then(n.bind(null,"d785"))}))},data:function(){return{canvasWidth:0,canvasHeight:0,blendOver:null,uiSize:192,currentlyRendering:!1,panel:"",dialogVisable:!1,canvasTooSmall:!1,expressionBuilderVisible:!1,expressionBuilderCharacter:"",expressionBuilderHeadGroup:void 0,systemPrefersDarkMode:!1}},computed:{isSafari:function(){return!1},useDarkTheme:function(){var t;return null!==(t=this.userPrefersDarkMode)&&void 0!==t?t:this.systemPrefersDarkMode},userPrefersDarkMode:function(){return this.$store.state.ui.useDarkTheme},nsfw:function(){return this.$store.state.ui.nsfw}},methods:{drawLastDownload:function(){var t=this.$store.state.ui.lastDownload;t&&this.$refs.render.blendOver(t)},setBlendOver:function(){this.blendOver=this.$store.state.ui.lastDownload},optimum:function(t,e){var n=t/Ds,r=e*Ds;return n>e?n=e:r=t,[r,n]},optimizeWithMenu:function(t,e){var n=this.optimum(t,e-this.uiSize),r=this.optimum(t-this.uiSize,e);return!this.isSafari&&n[0]*n[1]>r[0]*r[1]?[n[0],n[1],!1]:[r[0],r[1],!0]},updateArea:function(){var t=this.optimizeWithMenu(document.documentElement.clientWidth,document.documentElement.clientHeight),e=Object(l["a"])(t,3),n=e[0],r=e[1],o=e[2];this.canvasWidth=n,this.canvasHeight=r,this.canvasTooSmall=Math.max(n,r)<Es,this.$store.state.ui.vertical!==o&&this.$store.commit("ui/setVertical",o)},showDialog:function(t){var e=this;if(this.dialogVisable=!0,t){var n=function n(){e.$refs.packDialog&&e.$refs.packDialog.$refs.packDialog?e.$refs.packDialog.$refs.packDialog.setSearch(t):setTimeout(n,Vs)};this.$nextTick(n)}},showExpressionDialog:function(t){this.expressionBuilderVisible=!0,this.expressionBuilderCharacter=t.character,this.expressionBuilderHeadGroup=t.headGroup},onKeydown:function(t){var e=this;t.target instanceof HTMLInputElement||t.target instanceof HTMLTextAreaElement?console.log("skip keydown on potential target"):this.vuexHistory.transaction((function(){var n=e.$store.state.objects.objects[e.$store.state.ui.selection];if(t.ctrlKey){if("z"===t.key)return void t.preventDefault();if("y"===t.key)return void t.preventDefault();if("v"===t.key)return e.$store.dispatch("objects/pasteObjectFromClipboard",{}),void t.preventDefault()}if(n)if("Delete"!==t.key){if("c"===t.key||"x"===t.key)return e.$store.dispatch("objects/copyObjectToClipboard",{id:n.id}),"x"===t.key&&e.$store.dispatch("objects/removeObject",{id:n.id}),void t.preventDefault();if("character"===n.type){var r=n;if(!r.freeMove){if("ArrowLeft"===t.key)return void e.$store.dispatch("objects/shiftCharacterSlot",{id:r.id,delta:-1});if("ArrowRight"===t.key)return void e.$store.dispatch("objects/shiftCharacterSlot",{id:r.id,delta:1})}}var o=n.x,a=n.y;if("ArrowLeft"===t.key)o-=t.shiftKey?1:Hs;else if(n&&"ArrowRight"===t.key)o+=t.shiftKey?1:Hs;else if(n&&"ArrowUp"===t.key)a-=t.shiftKey?1:Hs;else{if(!n||"ArrowDown"!==t.key)return;a+=t.shiftKey?1:Hs}e.$store.dispatch("objects/setPosition",{id:n.id,x:o,y:a})}else e.$store.dispatch("objects/removeObject",{id:n.id})}))},destroyed:function(){window.removeEventListener("keydown",this.onKeydown)},applyTheme:function(){document.body.classList.toggle("dark-theme",this.useDarkTheme)}},watch:{systemPrefersDarkMode:function(){this.applyTheme()},userPrefersDarkMode:function(){this.applyTheme()},nsfw:function(t){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t){n.next=5;break}return n.next=3,e.$store.dispatch("content/loadContentPacks",Ls);case 3:n.next=7;break;case 5:return n.next=7,e.$store.dispatch("removePacks",{packs:Fs});case 7:case"end":return n.stop()}}),n)})))()}},mounted:function(){var t=this;if(window.addEventListener("keypress",(function(e){"Escape"===e.key&&t.vuexHistory.transaction((function(){null!==t.$store.state.ui.selection&&t.$store.commit("ui/setSelection",null)}))})),window.matchMedia){var e=window.matchMedia("(prefers-color-scheme: dark)");this.systemPrefersDarkMode=e.matches,e.addListener((function(e){t.systemPrefersDarkMode=e.matches}))}},created:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.updateArea(),$s["a"].setStore(t.$store),window.addEventListener("resize",t.updateArea),window.removeEventListener("keydown",t.onKeydown),window.addEventListener("keydown",t.onKeydown),window.app=t,window.store=t.$store,window.env=G["a"],document.body.addEventListener("drop",(function(t){t.preventDefault()}),!0),document.body.addEventListener("dragover",(function(t){t.preventDefault()}),!0),e.next=12,G["a"].loadSettings();case 12:n=e.sent,t.vuexHistory.transaction(Object(u["a"])(regeneratorRuntime.mark((function e(){var r,o,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.$store.commit("ui/setLqRendering",null!==(r=n.lq)&&void 0!==r&&r),t.$store.commit("ui/setDarkTheme",null!==(o=n.darkMode)&&void 0!==o?o:null),t.$store.commit("ui/setDefaultCharacterTalkingZoom",null===(a=n.defaultCharacterTalkingZoom)||void 0===a||a),e.next=5,t.$store.dispatch("content/loadContentPacks",["".concat("","packs/buildin.base.backgrounds.json"),"".concat("","packs/buildin.base.monika.json"),"".concat("","packs/buildin.base.sayori.json"),"".concat("","packs/buildin.base.natsuki.json"),"".concat("","packs/buildin.base.yuri.json"),"".concat("","packs/buildin.extra.mc.json"),"".concat("","packs/buildin.extra.mc_chad.json"),"".concat("","packs/buildin.extra.mc_classic.json"),"".concat("","packs/buildin.extra.femc.json"),"".concat("","packs/buildin.extra.classic_amy.json"),"".concat("","packs/buildin.extra.amy.json")]);case 5:return e.next=7,t.$store.dispatch("panels/createPanel");case 7:return 0===Object.keys(t.$store.state.objects.objects).length&&t.$store.dispatch("objects/createTextBox",{}),e.next=10,t.$store.commit("panels/setCurrentBackground",{current:"dddg.buildin.backgrounds:ddlc.clubroom",panelId:t.$store.state.panels.currentPanel});case 10:return e.next=12,t.$store.commit("ui/setNsfw",null!==(i=n.nsfw)&&void 0!==i&&i);case 12:case"end":return e.stop()}}),e)}))));case 14:case"end":return e.stop()}}),e)})))()}});n("2286");Ms.render=s;var Ns=Ms,Ws=n("5502"),Us=n("6289"),zs={},qs=0,Gs={createSprite:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.commit,o=t.rootState,n.next=3,Object(ht["a"])(e.assets[0],!1);case 3:if(a=n.sent,a instanceof HTMLImageElement){n.next=6;break}return n.abrupt("return");case 6:r("create",{object:Object(Qt["a"])(Object(Qt["a"])({},Object(Us["a"])()),{},{assets:e.assets,height:a.height,width:a.width,id:"sprite_"+ ++qs,panelId:o.panels.currentPanel,onTop:!1,preserveRatio:!0,ratio:a.width/a.height,type:"sprite",y:0,enlargeWhenTalking:o.ui.defaultCharacterTalkingZoom})});case 7:case"end":return n.stop()}}),n)})))()}},Ys={setChoices:function(t,e){var n=t.objects[e.id];n.choices=e.choices,++n.version},setChoiceColor:function(t,e){var n=t.objects[e.id];n.customColor=e.customColor,++n.version},setChoiceDistance:function(t,e){var n=t.objects[e.id];n.choiceDistance=e.choiceDistance,++n.version},setAutoWrapping:function(t,e){var n=t.objects[e.id];n.autoWrap=e.autoWrap,++n.version}},Ks=0,Xs={createChoice:function(t,e){var n=t.commit,r=t.rootState,o="choice_"+ ++Ks;return n("create",{object:Object(Qt["a"])(Object(Qt["a"])({},Object(Us["a"])()),{},{y:Oc,width:vc,height:0,panelId:r.panels.currentPanel,id:o,onTop:!0,autoWrap:!0,type:"choice",preserveRatio:!1,ratio:Fr/Mr,choiceDistance:mc,choices:[{selected:!1,text:"Click here to edit choice"}],customColor:hc})}),o},addChoice:function(t,e){var n=t.state,r=t.commit,o=n.objects[e.id];r("setChoices",{id:e.id,choices:[].concat(Object(wn["a"])(o.choices),[{selected:!1,text:e.text}])})},removeChoice:function(t,e){var n=t.state,r=t.commit,o=n.objects[e.id],a=Object(wn["a"])(o.choices);a[e.choiceIdx]&&(a.splice(e.choiceIdx,1),0===a.length&&a.push({selected:!1,text:""}),r("setChoices",{id:e.id,choices:a}))},setChoiceText:function(t,e){var n=t.state,r=t.commit,o=n.objects[e.id],a=Object(wn["a"])(o.choices);a[e.choiceIdx]&&(a[e.choiceIdx].text=e.text,r("setChoices",{id:e.id,choices:a}))}},Js=n("8cae"),Zs=4,Qs={setText:function(t,e){var n=t.objects[e.id];n.text=e.text,++n.version},setTalkingObject:function(t,e){var n=t.objects[e.id];n.talkingObjId=e.talkingObjId,++n.version},setTalkingOther:function(t,e){var n=t.objects[e.id];n.talkingOther=e.talkingOther,n.talkingObjId="$other$",++n.version},setStyle:function(t,e){var n=t.objects[e.id];n.style=e.style,++n.version},setControlsVisible:function(t,e){var n=t.objects[e.id];n.controls=e.controls,++n.version},setControlsColor:function(t,e){var n=t.objects[e.id];n.customControlsColor=e.customControlsColor,++n.version},setDeriveCustomColors:function(t,e){var n=t.objects[e.id];n.deriveCustomColors=e.deriveCustomColors,++n.version},setNameboxColor:function(t,e){var n=t.objects[e.id];n.customNameboxColor=e.customNameboxColor,++n.version},setNameboxStroke:function(t,e){var n=t.objects[e.id];n.customNameboxStroke=e.customNameboxStroke,++n.version},setNameboxWidth:function(t,e){var n=t.objects[e.id];n.customNameboxWidth=e.customNameboxWidth,++n.version},setSkipable:function(t,e){var n=t.objects[e.id];n.skip=e.skip,++n.version},setContinueArrow:function(t,e){var n=t.objects[e.id];n.continue=e.continue,++n.version},setCustomColor:function(t,e){var n=t.objects[e.id];n.customColor=e.color,++n.version},setAutoQuoting:function(t,e){var n=t.objects[e.id];n.autoQuoting=e.autoQuoting,++n.version},setAutoWrapping:function(t,e){var n=t.objects[e.id];n.autoWrap=e.autoWrap,++n.version},setResetBounds:function(t,e){var n=t.objects[e.id];n.resetBounds=e.resetBounds,n.x=e.resetBounds.x,n.y=e.resetBounds.y,n.height=e.resetBounds.height,n.width=e.resetBounds.width,n.rotation=e.resetBounds.rotation,++n.version},setColorOverride:function(t,e){var n=t.objects[e.id];n.overrideColor=e.overrideColor,++n.version}},tu=0,eu={createTextBox:function(t,e){var n=t.commit,r=t.rootState,o="textBox_"+ ++tu,a=e.resetBounds||{x:Te["d"]/2,y:co,width:Fr,height:Mr,rotation:0};return n("create",{object:Object(Qt["a"])(Object(Qt["a"])(Object(Qt["a"])({},Object(Us["a"])()),a),{},{panelId:r.panels.currentPanel,id:o,onTop:!0,type:"textBox",preserveRatio:!1,ratio:Fr/Mr,continue:!0,controls:!0,skip:!0,autoQuoting:!0,autoWrap:!0,style:"normal",overrideColor:!1,customColor:yr,deriveCustomColors:!0,customControlsColor:wr,customNameboxColor:xr,customNameboxWidth:168,customNameboxStroke:Cr,talkingObjId:null,talkingOther:"",text:"",resetBounds:a})}),o},setStyle:function(t,e){var n=t.commit;n("setStyle",{id:e.id,style:e.style})},resetTextboxBounds:function(t,e){var n=t.commit,r=t.state,o=r.objects[e.id];n("setPosition",{id:e.id,x:o.resetBounds.x,y:o.resetBounds.y}),n("setSize",{id:e.id,height:o.resetBounds.height,width:o.resetBounds.width}),n("setRotation",{id:e.id,rotation:o.resetBounds.rotation})},splitTextbox:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,a,i,c,s,u,l,d,p;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.commit,o=t.state,a=t.dispatch,i=o.objects[e.id],c=(i.width-Zs)/2,s=c/2+Zs/2,u=[i.x,i.y],l=[i.x-s,i.y],d=[i.x+s,i.y],0!==i.rotation&&(l=Object(Js["a"])(l[0],l[1],u[0],u[1],i.rotation/180*Math.PI),d=Object(Js["a"])(d[0],d[1],u[0],u[1],i.rotation/180*Math.PI)),r("setResetBounds",{id:e.id,resetBounds:{x:l[0],y:l[1],width:c,height:i.height,rotation:i.rotation}}),r("setStyle",{id:e.id,style:"custom"}),n.next=12,a("createTextBox",{resetBounds:{x:d[0],y:d[1],width:c,height:i.height,rotation:i.rotation}});case 12:p=n.sent,r("setStyle",{id:p,style:"custom"}),i.flip&&r("setFlip",{id:p,flip:i.flip});case 15:case"end":return n.stop()}}),n)})))()}},nu={setNotificationColor:function(t,e){var n=t.objects[e.id];n.customColor=e.customColor,++n.version},setNotificationText:function(t,e){var n=e.id,r=e.text,o=t.objects[n];o.text=r,++o.version},setNotificationBackdrop:function(t,e){var n=e.id,r=e.backdrop,o=t.objects[n];o.backdrop=r,++o.version},setAutoWrapping:function(t,e){var n=t.objects[e.id];n.autoWrap=e.autoWrap,++n.version}},ru=0,ou={createNotification:function(t,e){var n=t.commit,r=t.rootState,o="notification_"+ ++ru;return n("create",{object:Object(Qt["a"])(Object(Qt["a"])({},Object(Us["a"])()),{},{y:Te["c"]/2,width:vc,height:0,panelId:r.panels.currentPanel,autoWrap:!1,id:o,onTop:!0,type:"notification",preserveRatio:!1,ratio:Fr/Mr,customColor:hc,text:"Click here to edit notification",backdrop:!0})}),o}},au={setPoemBackground:function(t,e){var n=e.id,r=e.background,o=t.objects[n];o.background=r,++o.version},setPoemFont:function(t,e){var n=e.id,r=e.font,o=t.objects[n];o.font=r,++o.version},setPoemText:function(t,e){var n=e.id,r=e.text,o=t.objects[n];o.text=r,++o.version},setAutoWrapping:function(t,e){var n=t.objects[e.id];n.autoWrap=e.autoWrap,++n.version}},iu=0,cu={createPoem:function(t,e){var n=t.commit,r=t.rootState,o="poem_"+ ++iu;return n("create",{object:{subType:"poem",x:_c,y:$c,width:Vc,height:Ec,panelId:r.panels.currentPanel,flip:!1,rotation:0,id:o,onTop:!0,opacity:100,type:"poem",version:0,preserveRatio:!1,autoWrap:!0,ratio:Vc/Ec,background:Tc,font:Ac,text:"New poem\n\nClick here to edit poem",composite:"source-over",filters:[],label:null,textboxColor:null,enlargeWhenTalking:!0,nameboxWidth:null,zoom:1}}),o},createConsole:function(t,e){var n=t.commit,r=t.rootState,o="poem_"+ ++iu;return n("create",{object:Object(Qt["a"])(Object(Qt["a"])({},Object(Us["a"])()),{},{subType:"console",x:Fc/2,y:Lc/2,width:Fc,height:Lc,panelId:r.panels.currentPanel,id:o,onTop:!0,type:"poem",preserveRatio:!1,ratio:Fc/Lc,background:Mc,font:Nc,text:"> _\n  \n  Console command\n  Click here to edit",autoWrap:!0})}),o}},su=0,uu={namespaced:!0,state:{objects:{},panels:{}},mutations:Object(Qt["a"])(Object(Qt["a"])(Object(Qt["a"])(Object(Qt["a"])(Object(Qt["a"])(Object(Qt["a"])({create:function(t,e){var n=e.object;t.panels[n.panelId]||(t.panels[n.panelId]={id:n.panelId,onTopOrder:[],order:[]});var r=t.panels[n.panelId],o=n.onTop?r.onTopOrder:r.order;t.objects[n.id]=n,o.push(n.id)},removeFromList:function(t,e){var n=t.objects[e.id],r=t.panels[n.panelId],o=e.onTop?r.onTopOrder:r.order,a=o.indexOf(e.id);o.splice(a,1)},addToList:function(t,e){var n=t.objects[e.id],r=t.panels[n.panelId],o=e.onTop?r.onTopOrder:r.order;o.splice(e.position,0,e.id)},setOnTop:function(t,e){var n=t.objects[e.id];n.onTop=e.onTop},setPosition:function(t,e){var n=t.objects[e.id];n.x=e.x,n.y=e.y},setFlip:function(t,e){var n=t.objects[e.id];n.flip=e.flip},setSize:function(t,e){var n=t.objects[e.id];n.width=e.width,n.height=e.height},setRatio:function(t,e){var n=t.objects[e.id];n.preserveRatio=e.preserveRatio,n.ratio=e.ratio},setRotation:function(t,e){var n=t.objects[e.id];n.rotation=e.rotation<0?360-Math.abs(e.rotation)%360:e.rotation%360},removeObject:function(t,e){var n=t.objects[e.id];delete t.objects[e.id];var r=t.panels[n.panelId];0===r.onTopOrder.length&&0===r.order.length&&delete t.panels[n.panelId]},setComposition:function(t,e){var n=t.objects[e.id];n.composite=e.composite},setFilters:function(t,e){var n=t.objects[e.id];n.filters=e.filters},setLabel:function(t,e){var n=t.objects[e.id];n.label=e.label},setTextboxColor:function(t,e){var n=t.objects[e.id];n.textboxColor=e.textboxColor},setEnlargeWhenTalking:function(t,e){var n=t.objects[e.id];n.enlargeWhenTalking=e.enlargeWhenTalking,++n.version},setObjectNameboxWidth:function(t,e){var n=t.objects[e.id];n.nameboxWidth=e.nameboxWidth,++n.version},setObjectZoom:function(t,e){var n=t.objects[e.id];n.zoom=e.zoom,++n.version}},zs),Ht["b"]),Qs),Ys),nu),au),actions:Object(Qt["a"])(Object(Qt["a"])(Object(Qt["a"])(Object(Qt["a"])(Object(Qt["a"])(Object(Qt["a"])({removeObject:function(t,e){var n=t.state,r=t.commit,o=t.rootState,a=n.objects[e.id],i=n.panels[a.panelId];o.ui.selection===e.id&&r("ui/setSelection",null,{root:!0});for(var c=0,s=[].concat(Object(wn["a"])(i.onTopOrder),Object(wn["a"])(i.order));c<s.length;c++){var u=s[c],l=n.objects[u];a.id!==u&&"textBox"===l.type&&(l.talkingObjId===a.id&&r("setTalkingOther",{id:l.id,talkingOther:a.label||""}))}r("removeFromList",{id:e.id,onTop:a.onTop}),r("removeObject",{id:e.id})},setPosition:function(t,e){var n=t.state,r=t.commit,o=t.dispatch,a=n.objects[e.id];"character"===a.type?o("setCharacterPosition",e):r("setPosition",e)},setOnTop:function(t,e){var n=t.state,r=t.commit,o=n.objects[e.id],a=n.panels[o.panelId];o.onTop!==e.onTop&&(r("removeFromList",{id:e.id,onTop:o.onTop}),r("addToList",{id:e.id,position:(e.onTop?a.onTopOrder:a.order).length,onTop:e.onTop}),r("setOnTop",{id:e.id,onTop:e.onTop}))},shiftLayer:function(t,e){var n=t.state,r=t.commit,o=n.objects[e.id],a=n.panels[o.panelId],i=o.onTop?a.onTopOrder:a.order,c=i.indexOf(o.id),s=c+e.delta;s<0&&(s=0),s>i.length&&(s=i.length),r("removeFromList",{id:e.id,onTop:o.onTop}),r("addToList",{id:e.id,position:s,onTop:o.onTop})},setPreserveRatio:function(t,e){var n=t.commit,r=t.state,o=r.objects[e.id],a=e.preserveRatio?o.width/o.height:0;n("setRatio",{id:e.id,preserveRatio:e.preserveRatio,ratio:a})},setWidth:function(t,e){var n=t.commit,r=t.state,o=r.objects[e.id],a=o.preserveRatio?e.width/o.ratio:o.height;n("setSize",{id:e.id,height:a,width:e.width})},setHeight:function(t,e){var n=t.commit,r=t.state,o=r.objects[e.id],a=o.preserveRatio?e.height*o.ratio:o.width;n("setSize",{id:e.id,height:e.height,width:a})},fixContentPackRemoval:function(t,e){Object.values(t.state.objects).map((function(n){switch(n.type){case"character":return void Object(Ht["d"])(t,n.id,e);case"sprite":return;case"textBox":return}}))},copyObjects:function(t,e){var n=t.commit,r=t.state,o=e.sourcePanelId,a=e.targetPanelId,i=r.panels[o];if(i){var c,s=[].concat(Object(wn["a"])(i.onTopOrder),Object(wn["a"])(i.order)),u=new Map,l=Object(bt["a"])(s);try{for(l.s();!(c=l.n()).done;){var d=c.value,p="copy_".concat(++su);u.set(d,p)}}catch(g){l.e(g)}finally{l.f()}var b,h=Object(bt["a"])(s);try{for(h.s();!(b=h.n()).done;){var f=b.value,v=r.objects[f],m=JSON.parse(JSON.stringify(v));if("talkingObjId"in m){var j=m;null!==j.talkingObjId&&u.has(j.talkingObjId)&&(j.talkingObjId=u.get(j.talkingObjId))}n("create",{object:Object(Qt["a"])(Object(Qt["a"])({},m),{},{id:u.get(f),panelId:a})})}}catch(g){h.e(g)}finally{h.f()}}},copyObjectToClipboard:function(t,e){var n=t.commit,r=t.state,o=e.id,a=r.objects[o];n("ui/setClipboard",JSON.stringify(a),{root:!0})},pasteObjectFromClipboard:function(t){var e=t.commit,n=t.rootState;if(n.ui.clipboard){var r=JSON.parse(n.ui.clipboard);e("create",{object:Object(Qt["a"])(Object(Qt["a"])({},r),{},{id:"copy_".concat(++su),panelId:n.panels.currentPanel})})}},deleteAllOfPanel:function(t,e){for(var n=t.state,r=t.dispatch,o=e.panelId,a=n.panels[o],i=0,c=[].concat(Object(wn["a"])(a.onTopOrder),Object(wn["a"])(a.order));i<c.length;i++){var s=c[i];r("removeObject",{id:s})}},addFilter:function(t,e){var n=t.state,r=t.commit;Bn(e,(function(t){return n.objects[t]}),(function(t){return r("setFilters",t)}))},removeFilter:function(t,e){var n=t.state,r=t.commit;Fn(e,(function(t){return n.objects[t]}),(function(t){return r("setFilters",t)}))},moveFilter:function(t,e){var n=t.state,r=t.commit;Ln(e,(function(t){return n.objects[t]}),(function(t){return r("setFilters",t)}))},setFilter:function(t,e){var n=t.state,r=t.commit;Mn(e,(function(t){return n.objects[t]}),(function(t){return r("setFilters",t)}))}},Gs),Ht["a"]),eu),Xs),ou),cu)},lu={namespaced:!0,state:{vertical:!1,lqRendering:!0,nsfw:!1,selection:null,lastDownload:null,clipboard:null,useDarkTheme:null,defaultCharacterTalkingZoom:!0,pickColor:!1},mutations:{setVertical:function(t,e){t.vertical=e},setNsfw:function(t,e){t.nsfw=e},setLqRendering:function(t,e){t.lqRendering=e},setSelection:function(t,e){t.selection=e},setLastDownload:function(t,e){t.lastDownload=e},setClipboard:function(t,e){t.clipboard=e},setDarkTheme:function(t,e){t.useDarkTheme=e},setDefaultCharacterTalkingZoom:function(t,e){t.defaultCharacterTalkingZoom=e},setColorPicker:function(t,e){t.pickColor=e}}},du=n("0a94"),pu=n("5311"),bu=n("77e3"),hu=n("b3a0");function fu(t,e){return{backgrounds:vu(t.backgrounds,e.backgrounds),characters:ju(t.characters,e.characters),dependencies:wu(t.dependencies,e.dependencies),fonts:xu(t.fonts,e.fonts,(function(t){return t.id}),(function(t,e){return Object(Qt["a"])(Object(Qt["a"])({},t),{},{files:wu(t.files,e.files)})})),poemStyles:xu(t.poemStyles,e.poemStyles,(function(t){return t.label}),(function(){throw new Error})),poemBackgrounds:[].concat(Object(wn["a"])(t.poemBackgrounds),Object(wn["a"])(e.poemBackgrounds)),sprites:xu(t.sprites,e.sprites,(function(t){return t.id}),(function(t,e){return{id:t.id,label:t.label,variants:[].concat(Object(wn["a"])(t.variants),Object(wn["a"])(e.variants))}})),colors:xu(t.colors,e.colors,(function(t){return t.color}),(function(t){return t}))}}function vu(t,e){return xu(t,e,(function(t){return t.id}),mu)}function mu(t,e){return{id:t.id,label:t.label,variants:[].concat(Object(wn["a"])(t.variants),Object(wn["a"])(e.variants))}}function ju(t,e){return xu(t,e,(function(t){return t.id}),gu)}function gu(t,e){return{chibi:t.chibi,id:t.id,label:t.label,heads:yu(t.heads,e.heads),styleGroups:xu(t.styleGroups,e.styleGroups,(function(t){return t.id}),(function(t,e){return{id:t.id,styleComponents:xu(t.styleComponents,e.styleComponents,(function(t){return t.id}),(function(t,e){return{id:t.id,label:t.label,variants:Ou(t.variants,e.variants)}})),styles:xu(t.styles,e.styles,(function(t){return JSON.stringify(t.components)}),(function(t,e){return{components:t.components,poses:xu(t.poses,e.poses,(function(t){return t.id}),ku)}}))}}))}}function Ou(t,e){var n=Object(Qt["a"])({},t);for(var r in e)e.hasOwnProperty(r)&&(n.hasOwnProperty(r)||(n[r]=e[r]));return n}function ku(t,e){var n=Object(Qt["a"])({},t.positions);for(var r in e.positions)n[r]?n[r]=[].concat(Object(wn["a"])(n[r]),Object(wn["a"])(e.positions[r])):n[r]=e.positions[r];return{id:t.id,compatibleHeads:wu(t.compatibleHeads,e.compatibleHeads),previewOffset:t.previewOffset,previewSize:t.previewSize,scale:t.scale,size:t.size,renderCommands:t.renderCommands,positions:n}}function yu(t,e){var n=Object(Qt["a"])({},t);for(var r in e)if(e.hasOwnProperty(r)){var o=e[r];if(n[r]){var a=n[r];n[r]={previewOffset:a.previewOffset,previewSize:a.previewSize,variants:[].concat(Object(wn["a"])(a.variants),Object(wn["a"])(o.variants))}}else n[r]=o}return n}function wu(t,e){var n,r=Object(wn["a"])(t),o=Object(bt["a"])(e);try{for(o.s();!(n=o.n()).done;){var a=n.value;r.includes(a)||r.push(a)}}catch(i){o.e(i)}finally{o.f()}return r}function xu(t,e,n,r){var o,a=Object(wn["a"])(t),i=new Map(t.map((function(t,e){return[n(t),e]}))),c=Object(bt["a"])(e);try{for(c.s();!(o=c.n()).done;){var s=o.value,u=n(s);if(i.has(u)){var l=i.get(u),d=a[l];a.splice(l,1,r(d,s))}else i.set(u,a.length),a.push(s)}}catch(p){c.e(p)}finally{c.f()}return a}function Cu(t){return t.split("/").slice(0,-1).join("/")+"/"}var Su=new Set(["png","gif","bmp","svg"]),Ru={namespaced:!0,state:{contentPacks:[],current:{dependencies:[],backgrounds:[],characters:[],fonts:[],poemStyles:[],poemBackgrounds:[],sprites:[],colors:[]}},mutations:{setContentPacks:function(t,e){t.contentPacks=e},setCurrentContent:function(t,e){t.current=e}},actions:{contentPack:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,a,i,c,s,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.commit,o=t.state,n.next=3,Iu(e);case 3:a=n.sent,i=new Set(o.contentPacks.map((function(t){return t.packId}))),c=Object(bt["a"])(e.dependencies),n.prev=6,c.s();case 8:if((s=c.n()).done){n.next=14;break}if(u=s.value,i.has(u)){n.next=12;break}throw new Error("Missing dependency '".concat(u,"'. Refusing to install ").concat(e.packId));case 12:n.next=8;break;case 14:n.next=19;break;case 16:n.prev=16,n.t0=n["catch"](6),c.e(n.t0);case 19:return n.prev=19,c.f(),n.finish(19);case 22:r("setContentPacks",[].concat(Object(wn["a"])(o.contentPacks),[a])),r("setCurrentContent",fu(o.current,a));case 24:case"end":return n.stop()}}),n,null,[[6,16,19,22]])})))()},removeContentPacks:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=t.commit,o=t.state,a=Pu(o.contentPacks.filter((function(t){return!e.has(t.packId)}))),r("setContentPacks",a),r("setCurrentContent",a.reduce((function(t,e){return fu(t,e)})));case 4:case"end":return n.stop()}}),n)})))()},replaceContentPack:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,a,i,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=t.commit,o=t.state,!e.processed){n.next=5;break}n.t0=e.contentPack,n.next=8;break;case 5:return n.next=7,Iu(e.contentPack);case 7:n.t0=n.sent;case 8:a=n.t0,i=o.contentPacks,c=i.findIndex((function(t){return t.packId===e.contentPack.packId})),-1===c?i.push(a):i.splice(c,1,a),i=Pu(i),r("setContentPacks",i),r("setCurrentContent",i.reduce((function(t,e){return fu(t,e)})));case 15:case"end":return n.stop()}}),n)})))()},loadContentPacks:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,a,i,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.dispatch,"string"===typeof e&&(e=[e]),n.next=4,Promise.all(e.map(function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch(e);case 2:return n=t.sent,n.ok||Au("Could not load content pack. Server responded with: ".concat(n.statusText)),t.prev=4,t.next=7,n.json();case 7:r=t.sent,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](4),Au("Content pack is not valid json!");case 13:try{a={"./":Cu(e),"/":Cu(location.href)+"assets/"},o="2.0"===r.version?Object(pu["normalizeContentPack"])(r,a):Object(bu["convert"])(Object(hu["normalizeCharacter"])(r,a),a,!1)}catch(i){Au("Content pack is not in a valid format!",i)}return t.abrupt("return",o);case 15:case"end":return t.stop()}}),t,null,[[4,10]])})));return function(e){return t.apply(this,arguments)}}()));case 4:o=n.sent,a=Object(bt["a"])(o),n.prev=6,a.s();case 8:if((i=a.n()).done){n.next=14;break}return c=i.value,n.next=12,r("contentPack",c);case 12:n.next=8;break;case 14:n.next=19;break;case 16:n.prev=16,n.t0=n["catch"](6),a.e(n.t0);case 19:return n.prev=19,a.f(),n.finish(19);case 22:return n.abrupt("return",o.map((function(t){return t.packId})));case 23:case"end":return n.stop()}}),n,null,[[6,16,19,22]])})))()}},getters:{getCharacters:function(t){var e,n=t.current,r=new Map,o=Object(bt["a"])(n.characters);try{for(o.s();!(e=o.n()).done;){var a=e.value;r.set(a.id,a)}}catch(i){o.e(i)}finally{o.f()}return r},getBackgrounds:function(t){var e,n=t.current,r=new Map,o=Object(bt["a"])(n.backgrounds);try{for(o.s();!(e=o.n()).done;){var a=e.value;r.set(a.id,a)}}catch(i){o.e(i)}finally{o.f()}return r}}};function Pu(t){return t}function Iu(t){return Tu.apply(this,arguments)}function Tu(){return Tu=Object(u["a"])(regeneratorRuntime.mark((function t(e){var n,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.t0=Set,t.next=3,Object(ht["e"])();case 3:if(!t.sent){t.next=7;break}t.t1=["webp"].concat(Object(wn["a"])(Su)),t.next=8;break;case 7:t.t1=Su;case 8:return t.t2=t.t1,n=new t.t0(t.t2),r=new Map([["ext","{lq:.lq:}.{format:webp:webp:png:png}"]]),o=Object(du["assetWalker"])(e,(function(t,o){var a=Object(du["normalizePath"])(t,r,n,!1),i=Object(du["normalizePath"])(t,r,n,!0);return{hq:a,lq:i,sourcePack:e.packId||"buildIn"}})),t.abrupt("return",o);case 13:case"end":return t.stop()}}),t)}))),Tu.apply(this,arguments)}function Au(t,e){throw console.error(t,e),new Error(t)}var _u=Object(Ws["a"])({state:{unsafe:!1},mutations:{setUnsafe:function(t,e){t.unsafe=e}},actions:{removePacks:function(t,e){return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,a,i,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.dispatch,o=t.commit,a=t.state,i=e.packs,c=JSON.parse(JSON.stringify(a.content.current)),o("setUnsafe",!0),n.next=6,r("content/removeContentPacks",i);case 6:return n.next=8,r("panels/fixContentPackRemoval",c);case 8:return n.next=10,r("objects/fixContentPackRemoval",c);case 10:o("setUnsafe",!1);case 11:case"end":return n.stop()}}),n)})))()}},modules:{objects:uu,ui:lu,panels:Zi,content:Ru}}),$u=(n("4160"),n("159b"),{install:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t.config.globalProperties.$store)throw new Error("VuexUndoRedo plugin must be installed after the Vuex plugin.");e.resetStateMutation||(e.resetStateMutation="emptyState"),e.mutations||(e.mutations={});var n=t.config.globalProperties.$store;function o(t,e){var r={};switch(Object(Gi["a"])(e.payload)){case"object":e.payload instanceof Array&&(r=[]),n.commit("".concat(e.type),Object.assign(r,e.payload));break;default:n.commit("".concat(e.type),e.payload)}}function a(t,e){return i.apply(this,arguments)}function i(){return i=Object(u["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.transaction((function(){n.forEach((function(t){o(e,t)}))}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),i.apply(this,arguments)}function c(t){return s.apply(this,arguments)}function s(){return s=Object(u["a"])(regeneratorRuntime.mark((function t(r){var o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:o=r.data.done.slice(0),r.data.done=[],n.commit(e.resetStateMutation),i=0;case 4:if(!(i<o.length)){t.next=10;break}return t.next=7,a(r,o[i]);case 7:++i,t.next=4;break;case 10:case"end":return t.stop()}}),t)}))),s.apply(this,arguments)}var l={};function d(t){if(!l[t]){var n,r=t.split("/"),o={ignore:function(t){return!1},combinable:function(t,e){return!1},combinator:function(t,e){return e}},a="",i=Object(bt["a"])(r);try{for(i.s();!(n=i.n()).done;){var c=n.value;e.mutations[a+"*"]&&Object.assign(o,e.mutations[a+"*"]),a+=c+"/"}}catch(s){i.e(s)}finally{i.f()}e.mutations[t]&&Object.assign(o,e.mutations[t]),l[t]=o}return l[t]}var p={data:Object(r["s"])({done:[],undone:[],newMutation:!0,ignoreMutations:e.ignoreMutations||[],currentTransaction:null,transactionQueue:[],initialized:!1}),initialize:function(){p.initialized||(p.initialized=!0,n.subscribe((function(t){var n=function(){t.type===e.resetStateMutation||d(t.type).ignore(t)||(p.currentTransaction.push(t),p.newMutation&&(p.data.undone=[]))};p.currentTransaction?n():p.transaction((function(){n()}))})))},redo:function(){if(!(p.data.undone.length<=0)){var t=p.data.undone.pop();p.newMutation=!1,a(p,t),p.newMutation=!0}},undo:function(){return Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(p.data.done.length<=0)){t.next=2;break}return t.abrupt("return");case 2:return p.data.undone.push(p.data.done.pop()),p.newMutation=!1,t.next=6,c(p);case 6:p.newMutation=!0;case 7:case"end":return t.stop()}}),t)})))()},transaction:function(t){return new Promise((function(e,n){var r=function(){var n=Object(u["a"])(regeneratorRuntime.mark((function n(){var r,o,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return p.currentTransaction=[],n.prev=1,n.next=4,t();case 4:n.next=9;break;case 6:n.prev=6,n.t0=n["catch"](1),console.log("Error during transaction!: ",n.t0);case 9:r=p.data.done[p.data.done.length-1],1===p.currentTransaction.length&&r&&1===r.length&&(o=d(p.currentTransaction[0].type),o.combinable(r[0],p.currentTransaction[0])&&(a=o.combinator(r[0],p.currentTransaction[0]),p.data.done.pop(),p.currentTransaction=a?[a]:[])),p.currentTransaction.length>0&&p.data.done.push(p.currentTransaction),p.currentTransaction=null,p.data.transactionQueue.length>0&&p.data.transactionQueue.pop()(),e();case 15:case"end":return n.stop()}}),n,null,[[1,6]])})));return function(){return n.apply(this,arguments)}}();p.currentTransaction?p.data.transactionQueue.push(r):r()}))}};t.config.globalProperties.vuexHistory=p,p.initialize()}});Object(r["f"])(Ns).use(_u).use($u).mount("#app")},d2ab:function(t,e,n){},d7eb:function(t,e,n){},da86:function(t,e,n){},dc3c:function(t,e,n){"use strict";n("2b40")},dc61:function(t,e,n){"use strict";var r=n("7a23"),o=Object(r["F"])("data-v-0c92f421"),a=o((function(t,e,n,o,a,i){return t.visible?(Object(r["p"])(),Object(r["g"])("div",{key:0,onDragleave:e[1]||(e[1]=function(e){return t.visible=!1}),onDrop:e[2]||(e[2]=function(){return t.drop.apply(t,arguments)}),class:{vertical:t.vertical}},[Object(r["v"])(t.$slots,"default")],34)):Object(r["h"])("",!0)})),i=(n("ac1f"),n("466d"),n("b85c")),c=Object(r["m"])({computed:{vertical:function(){return this.$store.state.ui.vertical}},data:function(){return{visible:!1}},methods:{show:function(){this.visible=!0},hide:function(){this.visible=!1},drop:function(t){if(this.hide(),t.stopPropagation(),t.preventDefault(),t.dataTransfer){var e,n=Object(i["a"])(t.dataTransfer.items);try{for(n.s();!(e=n.n()).done;){var r=e.value;"file"===r.kind&&r.type.match(/image.*/)&&this.$emit("drop",r.getAsFile())}}catch(o){n.e(o)}finally{n.f()}}}}});n("fc0e");c.render=a,c.__scopeId="data-v-0c92f421";e["a"]=c},dd24:function(t,e,n){"use strict";n("6cff")},ddde:function(t,e,n){"use strict";n("a6d1")},dddf:function(t,e,n){"use strict";n("866c")},e3f7:function(t,e,n){},f317:function(t,e,n){},f526:function(t,e,n){},fc0e:function(t,e,n){"use strict";n("7e59")},fd0b:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));n("d3b7"),n("96cf");var r=n("1da1"),o=n("d4ec"),a=n("bee2"),i=n("6ae4"),c=n("73e5"),s=n("032b"),u=n("fec4"),l=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u["d"],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u["c"];Object(o["a"])(this,t),this.runningContext=null,this.previewCanvas=document.createElement("canvas"),this.previewCanvas.width=e,this.previewCanvas.height=n}return Object(a["a"])(t,[{key:"render",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,a,s=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=!(s.length>1&&void 0!==s[1])||s[1],r=!(s.length>2&&void 0!==s[2])||s[2],this.runningContext&&this.runningContext.abort(),o=this.previewCanvas.getContext("2d"),o.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),a=this.runningContext=i["a"].makeWithContext(this.previewCanvas,o,n,r),t.prev=6,t.next=9,e(this.runningContext);case 9:t.next=16;break;case 11:if(t.prev=11,t.t0=t["catch"](6),!(t.t0 instanceof c["a"])){t.next=15;break}return t.abrupt("return",!1);case 15:throw t.t0;case 16:return t.prev=16,a===this.runningContext&&(this.runningContext=null),t.finish(16);case 19:return t.abrupt("return",!0);case 20:case"end":return t.stop()}}),t,this,[[6,11,16,19]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"paintOnto",value:function(t,e){e.w&&e.h?t.drawImage(this.previewCanvas,e.x,e.y,e.w,e.h):t.drawImage(this.previewCanvas,e.x,e.y)}},{key:"download",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n){var r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=document.createElement("canvas"),r.width=this.previewCanvas.width,r.height=this.previewCanvas.height,o=r.getContext("2d"),o.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),t.next=7,e(i["a"].makeWithContext(r,o,!0,!1));case 7:return t.abrupt("return",s["a"].saveToFile(r,n));case 8:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"renderToBlob",value:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=document.createElement("canvas"),n.width=this.previewCanvas.width,n.height=this.previewCanvas.height,r=n.getContext("2d"),r.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),t.next=7,e(i["a"].makeWithContext(n,r,!0,!1));case 7:return t.next=9,new Promise((function(t,e){n.toBlob((function(n){n?t(n):e()}))}));case 9:return t.abrupt("return",t.sent);case 10:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"getDataAt",value:function(t,e){var n=this.previewCanvas.getContext("2d");return n.getImageData(t,e,1,1).data}},{key:"width",get:function(){return this.previewCanvas.width}},{key:"height",get:function(){return this.previewCanvas.height}}]),t}()},fec4:function(t,e,n){"use strict";n.d(e,"d",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return i}));var r=1280,o=720,a=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],i=[200,240,400,493,640,786,880,1040,1080]}});
//# sourceMappingURL=app.9bd6cffd.js.map