(function(t){function e(e){for(var r,a,s=e[0],c=e[1],u=e[2],h=0,d=[];h<s.length;h++)a=s[h],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&d.push(o[a][0]),o[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);l&&l(e);while(d.length)d.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(r=!1)}r&&(i.splice(e--,1),t=a(a.s=n[0]))}return t}var r={},o={app:0},i=[];function a(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=r,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(n,r,function(e){return t[e]}.bind(null,r));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var l=c;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"06b9":function(t,e,n){},"0bac":function(t,e,n){"use strict";var r=n("c140"),o=n.n(r);o.a},"17c6":function(t,e,n){},"18ea":function(t,e,n){"use strict";var r=n("4dc0"),o=n.n(r);o.a},"1bd8":function(t,e,n){"use strict";var r=n("4298"),o=n.n(r);o.a},"23b4":function(t,e,n){},"2fcb":function(t,e,n){"use strict";var r=n("4537"),o=n.n(r);o.a},3272:function(t,e,n){},"3c8e":function(t,e,n){"use strict";var r=n("6bbf"),o=n.n(r);o.a},4298:function(t,e,n){},4537:function(t,e,n){},"480b":function(t,e,n){"use strict";var r=n("8f0d"),o=n.n(r);o.a},4812:function(t,e,n){"use strict";var r=n("5d64"),o=n.n(r);o.a},"4a58":function(t,e,n){"use strict";var r=n("cf62"),o=n.n(r);o.a},"4dc0":function(t,e,n){},"5c0b":function(t,e,n){"use strict";var r=n("e332"),o=n.n(r);o.a},"5d64":function(t,e,n){},"65ef":function(t,e,n){"use strict";var r=n("17c6"),o=n.n(r);o.a},"671a":function(t,e,n){"use strict";var r=n("23b4"),o=n.n(r);o.a},"6bbf":function(t,e,n){},"6ee7":function(t,e,n){"use strict";var r=n("a75a"),o=n.n(r);o.a},"6f0e":function(t,e,n){},"781b":function(t,e,n){"use strict";var r=n("9b1d"),o=n.n(r);o.a},8062:function(t,e,n){},8404:function(t,e,n){"use strict";var r=n("8062"),o=n.n(r);o.a},"853e":function(t,e,n){"use strict";var r=n("6f0e"),o=n.n(r);o.a},"8f0d":function(t,e,n){},"9b1d":function(t,e,n){},a75a:function(t,e,n){},a85e:function(t,e,n){"use strict";var r=n("dd58"),o=n.n(r);o.a},c140:function(t,e,n){},ca64:function(t,e,n){"use strict";var r=n("3272"),o=n.n(r);o.a},cd49:function(t,e,n){"use strict";n.r(e);n("8e6e"),n("ac6a"),n("456d");var r=n("bd86"),o=(n("cadf"),n("551c"),n("f751"),n("097d"),n("2b0e")),i=n("2f62"),a=(n("ac4d"),n("8a81"),n("7f7f"),n("28a5"),n("7618")),s=(n("96cf"),n("3b8d")),c=(n("7514"),{install:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t._installedPlugins.find((function(t){return t.Store})))throw new Error("VuexUndoRedo plugin must be installed after the Vuex plugin.");function n(t){return r.apply(this,arguments)}function r(){return r=Object(s["a"])(regeneratorRuntime.mark((function t(n){var r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=n.done.slice(0),n.done=[],n.$store.commit(e.resetStateMutation),i=0;case 4:if(!(i<r.length)){t.next=10;break}return t.next=7,o(n,r[i]);case 7:++i,t.next=4;break;case 10:case"end":return t.stop()}}),t)}))),r.apply(this,arguments)}function o(t,e){return i.apply(this,arguments)}function i(){return i=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.transaction((function(){n.forEach((function(t){c(e,t)}))}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),i.apply(this,arguments)}function c(t,e){switch(Object(a["a"])(e.payload)){case"object":var n={};e.payload instanceof Array&&(n=[]),t.$store.commit("".concat(e.type),Object.assign(n,e.payload));break;default:t.$store.commit("".concat(e.type),e.payload)}}e.resetStateMutation||(e.resetStateMutation="emptyState"),e.mutations||(e.mutations={}),t.mixin({data:function(){return{done:[],undone:[],newMutation:!0,ignoreMutations:e.ignoreMutations||[],currentTransaction:null,transactionQueue:[]}},created:function(){var t=this;window.historyStuff=this,this.$store&&this.$store.subscribe((function(n){var r=function(){n.type===e.resetStateMutation||l(n.type).ignore(n)||(t.currentTransaction.push(n),t.newMutation&&(t.undone=[]))};t.currentTransaction?r():t.transaction((function(){r()}))}))},computed:{canRedo:function(){return this.undone.length},canUndo:function(){return this.done.length}},methods:{redo:function(){if(!(this.undone.length<=0)){var t=this.undone.pop();this.newMutation=!1,o(this,t),this.newMutation=!0}},undo:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(this.done.length<=0)){t.next=2;break}return t.abrupt("return");case 2:return this.undone.push(this.done.pop()),this.newMutation=!1,t.next=6,n(this);case 6:this.newMutation=!0;case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),transaction:function(t){var e=this;return new Promise((function(r,o){var i=function(){var i=Object(s["a"])(regeneratorRuntime.mark((function i(){var a,s,c;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return e.currentTransaction=[],i.prev=1,i.next=4,t();case 4:i.next=12;break;case 6:i.prev=6,i.t0=i["catch"](1),console.log("Error during transaction!: ",i.t0),o(i.t0),e.currentTransaction=[],n(e);case 12:a=e.done[e.done.length-1],1===e.currentTransaction.length&&a&&1===a.length&&(s=l(e.currentTransaction[0].type),s.combinable(a[0],e.currentTransaction[0])&&(c=s.combinator(a[0],e.currentTransaction[0]),e.done.pop(),e.currentTransaction=c?[c]:[])),e.currentTransaction.length>0&&e.done.push(e.currentTransaction),e.currentTransaction=null,e.transactionQueue.length>0&&e.transactionQueue.pop()(),r();case 18:case"end":return i.stop()}}),i,null,[[1,6]])})));return function(){return i.apply(this,arguments)}}();e.currentTransaction?e.transactionQueue.push(i):i()}))}}});var u={};function l(t){if(!u[t]){var n=t.split("/"),r={ignore:function(t){return!1},combinable:function(t,e){return!1},combinator:function(t,e){return e}},o="",i=!0,a=!1,s=void 0;try{for(var c,l=n[Symbol.iterator]();!(i=(c=l.next()).done);i=!0){var h=c.value;e.mutations[o+"*"]&&Object.assign(r,e.mutations[o+"*"]),o+=h+"/"}}catch(d){a=!0,s=d}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}e.mutations[t]&&Object.assign(r,e.mutations[t]),u[t]=r}return u[t]}}}),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("div",{attrs:{id:"container"}},[n("render",{ref:"render",attrs:{canvasWidth:t.canvasWidth,canvasHeight:t.canvasHeight}})],1),n("message-console"),n("tool-box",{on:{"show-prev-render":t.drawLastDownload,download:function(e){return t.$refs.render.download()}}})],1)},l=[],h=n("768b"),d=n("d225"),f=n("b0b4"),p=n("308d"),b=n("6bb5"),v=n("4e2b"),m=n("9ab4"),g=n("60a3"),y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{vertical:t.vertical},attrs:{id:"panels"}},[n("div",{attrs:{id:"toolbar"}},[n("button",{class:{active:"add"===t.panel},attrs:{title:"Add new objects to the scene"},on:{click:function(e){return t.setPanel("add")}}},[n("i",{staticClass:"material-icons"},[t._v("add_box")])]),n("button",{class:{active:"backgrounds"===t.panel},attrs:{title:"Change the current background"},on:{click:function(e){return t.setPanel("backgrounds")}}},[n("i",{staticClass:"material-icons"},[t._v("panorama")])]),n("button",{class:{active:"credits"===t.panel},attrs:{title:"Show credits"},on:{click:function(e){return t.setPanel("credits")}}},[n("i",{staticClass:"material-icons"},[t._v("subject")])]),n("button",{attrs:{title:"Take a screenshot of the current scene"},on:{click:function(e){return t.$emit("download")}}},[n("i",{staticClass:"material-icons"},[t._v("photo_camera")])])]),""===t.panel?n("general-panel",{on:{"show-prev-render":function(e){return t.$emit("show-prev-render")},"show-content-packs":function(e){return t.setPanel("content-packs")}}}):t._e(),"content-packs"===t.panel?n("content-packs-panel"):t._e(),"add"===t.panel?n("add-panel"):t._e(),"backgrounds"===t.panel?n("backgrounds-panel"):t._e(),"credits"===t.panel?n("credits-panel"):t._e(),"character"===t.panel?n("character-panel"):t._e(),"sprite"===t.panel?n("sprite-panel"):t._e(),"textBox"===t.panel?n("text-box-panel"):t._e()],1)},k=[],j=n("2298"),w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"panel"},[n("h1",[t._v("General")]),n("a",{staticClass:"btn",attrs:{target:"_blank",rel:"noopener noreferrer",href:"https://github.com/edave64/Doki-Doki-Dialog-Generator/blob/v1/docs/index.md"}},[t._v("Help")]),n("button",{attrs:{disabled:!t.hasPrevRender},on:{click:function(e){return t.$emit("show-prev-render")}}},[t._v("Compare to last download")]),n("button",{on:{click:function(e){return t.$emit("show-content-packs")}}},[t._v("Content Packs")]),n("toggle",{attrs:{label:"Low quality preview?",title:"Reduces the quality of the preview images to speed up the user experience and consume less data. Does not effect final render."},model:{value:t.lqRendering,callback:function(e){t.lqRendering=e},expression:"lqRendering"}}),n("toggle",{attrs:{label:"NSFW Mode?"},model:{value:t.nsfw,callback:function(e){t.nsfw=e},expression:"nsfw"}})],1)},x=[],O=(n("8615"),n("5df3"),n("4f7f"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("input",{ref:"checkbox",attrs:{id:t._uid,type:"checkbox"},domProps:{checked:t.value},on:{change:t.onChange}}),n("label",{staticClass:"switch",attrs:{for:t._uid}}),n("label",{attrs:{for:t._uid}},[t._v(t._s(t.label))])])}),C=[],P=function(t){function e(){return Object(d["a"])(this,e),Object(p["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(v["a"])(e,t),Object(f["a"])(e,[{key:"onChange",value:function(t){this.$emit("input",!!this.$refs.checkbox.checked)}},{key:"checkbox",get:function(){return this.$refs.checkbox}}]),e}(g["d"]);Object(m["a"])([Object(g["c"])({type:String})],P.prototype,"label",void 0),Object(m["a"])([Object(g["c"])({type:Boolean,default:!1})],P.prototype,"value",void 0),P=Object(m["a"])([Object(g["a"])({components:{}})],P);var _=P,R=_,S=(n("65ef"),n("2877")),$=Object(S["a"])(R,O,C,!1,null,"7bd0fd86",null),T=$.exports,L=function(t){function e(){return Object(d["a"])(this,e),Object(p["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(v["a"])(e,t),Object(f["a"])(e,[{key:"mounted",value:function(){this.updateVertical(),this.$el.addEventListener("wheel",(function(t){if("wheel"===t.type&&t.currentTarget){var e=t.currentTarget;if(!e.classList.contains("vertical")){var n=t;0!==n.deltaY&&(n.mozInputSource?e.scrollLeft+=25*n.deltaY:e.scrollLeft+=n.deltaY)}}}),{passive:!0})}},{key:"updateVertical",value:function(){this.$el&&(this.vertical?this.$el.classList.add("vertical"):this.$el.classList.remove("vertical"))}}]),e}(g["d"]);Object(m["a"])([Object(j["a"])("vertical",{namespace:"ui"})],L.prototype,"vertical",void 0),Object(m["a"])([Object(g["e"])("vertical")],L.prototype,"updateVertical",null),L=Object(m["a"])([Object(g["a"])({})],L);var I={"dddg.buildin.backgrounds.nsfw":"".concat("","packs/buildin.base.backgrounds.nsfw.json"),"dddg.buildin.sayori.nsfw":"".concat("","packs/buildin.base.sayori.nsfw.json"),"dddg.buildin.base.natsuki.nsfw":"".concat("","packs/buildin.base.natsuki.nsfw.json"),"dddg.buildin.yuri.nsfw":"".concat("","packs/buildin.base.yuri.nsfw.json")},D=new Set(Object.keys(I)),E=Object.values(I),N=function(t){function e(){return Object(d["a"])(this,e),Object(p["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(v["a"])(e,t),Object(f["a"])(e,[{key:"lqRendering",get:function(){return this.$store.state.ui.lqRendering},set:function(t){var e=this;this.history.transaction(Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$store.commit("ui/setLqRendering",t);case 2:case"end":return n.stop()}}),n)}))))}},{key:"hasPrevRender",get:function(){return null!==this.$store.state.ui.lastDownload}},{key:"history",get:function(){return this.$root}},{key:"nsfw",get:function(){return!!this.$store.state.content.contentPacks.map((function(t){return t.packId})).filter((function(t){return!!t})).find((function(t){return D.has(t)}))},set:function(t){var e=this;this.history.transaction(Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t){n.next=5;break}return n.next=3,e.$store.dispatch("content/loadContentPacks",E);case 3:n.next=7;break;case 5:return n.next=7,e.$store.dispatch("removePacks",{packs:D});case 7:case"end":return n.stop()}}),n)}))))}}]),e}(Object(g["b"])(L));N=Object(m["a"])([Object(g["a"])({components:{Toggle:T}})],N);var M=N,U=M,A=(n("e6de"),Object(S["a"])(U,w,x,!1,null,"0eaa856c",null)),B=A.exports,F=function(){var t=this,e=t.$createElement,n=t._self._c||e;return void 0!==t.isWebPSupported?n("div",{staticClass:"panel"},[n("h1",[t._v("Add")]),n("div",{class:{"group-selector":!0,vertical:t.vertical}},[n("button",{class:{active:"characters"===t.group},on:{click:function(e){t.group="characters"}}},[n("i",{staticClass:"material-icons"},[t._v("emoji_people")]),t._v(" Characters\n\t\t")]),n("button",{class:{active:"sprites"===t.group},on:{click:function(e){t.group="sprites"}}},[n("i",{staticClass:"material-icons"},[t._v("change_history")]),t._v(" Sprites\n\t\t")]),n("button",{class:{active:"ui"===t.group},on:{click:function(e){t.group="ui"}}},[n("i",{staticClass:"material-icons"},[t._v("view_quilt")]),t._v(" UI\n\t\t")])]),n("div",{class:{"item-grid":!0,vertical:t.vertical}},["characters"===t.group?t._l(t.characters,(function(e){return n("div",{key:e.id,staticClass:"character",attrs:{title:e.label},on:{click:function(n){t.onChosen(e.id.toLowerCase())}}},[n("img",{attrs:{src:t.assetPath(e),alt:e.label}})])})):t._e(),"sprites"===t.group?[n("div",{staticClass:"btn custom-sprite",on:{click:function(e){return t.$refs.upload.click()}}},[t._v("\n\t\t\t\tCustom sprite upload\n\t\t\t\t"),n("input",{ref:"upload",attrs:{type:"file"},on:{change:t.onFileUpload}})]),n("div",{staticClass:"btn custom-sprite",on:{click:t.uploadFromURL}},[t._v("Custom sprite from URL")])]:t._e(),"ui"===t.group?[n("button",{on:{click:t.addTextBox}},[t._v("Textbox")])]:t._e()],2)]):t._e()},q=[],H=(n("a481"),new o["a"]),z={fireCommand:function(t){H.$emit("command",t)},subscribeCommand:function(t){H.$on("command",t)},fire:function(t){H.$emit(t.kind,t)},subscribe:function(t,e){H.$on(t.kind,e)},unsubscribe:function(t,e){H.$off(t.kind,e)}},W=function t(e){Object(d["a"])(this,t),this.path=e,this.kind="AssetFailureEvent"};W.kind="AssetFailureEvent";var V=function t(e){Object(d["a"])(this,t),this.error=e,this.kind="CustomAssetFailureEvent"};V.kind="CustomAssetFailureEvent";var Y=function t(){Object(d["a"])(this,t),this.kind="InvalidateRenderEvent"};Y.kind="InvalidateRenderEvent";var G,X=function t(){Object(d["a"])(this,t)};function Q(){return G||(G=new Promise((function(t,e){var n="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=",r=document.createElement("img");r.addEventListener("load",(function(){t(2===r.width&&1===r.height)})),r.addEventListener("error",(function(){t(!1)})),r.src=n}))),G}var J={},K={};function Z(t){return tt.apply(this,arguments)}function tt(){return tt=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,o=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=!(o.length>1&&void 0!==o[1])||o[1],r=n?e.hq:e.lq,J[r]||(J[r]=new Promise((function(t,e){var n=new Image;n.addEventListener("load",(function(){t(n)})),n.addEventListener("error",(function(){z.fire(new W(r)),J[r]=void 0,t(new X)})),n.crossOrigin="Anonymous",n.src=r,n.style.display="none",document.body.appendChild(n)}))),t.abrupt("return",J[r]);case 4:case"end":return t.stop()}}),t)}))),tt.apply(this,arguments)}var et=".";function nt(t){return rt.apply(this,arguments)}function rt(){return rt=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,o=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=!(o.length>1&&void 0!==o[1])||o[1],!K[e]){t.next=3;break}return t.abrupt("return",K[e]);case 3:return t.t0="".concat(et,"/assets/").concat(e).concat(n?"":".lq"),t.next=6,Q();case 6:if(!t.sent){t.next=10;break}t.t1=".webp",t.next=11;break;case 10:t.t1=".png";case 11:return t.t2=t.t1,r=t.t0.concat.call(t.t0,t.t2).replace(/\/+/,"/"),J[r]||(J[r]=new Promise((function(t,e){var n=new Image;n.addEventListener("load",(function(){t(n)})),n.addEventListener("error",(function(){z.fire(new W(r)),J[r]=void 0,t(new X)})),n.crossOrigin="Anonymous",n.src=r,n.style.display="none",document.body.appendChild(n)}))),t.abrupt("return",J[r]);case 15:case"end":return t.stop()}}),t)}))),rt.apply(this,arguments)}function ot(t,e){var n=URL.createObjectURL(e);return K[t]=new Promise((function(t,e){var r=new Image;r.addEventListener("load",(function(){t(r)})),r.addEventListener("error",(function(t){z.fire(new V(t)),e('Failed to load "'.concat(n,'"'))})),r.crossOrigin="Anonymous",r.src=n,r.style.display="none",document.body.appendChild(r)})),n}function it(t,e){return K[t]=new Promise((function(t,n){var r=new Image;r.addEventListener("load",(function(){t(r)})),r.addEventListener("error",(function(t){z.fire(new V(t)),n('Failed to load "'.concat(e,'"'))})),r.crossOrigin="Anonymous",r.src=e,r.style.display="none",document.body.appendChild(r)}))}var at=function(t){function e(){var t;return Object(d["a"])(this,e),t=Object(p["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.isWebPSupported=null,t.customAssetCount=0,t.group="characters",t}return Object(v["a"])(e,t),Object(f["a"])(e,[{key:"created",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Q();case 2:this.isWebPSupported=t.sent;case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"assetPath",value:function(t){return t.chibi.lq}},{key:"onFileUpload",value:function(t){var e=this,n=this.$refs.upload;if(n.files){var r=!0,o=!1,i=void 0;try{for(var a,s=function(){var t=a.value;(function(e){var n="customAsset"+e;ot(n,t)})(++e.customAssetCount)},c=n.files[Symbol.iterator]();!(r=(a=c.next()).done);r=!0)s()}catch(u){o=!0,i=u}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}}}},{key:"uploadFromURL",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=prompt("Enter the URL of the image"),e){t.next=3;break}return t.abrupt("return");case 3:return n="customAsset"+ ++this.customAssetCount,t.next=6,it(n,e);case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"addTextBox",value:function(){this.$store.dispatch("objects/createTextBox",{})}},{key:"onChosen",value:function(t){this.$store.dispatch("objects/createCharacters",{characterType:t})}},{key:"characters",get:function(){return this.$store.state.content.current.characters}}]),e}(Object(g["b"])(L));at=Object(m["a"])([Object(g["a"])({components:{}})],at);var st=at,ct=st,ut=(n("a85e"),Object(S["a"])(ct,F,q,!1,null,"440e7bcd",null)),lt=ut.exports,ht=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"panel"},[n("h1",[t._v(t._s(t.label))]),t.panelForParts?n("parts",{attrs:{character:t.character,part:t.panelForParts},on:{leave:function(e){t.panelForParts=null}}}):[t.hasMultiplePoses||t.parts.length>0?n("fieldset",[n("legend",[t._v("Pose:")]),n("table",[n("tbody",[t.hasMultipleStyles?n("tr",[n("td",{staticClass:"arrow-col"},[n("button",{on:{click:function(e){return t.seekStyle(-1)}}},[t._v("<")])]),n("td",[n("button",{staticClass:"middle-button",on:{click:function(e){t.panelForParts="style"}}},[t._v("Style")])]),n("td",{staticClass:"arrow-col"},[n("button",{on:{click:function(e){return t.seekStyle(1)}}},[t._v(">")])])]):t._e(),t.hasMultiplePoses?n("tr",[n("td",{staticClass:"arrow-col"},[n("button",{on:{click:function(e){return t.seekPose(-1)}}},[t._v("<")])]),n("td",[n("button",{staticClass:"middle-button",on:{click:function(e){t.panelForParts="pose"}}},[t._v("Pose")])]),n("td",{staticClass:"arrow-col"},[n("button",{on:{click:function(e){return t.seekPose(1)}}},[t._v(">")])])]):t._e(),t._l(t.parts,(function(e){return n("tr",{key:e},[n("td",{staticClass:"arrow-col"},[n("button",{on:{click:function(n){return t.seekPart(e,-1)}}},[t._v("<")])]),n("td",[n("button",{staticClass:"middle-button",on:{click:function(n){t.panelForParts=e}}},[t._v(t._s(t.captialize(e)))])]),n("td",{staticClass:"arrow-col"},[n("button",{on:{click:function(n){return t.seekPart(e,1)}}},[t._v(">")])])])}))],2)])]):t._e(),n("position-and-size",{attrs:{obj:t.character}}),n("layers",{attrs:{obj:t.character}}),n("opacity",{attrs:{obj:t.character}}),n("toggle",{attrs:{label:"Close up?"},model:{value:t.closeUp,callback:function(e){t.closeUp=e},expression:"closeUp"}}),n("toggle",{attrs:{label:"Flip?"},model:{value:t.flip,callback:function(e){t.flip=e},expression:"flip"}}),n("delete",{attrs:{obj:t.character}})]],2)},dt=[],ft=(n("20d6"),n("55dd"),1280),pt=720,bt=["4-1","3-1","2-1","4-2","center","4-3","2-2","3-3","4-4"],vt=[200,240,400,493,640,786,880,1040,1080];function mt(t,e,n){var r=e+n,o=t.length;return r<0&&(r+=o),r>=o&&(r-=o),r}function gt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function yt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?gt(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):gt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var kt=-74,jt=-26,wt={setPose:function(t,e){var n=t.objects[e.id];n.poseId=e.poseId,++n.version},setCharStyle:function(t,e){console.log("Setting style of ".concat(e.id," to ").concat(e.styleId));var n=t.objects[e.id];n.styleId=e.styleId,++n.version},setPosePosition:function(t,e){var n=t.objects[e.id];n.posePositions=yt({},n.posePositions,{},e.posePositions),++n.version},setClose:function(t,e){var n=t.objects[e.id];n.close=e.close,++n.version},setFreeMove:function(t,e){var n=t.objects[e.id];n.freeMove=e.freeMove,n.freeMove||(n.x=vt[Rt(n.x)],n.y=jt)}};function xt(t,e){var n=t.getters["content/getCharacters"];return n.get(e.characterType)}function Ot(t,e){var n=t["content/getCharacters"];return n.get(e.characterType)}function Ct(t,e){return t.poses[e.poseId]}function Pt(t,e){var n=Ct(t,e),r=[];return n.compatibleHeads.length>0&&r.push("head"),n.variant.length>1&&r.push("variant"),n.left.length>1&&r.push("left"),n.right.length>1&&r.push("right"),r}function _t(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.posePositions.headType,r=Ct(t,e).compatibleHeads;if(!r||0===r.length)return null;var o=t.heads[r[n]];return o}function Rt(t){var e=vt.map((function(e,n){return{pos:Math.abs(t-e),idx:n}})).sort((function(t,e){return t.pos-e.pos}));return e[0].idx}var St=0,$t={createCharacters:function(t,e){t.state;var n=t.commit;n("create",{object:{flip:!1,id:"characters_"+ ++St,onTop:!1,opacity:100,type:"character",x:640,y:jt,preserveRatio:!0,ratio:1,height:768,width:768,characterType:e.characterType,close:!1,freeMove:!1,version:0,poseId:0,styleId:0,posePositions:{head:0,headType:0,left:0,right:0,variant:0}}})},seekPart:function(t,e){var n=t.state,o=t.commit,i=t.dispatch,a=t.rootGetters,s=e.delta,c=e.id,u=e.part;if("head"!==u){var l=n.objects[c],h=Ct(Ot(a,l),l);h[u]&&o("setPosePosition",{id:c,posePositions:Object(r["a"])({},u,mt(h[u],l.posePositions[u],s))})}else i("seekHead",{id:c,delta:s})},seekPose:function(t,e){var n=t.state,r=t.commit,o=t.rootGetters,i=e.id,a=e.delta,s=n.objects[i],c=Ot(o,s);Et(r,s,c,(function(t){t.poseId=mt(c.poses,t.poseId,a)}))},seekStyle:function(t,e){var n=t.state,r=t.commit,o=t.rootGetters,i=e.id,a=e.delta,s=n.objects[i],c=Ot(o,s);Et(r,s,c,(function(t){t.styleId=mt(c.styles,t.styleId,a)}))},seekHead:function(t,e){var n=t.state,r=t.commit,o=t.rootGetters,i=e.id,a=e.delta,s=n.objects[i],c=Ot(o,s),u=Ct(c,s),l=_t(c,s);if(l){var h=s.posePositions.head+a,d=s.posePositions.headType;(h<0||h>=l.variants.length)&&(d=mt(u.compatibleHeads.map((function(t){return c.heads[t]})),d,a),l=_t(c,s,d),h=1===a?0:l.variants.length-1),r("setPosePosition",{id:i,posePositions:{head:h,headType:d}})}},setPart:function(t,e){var n=t.state,r=t.commit,o=t.rootGetters,i=e.id,a=e.part,s=e.val,c=n.objects[i],u=Ot(o,c);Et(r,c,u,"pose"===a?function(t){t.poseId=s}:"style"===a?function(t){t.styleId=s}:function(t){t.posePositions[a]=s})},setCharacterPosition:function(t,e){var n=t.state,r=t.commit,o=e.id,i=e.x,a=e.y,s=n.objects[o];s.freeMove?r("setPosition",{id:o,x:i,y:a}):r("setPosition",{id:o,x:vt[Rt(i)],y:jt+(s.close?kt:0)})},shiftCharacterSlot:function(t,e){var n=t.state,r=t.commit,o=e.id,i=e.delta,a=n.objects[o],s=Rt(a.x),c=s+i;c<0&&(c=0),c>=vt.length&&(c=vt.length-1),r("setPosition",{id:o,x:vt[c],y:a.y})}};function Tt(t,e,n){return Lt.apply(this,arguments)}function Lt(){return Lt=Object(s["a"])(regeneratorRuntime.mark((function t(e,n,r){var o,i,a,s,c,u,l,h,d,f,p,b,v,m,g,y,k,j,w,x,O,C,P,_,R,S,$;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(o=e.state.objects[n],i=r.characters.find((function(t){return t.id===o.characterType})),i){t.next=6;break}return console.error("Character data is missing. Dropping the character."),e.dispatch("removeObject",{id:n}),t.abrupt("return");case 6:if(a=e.rootState.content.current.characters.find((function(t){return t.id===i.id})),a){t.next=11;break}return console.error("Character data is missing. Dropping the character."),e.dispatch("removeObject",{id:n}),t.abrupt("return");case 11:for(s=It(o),c=i.styles[o.styleId],u=a.styles.findIndex((function(t){return t.name===c.name})),-1===u?(s.styleId=0,l=i.poses[s.poseId],h=i.poses.filter((function(t){return t.style===c.name})).indexOf(l),d=a.poses.filter((function(t){return t.style===c.name})),d.length<h?s.poseId=a.poses.indexOf(d[h]):s.poseId=0):(u!==o.styleId&&(s.styleId=u),f=a.styles[s.styleId],p=i.poses[o.poseId],b=a.poses.findIndex((function(t){return t.name===p.name})),-1===b?s.poseId=a.poses.findIndex((function(t){return t.style===f.name})):b!==o.poseId&&(s.poseId=b)),v=i.poses[o.poseId],m=a.poses[s.poseId],g=function(){var t=k[y],e=JSON.stringify(v[t][o.posePositions[t]]),n=m[t].findIndex((function(t){return JSON.stringify(t)===e}));-1===n?s.posePositions[t]=0:n!==o.posePositions[t]&&(s.posePositions[t]=n)},y=0,k=["variant","left","right"];y<k.length;y++)g();j=JSON.stringify(v.variant[o.posePositions.variant]),w=m.variant.findIndex((function(t){return JSON.stringify(t)===j})),-1===w?s.posePositions.variant=0:w!==o.posePositions.variant&&(s.posePositions.variant=w),x=JSON.stringify(v.variant[o.posePositions.left]),O=m.variant.findIndex((function(t){return JSON.stringify(t)===x})),-1===O?s.posePositions.left=0:O!==o.posePositions.left&&(s.posePositions.left=O),C=JSON.stringify(v.variant[o.posePositions.right]),P=m.variant.findIndex((function(t){return JSON.stringify(t)===C})),-1===P?s.posePositions.right=0:P!==o.posePositions.right&&(s.posePositions.right=P),_=v.compatibleHeads[o.posePositions.headType],R=m.compatibleHeads.indexOf(_),-1===R?(s.posePositions.headType=0,s.posePositions.head=0):(R!==o.posePositions.headType&&(s.posePositions.headType=R),S=JSON.stringify(i.heads[_].variants[o.posePositions.head]),$=a.heads[_].variants.findIndex((function(t){return JSON.stringify(t)===S})),s.posePositions.head=-1===$?0:$),Dt(e.commit,o,s);case 32:case"end":return t.stop()}}),t)}))),Lt.apply(this,arguments)}function It(t){return{styleId:t.styleId,poseId:t.poseId,posePositions:yt({},t.posePositions)}}function Dt(t,e,n){n.styleId!==e.styleId&&(console.log("Setting style of ".concat(e.id," to ").concat(n.styleId)),t("setCharStyle",{id:e.id,styleId:n.styleId})),n.poseId!==e.poseId&&t("setPose",{id:e.id,poseId:n.poseId}),JSON.stringify(n.posePositions)!==JSON.stringify(e.posePositions)&&t("setPosePosition",{id:e.id,posePositions:n.posePositions})}function Et(t,e,n,r){var o=It(e);r(o),n.styles[o.styleId]||(o.styleId=0);var i=n.styles[o.styleId];n.poses[o.poseId]||(o.poseId=0),n.poses[o.poseId].style!==i.name&&(o.poseId=n.poses.findIndex((function(t,e){return e>o.poseId&&t.style===i.name})),o.poseId=n.poses.findIndex((function(t){return t.style===i.name})));var a=n.poses[o.poseId];a.left[o.posePositions.left]||(o.posePositions.left=0),a.right[o.posePositions.right]||(o.posePositions.right=0),a.variant[o.posePositions.variant]||(o.posePositions.variant=0);var s=n.poses[e.poseId],c=s.compatibleHeads[e.posePositions.headType],u=a.compatibleHeads.indexOf(c);u>=0?o.posePositions.headType=u:(o.posePositions.headType=0,o.posePositions.head=0),Dt(t,e,o)}var Nt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("fieldset",[n("legend",[t._v("Position"+t._s(t.allowSize?"/Size":"")+":")]),n("table",[n("tr",[n("td",{attrs:{colspan:"2"}},[t.allowStepMove?n("toggle",{attrs:{label:"Move freely?"},model:{value:t.freeMove,callback:function(e){t.freeMove=e},expression:"freeMove"}}):t._e()],1)]),t.allowStepMove&&!t.freeMove?n("tr",[n("td",{attrs:{colspan:"2"}},[n("table",[n("tr",[n("td",{staticClass:"arrow-col"},[n("button",{attrs:{disabled:t.isFirstPos},on:{click:function(e){--t.pos}}},[t._v("<")])]),n("td",[n("select",{directives:[{name:"model",rawName:"v-model.number",value:t.pos,expression:"pos",modifiers:{number:!0}}],attrs:{id:"current_talking"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(e){var n="_value"in e?e._value:e.value;return t._n(n)}));t.pos=e.target.multiple?n:n[0]}}},t._l(t.positionNames,(function(e,r){return n("option",{key:r,domProps:{value:r}},[t._v(t._s(e))])})),0)]),n("td",{staticClass:"arrow-col"},[n("button",{attrs:{disabled:t.isLastPos},on:{click:function(e){++t.pos}}},[t._v(">")])])])])])]):[n("tr",[t._m(0),n("td",[n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.x,expression:"x",modifiers:{number:!0}}],attrs:{id:"sprite_x",type:"number"},domProps:{value:t.x},on:{keydown:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.x=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]),n("tr",[t._m(1),n("td",[n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.y,expression:"y",modifiers:{number:!0}}],attrs:{id:"sprite_y",type:"number"},domProps:{value:t.y},on:{keydown:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.y=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])])],t.allowSize?[n("tr",[t._m(2),n("td",[n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.width,expression:"width",modifiers:{number:!0}}],attrs:{id:"sprite_w",type:"number"},domProps:{value:t.width},on:{keydown:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.width=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]),n("tr",[t._m(3),n("td",[n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.height,expression:"height",modifiers:{number:!0}}],attrs:{id:"sprite_h",type:"number"},domProps:{value:t.height},on:{keydown:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.height=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])]),n("tr",[n("td",{attrs:{colspan:"2"}},[n("toggle",{attrs:{label:"Lock ratio?"},model:{value:t.preserveRatio,callback:function(e){t.preserveRatio=e},expression:"preserveRatio"}})],1)])]:t._e()],2)])},Mt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("label",{attrs:{for:"sprite_x"}},[t._v("X:")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("label",{attrs:{for:"sprite_y"}},[t._v("Y:")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("label",{attrs:{for:"sprite_w"}},[t._v("Width:")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("label",{attrs:{for:"sprite_h"}},[t._v("Height:")])])}],Ut=function(t){function e(){return Object(d["a"])(this,e),Object(p["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(v["a"])(e,t),Object(f["a"])(e,[{key:"history",get:function(){return this.$root}},{key:"allowSize",get:function(){this.obj;return("textBox"!==this.obj.type||"custom"===this.obj.style)&&!("character"===this.obj.type&&!this.obj.freeMove)}},{key:"allowStepMove",get:function(){return"freeMove"in this.obj}},{key:"freeMove",get:function(){return this.obj.freeMove},set:function(t){var e=this;this.history.transaction((function(){e.$store.commit("objects/setFreeMove",{id:e.obj.id,freeMove:t})}))}},{key:"positionNames",get:function(){return bt}},{key:"pos",get:function(){return Rt(this.obj.x)},set:function(t){var e=this;this.history.transaction((function(){e.$store.dispatch("objects/setPosition",{id:e.obj.id,x:vt[t],y:e.obj.y})}))}},{key:"isFirstPos",get:function(){return 0===this.pos}},{key:"isLastPos",get:function(){return this.pos===bt.length-1}},{key:"x",get:function(){return this.obj.x},set:function(t){var e=this;this.history.transaction((function(){e.$store.dispatch("objects/setPosition",{id:e.obj.id,x:t,y:e.y})}))}},{key:"y",get:function(){return this.obj.y},set:function(t){var e=this;this.history.transaction((function(){e.$store.dispatch("objects/setPosition",{id:e.obj.id,x:e.x,y:t})}))}},{key:"height",get:function(){return this.obj.height},set:function(t){var e=this;this.history.transaction((function(){e.$store.dispatch("objects/setHeight",{id:e.obj.id,height:t})}))}},{key:"width",get:function(){return this.obj.width},set:function(t){var e=this;this.history.transaction((function(){e.$store.dispatch("objects/setWidth",{id:e.obj.id,width:t})}))}},{key:"preserveRatio",get:function(){return this.obj.preserveRatio},set:function(t){var e=this;this.history.transaction((function(){e.$store.dispatch("objects/setPreserveRatio",{id:e.obj.id,preserveRatio:t})}))}}]),e}(g["d"]);Object(m["a"])([Object(g["c"])({required:!0})],Ut.prototype,"obj",void 0),Ut=Object(m["a"])([Object(g["a"])({components:{Toggle:T}})],Ut);var At=Ut,Bt=At,Ft=(n("4812"),Object(S["a"])(Bt,Nt,Mt,!1,null,"35970b7c",null)),qt=Ft.exports,Ht=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("fieldset",{attrs:{id:"layerfs"}},[n("legend",[t._v("Layer:")]),n("table",[n("tbody",[n("tr",[n("td",[n("button",{attrs:{title:"Move to back"},on:{click:function(e){return t.shiftLayer(-1/0)}}},[n("i",{staticClass:"material-icons"},[t._v("vertical_align_bottom")])])]),n("td",[n("button",{attrs:{title:"Move backwards"},on:{click:function(e){return t.shiftLayer(-1)}}},[n("i",{staticClass:"material-icons"},[t._v("arrow_downward")])])]),n("td",[n("button",{attrs:{title:"Move forwards"},on:{click:function(e){return t.shiftLayer(1)}}},[n("i",{staticClass:"material-icons"},[t._v("arrow_upward")])])]),n("td",[n("button",{attrs:{title:"Move to front"},on:{click:function(e){return t.shiftLayer(1/0)}}},[n("i",{staticClass:"material-icons"},[t._v("vertical_align_top")])])])])])]),n("toggle",{attrs:{value:t.obj.onTop,label:"In front?"},on:{input:t.setInFront}})],1)},zt=[],Wt=function(t){function e(){return Object(d["a"])(this,e),Object(p["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(v["a"])(e,t),Object(f["a"])(e,[{key:"shiftLayer",value:function(t){var e=this;this.history.transaction((function(){e.$store.dispatch("objects/shiftLayer",{id:e.obj.id,delta:t})}))}},{key:"setInFront",value:function(t){var e=this;this.history.transaction((function(){e.$store.dispatch("objects/setOnTop",{id:e.obj.id,onTop:t})}))}},{key:"history",get:function(){return this.$root}}]),e}(g["d"]);Object(m["a"])([Object(g["c"])({required:!0})],Wt.prototype,"obj",void 0),Wt=Object(m["a"])([Object(g["a"])({components:{Toggle:T}})],Wt);var Vt=Wt,Yt=Vt,Gt=(n("0bac"),Object(S["a"])(Yt,Ht,zt,!1,null,"2cdcbad1",null)),Xt=Gt.exports,Qt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("table",[n("tr",[t._m(0),n("td",[n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.opacity,expression:"opacity",modifiers:{number:!0}}],attrs:{type:"number",max:"100",min:"0",id:"characterOpacity"},domProps:{value:t.opacity},on:{keydown:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.opacity=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})])])])},Jt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("label",{attrs:{for:"characterOpacity"}},[t._v("Opacity:")])])}],Kt=function(t){function e(){return Object(d["a"])(this,e),Object(p["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(v["a"])(e,t),Object(f["a"])(e,[{key:"history",get:function(){return this.$root}},{key:"opacity",get:function(){return this.obj.opacity},set:function(t){var e=this;this.history.transaction((function(){e.$store.commit("objects/setOpacity",{id:e.obj.id,opacity:t})}))}}]),e}(g["d"]);Object(m["a"])([Object(g["c"])({required:!0})],Kt.prototype,"obj",void 0),Kt=Object(m["a"])([Object(g["a"])({})],Kt);var Zt=Kt,te=Zt,ee=(n("ca64"),Object(S["a"])(te,Qt,Jt,!1,null,"78682e99",null)),ne=ee.exports,re=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("button",{on:{click:t.onClick}},[t._v("Delete")])},oe=[],ie=function(t){function e(){return Object(d["a"])(this,e),Object(p["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(v["a"])(e,t),Object(f["a"])(e,[{key:"onClick",value:function(){var t=this;this.history.transaction((function(){t.$store.dispatch("objects/removeObject",{id:t.obj.id})}))}},{key:"history",get:function(){return this.$root}}]),e}(g["d"]);Object(m["a"])([Object(g["c"])({required:!0})],ie.prototype,"obj",void 0),ie=Object(m["a"])([Object(g["a"])({})],ie);var ae=ie,se=ae,ce=Object(S["a"])(se,re,oe,!1,null,null,null),ue=ce.exports,le=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{partList:!0,vertical:t.vertical}},[n("button",{on:{click:function(e){return t.$emit("leave")}}},[t._v("Back")]),t._l(t.parts,(function(e,r){return n("part-button",{key:r,attrs:{value:r,part:e},on:{click:function(e){t.choose(r),t.$emit("leave")}}})})),t._l(t.styleComponents,(function(e){return n("fieldset",{key:e.name},[n("legend",[t._v(t._s(e.label))]),t._l(e.buttons,(function(r,o){return n("part-button",{key:o,attrs:{size:130,value:o,part:r},on:{click:function(n){return t.choose_component(e.name,o)}}})}))],2)}))],2)},he=[],de=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{part:!0,active:!1},style:t.style,on:{click:function(e){return t.$emit("click")}}})},fe=[],pe=(n("c5f6"),n("34ef"),n("6b54"),function(){function t(){Object(d["a"])(this,t),this.allowLQ=!0}return Object(f["a"])(t,[{key:"saveToFile",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=document.createElement("a"),r.setAttribute("download",n),t.next=4,this.createObjectURL(e);case 4:return o=t.sent,r.setAttribute("href",o),document.body.appendChild(r),r.click(),document.body.removeChild(r),t.abrupt("return",o);case 10:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"installBackground",value:function(t){throw new Error("This environment does not support installing backgrounds")}},{key:"installContentPack",value:function(t){throw new Error("This environment does not support installing content packs")}},{key:"uninstallBackground",value:function(t){throw new Error("This environment does not support uninstalling backgrounds")}},{key:"uninstallContentPack",value:function(t){throw new Error("This environment does not support uninstalling content packs")}},{key:"activateContentPack",value:function(t){throw new Error("This environment does not support installing content packs")}},{key:"deactivateContentPack",value:function(t){throw new Error("This environment does not support uninstalling content packs")}},{key:"prompt",value:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e){return new Promise((function(n,r){n(prompt(t,e))}))}))},{key:"onPanelChange",value:function(t){}},{key:"createObjectURL",value:function(t){var e=this;return new Promise((function(n,r){if(t.toBlob&&window.URL&&window.URL.createObjectURL)t.toBlob((function(t){t?n(URL.createObjectURL(t)):r()}),"image/png");else if(window.URL&&window.URL.createObjectURL){var o=t.toDataURL(),i=e.dataURItoBlob(o);n(URL.createObjectURL(i))}else n(t.toDataURL())}))}},{key:"dataURItoBlob",value:function(t){for(var e=atob(t.split(",")[1]),n=e.length,r=new Uint8Array(n),o=0;o<n;o++)r[o]=e.charCodeAt(o);return new Blob([r],{type:"image/png"})}},{key:"installedCharacterPacks",get:function(){return[]}},{key:"isBackgroundInstallingSupported",get:function(){return!1}},{key:"isPackInstallingSupported",get:function(){return!1}}]),t}()),be=function(t){function e(){return Object(d["a"])(this,e),Object(p["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(v["a"])(e,t),Object(f["a"])(e,[{key:"saveToFile",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.toDataURL(),o=this.dataURItoBlob(r),window.URL&&window.URL.createObjectURL&&(r=URL.createObjectURL(o)),window.navigator.msSaveBlob(o,n),t.abrupt("return",r);case 5:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()}]),e}(pe),ve=[],me=function(){function t(){var e=this;Object(d["a"])(this,t),this.allowLQ=!1,this.electron=window,this.promptCache={},this.lastPrompt=0,this.electron.ipcRenderer.on("add-persistent-character",function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:!(r.length>2&&void 0!==r[2])||r[2];case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),this.electron.ipcRenderer.on("add-persistent-background",function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r="persistentBg-"+n,n.split("/"),it(r,n),console.log(n);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),this.electron.ipcRenderer.on("push-message",function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),this.electron.ipcRenderer.on("prompt-answered",(function(t,n,r){e.promptCache[n](r)})),this.electron.ipcRenderer.send("find-customs")}return Object(f["a"])(t,[{key:"saveToFile",value:function(t,e){var n=this;return new Promise((function(r,o){t.toBlob(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(i){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i){t.next=3;break}return o(),t.abrupt("return");case 3:return t.next=5,i.arrayBuffer();case 5:a=t.sent,n.electron.ipcRenderer.send("save-file",e,new Uint8Array(a)),r(URL.createObjectURL(i));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}))}},{key:"installBackground",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"uninstallBackground",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"installContentPack",value:function(t){console.log("installContentPack",t),this.electron.ipcRenderer.send("install-content-pack",t)}},{key:"uninstallContentPack",value:function(t){console.log("uninstallContentPack",t),this.electron.ipcRenderer.send("uninstall-content-pack",t)}},{key:"activateContentPack",value:function(t){console.log("activateContentPack",t),this.electron.ipcRenderer.send("activate-content-pack",t)}},{key:"deactivateContentPack",value:function(t){console.log("deactivateContentPack",t),this.electron.ipcRenderer.send("deactivate-content-pack",t)}},{key:"prompt",value:function(t,e){var n=this;return new Promise((function(r,o){n.promptCache[++n.lastPrompt]=r,n.electron.ipcRenderer.send("show-prompt",n.lastPrompt,t,e)}))}},{key:"onPanelChange",value:function(t){this.electron.ipcRenderer.on("open-panel",(function(e,n){t(n)}))}},{key:"installedCharacterPacks",get:function(){return ve}},{key:"isBackgroundInstallingSupported",get:function(){return!0}},{key:"isPackInstallingSupported",get:function(){return!0}}]),t}();function ge(){return window.isElectron?new me:void 0!==window.navigator.msSaveOrOpenBlob?new be:new pe}var ye=ge();window.toast=ye;var ke=ye;function je(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function we(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?je(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var xe=function(t){function e(){var t;return Object(d["a"])(this,e),t=Object(p["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.lookups=[],t.loaded=!1,t}return Object(v["a"])(e,t),Object(f["a"])(e,[{key:"created",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.part.images.map((function(t){return"string"===typeof t?nt(t,!1):Z(t,!1)})));case 2:this.lookups=t.sent;case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"scaleX",get:function(){return this.size/this.part.size[0]}},{key:"scaleY",get:function(){return this.size/this.part.size[1]}},{key:"backgroundSize",get:function(){return"".concat(Math.floor(960*this.scaleX),"px ").concat(Math.floor(960*this.scaleY),"px")}},{key:"backgroundPosition",get:function(){return"".concat(Math.floor(this.part.offset[0]*-this.scaleX),"px ")+"".concat(Math.floor(this.part.offset[1]*-this.scaleY),"px")}},{key:"style",get:function(){var t={height:this.size+"px",width:this.size+"px",backgroundPosition:this.backgroundPosition,backgroundSize:this.backgroundSize},e=(ke.allowLQ,this.lookups.filter((function(t){return t instanceof HTMLImageElement})).map((function(t){return"url('".concat(t.src.replace("'","\\'"),"')")})));return we({backgroundImage:e.join(",")},t)}}]),e}(g["d"]);Object(m["a"])([Object(g["c"])({required:!0})],xe.prototype,"part",void 0),Object(m["a"])([Object(g["c"])({required:!0})],xe.prototype,"value",void 0),Object(m["a"])([Object(g["c"])({default:150,type:Number})],xe.prototype,"size",void 0),xe=Object(m["a"])([Object(g["a"])({components:{}})],xe);var Oe=xe,Ce=Oe,Pe=(n("fb87"),Object(S["a"])(Ce,de,fe,!1,null,"4ebd85c5",null)),_e=Pe.exports,Re=function(t){function e(){var t;return Object(d["a"])(this,e),t=Object(p["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.isWebPSupported=null,t.styleData={lastBase:"",components:{}},t}return Object(v["a"])(e,t),Object(f["a"])(e,[{key:"updateStyleData",value:function(){var t=Ct(this.charData,this.character),e=this.charData.styles.find((function(e){return e.name===t.style}));e&&(this.styleData.lastBase=e.styleGroup,this.styleData.components=e.components)}},{key:"created",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.updateStyleData(),t.next=3,Q();case 3:this.isWebPSupported=t.sent;case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"generatePosePreview",value:function(t){var e=this.charData,n=e.heads[t.compatibleHeads[0]],r=n?n.variants[0]:null,o=[],i=!0,a=!1,s=void 0;try{for(var c,u=t.renderOrder[Symbol.iterator]();!(i=(c=u.next()).done);i=!0){var l=c.value;switch(l.toUpperCase()){case"S":t.static&&(o=o.concat(t.static));break;case"V":t.variant.length>0&&(o=o.concat(t.variant[0]));break;case"L":t.left.length>0&&(o=o.concat(t.left[0]));break;case"R":t.right.length>0&&(o=o.concat(t.right[0]));break;case"H":r&&(o=o.concat(r));break}}}catch(h){a=!0,s=h}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}return{images:o,size:t.size,offset:t.offset}}},{key:"updatePose",value:function(){var t=this,e=this.charData,n=e.styles.filter((function(e){return e.styleGroup===t.styleData.lastBase})),r=!0,o=!1,i=void 0;try{for(var a,s=function(){var e=a.value,r=n.filter((function(n){return n.components[e.name]===t.styleData.components[e.name]}));r.length>0&&(n=r)},c=e.styleComponents[Symbol.iterator]();!(r=(a=c.next()).done);r=!0)s()}catch(u){o=!0,i=u}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}this.setPart("style",e.styles.indexOf(n[0]))}},{key:"choose",value:function(t){if("style"===this.part)this.styleData.lastBase=t,this.updatePose();else if("head"===this.part){var e=t.split("_",2).map((function(t){return parseInt(t,10)})),n=Object(h["a"])(e,2),r=n[0],o=n[1];this.setPart("headType",r),this.setPart("head",o)}else this.setPart(this.part,parseInt(t,10))}},{key:"choose_component",value:function(t,e){this.styleData.components[t]=e,this.updatePose()}},{key:"setPart",value:function(t,e){var n=this;this.history.transaction((function(){n.$store.dispatch("objects/setPart",{id:n.character.id,part:t,val:e})}))}},{key:"history",get:function(){return this.$root}},{key:"charData",get:function(){return xt(this.$store,this.character)}},{key:"styleComponents",get:function(){return"style"!==this.part?[]:this.charData.styleComponents.map((function(t){var e={};for(var n in t.variants)if(t.variants.hasOwnProperty(n)){var r=t.variants[n];e[n]={size:[960,960],offset:[0,0],images:[r]}}return{label:t.label,name:t.name,buttons:e}}))}},{key:"parts",get:function(){var t,e,n,r=this,o={},i=this.charData,a=Ct(i,this.character);switch(this.part){case"head":for(var s=0;s<a.compatibleHeads.length;++s)for(var c=a.compatibleHeads[s],u=i.heads[c],l=0;l<u.variants.length;++l){var h=u.variants[l];o["".concat(s,"_").concat(l)]={images:h,size:u.size,offset:u.offset}}return o;case"variant":t=a.variant,n=a.size,e=a.offset;break;case"left":t=a.left,n=a.size,e=a.offset;break;case"right":t=a.right,n=a.size,e=a.offset;break;case"pose":for(var d=i.styles[this.character.styleId],f=0;f<i.poses.length;++f){var p=i.poses[f];p.style===d.name&&(o[f]=this.generatePosePreview(p))}return o;case"style":var b=i.styles,v=b.map((function(t){return t.styleGroup})).filter((function(t,e,n){return n.indexOf(t)===e})),m=!0,g=!1,y=void 0;try{for(var k,j=function(){var t=k.value,e=b.find((function(e){return e.styleGroup===t})),n=i.poses.find((function(t){return t.style===e.name}));o[t]=r.generatePosePreview(n)},w=v[Symbol.iterator]();!(m=(k=w.next()).done);m=!0)j()}catch(C){g=!0,y=C}finally{try{m||null==w.return||w.return()}finally{if(g)throw y}}return o;default:throw new Error("Unrecognised pose part: "+this.part)}for(var x=0;x<t.length;++x){var O=t[x];o[x]={images:O,size:n,offset:e}}return o}}]),e}(g["d"]);Object(m["a"])([Object(j["a"])("vertical",{namespace:"ui"})],Re.prototype,"vertical",void 0),Object(m["a"])([Object(g["c"])({required:!0})],Re.prototype,"character",void 0),Object(m["a"])([Object(g["c"])({required:!0,type:String})],Re.prototype,"part",void 0),Object(m["a"])([Object(g["e"])("character")],Re.prototype,"updateStyleData",null),Re=Object(m["a"])([Object(g["a"])({components:{PartButton:_e}})],Re);var Se=Re,$e=Se,Te=(n("3c8e"),Object(S["a"])($e,le,he,!1,null,"cc4c7b62",null)),Le=Te.exports,Ie=function(t){function e(){var t;return Object(d["a"])(this,e),t=Object(p["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.panelForParts=null,t}return Object(v["a"])(e,t),Object(f["a"])(e,[{key:"seekPose",value:function(t){var e=this;this.history.transaction((function(){e.$store.dispatch("objects/seekPose",{id:e.character.id,delta:t})}))}},{key:"seekStyle",value:function(t){var e=this;this.history.transaction((function(){e.$store.dispatch("objects/seekStyle",{id:e.character.id,delta:t})}))}},{key:"seekPart",value:function(t,e){var n=this;this.history.transaction((function(){n.$store.dispatch("objects/seekPart",{id:n.character.id,delta:e,part:t})}))}},{key:"captialize",value:function(t){return t.charAt(0).toUpperCase()+t.substring(1)}},{key:"character",get:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("character"===t.type)return t}},{key:"history",get:function(){return this.$root}},{key:"charData",get:function(){return xt(this.$store,this.character)}},{key:"label",get:function(){return this.charData.label}},{key:"parts",get:function(){return Pt(this.charData,this.character)}},{key:"hasMultipleStyles",get:function(){return this.charData.styles.length>1}},{key:"hasMultiplePoses",get:function(){var t=this.charData.styles[this.character.styleId];return this.charData.poses.filter((function(e){return e.style===t.name})).length>1}},{key:"flip",get:function(){return this.character.flip},set:function(t){var e=this;this.history.transaction((function(){e.$store.commit("objects/setFlip",{id:e.character.id,flip:t})}))}},{key:"closeUp",get:function(){return this.character.close},set:function(t){var e=this;this.history.transaction((function(){e.$store.commit("objects/setClose",{id:e.character.id,close:t})}))}}]),e}(Object(g["b"])(L));Ie=Object(m["a"])([Object(g["a"])({components:{Toggle:T,PositionAndSize:qt,Layers:Xt,Opacity:ne,Delete:ue,Parts:Le}})],Ie);var De=Ie,Ee=De,Ne=(n("18ea"),Object(S["a"])(Ee,ht,dt,!1,null,"0cd6b3fa",null)),Me=Ne.exports,Ue=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"panel"},[n("h1",[t._v("Custom Sprite")]),n("position-and-size",{attrs:{obj:t.sprite}}),n("layers",{attrs:{obj:t.sprite}}),n("opacity",{attrs:{obj:t.sprite}}),n("toggle",{attrs:{label:"Flip?"},model:{value:t.flip,callback:function(e){t.flip=e},expression:"flip"}}),n("delete",{attrs:{obj:t.sprite}})],1)},Ae=[],Be=function(t){function e(){return Object(d["a"])(this,e),Object(p["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(v["a"])(e,t),Object(f["a"])(e,[{key:"sprite",get:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("sprite"===t.type)return t}},{key:"history",get:function(){return this.$root}},{key:"flip",get:function(){return this.sprite.flip},set:function(t){var e=this;this.history.transaction((function(){e.$store.commit("objects/setFlip",{id:e.sprite.id,flip:t})}))}}]),e}(Object(g["b"])(L));Be=Object(m["a"])([Object(g["a"])({components:{Toggle:T,PositionAndSize:qt,Layers:Xt,Opacity:ne,Delete:ue}})],Be);var Fe=Be,qe=Fe,He=(n("2fcb"),Object(S["a"])(qe,Ue,Ae,!1,null,"1ef64526",null)),ze=He.exports,We=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"panel"},[n("h1",[t._v("Textbox")]),n("table",{staticClass:"upper-combos"},[n("tr",[t._m(0),n("td",[n("select",{directives:[{name:"model",rawName:"v-model",value:t.textBoxStyle,expression:"textBoxStyle"}],attrs:{id:"text_style"},on:{keydown:function(t){t.stopPropagation()},change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.textBoxStyle=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"normal"}},[t._v("Normal")]),n("option",{attrs:{value:"corrupt"}},[t._v("Corrupt")]),n("option",{attrs:{value:"custom"}},[t._v("Custom")])])])]),n("tr",[t._m(1),n("td",[n("select",{directives:[{name:"model",rawName:"v-model",value:t.talkingDefaults,expression:"talkingDefaults"}],attrs:{id:"current_talking"},on:{keydown:function(t){t.stopPropagation()},change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.talkingDefaults=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"No-one"}},[t._v("No-one")]),n("option",{attrs:{value:"Sayori"}},[t._v("Sayori")]),n("option",{attrs:{value:"Yuri"}},[t._v("Yuri")]),n("option",{attrs:{value:"Natsuki"}},[t._v("Natsuki")]),n("option",{attrs:{value:"Monika"}},[t._v("Monika")]),n("option",{attrs:{value:"FeMC"}},[t._v("FeMC")]),n("option",{attrs:{value:"MC"}},[t._v("MC")]),n("option",{attrs:{value:"Chad"}},[t._v("Chad")]),n("option",{attrs:{value:"Amy"}},[t._v("Amy")]),n("option",{attrs:{value:"Other"}},[t._v("Other")])])])]),n("tr",[t._m(2),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.talkingOther,expression:"talkingOther"}],attrs:{id:"custom_name"},domProps:{value:t.talkingOther},on:{keydown:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.talkingOther=e.target.value)}}})])])]),n("toggle",{attrs:{label:"Controls visible?"},model:{value:t.showControls,callback:function(e){t.showControls=e},expression:"showControls"}}),n("toggle",{attrs:{label:"Able to skip?"},model:{value:t.allowSkipping,callback:function(e){t.allowSkipping=e},expression:"allowSkipping"}}),n("toggle",{attrs:{label:"Continue arrow?"},model:{value:t.showContinueArrow,callback:function(e){t.showContinueArrow=e},expression:"showContinueArrow"}}),n("toggle",{attrs:{label:"Auto quoting?"},model:{value:t.autoQuoting,callback:function(e){t.autoQuoting=e},expression:"autoQuoting"}}),n("div",{attrs:{id:"dialog_text_wrapper"}},[n("label",{attrs:{for:"dialog_text"}},[t._v("Dialog:")]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.dialog,expression:"dialog"}],attrs:{id:"dialog_text"},domProps:{value:t.dialog},on:{keydown:function(t){t.stopPropagation()},input:function(e){e.target.composing||(t.dialog=e.target.value)}}})]),n("position-and-size",{attrs:{obj:t.textbox}}),n("button",{on:{click:t.splitTextbox}},[t._v("Split textbox")]),n("layers",{attrs:{obj:t.textbox}}),n("opacity",{attrs:{obj:t.textbox}}),n("toggle",{attrs:{label:"Flip?"},model:{value:t.flip,callback:function(e){t.flip=e},expression:"flip"}}),"custom"===t.textBoxStyle?n("fieldset",[n("legend",[t._v("Customization:")]),n("label",{attrs:{for:"textbox_color"}},[t._v("Color:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.textboxColor,expression:"textboxColor"}],attrs:{id:"textbox_color",type:"color"},domProps:{value:t.textboxColor},on:{input:function(e){e.target.composing||(t.textboxColor=e.target.value)}}}),n("br"),n("label",{attrs:{for:"custom_namebox_width"}},[t._v("Namebox width:")]),n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.customNameboxWidth,expression:"customNameboxWidth",modifiers:{number:!0}}],attrs:{id:"custom_namebox_width",type:"number"},domProps:{value:t.customNameboxWidth},on:{input:function(e){e.target.composing||(t.customNameboxWidth=t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),n("br"),n("label",{attrs:{for:"derive_custom_colors"}},[t._v("Derive other colors:")]),n("toggle",{attrs:{id:"derive_custom_colors"},model:{value:t.deriveCustomColors,callback:function(e){t.deriveCustomColors=e},expression:"deriveCustomColors"}}),t.deriveCustomColors?t._e():[n("label",{attrs:{for:"custom_controls_color"}},[t._v("Controls Color:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.customControlsColor,expression:"customControlsColor"}],attrs:{id:"custom_controls_color",type:"color"},domProps:{value:t.customControlsColor},on:{input:function(e){e.target.composing||(t.customControlsColor=e.target.value)}}}),n("br"),n("label",{attrs:{for:"custom_namebox_color"}},[t._v("Namebox Color:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.customNameboxColor,expression:"customNameboxColor"}],attrs:{id:"custom_namebox_color",type:"color"},domProps:{value:t.customNameboxColor},on:{input:function(e){e.target.composing||(t.customNameboxColor=e.target.value)}}}),n("br"),n("label",{attrs:{for:"custom_namebox_stroke"}},[t._v("Namebox text stroke:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.customNameboxStroke,expression:"customNameboxStroke"}],attrs:{id:"custom_namebox_stroke",type:"color"},domProps:{value:t.customNameboxStroke},on:{input:function(e){e.target.composing||(t.customNameboxStroke=e.target.value)}}})]],2):t._e(),n("delete",{attrs:{obj:t.textbox}})],1)},Ve=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("label",{attrs:{for:"text_style"}},[t._v("Style:")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("label",{attrs:{for:"current_talking"}},[t._v("Person talking:")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("td",[n("label",{attrs:{for:"custom_name"}},[t._v("Other name:")])])}],Ye=function(t){function e(){return Object(d["a"])(this,e),Object(p["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(v["a"])(e,t),Object(f["a"])(e,[{key:"splitTextbox",value:function(){var t=this;this.history.transaction((function(){t.$store.dispatch("objects/splitTextbox",{id:t.textbox.id})}))}},{key:"textbox",get:function(){var t=this.$store.state.objects.objects[this.$store.state.ui.selection];if("textBox"===t.type)return t}},{key:"history",get:function(){return this.$root}},{key:"talkingDefaults",get:function(){return this.textbox.talkingDefault},set:function(t){var e=this;this.history.transaction((function(){e.$store.commit("objects/setTalkingDefault",{id:e.textbox.id,talkingDefault:t})}))}},{key:"talkingOther",get:function(){return this.textbox.talkingOther},set:function(t){var e=this;this.history.transaction((function(){e.$store.commit("objects/setTalkingOther",{id:e.textbox.id,talkingOther:t})}))}},{key:"showControls",get:function(){return this.textbox.controls},set:function(t){var e=this;this.history.transaction((function(){e.$store.commit("objects/setControlsVisible",{id:e.textbox.id,controls:t})}))}},{key:"allowSkipping",get:function(){return this.textbox.controls},set:function(t){var e=this;this.history.transaction((function(){e.$store.commit("objects/setSkipable",{id:e.textbox.id,skip:t})}))}},{key:"autoQuoting",get:function(){return this.textbox.autoQuoting},set:function(t){var e=this;this.history.transaction((function(){e.$store.commit("objects/setAutoQuoting",{id:e.textbox.id,autoQuoting:t})}))}},{key:"showContinueArrow",get:function(){return this.textbox.continue},set:function(t){var e=this;this.history.transaction((function(){e.$store.commit("objects/setContinueArrow",{id:e.textbox.id,continue:t})}))}},{key:"dialog",get:function(){return this.textbox.text},set:function(t){var e=this;this.history.transaction((function(){e.$store.commit("objects/setText",{id:e.textbox.id,text:t})}))}},{key:"flip",get:function(){return this.textbox.flip},set:function(t){var e=this;this.history.transaction((function(){e.$store.commit("objects/setFlip",{id:e.textbox.id,flip:t})}))}},{key:"textBoxStyle",get:function(){return this.textbox.style},set:function(t){this.$store.dispatch("objects/setStyle",{id:this.textbox.id,style:t})}},{key:"textboxColor",get:function(){return this.textbox.customColor},set:function(t){this.$store.commit("objects/setCustomColor",{id:this.textbox.id,color:t})}},{key:"deriveCustomColors",get:function(){return this.textbox.deriveCustomColors},set:function(t){this.$store.commit("objects/setDeriveCustomColors",{id:this.textbox.id,deriveCustomColors:t})}},{key:"customControlsColor",get:function(){return this.textbox.customControlsColor},set:function(t){this.$store.commit("objects/setControlsColor",{id:this.textbox.id,customControlsColor:t})}},{key:"customNameboxColor",get:function(){return this.textbox.customNameboxColor},set:function(t){this.$store.commit("objects/setNameboxColor",{id:this.textbox.id,customNameboxColor:t})}},{key:"customNameboxWidth",get:function(){return this.textbox.customNameboxWidth},set:function(t){this.$store.commit("objects/setNameboxWidth",{id:this.textbox.id,customNameboxWidth:t})}},{key:"customNameboxStroke",get:function(){return this.textbox.customNameboxStroke},set:function(t){this.$store.commit("objects/setNameboxStroke",{id:this.textbox.id,customNameboxStroke:t})}}]),e}(Object(g["b"])(L));Ye=Object(m["a"])([Object(g["a"])({components:{Toggle:T,PositionAndSize:qt,Layers:Xt,Opacity:ne,Delete:ue}})],Ye);var Ge=Ye,Xe=Ge,Qe=(n("781b"),Object(S["a"])(Xe,We,Ve,!1,null,"75b6bc2e",null)),Je=Qe.exports,Ke=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},Ze=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"panel"},[n("h1",[t._v("Credits")]),n("p",[t._v("\n\t\tAll assets used are IP of Team Salvato and created by them, unless noted\n\t\totherwise.\n\t")]),n("p",[t._v("\n\t\tUnused House Background by\n\t\t"),n("a",{attrs:{target:"_blank",rel:"noopener noreferrer",href:"https://www.deviantart.com/fatelogic/art/VN-Background-Practice-295671161"}},[t._v("Fatelogic")])]),n("p",[t._v("\n\t\tDoki Doki Dialog Generator developed by EDave64\n\t\t"),n("br"),t._v("Based on gemdude46's DDLC Shitpost generator\n\t")]),n("p",[t._v("\n\t\tMC Classic Sprite by Childish-N\n\t\t"),n("br"),t._v("MC Classic Chibi by GyleToTheRescue\n\t")]),n("p",[t._v("\n\t\tMC Sprite by Childish-N\n\t\t"),n("br"),t._v("MC Casual Sprite by SlightlySimple\n\t\t"),n("br"),t._v("MC Chibi by SlightlySimple\n\t")]),n("p",[t._v("\n\t\tMC Chad Sprite by Cylent-Nite\n\t\t"),n("br"),t._v("MC Chad Poses and expressions by SlightlySimple\n\t\t"),n("br"),t._v("MC Chad Poses\n\t\tand chibi by Meddy-sin\n\t")]),n("p",[t._v("\n\t\tFeMC Sprite by Meddy-sin\n\t\t"),n("br"),t._v("FeMC Casual Sprite by SlightlySimple\n\t")]),n("p",[t._v("Classic Amy Sprite by Meddy-sin")]),n("p",[t._v("Amy Sprite by Meddy-sin and SlightlySimple")]),n("p",[t._v("Special thanks to SlightlySimple for testing and technical help")])])}],tn=function(t){function e(){return Object(d["a"])(this,e),Object(p["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(v["a"])(e,t),e}(Object(g["b"])(L));tn=Object(m["a"])([Object(g["a"])({components:{}})],tn);var en=tn,nn=en,rn=(n("1bd8"),Object(S["a"])(nn,Ke,Ze,!1,null,"72cb4a6e",null)),on=rn.exports,an=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"panel"},[n("h1",[t._v("Background")]),n("background-settings",{attrs:{value:t.value}}),t._l(t.backgrounds,(function(e){return n("background-button",{key:e,attrs:{background:e},on:{input:function(n){return t.setBackground(e)}}})})),n("div",{staticClass:"btn upload-background",on:{click:function(e){return t.$refs.upload.click()}}},[t._v("\n\t\tUpload\n\t\t"),n("input",{ref:"upload",attrs:{type:"file"},on:{change:t.onFileUpload}})]),n("button",{staticClass:"upload-background",on:{click:t.addByUrl}},[t._v("Add by URL")])],2)},sn=[],cn=n("75fc"),un=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{background:!0,active:t.isActive},style:t.style,attrs:{title:t.title},on:{click:function(e){return t.$emit("input",t.background)}}},[t._v(t._s(t.title))])},ln=[],hn=function(t){function e(){var t;return Object(d["a"])(this,e),t=Object(p["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.isWebPSupported=null,t.assets=[],t}return Object(v["a"])(e,t),Object(f["a"])(e,[{key:"created",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.bgData){t.next=4;break}return t.next=3,Promise.all(this.bgData.variants[0].map((function(t){return Z(t,!1)})));case 3:this.assets=t.sent;case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"bgData",get:function(){var t=this.$store.getters["content/getBackgrounds"];return t.get(this.background)||null}},{key:"isActive",get:function(){return this.background===this.$store.state.background.current}},{key:"title",get:function(){switch(this.background){case"buildin.static-color":return"Static color";case"buildin.transparent":return"Transparent"}return this.bgData.label}},{key:"style",get:function(){switch(this.background){case"buildin.static-color":return{"background-color":this.$store.state.background.color};case"buildin.transparent":return{}}this.bgData.variants[0];var t=this.assets.filter((function(t){return t instanceof HTMLImageElement})).map((function(t){return"url('".concat(t.src,"')")})).join(",");return{backgroundImage:t}}}]),e}(g["d"]);Object(m["a"])([Object(g["c"])({required:!0})],hn.prototype,"background",void 0),hn=Object(m["a"])([Object(g["a"])({components:{}})],hn);var dn=hn,fn=dn,pn=(n("671a"),Object(S["a"])(fn,un,ln,!1,null,"f64ed4b2",null)),bn=pn.exports,vn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("fieldset",[n("legend",[t._v("Settings:")]),t.isColor?[n("label",{attrs:{for:"bg_color"}},[t._v("Color:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.color,expression:"color"}],attrs:{id:"bg_color",type:"color"},domProps:{value:t.color},on:{input:function(e){e.target.composing||(t.color=e.target.value)}}})]:t._e(),t.isVariant?n("table",[n("tr",[n("td",{attrs:{colspan:"3"}},[n("toggle",{attrs:{label:"Flipped?"},model:{value:t.flipped,callback:function(e){t.flipped=e},expression:"flipped"}})],1)]),t.hasVariants?n("tr",[n("td",[n("button",{on:{click:function(e){return t.seekVariant(-1)}}},[t._v("<")])]),n("td",[t._v("Variant")]),n("td",[n("button",{on:{click:function(e){return t.seekVariant(1)}}},[t._v(">")])])]):t._e(),n("tr",[n("td",{attrs:{colspan:"3"}},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.scaling,expression:"scaling"}],on:{keydown:function(t){t.stopPropagation()},change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.scaling=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"0"}},[t._v("None")]),n("option",{attrs:{value:"1"}},[t._v("Stretch")]),n("option",{attrs:{value:"2"}},[t._v("Cover")])])])])]):t._e()],2)},mn=[],gn=function(t){function e(){return Object(d["a"])(this,e),Object(p["a"])(this,Object(b["a"])(e).apply(this,arguments))}return Object(v["a"])(e,t),Object(f["a"])(e,[{key:"seekVariant",value:function(t){var e=this;this.history.transaction((function(){e.$store.dispatch("background/seekVariant",{delta:t})}))}},{key:"history",get:function(){return this.$root}},{key:"bgData",get:function(){var t=this;return this.$store.state.content.current.backgrounds.find((function(e){return e.label===t.currentBackgroundId}))||null}},{key:"isColor",get:function(){return"buildin.static-color"===this.currentBackgroundId}},{key:"color",get:function(){return this.$store.state.background.color},set:function(t){var e=this;this.history.transaction((function(){e.$store.commit("background/setColor",{color:t})}))}},{key:"flipped",get:function(){return this.$store.state.background.flipped},set:function(t){var e=this;this.history.transaction((function(){e.$store.commit("background/setFlipped",{flipped:t})}))}},{key:"scaling",get:function(){return this.$store.state.background.scaling.toString()},set:function(t){var e=this;this.history.transaction((function(){e.$store.commit("background/setScaling",{scaling:parseInt(t)})}))}},{key:"isVariant",get:function(){return!!this.bgData}},{key:"hasVariants",get:function(){return!!this.bgData&&this.bgData.variants.length>1}}]),e}(g["d"]);Object(m["a"])([Object(j["a"])("current",{namespace:"background"})],gn.prototype,"currentBackgroundId",void 0),gn=Object(m["a"])([Object(g["a"])({components:{Toggle:T}})],gn);var yn=gn,kn=yn,jn=(n("8404"),Object(S["a"])(kn,vn,mn,!1,null,"fbd68b36",null)),wn=jn.exports,xn=function(t){function e(){var t;return Object(d["a"])(this,e),t=Object(p["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.uploadedBackgroundsPack={packId:"buildin.uploadedBackgrounds",packCredits:"",characters:[],fonts:[],sprites:[],poemStyles:[],backgrounds:[]},t.customPathLookup={},t.customBGCount=0,t}return Object(v["a"])(e,t),Object(f["a"])(e,[{key:"setBackground",value:function(t){this.$store.commit("background/setCurrent",{current:t})}},{key:"onFileUpload",value:function(t){var e=this.$refs.upload;if(e.files){var n=!0,r=!1,o=void 0;try{for(var i,a=e.files[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value,c=URL.createObjectURL(s);this.uploadedBackgroundsPack.backgrounds.push({label:s.name,variants:[[c]]}),this.$store.dispatch("content/replaceContentPack",{contentPack:this.uploadedBackgroundsPack})}}catch(u){r=!0,o=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}}},{key:"addByUrl",value:function(){var t=prompt("Enter the URL of the image");if(t){++this.customBGCount;var e=t.split("/").slice(-1)[0];this.uploadedBackgroundsPack.backgrounds.push({label:e,variants:[[t]]}),this.$store.dispatch("content/replaceContentPack",{contentPack:this.uploadedBackgroundsPack})}}},{key:"backgrounds",get:function(){return[].concat(Object(cn["a"])(this.$store.state.content.current.backgrounds.map((function(t){return t.label}))),["buildin.static-color","buildin.transparent"])}}]),e}(Object(g["b"])(L));Object(m["a"])([Object(g["c"])({required:!0})],xn.prototype,"value",void 0),xn=Object(m["a"])([Object(g["a"])({components:{BackgroundButton:bn,BackgroundSettings:wn}})],xn);var On=xn,Cn=On,Pn=(n("6ee7"),Object(S["a"])(Cn,an,sn,!1,null,"0d2fdc72",null)),_n=Pn.exports,Rn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"panel"},[n("h1",[t._v("Content Packs")]),n("button",{on:{click:t.addNew}},[t._v("Add new Pack")]),n("fieldset",[n("legend",[t._v("Installed Packs:")]),n("div",{staticClass:"list"},t._l(t.packs,(function(e){return n("div",{key:e.name,class:{active:e.name===t.name},on:{click:function(n){return t.select(e.name)}}},[t._v(t._s(e.name))])})),0)]),n("label",{attrs:{for:"pack_name"}},[t._v("Name:")]),n("input",{attrs:{id:"pack_name",readonly:""},domProps:{value:t.name}}),n("label",{attrs:{for:"pack_credits"}},[t._v("Credits:")]),n("div",{attrs:{id:"pack_credits"},domProps:{innerHTML:t._s(t.credits)}}),t.activatable?n("button",{on:{click:t.activate}},[t._v("Activate")]):t._e(),t.deactivatable?n("button",{on:{click:t.deactivate}},[t._v("Deactivate")]):t._e(),t.installable?n("button",{on:{click:t.install}},[t._v("Install")]):t._e(),t.uninstallable?n("button",{on:{click:t.uninstall}},[t._v("Uninstall")]):t._e(),t.needRestart?n("div",[t._v("\n\t\tThe tool need restart for changes to take effect.\n\t\t"),n("button",{on:{click:t.restart}},[t._v("Restart Now")])]):t._e()])},Sn=[],$n=(n("4917"),n("2fdb"),n("6762"),n("1c4c"),["h3","h4","h5","h6","blockquote","p","a","ul","ol","nl","li","b","i","strong","em","strike","code","hr","br","div","table","thead","caption","tbody","tr","th","td","pre"]),Tn={a:["href"],img:["src"]},Ln=["href","src"],In=["http","https"],Dn={a:{target:"_blank",rel:"noopener noreferrer"}};function En(t){var e=document.createElement("div"),n=document.createElement("div");n.innerHTML=t;for(var r=0,o=Array.from(n.childNodes);r<o.length;r++){var i=o[r],a=!0,s=!1,c=void 0;try{for(var u,l=Mn(i)[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var h=u.value;e.appendChild(h)}}catch(d){s=!0,c=d}finally{try{a||null==l.return||l.return()}finally{if(s)throw c}}}return e.innerHTML}var Nn=/^(\w+):/;function Mn(t){if(t.nodeType!==Node.ELEMENT_NODE)return[t];var e=t,n=[],r=e.tagName.toLowerCase();if($n.includes(r)){n.push(e);var o=Array.prototype.slice.call(e.attributes),i=Tn[r]||[],a=!0,s=!1,c=void 0;try{for(var u,l=o[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var h=u.value;if(i.includes(h.name)){if(Ln.includes(h.name)){var d=h.value.match(Nn);d&&!In.includes(d[1])&&e.removeAttribute(h.name)}}else e.removeAttribute(h.name)}}catch(j){s=!0,c=j}finally{try{a||null==l.return||l.return()}finally{if(s)throw c}}var f=Dn[r];if(f)for(var p in f)f.hasOwnProperty(p)&&e.setAttribute(p,f[p])}else{n.push(document.createTextNode("<".concat(r,">")));var b=!0,v=!1,m=void 0;try{for(var g,y=e.childNodes[Symbol.iterator]();!(b=(g=y.next()).done);b=!0){var k=g.value;n=n.concat(Mn(k))}}catch(j){v=!0,m=j}finally{try{b||null==y.return||y.return()}finally{if(v)throw m}}n.push(document.createTextNode("</".concat(r,">")))}return n}var Un=function(t){function e(){var t;return Object(d["a"])(this,e),t=Object(p["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.selectedPack=null,t.needRestart=!1,t}return Object(v["a"])(e,t),Object(f["a"])(e,[{key:"created",value:function(){var t=ke.installedCharacterPacks;console.log("packs:",t)}},{key:"select",value:function(t){this.selectedPack=this.packs.find((function(e){return e.name===t}))||null}},{key:"addNew",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ke.prompt("Enter the URL of the character pack:");case 2:if(e=t.sent,e){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,this.$store.dispatch("content/loadContentPacks",e);case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"restart",value:function(){location.reload(!0)}},{key:"install",value:function(){this.selectedPack&&(ke.installContentPack(this.selectedPack.url),this.selectedPack.queuedUninstall?this.selectedPack.queuedUninstall=!1:this.selectedPack.installed=!0)}},{key:"uninstall",value:function(){this.selectedPack&&(ke.uninstallContentPack(this.selectedPack.url),this.selectedPack.queuedUninstall=!0,this.needRestart=!0)}},{key:"activate",value:function(){this.selectedPack&&(ke.activateContentPack(this.selectedPack.url),this.selectedPack.active=!0,this.needRestart=!0)}},{key:"deactivate",value:function(){this.selectedPack&&(ke.deactivateContentPack(this.selectedPack.url),this.selectedPack.active=!1,this.needRestart=!0)}},{key:"packs",get:function(){var t=this.$store.state.content.contentPacks;return t.map((function(t){return{name:t.packId,credits:t.packCredits,installed:!0,active:!0,queuedUninstall:!1,freshInstall:!1,url:""}}))}},{key:"name",get:function(){return this.selectedPack?this.selectedPack.name:""}},{key:"credits",get:function(){return this.selectedPack?En(this.selectedPack.credits||""):""}},{key:"activatable",get:function(){return!!ke.isPackInstallingSupported&&(!!this.selectedPack&&(!!this.selectedPack.installed&&(!this.selectedPack.queuedUninstall&&(!this.selectedPack.freshInstall&&!this.selectedPack.active))))}},{key:"deactivatable",get:function(){return!!ke.isPackInstallingSupported&&(!!this.selectedPack&&(!!this.selectedPack.installed&&(!this.selectedPack.queuedUninstall&&(!this.selectedPack.freshInstall&&this.selectedPack.active))))}},{key:"installable",get:function(){return!!ke.isPackInstallingSupported&&(!!this.selectedPack&&(this.selectedPack.queuedUninstall||!this.selectedPack.installed))}},{key:"uninstallable",get:function(){return!!ke.isPackInstallingSupported&&(!!this.selectedPack&&(!this.selectedPack.freshInstall&&!(this.selectedPack.queuedUninstall||!this.selectedPack.installed)))}}]),e}(Object(g["b"])(L));Un=Object(m["a"])([Object(g["a"])({components:{}})],Un);var An=Un,Bn=An,Fn=(n("480b"),Object(S["a"])(Bn,Rn,Sn,!1,null,"74799c18",null)),qn=Fn.exports,Hn=function(t){function e(){var t;return Object(d["a"])(this,e),t=Object(p["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.panelSelection="",t}return Object(v["a"])(e,t),Object(f["a"])(e,[{key:"create",value:function(){var t=this;ke.onPanelChange((function(e){t.panelSelection=e}))}},{key:"setPanel",value:function(t){t===this.panelSelection&&(t=""),this.panelSelection=t,this.selection&&this.$store.commit("ui/setSelection",null)}},{key:"onSelectionChange",value:function(t){t?this.panelSelection="selection":"selection"===this.panelSelection&&(this.panelSelection="")}},{key:"selection",get:function(){return this.$store.state.ui.selection}},{key:"panel",get:function(){if("selection"===this.panelSelection){if(null!==this.selection){var t=this.$store.state.objects.objects[this.selection];return t.type}this.panelSelection=""}return this.panelSelection}}]),e}(g["d"]);Object(m["a"])([Object(j["a"])("vertical",{namespace:"ui"})],Hn.prototype,"vertical",void 0),Object(m["a"])([Object(g["e"])("selection")],Hn.prototype,"onSelectionChange",null),Hn=Object(m["a"])([Object(g["a"])({components:{GeneralPanel:B,AddPanel:lt,BackgroundsPanel:_n,CreditsPanel:on,CharacterPanel:Me,TextBoxPanel:Je,SpritePanel:ze,ContentPacksPanel:qn}})],Hn);var zn=Hn,Wn=zn,Vn=(n("4a58"),Object(S["a"])(Wn,y,k,!1,null,null,null)),Yn=Vn.exports,Gn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{vertical:t.vertical},attrs:{id:"messageConsole"}},[t.showLoading?n("p",[t._v("Loading...")]):t._e(),t._l(t.messages,(function(e,r){return n("p",{key:e+"_"+r},[t._v(t._s(e))])}))],2)},Xn=[],Qn=function(t){function e(){var t;return Object(d["a"])(this,e),t=Object(p["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.messages=[],t.showLoading=!1,t.showLoadingTimeout=0,t.hideLoadingTimeout=0,t}return Object(v["a"])(e,t),Object(f["a"])(e,[{key:"created",value:function(){var t=this;this.onLoadingChange(this.loading),z.subscribe(W,(function(e){t.messages.push("Failed to load asset '".concat(e.path,"'")),setTimeout((function(){t.messages.pop()}),5e3)})),z.subscribe(V,(function(e){t.messages.push("Failed to load custom asset. Try to download it manually and then upload it."),setTimeout((function(){t.messages.pop()}),5e4)}))}},{key:"onLoadingChange",value:function(t){var e=this;t?(this.hideLoadingTimeout&&(clearTimeout(this.hideLoadingTimeout),this.hideLoadingTimeout=0),this.showLoading||this.showLoadingTimeout||(this.showLoadingTimeout=setTimeout((function(){e.showLoading=!0,e.showLoadingTimeout=0}),100))):(this.showLoadingTimeout&&(clearTimeout(this.showLoadingTimeout),this.showLoadingTimeout=0),this.showLoading&&!this.hideLoadingTimeout&&(this.hideLoadingTimeout=setTimeout((function(){e.showLoading=!1,e.hideLoadingTimeout=0}),100)))}}]),e}(g["d"]);Object(m["a"])([Object(g["c"])({default:!1,type:Boolean})],Qn.prototype,"loading",void 0),Object(m["a"])([Object(j["a"])("vertical",{namespace:"ui"})],Qn.prototype,"vertical",void 0),Object(m["a"])([Object(g["e"])("loading")],Qn.prototype,"onLoadingChange",null),Qn=Object(m["a"])([Object(g["a"])({components:{}})],Qn);var Jn=Qn,Kn=Jn,Zn=(n("853e"),Object(S["a"])(Kn,Gn,Xn,!1,null,"f7358fd0",null)),tr=Zn.exports,er=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("canvas",{ref:"sd",style:{width:t.canvasWidth+"px",height:t.canvasHeight+"px"},attrs:{id:"scaled_display",height:"720",width:"1280",draggable:""},on:{click:t.onUiClick,touchstart:t.onTouchStart,dragstart:t.onDragStart,touchmove:t.onSpriteDragMove,mousemove:t.onSpriteDragMove,touchend:t.onSpriteDrop,mouseup:t.onSpriteDrop,dragover:t.onDragOver,drop:t.onDrop,mouseenter:t.onMouseEnter}},[t._v("HTML5 is required to use the Doki Doki Dialog Generator.")])},nr=[],rr=(n("6c7b"),function t(){Object(d["a"])(this,t)});function or(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ir(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?or(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):or(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ar,sr=function(){function t(e,n,r){Object(d["a"])(this,t),this.fsCtx=e,this.hq=n,this.preview=r,this.aborted=!1}return Object(f["a"])(t,[{key:"drawText",value:function(t){if(this.aborted)throw new rr;this.fsCtx.save();var e=ir({},{font:"20px aller",align:"left"},{},t),n=e.font,r=e.align,o=e.x,i=void 0===o?0:o,a=e.y,s=void 0===a?0:a,c=e.text,u=void 0===c?"":c;this.fsCtx.lineJoin="round",this.fsCtx.textAlign=r,this.fsCtx.font=n,t.outline&&(this.fsCtx.strokeStyle=t.outline.style,this.fsCtx.lineWidth=t.outline.width,this.fsCtx.strokeText(u,i,s)),t.fill&&(this.fsCtx.fillStyle=t.fill.style,this.fsCtx.fillText(u,i,s)),this.fsCtx.restore()}},{key:"measureText",value:function(t){if(this.aborted)throw new rr;this.fsCtx.save();var e=ir({},{font:"20px aller",align:"left"},{},t),n=e.font,r=e.align,o=e.text,i=void 0===o?"":o;this.fsCtx.lineJoin="round",this.fsCtx.textAlign=r,this.fsCtx.font=n,t.outline&&(this.fsCtx.strokeStyle=t.outline.style,this.fsCtx.lineWidth=t.outline.width),t.fill&&(this.fsCtx.fillStyle=t.fill.style);var a=this.fsCtx.measureText(i);return this.fsCtx.restore(),a}},{key:"drawImage",value:function(t){if(this.aborted)throw new rr;if(!(t.image instanceof X)){var e=ir({flip:!1,w:t.image.width,h:t.image.height,opacity:100},t),n=e.image,r=e.flip,o=e.x,i=e.y,a=e.w,s=e.h,c=e.opacity;if(this.fsCtx.save(),c<100&&(this.fsCtx.globalAlpha=c/100),t.shadow){var u=t.shadow;u.color&&(this.fsCtx.shadowColor=u.color),u.blur&&(this.fsCtx.shadowBlur=u.blur),u.offsetX&&(this.fsCtx.shadowOffsetX=u.offsetX),u.offsetY&&(this.fsCtx.shadowOffsetY=u.offsetY)}this.fsCtx.translate(o+a/2,i+s/2),this.fsCtx.scale(r?-1:1,1),n instanceof cr?n.paintOnto(this.fsCtx,-a/2,-s/2,a,s):this.fsCtx.drawImage(n,-a/2,-s/2,a,s),this.fsCtx.restore()}}},{key:"drawRect",value:function(t){var e=t.x,n=t.y,r=t.w,o=t.h,i=t.outline,a=t.fill,s=t.composition;if(this.aborted)throw new rr;this.fsCtx.save(),this.fsCtx.beginPath(),this.fsCtx.rect(e,n,r,o),s&&(this.fsCtx.globalCompositeOperation=s),a&&(this.fsCtx.fillStyle=a.style,this.fsCtx.fill()),i&&(this.fsCtx.strokeStyle=i.style,this.fsCtx.lineWidth=i.width,this.fsCtx.stroke()),this.fsCtx.restore()}},{key:"drawPath",value:function(t){var e=t.outline,n=t.fill,r=t.path;if(this.aborted)throw new rr;this.fsCtx.save(),this.fsCtx.beginPath(),r(this.fsCtx),n&&(this.fsCtx.fillStyle=n.style,this.fsCtx.fill()),e&&(this.fsCtx.strokeStyle=e.style,this.fsCtx.lineWidth=e.width,this.fsCtx.stroke()),this.fsCtx.restore()}},{key:"patternFrom",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"repeat";return t instanceof cr&&(t=t.previewCanvas),this.fsCtx.createPattern(t,e)}},{key:"customTransform",value:function(t,e){this.fsCtx.save(),t(this.fsCtx),e(this),this.fsCtx.restore()}},{key:"linearGradient",value:function(t,e,n,r){return this.fsCtx.createLinearGradient(t,e,n,r)}},{key:"abort",value:function(){this.aborted=!0}}]),t}(),cr=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1280,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:720;Object(d["a"])(this,t),this.runningContext=null,this.previewCanvas=document.createElement("canvas"),this.previewCanvas.width=e,this.previewCanvas.height=n}return Object(f["a"])(t,[{key:"render",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,i=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=!(i.length>1&&void 0!==i[1])||i[1],this.runningContext&&this.runningContext.abort(),r=this.previewCanvas.getContext("2d"),r.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),o=this.runningContext=new sr(r,n,!0),t.prev=5,t.next=8,e(this.runningContext);case 8:t.next=15;break;case 10:if(t.prev=10,t.t0=t["catch"](5),!(t.t0 instanceof rr)){t.next=14;break}return t.abrupt("return",!1);case 14:throw t.t0;case 15:return t.prev=15,o===this.runningContext&&(this.runningContext=null),t.finish(15);case 18:return t.abrupt("return",!0);case 19:case"end":return t.stop()}}),t,this,[[5,10,15,18]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"paintOnto",value:function(t,e,n,r,o){r&&o?t.drawImage(this.previewCanvas,e,n,r,o):t.drawImage(this.previewCanvas,e,n)}},{key:"download",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r,o,i,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=document.createElement("canvas"),r.width=this.previewCanvas.width,r.height=this.previewCanvas.height,o=r.getContext("2d"),o.clearRect(0,0,this.previewCanvas.width,this.previewCanvas.height),t.next=7,e(new sr(o,!0,!1));case 7:if(void 0!==window.navigator.msSaveOrOpenBlob){t.next=19;break}return a=document.createElement("a"),a.setAttribute("download",n),t.next=12,this.createObjectURL(r);case 12:i=t.sent,a.setAttribute("href",i),document.body.appendChild(a),a.click(),document.body.removeChild(a),t.next=23;break;case 19:i=r.toDataURL(),s=this.dataURItoBlob(i),window.URL&&window.URL.createObjectURL&&(i=URL.createObjectURL(s)),window.navigator.msSaveBlob(s,n);case 23:return t.abrupt("return",i);case 24:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"createObjectURL",value:function(t){var e=this;return new Promise((function(n,r){if(t.toBlob&&window.URL&&window.URL.createObjectURL)t.toBlob((function(t){t?n(URL.createObjectURL(t)):r()}),"image/png");else if(window.URL&&window.URL.createObjectURL){var o=t.toDataURL(),i=e.dataURItoBlob(o);n(URL.createObjectURL(i))}else n(t.toDataURL())}))}},{key:"getDataAt",value:function(t,e){var n=this.previewCanvas.getContext("2d");return n.getImageData(t,e,1,1).data}},{key:"dataURItoBlob",value:function(t){for(var e=atob(t.split(",")[1]),n=e.length,r=new Uint8Array(n),o=0;o<n;o++)r[o]=e.charCodeAt(o);return new Blob([r],{type:"image/png"})}},{key:"width",get:function(){return this.previewCanvas.width}},{key:"height",get:function(){return this.previewCanvas.height}}]),t}();(function(t){t[t["None"]=0]="None",t[t["Stretch"]=1]="Stretch",t[t["Cover"]=2]="Cover"})(ar||(ar={}));var ur={namespaced:!0,state:{current:"",color:"#000000",flipped:!1,scaling:ar.None,variant:0},mutations:{setCurrent:function(t,e){var n=e.current;t.current=n,t.variant=0},setColor:function(t,e){var n=e.color;t.color=n},setFlipped:function(t,e){var n=e.flipped;t.flipped=n},setVariant:function(t,e){var n=e.variant;t.variant=n},setScaling:function(t,e){var n=e.scaling;t.scaling=n}},actions:{seekVariant:function(t,e){var n=t.state,r=t.rootGetters,o=t.commit,i=e.delta,a=r["content/getBackgrounds"],s=a.get(n.current);s&&o("setVariant",{variant:mt(s.variants,n.variant,i)})},fixContentPackRemoval:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r,o,i,a,s,c,u,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.state,o=e.rootGetters,i=e.commit,a=e.rootState,s=n.backgrounds.find((function(t){return t.label===r.current})),s){t.next=4;break}return t.abrupt("return");case 4:if(c=o["content/getBackgrounds"].get(r.current),c){t.next=8;break}return a.content.current.backgrounds[0]?i("setCurrent",{current:a.content.current.backgrounds[0].label}):i("setCurrent",{current:"buildin.transparent"}),t.abrupt("return");case 8:u=JSON.stringify(s.variants[r.variant]),l=c.variants.findIndex((function(t){return JSON.stringify(t)===u})),l!==r.variant&&i("setVariant",-1===l?0:l);case 11:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}()}},lr=function(){function t(e,n,r){Object(d["a"])(this,t),this.assets=e,this.flip=n,this.scale=r}return Object(f["a"])(t,[{key:"render",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,i,a,s,c,u,l,h,d,f,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.assets.map((function(t){return Z(t,e.hq)})));case 2:n=t.sent,r=!0,o=!1,i=void 0,t.prev=6,a=n[Symbol.iterator]();case 8:if(r=(s=a.next()).done){t.next=35;break}if(c=s.value,c instanceof HTMLImageElement){t.next=12;break}return t.abrupt("return");case 12:u=0,l=0,h=c.width,d=c.height,console.log("asd: ".concat(void 0," ").concat(ar.None," | ").concat(this.scale)),t.t0=this.scale,t.next=t.t0===ar.None?20:t.t0===ar.Stretch?23:t.t0===ar.Cover?26:31;break;case 20:return u=ft/2-h/2,l=pt/2-d/2,t.abrupt("break",31);case 23:return h=ft,d=pt,t.abrupt("break",31);case 26:f=h/d,p=ft/pt,f>p?(d=pt,h=d*f):(h=ft,d=h/f),u=ft/2-h/2,l=pt/2-d/2;case 31:e.drawImage({image:c,x:u,y:l,w:h,h:d,flip:this.flip});case 32:r=!0,t.next=8;break;case 35:t.next=41;break;case 37:t.prev=37,t.t1=t["catch"](6),o=!0,i=t.t1;case 41:t.prev=41,t.prev=42,r||null==a.return||a.return();case 44:if(t.prev=44,!o){t.next=47;break}throw i;case 47:return t.finish(44);case 48:return t.finish(41);case 49:case"end":return t.stop()}}),t,this,[[6,37,41,49],[42,,44,48]])})));function e(e){return t.apply(this,arguments)}return e}()}]),t}(),hr={name:"Static color",color:"#000000",render:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.drawRect({x:0,y:0,w:1280,h:720,fill:{style:this.color}});case 1:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},dr=(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}}(),function(){function t(e,n){Object(d["a"])(this,t),this.obj=e,this.$store=n,this.styleData={lastBase:"",components:{}},this.lq=!0,this.localRenderer=new cr(960,960),this.lastVersion=-1,this.hitDetectionFallback=!1}return Object(f["a"])(t,[{key:"updateLocalCanvas",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.localRenderer.render(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(n){var r,o,i,a,s,c,u,l,d,f,p,b,v,m,g,y,k,j,w,x,O,C,P,_,R,S,$;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=e.getData(),o=Ct(r,e.obj),i=[],a=[],Pt(r,e.obj),s=_t(r,e.obj),console.log(o.renderOrder),c=!0,u=!1,l=void 0,t.prev=10,d=o.renderOrder.toLowerCase()[Symbol.iterator]();case 12:if(c=(f=d.next()).done){t.next=31;break}p=f.value,t.t0=p,t.next="l"===t.t0?17:"r"===t.t0?19:"s"===t.t0?21:"v"===t.t0?23:"h"===t.t0?25:28;break;case 17:return i=[].concat(i,o.left[e.obj.posePositions.left]),t.abrupt("break",28);case 19:return i=[].concat(i,o.right[e.obj.posePositions.right]),t.abrupt("break",28);case 21:return i=[].concat(i,o.static),t.abrupt("break",28);case 23:return i=[].concat(i,o.variant[e.obj.posePositions.variant]),t.abrupt("break",28);case 25:return a=s?s.variants[e.obj.posePositions.head]:[],i.push("head"),t.abrupt("break",28);case 28:c=!0,t.next=12;break;case 31:t.next=37;break;case 33:t.prev=33,t.t1=t["catch"](10),u=!0,l=t.t1;case 37:t.prev=37,t.prev=38,c||null==d.return||d.return();case 40:if(t.prev=40,!u){t.next=43;break}throw l;case 43:return t.finish(40);case 44:return t.finish(37);case 45:return i=i.filter((function(t){return t})),t.next=48,Promise.all([Promise.all(i.map((function(t){return"string"===typeof t?Promise.resolve(t):Z(t,n.hq)}))),Promise.all(a.map((function(t){return Z(t,n.hq)})))]);case 48:b=t.sent,v=Object(h["a"])(b,2),m=v[0],g=v[1],y=!0,k=!1,j=void 0,t.prev=55,w=m[Symbol.iterator]();case 57:if(y=(x=w.next()).done){t.next=85;break}if(O=x.value,"head"!==O){t.next=81;break}for(C=!0,P=!1,_=void 0,t.prev=63,R=g[Symbol.iterator]();!(C=(S=R.next()).done);C=!0)$=S.value,n.drawImage({image:$,x:o.headAnchor[0],y:o.headAnchor[1]});t.next=71;break;case 67:t.prev=67,t.t2=t["catch"](63),P=!0,_=t.t2;case 71:t.prev=71,t.prev=72,C||null==R.return||R.return();case 74:if(t.prev=74,!P){t.next=77;break}throw _;case 77:return t.finish(74);case 78:return t.finish(71);case 79:t.next=82;break;case 81:n.drawImage({image:O,x:0,y:0});case 82:y=!0,t.next=57;break;case 85:t.next=91;break;case 87:t.prev=87,t.t3=t["catch"](55),k=!0,j=t.t3;case 91:t.prev=91,t.prev=92,y||null==w.return||w.return();case 94:if(t.prev=94,!k){t.next=97;break}throw j;case 97:return t.finish(94);case 98:return t.finish(91);case 99:e.lastVersion=e.obj.version;case 100:case"end":return t.stop()}}),t,null,[[10,33,37,45],[38,,40,44],[55,87,91,99],[63,67,71,79],[72,,74,78],[92,,94,98]])})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"render",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r,o,i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.lastVersion===this.obj.version&&this.lq===!n.hq){t.next=3;break}return t.next=3,this.updateLocalCanvas();case 3:r=this.width,o=this.height,i=this.x-r/2,a=this.y,n.drawImage({image:this.localRenderer,x:i,y:a,w:r,h:o,flip:this.obj.flip,shadow:e&&n.preview?{blur:20,color:"red"}:void 0,opacity:this.obj.opacity});case 8:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"hitTest",value:function(t,e){var n=t-(this.x-this.width/2),r=e-this.y;if(n<0||n>this.width)return!1;if(r<0||r>this.height)return!1;if(!this.hitDetectionFallback)try{var o=this.obj.flip?this.width-n:n,i=960/this.width,a=960/this.height,s=this.localRenderer.getDataAt(Math.round(o*i),Math.round(r*a));return 0!==s[3]}catch(c){if(!(c instanceof DOMException&&c.message.includes("cross-origin")))throw c;this.hitDetectionFallback=!0}return!0}},{key:"getData",value:function(){return Ot(this.$store.getters,this.obj)}},{key:"id",get:function(){return this.obj.id}},{key:"width",get:function(){var t=this.obj.close?2:1;return this.obj.width*t}},{key:"height",get:function(){var t=this.obj.close?2:1;return this.obj.height*t}},{key:"x",get:function(){return this.obj.x}},{key:"y",get:function(){return(this.obj.close?kt:0)+this.obj.y}}]),t}()),fr=function(){function t(e){var n=this;Object(d["a"])(this,t),this.obj=e,this.ratio=0,this.lockedRatio=!0,this.asset=null,Z(e.asset).then((function(t){t instanceof X||(n.asset=t,z.fire(new Y))})).catch((function(t){console.error("Failed to load asset: ".concat(t))}))}return Object(f["a"])(t,[{key:"render",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.asset){t.next=2;break}return t.abrupt("return");case 2:r=this.obj.x-this.obj.width/2,n.drawImage({image:this.asset,x:r,y:this.obj.y,w:this.obj.width,h:this.obj.height,shadow:e&&n.preview?{blur:20,color:"red"}:void 0,flip:this.obj.flip,opacity:this.obj.opacity});case 4:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"hitTest",value:function(t,e){var n=t-this.obj.x+this.obj.width/2,r=e-this.obj.y;return n>=0&&n<=this.obj.width&&r>=0&&r<=this.obj.height}},{key:"id",get:function(){return this.obj.id}},{key:"infront",get:function(){return this.obj.onTop}}]),t}();function pr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function br(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pr(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var vr=816,mr=900,gr=146,yr=568,kr=0,jr=29,wr=8,xr=38,Or=50,Cr=9,Pr=9,_r=39,Rr=168,Sr=34,$r=29,Tr=12,Lr=-126,Ir=-72,Dr=-38,Er=30.75,Nr=26,Mr=426,Ur=58,Ar={align:"center",font:"24px riffic",outline:{style:"#b59",width:6},fill:{style:"white"}},Br={align:"left",font:"13px aller",fill:{style:"#522"}},Fr=br({},Br,{fill:{style:"#a66"}}),qr={align:"left",font:"24px aller",outline:{style:"#523140",width:4},fill:{style:"#fff"}},Hr={align:"left",font:"24px verily",outline:{style:"#000",width:20},fill:{style:"#fff"}},zr=yr-_r;function Wr(t,e,n,r,o,i){r<2*i&&(i=r/2),o<2*i&&(i=o/2),t.moveTo(e+i,n),t.arcTo(e+r,n,e+r,n+o,i),t.arcTo(e+r,n+o,e,n+o,i),t.arcTo(e,n+o,e,n,i),t.arcTo(e,n,e+r,n,i),t.closePath()}function Vr(t,e,n,r,o,i){r<2*i&&(i=r/2),o<2*i&&(i=o/2),t.moveTo(e+i,n),t.arcTo(e+r,n,e+r,n+o,i),t.lineTo(e+r,n+o),t.lineTo(e,n+o),t.arcTo(e,n,e+r,n,i),t.closePath()}var Yr=function(){function t(e,n,r,o){Object(d["a"])(this,t),this.h=e,this.s=n,this.l=r,this.a=o}return Object(f["a"])(t,[{key:"toCss",value:function(){return this.a>=1?"hsl(".concat(this.h,", ").concat(this.s,", ").concat(this.l,")"):"hsla(".concat(this.h,", ").concat(this.s,", ").concat(this.l,", ").concat(this.a,")")}},{key:"shift",value:function(e){var n=this.h,r=this.s,o=this.l,i=this.a;return n+=e.h,n>=1?n-=1:n<0&&(n+=1),r+e.s>1||r+e.s<0?r-=e.s:r+=e.s,o+e.l>1||o+e.l<0?o-=e.l:o+=e.l,i+e.a>1||i+e.a<0?i-=e.a:i+=e.a,new t(n,r,o,i)}},{key:"toRgb",value:function(){var t,e,n,r=this.h,o=this.s,i=this.l,a=this.a;if(0===o)t=e=n=i;else{var s=i<.5?i*(1+o):i+o-i*o,c=2*i-s;t=this.hue2rgb(c,s,r+1/3),e=this.hue2rgb(c,s,r),n=this.hue2rgb(c,s,r-1/3)}return new Gr(Math.round(255*t),Math.round(255*e),Math.round(255*n),a)}},{key:"toHSL",value:function(){return this}},{key:"hue2rgb",value:function(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}}]),t}(),Gr=function(){function t(e,n,r,o){Object(d["a"])(this,t),this.r=e,this.g=n,this.b=r,this.a=o}return Object(f["a"])(t,[{key:"toCss",value:function(){return this.a>1?"rgb(".concat(this.r,",").concat(this.g,",").concat(this.b,")"):"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.a,")")}},{key:"toRgb",value:function(){return this}},{key:"toHSL",value:function(){var t=this.r,e=this.g,n=this.b,r=this.a;t/=255,e/=255,n/=255;var o,i,a=Math.max(t,e,n),s=Math.min(t,e,n),c=(a+s)/2;if(a===s)o=i=0;else{var u=a-s;switch(i=c>.5?u/(2-a-s):u/(a+s),a){case t:o=(e-n)/u+(e<n?6:0);break;case e:o=(n-t)/u+2;break;case n:o=(t-e)/u+4;break}o/=6}return new Yr(o,i,c,r)}}],[{key:"validCss",value:function(t){return this.validCssRgb(t)||this.validHex(t)}},{key:"fromCss",value:function(t){if(this.validCssRgb(t))return this.fromCssRgb(t);if(this.validHex(t))return this.fromHex(t);throw new Error("Invalid RGB color format")}},{key:"validCssRgb",value:function(t){return this.rgbEx.test(t)||this.rgbaEx.test(t)}},{key:"fromCssRgb",value:function(e){if(!this.validCssRgb(e))throw new Error("Invalid RGB color format");var n=e.slice(0,-1),r=n.indexOf("("),o=n.slice(r+1),i=o.split(",").map((function(t){return parseFloat(t.trim())}));return new t(i[0],i[1],i[2],4===i.length?i[3]:1)}},{key:"validHex",value:function(t){return this.hexShortEx.test(t)||this.hexLongEx.test(t)}},{key:"fromHex",value:function(e){if(!this.validHex(e))throw new Error("Invalid Hex color format");var n=e.slice(1);if(3===n.length)return new t(parseInt(n[0]+n[0],16),parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),1);if(4===n.length)return new t(parseInt(n[0]+n[0],16),parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),parseInt(n[3]+n[3],16)/255);if(6===n.length)return new t(parseInt(n[0]+n[1],16),parseInt(n[2]+n[3],16),parseInt(n[4]+n[5],16),1);if(8===n.length)return new t(parseInt(n[0]+n[1],16),parseInt(n[2]+n[3],16),parseInt(n[4]+n[5],16),parseInt(n[6]+n[7],16)/255);throw new Error("Invalid Hex color format length")}}]),t}();function Xr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Qr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Xr(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}Gr.rgbEx=/^rgb\((\d*?)\,(\d*?)\,(\d*?)\)$/i,Gr.rgbaEx=/^rgba\((\d{1,3})\,(\d{1,3})\,(\d{1,3})\,([\d\.]+)\)$/i,Gr.hexShortEx=/^\#[0-9A-Z]{3,4}$/i,Gr.hexLongEx=/^\#[0-9A-Z]{6,8}$/i;var Jr=function(){function t(e){Object(d["a"])(this,t),this.obj=e,this.display=!0,this.lastVersion=-1,this.lastX=0,this.lastY=0,this.lastH=0,this.lastW=0,this.localRenderer=new cr(1280,720)}return Object(f["a"])(t,[{key:"hitTest",value:function(t,e){var n=this.width,r=this.height,o=n/2,i=this.obj.x-o,a=i+n,s=this.obj.y,c=s+r;return i<=t&&a>=t&&s<=e&&c>=e}},{key:"render",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.lastVersion===this.obj.version&&this.lastX===this.obj.x&&this.lastY===this.obj.y&&this.lastH===this.obj.height&&this.lastW===this.obj.width){t.next=6;break}return t.next=3,this.updateLocalCanvas();case 3:this.lastVersion=this.obj.version,this.lastX=this.obj.x,this.lastY=this.obj.y;case 6:n.drawImage({image:this.localRenderer,x:0,y:0,flip:this.obj.flip,shadow:e&&n.preview?{blur:20,color:"red"}:void 0,opacity:this.obj.opacity});case 7:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"updateLocalCanvas",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return Gr.fromCss(this.obj.customColor).toHSL(),Gr.fromCss("#552222").toHSL(),t.next=4,this.localRenderer.render(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(n){var r,o,i,a,s,c,u,l,h;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.width,o=e.height,i=r/2,a=e.obj.x-i,s=e.obj.y,t.next=7,e.renderBackdrop(n,a,s+_r);case 7:if("No-one"===e.obj.talkingDefault){t.next=11;break}return c="Other"===e.obj.talkingDefault?e.obj.talkingOther:e.obj.talkingDefault,t.next=11,e.renderNamebox(n,a+Sr,s,c);case 11:if(e.renderText(n,a,s),u=s+o,l=u-Tr,h=a+r/2,e.obj.controls&&(n.drawText(Qr({text:"History",x:h+Lr,y:l},e.controlsStyle)),n.drawText(Qr({text:"Skip",x:h+Ir,y:l},e.obj.skip?e.controlsStyle:e.controlsDisableStyle)),n.drawText(Qr({text:"Auto   Save   Load   Settings",x:h+Dr,y:l},e.controlsStyle))),!e.obj.continue){t.next=25;break}return t.t0=n,t.next=20,nt("next");case 20:t.t1=t.sent,t.t2=a+r-Er,t.t3=u-Nr,t.t4={image:t.t1,x:t.t2,y:t.t3},t.t0.drawImage.call(t.t0,t.t4);case 25:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"renderNamebox",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n,r,o){var i,a,s,c,u=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=_r,s=Ar,"custom"!==this.obj.style){t.next=9;break}c=Gr.fromCss(this.nameboxOutlineColor).toHSL(),s=Qr({},s,{outline:{style:this.nameboxOutlineColor,width:6},fill:{style:c.l>.6?"#000000":"#FFFFFF"}}),i=this.obj.customNameboxWidth,e.customTransform((function(t){t.beginPath(),Vr(t,n,r,i,a,12),t.clip()}),(function(t){var e=t.linearGradient(n,r,n,r+_r),o=Gr.fromCss(u.nameboxBackgroundColor),i=new Gr(o.r,o.g,o.b,244),a=new Yr(-.004901960784313708,-.8599999999999999,-.16274509803921566,0),s=i.toHSL().shift(a).toRgb();e.addColorStop(0,i.toCss()),e.addColorStop(.82,i.toCss()),e.addColorStop(1,s.toCss()),t.drawRect({x:n,y:r,w:u.obj.width,h:u.obj.height,fill:{style:e}})})),t.next=18;break;case 9:return i=Rr,t.t0=e,t.next=13,nt("namebox");case 13:t.t1=t.sent,t.t2=n,t.t3=r,t.t4={image:t.t1,x:t.t2,y:t.t3},t.t0.drawImage.call(t.t0,t.t4);case 18:e.drawText(Qr({x:n+i/2,y:r+$r,text:o},s));case 19:case"end":return t.stop()}}),t,this)})));function e(e,n,r,o){return t.apply(this,arguments)}return e}()},{key:"renderBackdrop",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n,r){var o,i,a,c,u,l=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("custom"!==this.obj.style){t.next=10;break}o=Gr.fromCss(this.obj.customColor).toHSL(),i=new cr(47,47),i.render(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=new Yr(.004269293924466178,-.01869158878504662,-.039215686274509665,0),r={style:o.shift(n).toRgb().toCss()},i=function(t,n){e.drawPath({path:function(e){e.ellipse(t,n,9.5,9.5,0,0,2*Math.PI)},fill:r})},i(0,0),i(47,0),i(0,47),i(47,47),i(23.5,24.5);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),!0),e.customTransform((function(t){t.beginPath(),Wr(t,n+1.5,r+1.5,l.obj.width-3,l.obj.height-3,12),t.clip()}),(function(t){var e=l.obj.height,o=l.obj.width,a=t.linearGradient(n,r,n,r+e),s=Gr.fromHex(l.obj.customColor);a.addColorStop(0,s.toCss()),a.addColorStop(1,"rgba(".concat(s.r,",").concat(s.g,",").concat(s.b,",0.6667)")),t.drawRect({x:n,y:r,w:o,h:e,fill:{style:a},outline:{style:"#ffdfee",width:6}}),t.customTransform((function(t){t.translate(n,r)}),(function(n){var r=t.patternFrom(i);t.drawRect({x:0,y:0,w:o,h:e,fill:{style:r},composition:"source-atop"})}));var c=t.linearGradient(n,r+e-Ur,n,r+e);c.addColorStop(0,"rgba(255,255,255,0.3137)"),c.addColorStop(.5,"rgba(255,255,255,0.0627)"),c.addColorStop(1,"rgba(255,255,255,0)"),t.drawPath({path:function(t){t.ellipse(n+o/2,r+e,Mr,Ur,0,0,2*Math.PI)},fill:{style:c}})})),a=new Yr(.0023347701149424305,0,.10784313725490202,0),c=o.shift(a).toRgb().toCss(),e.drawPath({path:function(t){Wr(t,n+1.5,r+1.5,l.obj.width-3,l.obj.height-3,12)},outline:{style:c,width:3}}),t.next=15;break;case 10:return"corrupt"===this.obj.style&&(n+=(vr-mr)/2),t.next=13,nt("corrupt"===this.obj.style?"textbox_monika":"textbox");case 13:u=t.sent,e.drawImage({image:u,x:n,y:r});case 15:case"end":return t.stop()}}),t,this)})));function e(e,n,r){return t.apply(this,arguments)}return e}()},{key:"renderText",value:function(t,e,n){var r=[],o=!1,i=!0,a=!1,s=void 0;try{for(var c,u=this.text.split("\n")[Symbol.iterator]();!(i=(c=u.next()).done);i=!0){var l=c.value,h=void 0;r.push(h=[]);var d=!0,f=!1,p=void 0;try{for(var b,v=l[Symbol.iterator]();!(d=(b=v.next()).done);d=!0){var m=b.value;"["===m?o=!0:"]"===m?o=!1:h.push({l:m,b:o})}}catch(L){f=!0,p=L}finally{try{d||null==v.return||v.return()}finally{if(f)throw p}}}}catch(L){a=!0,s=L}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}var g=e+xr,y=n+_r+Or;r[0]&&r[0][0]&&r[0][0].b&&(y+=Pr);for(var k=0,j=r;k<j.length;k++){var w=j[k],x=g;w[0]&&w[0].b&&(x+=Cr);var O=!0,C=!1,P=void 0;try{for(var _,R=w[Symbol.iterator]();!(O=(_=R.next()).done);O=!0){var S=_.value,$=S.l,T=S.b;t.drawText(Qr({text:$,x:x,y:y},T?Hr:qr)),x+=t.measureText(Qr({text:$},T?Hr:qr)).width,x+=T?wr:kr}}catch(L){C=!0,P=L}finally{try{O||null==R.return||R.return()}finally{if(C)throw P}}y+=jr}}},{key:"id",get:function(){return this.obj.id}},{key:"width",get:function(){return"custom"===this.obj.style?this.obj.width:vr}},{key:"height",get:function(){return("custom"===this.obj.style?this.obj.height:gr)+_r}},{key:"text",get:function(){var t=this.obj.text;return this.obj.autoQuoting&&"No-one"!==this.obj.talkingDefault&&(t="["===t[0]?'["'+t.slice(1):'"'+t,"]"===t[t.length-1]?t=t.slice(0,-1)+'"]':t+='"'),t}},{key:"controlColor",get:function(){if(this.obj.deriveCustomColors){var t=Gr.fromCss(this.obj.customColor).toHSL(),e=new Yr(.08045977011494243,-.5714285714285714,-.5960784313725489,0);return t.shift(e).toRgb().toCss()}return this.obj.customControlsColor}},{key:"controlsStyle",get:function(){return"custom"!==this.obj.style?Br:Qr({},Br,{fill:{style:this.controlColor}})}},{key:"controlsDisableStyle",get:function(){if("custom"!==this.obj.style)return Fr;var t=Gr.fromCss(this.controlColor).toHSL(),e=new Yr(0,-.14285714285714296,.3,0),n=t.shift(e).toRgb().toCss();return Qr({},Br,{fill:{style:n}})}},{key:"nameboxOutlineColor",get:function(){if(this.obj.deriveCustomColors){var t=Gr.fromCss(this.obj.customColor).toHSL(),e=new Yr(-.03065134099616873,-.5714285714285714,-.29607843137254897,0);return t.shift(e).toRgb().toCss()}return this.obj.customNameboxStroke}},{key:"nameboxBackgroundColor",get:function(){if(this.obj.deriveCustomColors){var t=Gr.fromCss(this.obj.customColor).toHSL(),e=new Yr(.002028397565922768,0,.13725490196078438,0);return t.shift(e).toRgb().toCss()}return this.obj.customNameboxColor}}]),t}(),Kr=function(t){function e(){var t;return Object(d["a"])(this,e),t=Object(p["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.renderer=new cr,t.currentlyRendering=!1,t.queuedRender=null,t.showingLast=!1,t.dropSpriteCount=0,t.dropPreventClick=!1,t.draggedObject=null,t.dragXOffset=0,t.dragYOffset=0,t.dragXOriginal=0,t.dragYOriginal=0,t.renderObjectCache={},t}return Object(v["a"])(e,t),Object(f["a"])(e,[{key:"blendOver",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.renderer.render((function(t){return new Promise((function(n,r){var o=new Image;o.addEventListener("load",(function(){t.drawImage({image:o,x:0,y:0,w:1280,h:720}),n()})),o.src=e}))}),!0);case 2:n=t.sent,n&&this.display();case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"download",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.renderer.download(this.renderCallback,"panel.png");case 2:e=t.sent,this.history.transaction(Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=n.$store.state.ui.lastDownload,n.$store.commit("ui/setLastDownload",e),r&&URL.revokeObjectURL(r);case 3:case"end":return t.stop()}}),t)}))));case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"invalidateRender",value:function(){var t=this;this.queuedRender||(this.queuedRender=requestAnimationFrame((function(){return t.render_()})))}},{key:"renderLoadingScreen",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.renderer.render(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.drawText({text:"Starting...",x:n.renderer.width/2,y:n.renderer.height/2,align:"center",outline:{width:5,style:"#b59"},font:"32px riffic",fill:{style:"white"}});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),!0);case 2:e=t.sent,e&&this.display();case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"render_",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.queuedRender&&(cancelAnimationFrame(this.queuedRender),this.queuedRender=null),!this.$store.state.unsafe){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,this.renderer.render(this.renderCallback,!this.lqRendering);case 5:e=t.sent,e&&this.display();case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"renderCallback",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,i,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.currentlyRendering=!0,t.prev=1,!e.preview){t.next=9;break}return t.t0=e,t.next=6,nt("backgrounds/transparent");case 6:t.t1=t.sent,t.t2={x:0,y:0,image:t.t1},t.t0.drawImage.call(t.t0,t.t2);case 9:if(!this.currentBackground){t.next=12;break}return t.next=12,this.currentBackground.render(e);case 12:n=!0,r=!1,o=void 0,t.prev=15,i=this.renderObjects[Symbol.iterator]();case 17:if(n=(a=i.next()).done){t.next=24;break}return s=a.value,t.next=21,s.render(this.selection===s.id,e);case 21:n=!0,t.next=17;break;case 24:t.next=30;break;case 26:t.prev=26,t.t3=t["catch"](15),r=!0,o=t.t3;case 30:t.prev=30,t.prev=31,n||null==i.return||i.return();case 33:if(t.prev=33,!r){t.next=36;break}throw o;case 36:return t.finish(33);case 37:return t.finish(30);case 38:return t.prev=38,this.currentlyRendering=!1,t.finish(38);case 41:case"end":return t.stop()}}),t,this,[[1,,38,41],[15,26,30,38],[31,,33,37]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"created",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:z.subscribe(Y,(function(t){return e.invalidateRender})),this.$store.subscribe(this.invalidateRender);case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"mounted",value:function(){var t=this.$refs.sd;this.sdCtx=t.getContext("2d")||void 0,this.renderLoadingScreen(),this.invalidateRender()}},{key:"display",value:function(){this.sdCtx&&(this.showingLast=!1,this.renderer.paintOnto(this.sdCtx,0,0,1280,720))}},{key:"toRendererCoordinate",value:function(t,e){var n=this.$refs.sd,r=t-n.offsetLeft,o=e-n.offsetTop,i=r/n.offsetWidth*n.width,a=o/n.offsetWidth*n.width;return[i,a]}},{key:"onUiClick",value:function(t){var e=this;if(this.dropPreventClick)this.dropPreventClick=!1;else{var n,r=this.toRendererCoordinate(t.clientX,t.clientY),o=Object(h["a"])(r,2),i=o[0],a=o[1],s=this.objectsAt(i,a),c=s.findIndex((function(t){return t.id===e.selection}));n=0===c?null:-1!==c?s[c-1]:s[s.length-1]||null,this.$store.commit("ui/setSelection",n?n.id:null)}}},{key:"objectsAt",value:function(t,e){return this.renderObjects.filter((function(n){return n.hitTest(t,e)}))}},{key:"onDragStart",value:function(t){if(t.preventDefault(),this.selection){this.draggedObject=this.$store.state.objects.objects[this.selection];var e=this.toRendererCoordinate(t.clientX,t.clientY),n=Object(h["a"])(e,2),r=n[0],o=n[1];this.dragXOffset=r-this.draggedObject.x,this.dragYOffset=o-this.draggedObject.y,this.dragXOriginal=this.draggedObject.x,this.dragYOriginal=this.draggedObject.y}}},{key:"onTouchStart",value:function(t){if(this.selection){this.draggedObject=this.$store.state.objects.objects[this.selection];var e=this.toRendererCoordinate(t.touches[0].clientX,t.touches[0].clientY),n=Object(h["a"])(e,2),r=n[0],o=n[1];this.dragXOffset=r-this.draggedObject.x,this.dragYOffset=o-this.draggedObject.y,this.dragXOriginal=this.draggedObject.x,this.dragYOriginal=this.draggedObject.y}}},{key:"onDragOver",value:function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"}},{key:"onSpriteDragMove",value:function(t){var e=this;if(this.draggedObject){t.preventDefault();var n=t instanceof MouseEvent?this.toRendererCoordinate(t.clientX,t.clientY):this.toRendererCoordinate(t.touches[0].clientX,t.touches[0].clientY),r=Object(h["a"])(n,2),o=r[0],i=r[1];o-=this.dragXOffset,i-=this.dragYOffset;var a=Math.abs(o-this.dragXOriginal),s=Math.abs(i-this.dragYOriginal);a+s>1&&(this.dropPreventClick=!0),t.shiftKey&&(a>s?i=this.dragYOriginal:o=this.dragXOriginal),this.history.transaction((function(){e.$store.dispatch("objects/setPosition",{id:e.draggedObject.id,x:o,y:i})}))}}},{key:"onDrop",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,i,a,c,u=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.stopPropagation(),e.preventDefault(),e.dataTransfer){t.next=4;break}return t.abrupt("return");case 4:for(n=!0,r=!1,o=void 0,t.prev=7,i=e.dataTransfer.items[Symbol.iterator]();!(n=(a=i.next()).done);n=!0)c=a.value,"file"===c.kind&&c.type.match(/image.*/)&&function(){var t="dropCustomAsset"+ ++u.dropSpriteCount,e=ot(t,c.getAsFile());u.history.transaction(Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,u.$store.dispatch("objects/createSprite",{asset:{hq:e,lq:e,sourcePack:"dddg.generated.uploaded-sprites"}});case 2:case"end":return t.stop()}}),t)}))))}();t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](7),r=!0,o=t.t0;case 15:t.prev=15,t.prev=16,n||null==i.return||i.return();case 18:if(t.prev=18,!r){t.next=21;break}throw o;case 21:return t.finish(18);case 22:return t.finish(15);case 23:case"end":return t.stop()}}),t,null,[[7,11,15,23],[16,,18,22]])})));function e(e){return t.apply(this,arguments)}return e}()},{key:"onSpriteDrop",value:function(t){this.draggedObject&&("TouchEvent"in window&&t instanceof TouchEvent&&(this.dropPreventClick=!1),this.draggedObject=null)}},{key:"onMouseEnter",value:function(t){1!==t.buttons&&(this.draggedObject=null)}},{key:"selection",get:function(){return this.$store.state.ui.selection}},{key:"history",get:function(){return this.$root}},{key:"currentBackground",get:function(){var t=this;switch(this.$store.state.background.current){case"buildin.static-color":return hr.color=this.$store.state.background.color,hr;default:var e=this.$store.state.content.current.backgrounds.find((function(e){return e.label===t.$store.state.background.current}));if(!e)return null;var n=e.variants[this.$store.state.background.variant];return n?new lr(n,this.$store.state.background.flipped,this.$store.state.background.scaling):null}}},{key:"renderObjects",get:function(){var t=this,e=this.$store.state.objects,n=[].concat(Object(cn["a"])(e.order),Object(cn["a"])(e.onTopOrder)),r=this.$store.state.objects.objects,o=Object.keys(this.renderObjectCache).filter((function(t){return!n.includes(t)})),i=!0,a=!1,s=void 0;try{for(var c,u=function(){var e=c.value;t.selection===e&&t.history.transaction((function(){t.$store.commit("ui/setSelection",e)})),t.$delete(t.renderObjectCache,e)},l=o[Symbol.iterator]();!(i=(c=l.next()).done);i=!0)u()}catch(h){a=!0,s=h}finally{try{i||null==l.return||l.return()}finally{if(a)throw s}}return n.map((function(e){if(!t.renderObjectCache[e]){var n=r[e];switch(n.type){case"sprite":t.renderObjectCache[e]=new fr(n);break;case"character":t.renderObjectCache[e]=new dr(n,t.$store);break;case"textBox":t.renderObjectCache[e]=new Jr(n);break}}return t.renderObjectCache[e].obj=r[e],t.renderObjectCache[e]}))}}]),e}(g["d"]);Object(m["a"])([Object(g["c"])({type:Number,default:0})],Kr.prototype,"canvasWidth",void 0),Object(m["a"])([Object(g["c"])({type:Number,default:0})],Kr.prototype,"canvasHeight",void 0),Object(m["a"])([Object(j["a"])("lqRendering",{namespace:"ui"})],Kr.prototype,"lqRendering",void 0),Object(m["a"])([Object(g["e"])("canvasWidth"),Object(g["e"])("canvasHeight")],Kr.prototype,"display",null),Kr=Object(m["a"])([Object(g["a"])({})],Kr);var Zr=Kr,to=Zr,eo=Object(S["a"])(to,er,nr,!1,null,null,null),no=eo.exports,ro=function(t){function e(){var t;return Object(d["a"])(this,e),t=Object(p["a"])(this,Object(b["a"])(e).apply(this,arguments)),t.canvasWidth=0,t.canvasHeight=0,t.blendOver=null,t.uiSize=192,t.currentlyRendering=!1,t.panel="",t}return Object(v["a"])(e,t),Object(f["a"])(e,[{key:"drawLastDownload",value:function(){var t=this.$store.state.ui.lastDownload;t&&this.$refs.render.blendOver(t)}},{key:"setBlendOver",value:function(){this.blendOver=this.$store.state.ui.lastDownload}},{key:"created",value:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.updateArea(),window.addEventListener("resize",this.updateArea),window.removeEventListener("keydown",this.onKeydown),window.addEventListener("keydown",this.onKeydown),0===Object.keys(this.$store.state.objects.objects).length&&this.$store.dispatch("objects/createTextBox",{}),this.history.transaction(Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("content/loadContentPacks",["".concat("","packs/buildin.base.backgrounds.json"),"".concat("","packs/buildin.base.monika.json"),"".concat("","packs/buildin.base.sayori.json"),"".concat("","packs/buildin.base.natsuki.json"),"".concat("","packs/buildin.base.yuri.json"),"".concat("","packs/buildin.extra.mc.json"),"".concat("","packs/buildin.extra.mc_chad.json"),"".concat("","packs/buildin.extra.mc_classic.json"),"".concat("","packs/buildin.extra.femc.json"),"".concat("","packs/buildin.extra.classic_amy.json"),"".concat("","packs/buildin.extra.amy.json")]);case 2:return t.next=4,e.$store.commit("background/setCurrent",{current:"Clubroom"});case 4:case"end":return t.stop()}}),t)}))));case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"destroyed",value:function(){window.removeEventListener("keydown",this.onKeydown)}},{key:"mounted",value:function(){var t=this;window.addEventListener("keypress",(function(e){27===e.keyCode&&t.history.transaction((function(){t.$store.commit("ui/setSelection",null)}))}))}},{key:"optimum",value:function(t,e){var n=t/(16/9),r=e*(16/9);return n>e?n=e:r=t,[r,n]}},{key:"optimizeWithMenu",value:function(t,e){var n=this.optimum(t,e-this.uiSize),r=this.optimum(t-this.uiSize,e);return n[0]*n[1]>r[0]*r[1]?[n[0],n[1],!1]:[r[0],r[1],!0]}},{key:"updateArea",value:function(){var t=this.optimizeWithMenu(document.documentElement.clientWidth,document.documentElement.clientHeight),e=Object(h["a"])(t,3),n=e[0],r=e[1],o=e[2];this.canvasWidth=n,this.canvasHeight=r,this.$store.commit("ui/setVertical",o)}},{key:"onKeydown",value:function(t){var e=this;this.history.transaction((function(){var n=e.$store.state.objects.objects[e.$store.state.ui.selection];if(n)if("Delete"!==t.key)if("z"===t.key&&t.ctrlKey)e.$store.commit("history/undo");else if("y"===t.key&&t.ctrlKey)e.$store.commit("history/redo");else{if("character"===n.type){var r=n;if(r.freeMove){if("ArrowLeft"===t.key)return void e.$store.dispatch("objects/shiftCharacterSlot",{id:r.id,delta:-1});if("ArrowRight"===t.key)return void e.$store.dispatch("objects/shiftCharacterSlot",{id:r.id,delta:1})}}var o=n.x,i=n.y;if("ArrowLeft"===t.key)o-=t.shiftKey?1:20;else if(n&&"ArrowRight"===t.key)o+=t.shiftKey?1:20;else if(n&&"ArrowUp"===t.key)i-=t.shiftKey?1:20;else{if(!n||"ArrowDown"!==t.key)return void console.log(t);i+=t.shiftKey?1:20}e.$store.dispatch("objects/setPosition",{id:n.id,x:o,y:i}),console.log(t)}else e.$store.dispatch("objects/removeObject",{id:n.id})}))}},{key:"history",get:function(){return this.$root}}]),e}(g["d"]);ro=Object(m["a"])([Object(g["a"])({components:{ToolBox:Yn,MessageConsole:tr,Render:no}})],ro);var oo=ro,io=oo,ao=(n("5c0b"),Object(S["a"])(io,u,l,!1,null,null,null)),so=ao.exports,co={},uo=0,lo={createSprite:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.state,r=e.commit,t.next=3,Z(n.asset,!1);case 3:if(o=t.sent,o instanceof HTMLImageElement){t.next=6;break}return t.abrupt("return");case 6:r("create",{object:{asset:n.asset,flip:!1,height:o.height,width:o.width,id:"sprite_"+ ++uo,onTop:!1,opacity:100,preserveRatio:!0,ratio:o.width/o.height,type:"sprite",version:0,x:640,y:0}});case 7:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}()},ho={setText:function(t,e){var n=t.objects[e.id];n.text=e.text,++n.version},setTalkingDefault:function(t,e){var n=t.objects[e.id];n.talkingDefault=e.talkingDefault,++n.version},setTalkingOther:function(t,e){var n=t.objects[e.id];n.talkingOther=e.talkingOther,n.talkingDefault="Other",++n.version},setStyle:function(t,e){var n=t.objects[e.id];n.style=e.style,++n.version},setControlsVisible:function(t,e){var n=t.objects[e.id];n.controls=e.controls,++n.version},setControlsColor:function(t,e){var n=t.objects[e.id];n.customControlsColor=e.customControlsColor,++n.version},setDeriveCustomColors:function(t,e){var n=t.objects[e.id];n.deriveCustomColors=e.deriveCustomColors,++n.version},setNameboxColor:function(t,e){var n=t.objects[e.id];n.customNameboxColor=e.customNameboxColor,++n.version},setNameboxStroke:function(t,e){var n=t.objects[e.id];n.customNameboxStroke=e.customNameboxStroke,++n.version},setNameboxWidth:function(t,e){var n=t.objects[e.id];n.customNameboxWidth=e.customNameboxWidth,++n.version},setSkipable:function(t,e){var n=t.objects[e.id];n.skip=e.skip,++n.version},setContinueArrow:function(t,e){var n=t.objects[e.id];n.continue=e.continue,++n.version},setCustomColor:function(t,e){var n=t.objects[e.id];n.customColor=e.color,++n.version},setAutoQuoting:function(t,e){var n=t.objects[e.id];n.autoQuoting=e.autoQuoting,++n.version}},fo=0,po={createTextBox:function(t,e){var n=t.commit,r="textBox_"+ ++fo;return n("create",{object:{flip:!1,id:r,onTop:!0,opacity:100,type:"textBox",version:0,x:640,y:zr,width:vr,height:gr,preserveRatio:!1,ratio:vr/gr,continue:!0,controls:!0,skip:!0,autoQuoting:!0,style:"normal",customColor:"#ffa8d2",deriveCustomColors:!0,customControlsColor:"#552222",customNameboxColor:"#ffeef6",customNameboxWidth:168,customNameboxStroke:"#bb5599",talkingDefault:"No-one",talkingOther:"",text:""}}),r},setStyle:function(t,e){var n=t.commit;n("setStyle",{id:e.id,style:e.style})},splitTextbox:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r,o,i,a,s,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,o=e.state,i=e.dispatch,a=o.objects[n.id],s=(a.width-4)/2,r("setSize",{id:n.id,width:s,height:a.height}),r("setStyle",{id:n.id,style:"custom"}),r("setPosition",{id:n.id,x:a.x-s/2,y:a.y}),t.next=8,i("createTextBox",{});case 8:c=t.sent,r("setPosition",{id:c,x:a.x+s+2,y:a.y}),r("setSize",{id:c,width:s,height:a.height}),r("setStyle",{id:c,style:"custom"}),a.flip&&r("setFlip",{id:c,flip:a.flip});case 13:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}()};function bo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function vo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bo(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bo(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var mo={namespaced:!0,state:{objects:{},order:[],onTopOrder:[]},mutations:vo({create:function(t,e){t.objects[e.object.id]=e.object,e.object.onTop?t.onTopOrder.push(e.object.id):t.order.push(e.object.id)},removeFromList:function(t,e){var n=e.onTop?t.onTopOrder:t.order,r=n.indexOf(e.id);n.splice(r,1)},addToList:function(t,e){var n=e.onTop?t.onTopOrder:t.order;n.splice(e.position,0,e.id)},setOnTop:function(t,e){var n=t.objects[e.id];n.onTop=e.onTop},setPosition:function(t,e){var n=t.objects[e.id];n.x=e.x,n.y=e.y},setFlip:function(t,e){var n=t.objects[e.id];n.flip=e.flip},setOpacity:function(t,e){var n=t.objects[e.id];n.opacity=e.opacity},setSize:function(t,e){var n=t.objects[e.id];n.width=e.width,n.height=e.height},setRatio:function(t,e){var n=t.objects[e.id];n.preserveRatio=e.preserveRatio,n.ratio=e.ratio},removeObject:function(t,e){delete t.objects[e.id]}},co,{},wt,{},ho),actions:vo({removeObject:function(t,e){var n=t.state,r=t.commit,o=n.objects[e.id];r("removeFromList",{id:e.id,onTop:o.onTop}),r("removeObject",{id:e.id})},setPosition:function(t,e){var n=t.state,r=t.commit,o=t.dispatch,i=n.objects[e.id];"character"===i.type?o("setCharacterPosition",e):r("setPosition",e)},setOnTop:function(t,e){var n=t.state,r=t.commit,o=n.objects[e.id];o.onTop!==e.onTop&&(r("removeFromList",{id:e.id,onTop:o.onTop}),r("addToList",{id:e.id,position:(e.onTop?n.onTopOrder:n.order).length,onTop:e.onTop}),r("setOnTop",{id:e.id,onTop:e.onTop}))},shiftLayer:function(t,e){var n=t.state,r=t.commit,o=n.objects[e.id],i=o.onTop?n.onTopOrder:n.order,a=i.indexOf(o.id),s=a+e.delta;s<0&&(s=0),s>i.length&&(s=i.length),r("removeFromList",{id:e.id,onTop:o.onTop}),r("addToList",{id:e.id,position:s,onTop:o.onTop})},setPreserveRatio:function(t,e){var n=t.commit,r=t.state,o=r.objects[e.id],i=e.preserveRatio?o.width/o.height:0;n("setRatio",{id:e.id,preserveRatio:e.preserveRatio,ratio:i})},setWidth:function(t,e){var n=t.commit,r=t.state,o=r.objects[e.id],i=o.preserveRatio?e.width/o.ratio:o.height;n("setSize",{id:e.id,height:i,width:e.width})},setHeight:function(t,e){var n=t.commit,r=t.state,o=r.objects[e.id],i=o.preserveRatio?e.height*o.ratio:o.width;n("setSize",{id:e.id,height:e.height,width:i})},fixContentPackRemoval:function(t,e){Object.values(t.state.objects).map((function(n){switch(n.type){case"character":return void Tt(t,n.id,e);case"sprite":return;case"textBox":return}}))}},lo,{},$t,{},po)},go={namespaced:!0,state:{vertical:!1,lqRendering:!0,nsfw:!1,selection:null,lastDownload:null},mutations:{setVertical:function(t,e){t.vertical=e},setNsfw:function(t,e){t.nsfw=e},setLqRendering:function(t,e){t.lqRendering=e},setSelection:function(t,e){t.selection=e},setLastDownload:function(t,e){t.lastDownload=e}}},yo=(n("f400"),n("0a94")),ko=n("5311"),jo=n("77e3"),wo=n("b3a0");function xo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Oo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xo(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xo(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Co(t,e){return{backgrounds:Po(t.backgrounds,e.backgrounds),characters:Ro(t.characters,e.characters),fonts:Io(t.fonts,e.fonts,(function(t){return t.id}),(function(t,e){return Oo({},t,{files:Lo(t.files,e.files)})})),poemStyles:Io(t.poemStyles,e.poemStyles,(function(t){return t.label}),(function(){throw new Error})),sprites:Io(t.sprites,e.sprites,(function(t){return t.label}),(function(t,e){return{label:t.label,variants:[].concat(Object(cn["a"])(t.variants),Object(cn["a"])(e.variants))}}))}}function Po(t,e){return Io(t,e,(function(t){return t.label}),_o)}function _o(t,e){return{label:e.label,variants:[].concat(Object(cn["a"])(t.variants),Object(cn["a"])(e.variants))}}function Ro(t,e){return Io(t,e,(function(t){return t.id}),So)}function So(t,e){return{chibi:t.chibi,id:t.id,label:t.label,size:t.size,styleComponents:Io(t.styleComponents,e.styleComponents,(function(t){return t.name}),(function(t,e){return{label:t.label,name:t.name,variants:Oo({},e.variants,{},t.variants)}})),heads:To(t.heads,e.heads),poses:Io(t.poses,e.poses,(function(t){return t.name}),$o),styles:Io(t.styles,e.styles,(function(t){return t.name}),(function(t,e){throw new Error("Colliding style definitions")}))}}function $o(t,e){if(t.static&&t.static.length>0&&e.static&&e.static.length>0)throw new Error("Colliding static poses");return{compatibleHeads:Lo(t.compatibleHeads,e.compatibleHeads),headAnchor:t.headAnchor,left:[].concat(Object(cn["a"])(t.left),Object(cn["a"])(e.left)),right:[].concat(Object(cn["a"])(t.right),Object(cn["a"])(e.right)),name:t.name,offset:t.offset,renderOrder:t.renderOrder,size:t.size,static:t.static,style:t.style,variant:[].concat(Object(cn["a"])(t.variant),Object(cn["a"])(e.variant))}}function To(t,e){var n=Oo({},t);for(var r in e)if(e.hasOwnProperty(r)){var o=e[r];if(n[r]){var i=n[r];n[r]={offset:i.offset,size:i.size,variants:[].concat(Object(cn["a"])(i.variants),Object(cn["a"])(o.variants))}}else n[r]=o}return n}function Lo(t,e){var n=Object(cn["a"])(t),r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var c=a.value;n.includes(c)||n.push(c)}}catch(u){o=!0,i=u}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}function Io(t,e,n,r){var o=Object(cn["a"])(t),i=new Map(t.map((function(t,e){return[n(t),e]}))),a=!0,s=!1,c=void 0;try{for(var u,l=e[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var h=u.value,d=n(h);if(i.has(d)){var f=i.get(d),p=o[f];o.splice(f,1,r(p,h))}else i.set(d,o.length),o.push(h)}}catch(b){s=!0,c=b}finally{try{a||null==l.return||l.return()}finally{if(s)throw c}}return o}function Do(t){return t.split("/").slice(0,-1).join("/")+"/"}var Eo=new Set(["png","gif","bmp","svg"]),No={namespaced:!0,state:{contentPacks:[],current:{backgrounds:[],characters:[],fonts:[],poemStyles:[],sprites:[]}},mutations:{setContentPacks:function(t,e){t.contentPacks=e},setCurrentContent:function(t,e){t.current=e}},actions:{contentPack:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,o=e.state,t.next=3,Mo(n);case 3:i=t.sent,r("setContentPacks",[].concat(Object(cn["a"])(o.contentPacks),[i])),r("setCurrentContent",Co(o.current,i));case 6:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}(),removeContentPacks:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=e.commit,o=e.state,i=o.contentPacks.filter((function(t){return!n.has(t.packId)})),r("setContentPacks",i),r("setCurrentContent",i.reduce((function(t,e){return Co(t,e)})));case 4:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}(),replaceContentPack:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r,o,i,a,s,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,o=e.state,i=n.contentPack,t.next=4,Mo(i);case 4:a=t.sent,s=o.contentPacks,c=s.findIndex((function(t){return t.packId===i.packId})),-1===c?s.push(a):s.splice(c,1,a),r("setContentPacks",s),r("setCurrentContent",s.reduce((function(t,e){return Co(t,e)})));case 10:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}(),loadContentPacks:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r,o,i,a,c,u,l,h;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.dispatch,"string"===typeof n&&(n=[n]),t.next=4,Promise.all(n.map(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch(e);case 2:return n=t.sent,200!==n.status&&Ao("Could not load content pack. Server responded with: ".concat(n.statusText)),t.prev=4,t.next=7,n.json();case 7:r=t.sent,t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](4),Ao("Content pack is not valid json!");case 13:try{i={"./":Do(e),"/":Do(location.href)+"assets/"},o="2.0"===r.version?Object(ko["normalizeContentPack"])(r,i):Object(jo["convert"])(Object(wo["normalizeCharacter"])(r,i),!1)}catch(a){Ao("Content pack is not in a valid format!",a)}return t.abrupt("return",o);case 15:case"end":return t.stop()}}),t,null,[[4,10]])})));return function(e){return t.apply(this,arguments)}}()));case 4:o=t.sent,i=!0,a=!1,c=void 0,t.prev=8,u=o[Symbol.iterator]();case 10:if(i=(l=u.next()).done){t.next=17;break}return h=l.value,t.next=14,r("contentPack",h);case 14:i=!0,t.next=10;break;case 17:t.next=23;break;case 19:t.prev=19,t.t0=t["catch"](8),a=!0,c=t.t0;case 23:t.prev=23,t.prev=24,i||null==u.return||u.return();case 26:if(t.prev=26,!a){t.next=29;break}throw c;case 29:return t.finish(26);case 30:return t.finish(23);case 31:case"end":return t.stop()}}),t,null,[[8,19,23,31],[24,,26,30]])})));function e(e,n){return t.apply(this,arguments)}return e}()},getters:{getCharacters:function(t){var e=t.current,n=new Map,r=!0,o=!1,i=void 0;try{for(var a,s=e.characters[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var c=a.value;n.set(c.id,c)}}catch(u){o=!0,i=u}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n},getBackgrounds:function(t){var e=t.current,n=new Map,r=!0,o=!1,i=void 0;try{for(var a,s=e.backgrounds[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var c=a.value;n.set(c.label,c)}}catch(u){o=!0,i=u}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}};function Mo(t){return Uo.apply(this,arguments)}function Uo(){return Uo=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.t0=Set,t.next=3,Q();case 3:if(!t.sent){t.next=7;break}t.t1=["webp"].concat(Object(cn["a"])(Eo)),t.next=8;break;case 7:t.t1=Eo;case 8:return t.t2=t.t1,n=new t.t0(t.t2),t.abrupt("return",Object(yo["assetWalker"])(e,(function(t,r){var o=new Map([["ext","{lq:.lq:}.{format:webp:webp:png:png}"]]),i=Object(yo["normalizePath"])(t,o,n,!1),a=Object(yo["normalizePath"])(t,o,n,!0);return{hq:i,lq:a,sourcePack:e.packId||"buildIn"}})));case 11:case"end":return t.stop()}}),t)}))),Uo.apply(this,arguments)}function Ao(t,e){throw console.error(t,e),new Error(t)}o["a"].use(i["a"]);var Bo=new i["a"].Store({modules:{objects:mo,ui:go,background:ur,content:No},state:{unsafe:!1},mutations:{setUnsafe:function(t,e){}},actions:{removePacks:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e,n){var r,o,i,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.dispatch,o=e.commit,i=e.state,a=n.packs,s=JSON.parse(JSON.stringify(i.content.current)),o("setUnsafe",!0),t.next=6,r("content/removeContentPacks",a);case 6:return t.next=8,r("background/fixContentPackRemoval",s);case 8:return t.next=10,r("objects/fixContentPackRemoval",s);case 10:o("setUnsafe",!1);case 11:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}()}}),Fo={mutations:{}};function qo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ho(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?qo(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qo(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var zo={mutations:Ho({"objects/*":{combinable:function(t,e){return t.type===e.type&&t.payload.id===e.payload.id}},"objects/create":{combinable:function(){return!1}},"objects/removeObject":{combinable:function(){return!1}}},Fo.mutations)};function Wo(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Vo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Wo(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Wo(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}o["a"].config.productionTip=!1,o["a"].use(i["a"]),o["a"].use(c,{mutations:Vo({},zo.mutations)}),new o["a"]({store:Bo,render:function(t){return t(so)}}).$mount("#app")},cf62:function(t,e,n){},dd58:function(t,e,n){},df9f:function(t,e,n){},e332:function(t,e,n){},e6de:function(t,e,n){"use strict";var r=n("06b9"),o=n.n(r);o.a},fb87:function(t,e,n){"use strict";var r=n("df9f"),o=n.n(r);o.a}});
//# sourceMappingURL=app.84b39f15.js.map